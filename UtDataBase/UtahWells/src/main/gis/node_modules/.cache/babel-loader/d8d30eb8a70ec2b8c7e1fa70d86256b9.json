{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport { glsl as v } from \"../../shaderModules/interfaces.js\";\nimport { VertexAttribute as e } from \"../../../lib/VertexAttribute.js\";\n\nfunction o(o, r) {\n  r.vvInstancingEnabled && (r.vvSize || r.vvColor) && o.attributes.add(e.INSTANCEFEATUREATTRIBUTE, \"vec4\"), r.vvSize ? (o.vertex.uniforms.add(\"vvSizeMinSize\", \"vec3\"), o.vertex.uniforms.add(\"vvSizeMaxSize\", \"vec3\"), o.vertex.uniforms.add(\"vvSizeOffset\", \"vec3\"), o.vertex.uniforms.add(\"vvSizeFactor\", \"vec3\"), o.vertex.uniforms.add(\"vvSymbolRotationMatrix\", \"mat3\"), o.vertex.uniforms.add(\"vvSymbolAnchor\", \"vec3\"), o.vertex.code.add(v`vec3 vvScale(vec4 _featureAttribute) {\nreturn clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize);\n}\nvec4 vvTransformPosition(vec3 position, vec4 _featureAttribute) {\nreturn vec4(vvSymbolRotationMatrix * ( vvScale(_featureAttribute) * (position + vvSymbolAnchor)), 1.0);\n}`), o.vertex.code.add(v`\n      const float eps = 1.192092896e-07;\n      vec4 vvTransformNormal(vec3 _normal, vec4 _featureAttribute) {\n        vec3 vvScale = clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize + eps, vvSizeMaxSize);\n        return vec4(vvSymbolRotationMatrix * _normal / vvScale, 1.0);\n      }\n\n      ${r.vvInstancingEnabled ? v`\n      vec4 vvLocalNormal(vec3 _normal) {\n        return vvTransformNormal(_normal, instanceFeatureAttribute);\n      }\n\n      vec4 localPosition() {\n        return vvTransformPosition(position, instanceFeatureAttribute);\n      }` : \"\"}\n    `)) : o.vertex.code.add(v`vec4 localPosition() { return vec4(position, 1.0); }\nvec4 vvLocalNormal(vec3 _normal) { return vec4(_normal, 1.0); }`), r.vvColor ? (o.vertex.constants.add(\"vvColorNumber\", \"int\", 8), o.vertex.code.add(v`\n      uniform float vvColorValues[vvColorNumber];\n      uniform vec4 vvColorColors[vvColorNumber];\n\n      vec4 vvGetColor(vec4 featureAttribute, float values[vvColorNumber], vec4 colors[vvColorNumber]) {\n        float value = featureAttribute.y;\n        if (value <= values[0]) {\n          return colors[0];\n        }\n\n        for (int i = 1; i < vvColorNumber; ++i) {\n          if (values[i] >= value) {\n            float f = (value - values[i-1]) / (values[i] - values[i-1]);\n            return mix(colors[i-1], colors[i], f);\n          }\n        }\n        return colors[vvColorNumber - 1];\n      }\n\n      ${r.vvInstancingEnabled ? v`\n      vec4 vvColor() {\n        return vvGetColor(instanceFeatureAttribute, vvColorValues, vvColorColors);\n      }` : \"\"}\n    `)) : o.vertex.code.add(v`vec4 vvColor() { return vec4(1.0); }`);\n}\n\nfunction r(v, e) {\n  e.vvSizeEnabled && (v.setUniform3fv(\"vvSizeMinSize\", e.vvSizeMinSize), v.setUniform3fv(\"vvSizeMaxSize\", e.vvSizeMaxSize), v.setUniform3fv(\"vvSizeOffset\", e.vvSizeOffset), v.setUniform3fv(\"vvSizeFactor\", e.vvSizeFactor)), e.vvColorEnabled && (v.setUniform1fv(\"vvColorValues\", e.vvColorValues), v.setUniform4fv(\"vvColorColors\", e.vvColorColors));\n}\n\nfunction t(v, e) {\n  r(v, e), e.vvOpacityEnabled && (v.setUniform1fv(\"vvOpacityValues\", e.vvOpacityValues), v.setUniform1fv(\"vvOpacityOpacities\", e.vvOpacityOpacities));\n}\n\nfunction i(v, e) {\n  r(v, e), e.vvSizeEnabled && (v.setUniform3fv(\"vvSymbolAnchor\", e.vvSymbolAnchor), v.setUniformMatrix3fv(\"vvSymbolRotationMatrix\", e.vvSymbolRotationMatrix));\n}\n\nexport { o as VisualVariables, r as bindVisualVariablesUniforms, i as bindVisualVariablesUniformsForSymbols, t as bindVisualVariablesUniformsWithOpacity };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/VisualVariables.glsl.js"],"names":["glsl","v","VertexAttribute","e","o","r","vvInstancingEnabled","vvSize","vvColor","attributes","add","INSTANCEFEATUREATTRIBUTE","vertex","uniforms","code","constants","vvSizeEnabled","setUniform3fv","vvSizeMinSize","vvSizeMaxSize","vvSizeOffset","vvSizeFactor","vvColorEnabled","setUniform1fv","vvColorValues","setUniform4fv","vvColorColors","t","vvOpacityEnabled","vvOpacityValues","vvOpacityOpacities","i","vvSymbolAnchor","setUniformMatrix3fv","vvSymbolRotationMatrix","VisualVariables","bindVisualVariablesUniforms","bindVisualVariablesUniformsForSymbols","bindVisualVariablesUniformsWithOpacity"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{glsl as v}from\"../../shaderModules/interfaces.js\";import{VertexAttribute as e}from\"../../../lib/VertexAttribute.js\";function o(o,r){r.vvInstancingEnabled&&(r.vvSize||r.vvColor)&&o.attributes.add(e.INSTANCEFEATUREATTRIBUTE,\"vec4\"),r.vvSize?(o.vertex.uniforms.add(\"vvSizeMinSize\",\"vec3\"),o.vertex.uniforms.add(\"vvSizeMaxSize\",\"vec3\"),o.vertex.uniforms.add(\"vvSizeOffset\",\"vec3\"),o.vertex.uniforms.add(\"vvSizeFactor\",\"vec3\"),o.vertex.uniforms.add(\"vvSymbolRotationMatrix\",\"mat3\"),o.vertex.uniforms.add(\"vvSymbolAnchor\",\"vec3\"),o.vertex.code.add(v`vec3 vvScale(vec4 _featureAttribute) {\nreturn clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize);\n}\nvec4 vvTransformPosition(vec3 position, vec4 _featureAttribute) {\nreturn vec4(vvSymbolRotationMatrix * ( vvScale(_featureAttribute) * (position + vvSymbolAnchor)), 1.0);\n}`),o.vertex.code.add(v`\n      const float eps = 1.192092896e-07;\n      vec4 vvTransformNormal(vec3 _normal, vec4 _featureAttribute) {\n        vec3 vvScale = clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize + eps, vvSizeMaxSize);\n        return vec4(vvSymbolRotationMatrix * _normal / vvScale, 1.0);\n      }\n\n      ${r.vvInstancingEnabled?v`\n      vec4 vvLocalNormal(vec3 _normal) {\n        return vvTransformNormal(_normal, instanceFeatureAttribute);\n      }\n\n      vec4 localPosition() {\n        return vvTransformPosition(position, instanceFeatureAttribute);\n      }`:\"\"}\n    `)):o.vertex.code.add(v`vec4 localPosition() { return vec4(position, 1.0); }\nvec4 vvLocalNormal(vec3 _normal) { return vec4(_normal, 1.0); }`),r.vvColor?(o.vertex.constants.add(\"vvColorNumber\",\"int\",8),o.vertex.code.add(v`\n      uniform float vvColorValues[vvColorNumber];\n      uniform vec4 vvColorColors[vvColorNumber];\n\n      vec4 vvGetColor(vec4 featureAttribute, float values[vvColorNumber], vec4 colors[vvColorNumber]) {\n        float value = featureAttribute.y;\n        if (value <= values[0]) {\n          return colors[0];\n        }\n\n        for (int i = 1; i < vvColorNumber; ++i) {\n          if (values[i] >= value) {\n            float f = (value - values[i-1]) / (values[i] - values[i-1]);\n            return mix(colors[i-1], colors[i], f);\n          }\n        }\n        return colors[vvColorNumber - 1];\n      }\n\n      ${r.vvInstancingEnabled?v`\n      vec4 vvColor() {\n        return vvGetColor(instanceFeatureAttribute, vvColorValues, vvColorColors);\n      }`:\"\"}\n    `)):o.vertex.code.add(v`vec4 vvColor() { return vec4(1.0); }`)}function r(v,e){e.vvSizeEnabled&&(v.setUniform3fv(\"vvSizeMinSize\",e.vvSizeMinSize),v.setUniform3fv(\"vvSizeMaxSize\",e.vvSizeMaxSize),v.setUniform3fv(\"vvSizeOffset\",e.vvSizeOffset),v.setUniform3fv(\"vvSizeFactor\",e.vvSizeFactor)),e.vvColorEnabled&&(v.setUniform1fv(\"vvColorValues\",e.vvColorValues),v.setUniform4fv(\"vvColorColors\",e.vvColorColors))}function t(v,e){r(v,e),e.vvOpacityEnabled&&(v.setUniform1fv(\"vvOpacityValues\",e.vvOpacityValues),v.setUniform1fv(\"vvOpacityOpacities\",e.vvOpacityOpacities))}function i(v,e){r(v,e),e.vvSizeEnabled&&(v.setUniform3fv(\"vvSymbolAnchor\",e.vvSymbolAnchor),v.setUniformMatrix3fv(\"vvSymbolRotationMatrix\",e.vvSymbolRotationMatrix))}export{o as VisualVariables,r as bindVisualVariablesUniforms,i as bindVisualVariablesUniformsForSymbols,t as bindVisualVariablesUniformsWithOpacity};\n"]},"metadata":{},"sourceType":"module"}