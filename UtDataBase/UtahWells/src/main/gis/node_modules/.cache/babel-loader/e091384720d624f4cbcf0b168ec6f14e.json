{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport e from \"../../core/Collection.js\";\nimport \"../../core/has.js\";\nimport { eachAlways as r } from \"../../core/promiseUtils.js\";\nimport { layerLookupMap as a } from \"./lazyLayerLoader.js\";\nimport y from \"../../portal/PortalItem.js\";\nimport { isMapNotesLayer as t, isRouteLayer as i } from \"../../portal/support/featureCollectionUtils.js\";\nimport { selectLayerClassPath as L } from \"../../portal/support/portalLayers.js\";\nimport { loadStyleRenderer as o } from \"../../renderers/support/styleUtils.js\";\n\nasync function n(e, a, y) {\n  if (!a) return;\n  const t = [];\n\n  for (const r of a) {\n    const e = d(r, y);\n    \"GroupLayer\" === r.layerType ? t.push(G(e, r, y)) : t.push(e);\n  }\n\n  const i = await r(t);\n\n  for (const r of i) !r.value || y.filter && !y.filter(r.value) || e.add(r.value);\n}\n\nconst l = {\n  ArcGISFeatureLayer: \"FeatureLayer\",\n  ArcGISImageServiceLayer: \"ImageryLayer\",\n  ArcGISMapServiceLayer: \"MapImageLayer\",\n  PointCloudLayer: \"PointCloudLayer\",\n  ArcGISSceneServiceLayer: \"SceneLayer\",\n  IntegratedMeshLayer: \"IntegratedMeshLayer\",\n  OGCFeatureLayer: \"OGCFeatureLayer\",\n  BuildingSceneLayer: \"BuildingSceneLayer\",\n  ArcGISTiledElevationServiceLayer: \"ElevationLayer\",\n  ArcGISTiledImageServiceLayer: \"ImageryTileLayer\",\n  ArcGISTiledMapServiceLayer: \"TileLayer\",\n  GroupLayer: \"GroupLayer\",\n  GeoJSON: \"GeoJSONLayer\",\n  WebTiledLayer: \"WebTileLayer\",\n  CSV: \"CSVLayer\",\n  VectorTileLayer: \"VectorTileLayer\",\n  WFS: \"WFSLayer\",\n  WMS: \"WMSLayer\",\n  DefaultTileLayer: \"TileLayer\",\n  KML: \"KMLLayer\",\n  RasterDataLayer: \"UnsupportedLayer\",\n  Voxel: \"VoxelLayer\"\n},\n      c = {\n  ArcGISTiledElevationServiceLayer: \"ElevationLayer\",\n  DefaultTileLayer: \"ElevationLayer\",\n  RasterDataElevationLayer: \"UnsupportedLayer\"\n},\n      s = {\n  ArcGISTiledMapServiceLayer: \"TileLayer\",\n  ArcGISTiledImageServiceLayer: \"ImageryTileLayer\",\n  OpenStreetMap: \"OpenStreetMapLayer\",\n  WebTiledLayer: \"WebTileLayer\",\n  VectorTileLayer: \"VectorTileLayer\",\n  ArcGISImageServiceLayer: \"UnsupportedLayer\",\n  WMS: \"UnsupportedLayer\",\n  ArcGISMapServiceLayer: \"UnsupportedLayer\",\n  DefaultTileLayer: \"TileLayer\"\n},\n      p = {\n  ArcGISFeatureLayer: \"FeatureLayer\",\n  ArcGISImageServiceLayer: \"ImageryLayer\",\n  ArcGISImageServiceVectorLayer: \"ImageryLayer\",\n  ArcGISMapServiceLayer: \"MapImageLayer\",\n  ArcGISStreamLayer: \"StreamLayer\",\n  ArcGISTiledImageServiceLayer: \"ImageryTileLayer\",\n  ArcGISTiledMapServiceLayer: \"TileLayer\",\n  BingMapsAerial: \"BingMapsLayer\",\n  BingMapsRoad: \"BingMapsLayer\",\n  BingMapsHybrid: \"BingMapsLayer\",\n  CSV: \"CSVLayer\",\n  DefaultTileLayer: \"TileLayer\",\n  GeoRSS: \"GeoRSSLayer\",\n  GeoJSON: \"GeoJSONLayer\",\n  GroupLayer: \"GroupLayer\",\n  KML: \"KMLLayer\",\n  OGCFeatureLayer: \"OGCFeatureLayer\",\n  SubtypeGroupLayer: \"UnsupportedLayer\",\n  VectorTileLayer: \"VectorTileLayer\",\n  WFS: \"WFSLayer\",\n  WMS: \"WMSLayer\",\n  WebTiledLayer: \"WebTileLayer\"\n},\n      u = {\n  ArcGISFeatureLayer: \"FeatureLayer\"\n},\n      S = {\n  ArcGISImageServiceLayer: \"ImageryLayer\",\n  ArcGISImageServiceVectorLayer: \"ImageryLayer\",\n  ArcGISMapServiceLayer: \"MapImageLayer\",\n  ArcGISTiledImageServiceLayer: \"ImageryTileLayer\",\n  ArcGISTiledMapServiceLayer: \"TileLayer\",\n  OpenStreetMap: \"OpenStreetMapLayer\",\n  VectorTileLayer: \"VectorTileLayer\",\n  WebTiledLayer: \"WebTileLayer\",\n  BingMapsAerial: \"BingMapsLayer\",\n  BingMapsRoad: \"BingMapsLayer\",\n  BingMapsHybrid: \"BingMapsLayer\",\n  WMS: \"WMSLayer\",\n  DefaultTileLayer: \"TileLayer\"\n};\n\nasync function d(e, r) {\n  return I(await T(e, r), e, r);\n}\n\nasync function I(e, r, a) {\n  const y = new e();\n  return y.read(r, a.context), \"group\" === y.type && m(r) && (await M(y, r, a.context)), await o(y, a.context), y;\n}\n\nasync function T(e, r) {\n  const o = r.context,\n        n = g(o);\n  let l = e.layerType || e.type;\n  !l && r && r.defaultLayerType && (l = r.defaultLayerType);\n  const c = n[l];\n  let s = c ? a[c] : a.UnknownLayer;\n\n  if (f(e)) {\n    const r = null == o ? void 0 : o.portal;\n\n    if (e.itemId) {\n      const t = new y({\n        id: e.itemId,\n        portal: r\n      });\n      await t.load();\n      const i = (await L(t)).className || \"UnknownLayer\";\n      s = a[i];\n    }\n  } else \"ArcGISFeatureLayer\" === l ? t(e) ? s = a.MapNotesLayer : i(e) ? s = a.RouteLayer : m(e) && (s = a.GroupLayer) : e.wmtsInfo && e.wmtsInfo.url && e.wmtsInfo.layerIdentifier ? s = a.WMTSLayer : \"WFS\" === l && \"2.0.0\" !== e.wfsInfo.version && (s = a.UnsupportedLayer);\n\n  return s();\n}\n\nfunction m(e) {\n  var r, a, y;\n  if (\"ArcGISFeatureLayer\" !== e.layerType || f(e)) return !1;\n  return (null != (r = null == (a = e.featureCollection) || null == (y = a.layers) ? void 0 : y.length) ? r : 0) > 1;\n}\n\nfunction f(e) {\n  return \"Feature Collection\" === e.type;\n}\n\nfunction g(e) {\n  let r;\n  if (\"web-scene\" === e.origin) switch (e.layerContainerType) {\n    case \"basemap\":\n      r = s;\n      break;\n\n    case \"ground\":\n      r = c;\n      break;\n\n    default:\n      r = l;\n  } else switch (e.layerContainerType) {\n    case \"basemap\":\n      r = S;\n      break;\n\n    case \"tables\":\n      r = u;\n      break;\n\n    default:\n      r = p;\n  }\n  return r;\n}\n\nasync function G(r, a, y) {\n  const t = new e(),\n        i = n(t, Array.isArray(a.layers) ? a.layers : [], y),\n        L = await r;\n  if (await i, \"group\" === L.type) return L.layers.addMany(t), L;\n}\n\nasync function M(e, r, y) {\n  const t = a.FeatureLayer,\n        i = await t(),\n        L = r.featureCollection,\n        o = L.showLegend,\n        n = L.layers.map((a, t) => {\n    var L, n;\n    const l = new i();\n    l.read(a, y);\n    const c = { ...y,\n      ignoreDefaults: !0\n    };\n    return l.read({\n      id: `${e.id}-sublayer-${t}`,\n      visibility: null == (L = null == (n = r.visibleLayers) ? void 0 : n.includes(t)) || L\n    }, c), null != o && l.read({\n      showLegend: o\n    }, c), l;\n  });\n  e.layers.addMany(n);\n}\n\nexport { n as populateOperationalLayers };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/layers/support/layersCreator.js"],"names":["e","eachAlways","r","layerLookupMap","a","y","isMapNotesLayer","t","isRouteLayer","i","selectLayerClassPath","L","loadStyleRenderer","o","n","d","layerType","push","G","value","filter","add","l","ArcGISFeatureLayer","ArcGISImageServiceLayer","ArcGISMapServiceLayer","PointCloudLayer","ArcGISSceneServiceLayer","IntegratedMeshLayer","OGCFeatureLayer","BuildingSceneLayer","ArcGISTiledElevationServiceLayer","ArcGISTiledImageServiceLayer","ArcGISTiledMapServiceLayer","GroupLayer","GeoJSON","WebTiledLayer","CSV","VectorTileLayer","WFS","WMS","DefaultTileLayer","KML","RasterDataLayer","Voxel","c","RasterDataElevationLayer","s","OpenStreetMap","p","ArcGISImageServiceVectorLayer","ArcGISStreamLayer","BingMapsAerial","BingMapsRoad","BingMapsHybrid","GeoRSS","SubtypeGroupLayer","u","S","I","T","read","context","type","m","M","g","defaultLayerType","UnknownLayer","f","portal","itemId","id","load","className","MapNotesLayer","RouteLayer","wmtsInfo","url","layerIdentifier","WMTSLayer","wfsInfo","version","UnsupportedLayer","featureCollection","layers","length","origin","layerContainerType","Array","isArray","addMany","FeatureLayer","showLegend","map","ignoreDefaults","visibility","visibleLayers","includes","populateOperationalLayers"],"mappings":"AAAA;AACA;AACA;AACA;AACA,OAAOA,CAAP,MAAa,0BAAb;AAAwC,OAAM,mBAAN;AAA0B,SAAOC,UAAU,IAAIC,CAArB,QAA2B,4BAA3B;AAAwD,SAAOC,cAAc,IAAIC,CAAzB,QAA+B,sBAA/B;AAAsD,OAAOC,CAAP,MAAa,4BAAb;AAA0C,SAAOC,eAAe,IAAIC,CAA1B,EAA4BC,YAAY,IAAIC,CAA5C,QAAkD,gDAAlD;AAAmG,SAAOC,oBAAoB,IAAIC,CAA/B,QAAqC,sCAArC;AAA4E,SAAOC,iBAAiB,IAAIC,CAA5B,QAAkC,uCAAlC;;AAA0E,eAAeC,CAAf,CAAiBd,CAAjB,EAAmBI,CAAnB,EAAqBC,CAArB,EAAuB;AAAC,MAAG,CAACD,CAAJ,EAAM;AAAO,QAAMG,CAAC,GAAC,EAAR;;AAAW,OAAI,MAAML,CAAV,IAAeE,CAAf,EAAiB;AAAC,UAAMJ,CAAC,GAACe,CAAC,CAACb,CAAD,EAAGG,CAAH,CAAT;AAAe,qBAAeH,CAAC,CAACc,SAAjB,GAA2BT,CAAC,CAACU,IAAF,CAAOC,CAAC,CAAClB,CAAD,EAAGE,CAAH,EAAKG,CAAL,CAAR,CAA3B,GAA4CE,CAAC,CAACU,IAAF,CAAOjB,CAAP,CAA5C;AAAsD;;AAAA,QAAMS,CAAC,GAAC,MAAMP,CAAC,CAACK,CAAD,CAAf;;AAAmB,OAAI,MAAML,CAAV,IAAeO,CAAf,EAAiB,CAACP,CAAC,CAACiB,KAAH,IAAUd,CAAC,CAACe,MAAF,IAAU,CAACf,CAAC,CAACe,MAAF,CAASlB,CAAC,CAACiB,KAAX,CAArB,IAAwCnB,CAAC,CAACqB,GAAF,CAAMnB,CAAC,CAACiB,KAAR,CAAxC;AAAuD;;AAAA,MAAMG,CAAC,GAAC;AAACC,EAAAA,kBAAkB,EAAC,cAApB;AAAmCC,EAAAA,uBAAuB,EAAC,cAA3D;AAA0EC,EAAAA,qBAAqB,EAAC,eAAhG;AAAgHC,EAAAA,eAAe,EAAC,iBAAhI;AAAkJC,EAAAA,uBAAuB,EAAC,YAA1K;AAAuLC,EAAAA,mBAAmB,EAAC,qBAA3M;AAAiOC,EAAAA,eAAe,EAAC,iBAAjP;AAAmQC,EAAAA,kBAAkB,EAAC,oBAAtR;AAA2SC,EAAAA,gCAAgC,EAAC,gBAA5U;AAA6VC,EAAAA,4BAA4B,EAAC,kBAA1X;AAA6YC,EAAAA,0BAA0B,EAAC,WAAxa;AAAobC,EAAAA,UAAU,EAAC,YAA/b;AAA4cC,EAAAA,OAAO,EAAC,cAApd;AAAmeC,EAAAA,aAAa,EAAC,cAAjf;AAAggBC,EAAAA,GAAG,EAAC,UAApgB;AAA+gBC,EAAAA,eAAe,EAAC,iBAA/hB;AAAijBC,EAAAA,GAAG,EAAC,UAArjB;AAAgkBC,EAAAA,GAAG,EAAC,UAApkB;AAA+kBC,EAAAA,gBAAgB,EAAC,WAAhmB;AAA4mBC,EAAAA,GAAG,EAAC,UAAhnB;AAA2nBC,EAAAA,eAAe,EAAC,kBAA3oB;AAA8pBC,EAAAA,KAAK,EAAC;AAApqB,CAAR;AAAA,MAA0rBC,CAAC,GAAC;AAACd,EAAAA,gCAAgC,EAAC,gBAAlC;AAAmDU,EAAAA,gBAAgB,EAAC,gBAApE;AAAqFK,EAAAA,wBAAwB,EAAC;AAA9G,CAA5rB;AAAA,MAA8zBC,CAAC,GAAC;AAACd,EAAAA,0BAA0B,EAAC,WAA5B;AAAwCD,EAAAA,4BAA4B,EAAC,kBAArE;AAAwFgB,EAAAA,aAAa,EAAC,oBAAtG;AAA2HZ,EAAAA,aAAa,EAAC,cAAzI;AAAwJE,EAAAA,eAAe,EAAC,iBAAxK;AAA0Ld,EAAAA,uBAAuB,EAAC,kBAAlN;AAAqOgB,EAAAA,GAAG,EAAC,kBAAzO;AAA4Pf,EAAAA,qBAAqB,EAAC,kBAAlR;AAAqSgB,EAAAA,gBAAgB,EAAC;AAAtT,CAAh0B;AAAA,MAAmoCQ,CAAC,GAAC;AAAC1B,EAAAA,kBAAkB,EAAC,cAApB;AAAmCC,EAAAA,uBAAuB,EAAC,cAA3D;AAA0E0B,EAAAA,6BAA6B,EAAC,cAAxG;AAAuHzB,EAAAA,qBAAqB,EAAC,eAA7I;AAA6J0B,EAAAA,iBAAiB,EAAC,aAA/K;AAA6LnB,EAAAA,4BAA4B,EAAC,kBAA1N;AAA6OC,EAAAA,0BAA0B,EAAC,WAAxQ;AAAoRmB,EAAAA,cAAc,EAAC,eAAnS;AAAmTC,EAAAA,YAAY,EAAC,eAAhU;AAAgVC,EAAAA,cAAc,EAAC,eAA/V;AAA+WjB,EAAAA,GAAG,EAAC,UAAnX;AAA8XI,EAAAA,gBAAgB,EAAC,WAA/Y;AAA2Zc,EAAAA,MAAM,EAAC,aAAla;AAAgbpB,EAAAA,OAAO,EAAC,cAAxb;AAAucD,EAAAA,UAAU,EAAC,YAAld;AAA+dQ,EAAAA,GAAG,EAAC,UAAne;AAA8eb,EAAAA,eAAe,EAAC,iBAA9f;AAAghB2B,EAAAA,iBAAiB,EAAC,kBAAliB;AAAqjBlB,EAAAA,eAAe,EAAC,iBAArkB;AAAulBC,EAAAA,GAAG,EAAC,UAA3lB;AAAsmBC,EAAAA,GAAG,EAAC,UAA1mB;AAAqnBJ,EAAAA,aAAa,EAAC;AAAnoB,CAAroC;AAAA,MAAwxDqB,CAAC,GAAC;AAAClC,EAAAA,kBAAkB,EAAC;AAApB,CAA1xD;AAAA,MAA8zDmC,CAAC,GAAC;AAAClC,EAAAA,uBAAuB,EAAC,cAAzB;AAAwC0B,EAAAA,6BAA6B,EAAC,cAAtE;AAAqFzB,EAAAA,qBAAqB,EAAC,eAA3G;AAA2HO,EAAAA,4BAA4B,EAAC,kBAAxJ;AAA2KC,EAAAA,0BAA0B,EAAC,WAAtM;AAAkNe,EAAAA,aAAa,EAAC,oBAAhO;AAAqPV,EAAAA,eAAe,EAAC,iBAArQ;AAAuRF,EAAAA,aAAa,EAAC,cAArS;AAAoTgB,EAAAA,cAAc,EAAC,eAAnU;AAAmVC,EAAAA,YAAY,EAAC,eAAhW;AAAgXC,EAAAA,cAAc,EAAC,eAA/X;AAA+Yd,EAAAA,GAAG,EAAC,UAAnZ;AAA8ZC,EAAAA,gBAAgB,EAAC;AAA/a,CAAh0D;;AAA4vE,eAAe1B,CAAf,CAAiBf,CAAjB,EAAmBE,CAAnB,EAAqB;AAAC,SAAOyD,CAAC,CAAC,MAAMC,CAAC,CAAC5D,CAAD,EAAGE,CAAH,CAAR,EAAcF,CAAd,EAAgBE,CAAhB,CAAR;AAA2B;;AAAA,eAAeyD,CAAf,CAAiB3D,CAAjB,EAAmBE,CAAnB,EAAqBE,CAArB,EAAuB;AAAC,QAAMC,CAAC,GAAC,IAAIL,CAAJ,EAAR;AAAc,SAAOK,CAAC,CAACwD,IAAF,CAAO3D,CAAP,EAASE,CAAC,CAAC0D,OAAX,GAAoB,YAAUzD,CAAC,CAAC0D,IAAZ,IAAkBC,CAAC,CAAC9D,CAAD,CAAnB,KAAwB,MAAM+D,CAAC,CAAC5D,CAAD,EAAGH,CAAH,EAAKE,CAAC,CAAC0D,OAAP,CAA/B,CAApB,EAAmE,MAAMjD,CAAC,CAACR,CAAD,EAAGD,CAAC,CAAC0D,OAAL,CAA1E,EAAwFzD,CAA/F;AAAiG;;AAAA,eAAeuD,CAAf,CAAiB5D,CAAjB,EAAmBE,CAAnB,EAAqB;AAAC,QAAMW,CAAC,GAACX,CAAC,CAAC4D,OAAV;AAAA,QAAkBhD,CAAC,GAACoD,CAAC,CAACrD,CAAD,CAArB;AAAyB,MAAIS,CAAC,GAACtB,CAAC,CAACgB,SAAF,IAAahB,CAAC,CAAC+D,IAArB;AAA0B,GAACzC,CAAD,IAAIpB,CAAJ,IAAOA,CAAC,CAACiE,gBAAT,KAA4B7C,CAAC,GAACpB,CAAC,CAACiE,gBAAhC;AAAkD,QAAMtB,CAAC,GAAC/B,CAAC,CAACQ,CAAD,CAAT;AAAa,MAAIyB,CAAC,GAACF,CAAC,GAACzC,CAAC,CAACyC,CAAD,CAAF,GAAMzC,CAAC,CAACgE,YAAf;;AAA4B,MAAGC,CAAC,CAACrE,CAAD,CAAJ,EAAQ;AAAC,UAAME,CAAC,GAAC,QAAMW,CAAN,GAAQ,KAAK,CAAb,GAAeA,CAAC,CAACyD,MAAzB;;AAAgC,QAAGtE,CAAC,CAACuE,MAAL,EAAY;AAAC,YAAMhE,CAAC,GAAC,IAAIF,CAAJ,CAAM;AAACmE,QAAAA,EAAE,EAACxE,CAAC,CAACuE,MAAN;AAAaD,QAAAA,MAAM,EAACpE;AAApB,OAAN,CAAR;AAAsC,YAAMK,CAAC,CAACkE,IAAF,EAAN;AAAe,YAAMhE,CAAC,GAAC,CAAC,MAAME,CAAC,CAACJ,CAAD,CAAR,EAAamE,SAAb,IAAwB,cAAhC;AAA+C3B,MAAAA,CAAC,GAAC3C,CAAC,CAACK,CAAD,CAAH;AAAO;AAAC,GAAlK,MAAsK,yBAAuBa,CAAvB,GAAyBf,CAAC,CAACP,CAAD,CAAD,GAAK+C,CAAC,GAAC3C,CAAC,CAACuE,aAAT,GAAuBlE,CAAC,CAACT,CAAD,CAAD,GAAK+C,CAAC,GAAC3C,CAAC,CAACwE,UAAT,GAAoBZ,CAAC,CAAChE,CAAD,CAAD,KAAO+C,CAAC,GAAC3C,CAAC,CAAC8B,UAAX,CAApE,GAA2FlC,CAAC,CAAC6E,QAAF,IAAY7E,CAAC,CAAC6E,QAAF,CAAWC,GAAvB,IAA4B9E,CAAC,CAAC6E,QAAF,CAAWE,eAAvC,GAAuDhC,CAAC,GAAC3C,CAAC,CAAC4E,SAA3D,GAAqE,UAAQ1D,CAAR,IAAW,YAAUtB,CAAC,CAACiF,OAAF,CAAUC,OAA/B,KAAyCnC,CAAC,GAAC3C,CAAC,CAAC+E,gBAA7C,CAAhK;;AAA+N,SAAOpC,CAAC,EAAR;AAAW;;AAAA,SAASiB,CAAT,CAAWhE,CAAX,EAAa;AAAC,MAAIE,CAAJ,EAAME,CAAN,EAAQC,CAAR;AAAU,MAAG,yBAAuBL,CAAC,CAACgB,SAAzB,IAAoCqD,CAAC,CAACrE,CAAD,CAAxC,EAA4C,OAAM,CAAC,CAAP;AAAS,SAAM,CAAC,SAAOE,CAAC,GAAC,SAAOE,CAAC,GAACJ,CAAC,CAACoF,iBAAX,KAA+B,SAAO/E,CAAC,GAACD,CAAC,CAACiF,MAAX,CAA/B,GAAkD,KAAK,CAAvD,GAAyDhF,CAAC,CAACiF,MAApE,IAA4EpF,CAA5E,GAA8E,CAA/E,IAAkF,CAAxF;AAA0F;;AAAA,SAASmE,CAAT,CAAWrE,CAAX,EAAa;AAAC,SAAM,yBAAuBA,CAAC,CAAC+D,IAA/B;AAAoC;;AAAA,SAASG,CAAT,CAAWlE,CAAX,EAAa;AAAC,MAAIE,CAAJ;AAAM,MAAG,gBAAcF,CAAC,CAACuF,MAAnB,EAA0B,QAAOvF,CAAC,CAACwF,kBAAT;AAA6B,SAAI,SAAJ;AAActF,MAAAA,CAAC,GAAC6C,CAAF;AAAI;;AAAM,SAAI,QAAJ;AAAa7C,MAAAA,CAAC,GAAC2C,CAAF;AAAI;;AAAM;AAAQ3C,MAAAA,CAAC,GAACoB,CAAF;AAApF,GAA1B,MAAuH,QAAOtB,CAAC,CAACwF,kBAAT;AAA6B,SAAI,SAAJ;AAActF,MAAAA,CAAC,GAACwD,CAAF;AAAI;;AAAM,SAAI,QAAJ;AAAaxD,MAAAA,CAAC,GAACuD,CAAF;AAAI;;AAAM;AAAQvD,MAAAA,CAAC,GAAC+C,CAAF;AAApF;AAAwF,SAAO/C,CAAP;AAAS;;AAAA,eAAegB,CAAf,CAAiBhB,CAAjB,EAAmBE,CAAnB,EAAqBC,CAArB,EAAuB;AAAC,QAAME,CAAC,GAAC,IAAIP,CAAJ,EAAR;AAAA,QAAcS,CAAC,GAACK,CAAC,CAACP,CAAD,EAAGkF,KAAK,CAACC,OAAN,CAActF,CAAC,CAACiF,MAAhB,IAAwBjF,CAAC,CAACiF,MAA1B,GAAiC,EAApC,EAAuChF,CAAvC,CAAjB;AAAA,QAA2DM,CAAC,GAAC,MAAMT,CAAnE;AAAqE,MAAG,MAAMO,CAAN,EAAQ,YAAUE,CAAC,CAACoD,IAAvB,EAA4B,OAAOpD,CAAC,CAAC0E,MAAF,CAASM,OAAT,CAAiBpF,CAAjB,GAAoBI,CAA3B;AAA6B;;AAAA,eAAesD,CAAf,CAAiBjE,CAAjB,EAAmBE,CAAnB,EAAqBG,CAArB,EAAuB;AAAC,QAAME,CAAC,GAACH,CAAC,CAACwF,YAAV;AAAA,QAAuBnF,CAAC,GAAC,MAAMF,CAAC,EAAhC;AAAA,QAAmCI,CAAC,GAACT,CAAC,CAACkF,iBAAvC;AAAA,QAAyDvE,CAAC,GAACF,CAAC,CAACkF,UAA7D;AAAA,QAAwE/E,CAAC,GAACH,CAAC,CAAC0E,MAAF,CAASS,GAAT,CAAc,CAAC1F,CAAD,EAAGG,CAAH,KAAO;AAAC,QAAII,CAAJ,EAAMG,CAAN;AAAQ,UAAMQ,CAAC,GAAC,IAAIb,CAAJ,EAAR;AAAca,IAAAA,CAAC,CAACuC,IAAF,CAAOzD,CAAP,EAASC,CAAT;AAAY,UAAMwC,CAAC,GAAC,EAAC,GAAGxC,CAAJ;AAAM0F,MAAAA,cAAc,EAAC,CAAC;AAAtB,KAAR;AAAiC,WAAOzE,CAAC,CAACuC,IAAF,CAAO;AAACW,MAAAA,EAAE,EAAE,GAAExE,CAAC,CAACwE,EAAG,aAAYjE,CAAE,EAA1B;AAA4ByF,MAAAA,UAAU,EAAC,SAAOrF,CAAC,GAAC,SAAOG,CAAC,GAACZ,CAAC,CAAC+F,aAAX,IAA0B,KAAK,CAA/B,GAAiCnF,CAAC,CAACoF,QAAF,CAAW3F,CAAX,CAA1C,KAA0DI;AAAjG,KAAP,EAA2GkC,CAA3G,GAA8G,QAAMhC,CAAN,IAASS,CAAC,CAACuC,IAAF,CAAO;AAACgC,MAAAA,UAAU,EAAChF;AAAZ,KAAP,EAAsBgC,CAAtB,CAAvH,EAAgJvB,CAAvJ;AAAyJ,GAAlP,CAA1E;AAA+TtB,EAAAA,CAAC,CAACqF,MAAF,CAASM,OAAT,CAAiB7E,CAAjB;AAAoB;;AAAA,SAAOA,CAAC,IAAIqF,yBAAZ","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport e from\"../../core/Collection.js\";import\"../../core/has.js\";import{eachAlways as r}from\"../../core/promiseUtils.js\";import{layerLookupMap as a}from\"./lazyLayerLoader.js\";import y from\"../../portal/PortalItem.js\";import{isMapNotesLayer as t,isRouteLayer as i}from\"../../portal/support/featureCollectionUtils.js\";import{selectLayerClassPath as L}from\"../../portal/support/portalLayers.js\";import{loadStyleRenderer as o}from\"../../renderers/support/styleUtils.js\";async function n(e,a,y){if(!a)return;const t=[];for(const r of a){const e=d(r,y);\"GroupLayer\"===r.layerType?t.push(G(e,r,y)):t.push(e)}const i=await r(t);for(const r of i)!r.value||y.filter&&!y.filter(r.value)||e.add(r.value)}const l={ArcGISFeatureLayer:\"FeatureLayer\",ArcGISImageServiceLayer:\"ImageryLayer\",ArcGISMapServiceLayer:\"MapImageLayer\",PointCloudLayer:\"PointCloudLayer\",ArcGISSceneServiceLayer:\"SceneLayer\",IntegratedMeshLayer:\"IntegratedMeshLayer\",OGCFeatureLayer:\"OGCFeatureLayer\",BuildingSceneLayer:\"BuildingSceneLayer\",ArcGISTiledElevationServiceLayer:\"ElevationLayer\",ArcGISTiledImageServiceLayer:\"ImageryTileLayer\",ArcGISTiledMapServiceLayer:\"TileLayer\",GroupLayer:\"GroupLayer\",GeoJSON:\"GeoJSONLayer\",WebTiledLayer:\"WebTileLayer\",CSV:\"CSVLayer\",VectorTileLayer:\"VectorTileLayer\",WFS:\"WFSLayer\",WMS:\"WMSLayer\",DefaultTileLayer:\"TileLayer\",KML:\"KMLLayer\",RasterDataLayer:\"UnsupportedLayer\",Voxel:\"VoxelLayer\"},c={ArcGISTiledElevationServiceLayer:\"ElevationLayer\",DefaultTileLayer:\"ElevationLayer\",RasterDataElevationLayer:\"UnsupportedLayer\"},s={ArcGISTiledMapServiceLayer:\"TileLayer\",ArcGISTiledImageServiceLayer:\"ImageryTileLayer\",OpenStreetMap:\"OpenStreetMapLayer\",WebTiledLayer:\"WebTileLayer\",VectorTileLayer:\"VectorTileLayer\",ArcGISImageServiceLayer:\"UnsupportedLayer\",WMS:\"UnsupportedLayer\",ArcGISMapServiceLayer:\"UnsupportedLayer\",DefaultTileLayer:\"TileLayer\"},p={ArcGISFeatureLayer:\"FeatureLayer\",ArcGISImageServiceLayer:\"ImageryLayer\",ArcGISImageServiceVectorLayer:\"ImageryLayer\",ArcGISMapServiceLayer:\"MapImageLayer\",ArcGISStreamLayer:\"StreamLayer\",ArcGISTiledImageServiceLayer:\"ImageryTileLayer\",ArcGISTiledMapServiceLayer:\"TileLayer\",BingMapsAerial:\"BingMapsLayer\",BingMapsRoad:\"BingMapsLayer\",BingMapsHybrid:\"BingMapsLayer\",CSV:\"CSVLayer\",DefaultTileLayer:\"TileLayer\",GeoRSS:\"GeoRSSLayer\",GeoJSON:\"GeoJSONLayer\",GroupLayer:\"GroupLayer\",KML:\"KMLLayer\",OGCFeatureLayer:\"OGCFeatureLayer\",SubtypeGroupLayer:\"UnsupportedLayer\",VectorTileLayer:\"VectorTileLayer\",WFS:\"WFSLayer\",WMS:\"WMSLayer\",WebTiledLayer:\"WebTileLayer\"},u={ArcGISFeatureLayer:\"FeatureLayer\"},S={ArcGISImageServiceLayer:\"ImageryLayer\",ArcGISImageServiceVectorLayer:\"ImageryLayer\",ArcGISMapServiceLayer:\"MapImageLayer\",ArcGISTiledImageServiceLayer:\"ImageryTileLayer\",ArcGISTiledMapServiceLayer:\"TileLayer\",OpenStreetMap:\"OpenStreetMapLayer\",VectorTileLayer:\"VectorTileLayer\",WebTiledLayer:\"WebTileLayer\",BingMapsAerial:\"BingMapsLayer\",BingMapsRoad:\"BingMapsLayer\",BingMapsHybrid:\"BingMapsLayer\",WMS:\"WMSLayer\",DefaultTileLayer:\"TileLayer\"};async function d(e,r){return I(await T(e,r),e,r)}async function I(e,r,a){const y=new e;return y.read(r,a.context),\"group\"===y.type&&m(r)&&await M(y,r,a.context),await o(y,a.context),y}async function T(e,r){const o=r.context,n=g(o);let l=e.layerType||e.type;!l&&r&&r.defaultLayerType&&(l=r.defaultLayerType);const c=n[l];let s=c?a[c]:a.UnknownLayer;if(f(e)){const r=null==o?void 0:o.portal;if(e.itemId){const t=new y({id:e.itemId,portal:r});await t.load();const i=(await L(t)).className||\"UnknownLayer\";s=a[i]}}else\"ArcGISFeatureLayer\"===l?t(e)?s=a.MapNotesLayer:i(e)?s=a.RouteLayer:m(e)&&(s=a.GroupLayer):e.wmtsInfo&&e.wmtsInfo.url&&e.wmtsInfo.layerIdentifier?s=a.WMTSLayer:\"WFS\"===l&&\"2.0.0\"!==e.wfsInfo.version&&(s=a.UnsupportedLayer);return s()}function m(e){var r,a,y;if(\"ArcGISFeatureLayer\"!==e.layerType||f(e))return!1;return(null!=(r=null==(a=e.featureCollection)||null==(y=a.layers)?void 0:y.length)?r:0)>1}function f(e){return\"Feature Collection\"===e.type}function g(e){let r;if(\"web-scene\"===e.origin)switch(e.layerContainerType){case\"basemap\":r=s;break;case\"ground\":r=c;break;default:r=l}else switch(e.layerContainerType){case\"basemap\":r=S;break;case\"tables\":r=u;break;default:r=p}return r}async function G(r,a,y){const t=new e,i=n(t,Array.isArray(a.layers)?a.layers:[],y),L=await r;if(await i,\"group\"===L.type)return L.layers.addMany(t),L}async function M(e,r,y){const t=a.FeatureLayer,i=await t(),L=r.featureCollection,o=L.showLegend,n=L.layers.map(((a,t)=>{var L,n;const l=new i;l.read(a,y);const c={...y,ignoreDefaults:!0};return l.read({id:`${e.id}-sublayer-${t}`,visibility:null==(L=null==(n=r.visibleLayers)?void 0:n.includes(t))||L},c),null!=o&&l.read({showLegend:o},c),l}));e.layers.addMany(n)}export{n as populateOperationalLayers};\n"]},"metadata":{},"sourceType":"module"}