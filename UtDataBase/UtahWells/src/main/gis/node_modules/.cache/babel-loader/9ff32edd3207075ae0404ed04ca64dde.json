{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport { clamp as t } from \"../../../../../core/mathUtils.js\";\nimport { isNone as e, isSome as n } from \"../../../../../core/maybe.js\";\nimport { s as i, c as o, n as r } from \"../../../../../chunks/vec3.js\";\nimport { c as s } from \"../../../../../chunks/vec3f64.js\";\nimport { create as c, setMin as f, setMax as a } from \"../../../../../geometry/support/aaBoundingBox.js\";\nimport { PrimitiveType as l } from \"../../lib/basicInterfaces.js\";\nimport { scale as u } from \"../../lib/screenSizePerspectiveUtils.js\";\nimport { assert as m } from \"../../lib/Util.js\";\nimport { VertexAttribute as p } from \"../../lib/VertexAttribute.js\";\nimport { isInstanceHidden as h } from \"../renderers/utils.js\";\nconst d = c();\n\nfunction g(t, e, n, i, o, r, s) {\n  if (!h(e)) if (t.boundingInfo) {\n    m(t.primitiveType === l.Triangle);\n    const e = n.tolerance;\n    b(t.boundingInfo, i, o, e, r, s);\n  } else {\n    const e = t.indices.get(p.POSITION),\n          n = t.vertexAttributes.get(p.POSITION);\n    v(i, o, 0, e.length / 3, e, n, void 0, r, s);\n  }\n}\n\nconst x = s();\n\nfunction b(t, i, o, r, s, c) {\n  if (e(t)) return;\n  const l = A(i, o, x);\n\n  if (f(d, t.getBBMin()), a(d, t.getBBMax()), n(s) && s.applyToAabb(d), O(d, i, l, r)) {\n    const {\n      primitiveIndices: e,\n      indices: n,\n      position: f\n    } = t,\n          a = e ? e.length : n.length / 3;\n\n    if (a > z) {\n      const e = t.getChildren();\n\n      if (void 0 !== e) {\n        for (let t = 0; t < 8; ++t) void 0 !== e[t] && b(e[t], i, o, r, s, c);\n\n        return;\n      }\n    }\n\n    v(i, o, 0, a, n, f, e, s, c);\n  }\n}\n\nconst M = s();\n\nfunction v(t, e, i, o, r, s, c, f, a) {\n  if (c) return y(t, e, i, o, r, s, c, f, a);\n  const l = s.data,\n        u = s.stride || s.size,\n        m = t[0],\n        p = t[1],\n        h = t[2],\n        d = e[0] - m,\n        g = e[1] - p,\n        x = e[2] - h;\n\n  for (let b = i, v = 3 * i; b < o; ++b) {\n    let t = u * r[v++],\n        e = l[t++],\n        i = l[t++],\n        o = l[t];\n    t = u * r[v++];\n    let s = l[t++],\n        c = l[t++],\n        y = l[t];\n    t = u * r[v++];\n    let I = l[t++],\n        T = l[t++],\n        A = l[t];\n    n(f) && ([e, i, o] = f.applyToVertex(e, i, o, b), [s, c, y] = f.applyToVertex(s, c, y, b), [I, T, A] = f.applyToVertex(I, T, A, b));\n    const O = s - e,\n          N = c - i,\n          P = y - o,\n          S = I - e,\n          V = T - i,\n          L = A - o,\n          B = g * L - V * x,\n          E = x * S - L * d,\n          U = d * V - S * g,\n          z = O * B + N * E + P * U;\n    if (Math.abs(z) <= Number.EPSILON) continue;\n    const W = m - e,\n          k = p - i,\n          R = h - o,\n          C = W * B + k * E + R * U;\n\n    if (z > 0) {\n      if (C < 0 || C > z) continue;\n    } else if (C > 0 || C < z) continue;\n\n    const H = k * P - N * R,\n          X = R * O - P * W,\n          Y = W * N - O * k,\n          Z = d * H + g * X + x * Y;\n\n    if (z > 0) {\n      if (Z < 0 || C + Z > z) continue;\n    } else if (Z > 0 || C + Z < z) continue;\n\n    const _ = (S * H + V * X + L * Y) / z;\n\n    if (_ >= 0) {\n      a(_, j(O, N, P, S, V, L, M), b, !1);\n    }\n  }\n}\n\nfunction y(t, e, i, o, r, s, c, f, a) {\n  const l = s.data,\n        u = s.stride || s.size,\n        m = t[0],\n        p = t[1],\n        h = t[2],\n        d = e[0] - m,\n        g = e[1] - p,\n        x = e[2] - h;\n\n  for (let b = i; b < o; ++b) {\n    const t = c[b];\n    let e = 3 * t,\n        i = u * r[e++],\n        o = l[i++],\n        s = l[i++],\n        v = l[i];\n    i = u * r[e++];\n    let y = l[i++],\n        I = l[i++],\n        T = l[i];\n    i = u * r[e];\n    let A = l[i++],\n        O = l[i++],\n        N = l[i];\n    n(f) && ([o, s, v] = f.applyToVertex(o, s, v, b), [y, I, T] = f.applyToVertex(y, I, T, b), [A, O, N] = f.applyToVertex(A, O, N, b));\n    const P = y - o,\n          S = I - s,\n          V = T - v,\n          L = A - o,\n          B = O - s,\n          E = N - v,\n          U = g * E - B * x,\n          z = x * L - E * d,\n          W = d * B - L * g,\n          k = P * U + S * z + V * W;\n    if (Math.abs(k) <= Number.EPSILON) continue;\n    const R = m - o,\n          C = p - s,\n          H = h - v,\n          X = R * U + C * z + H * W;\n\n    if (k > 0) {\n      if (X < 0 || X > k) continue;\n    } else if (X > 0 || X < k) continue;\n\n    const Y = C * V - S * H,\n          Z = H * P - V * R,\n          _ = R * S - P * C,\n          q = d * Y + g * Z + x * _;\n\n    if (k > 0) {\n      if (q < 0 || X + q > k) continue;\n    } else if (q > 0 || X + q < k) continue;\n\n    const w = (L * Y + B * Z + E * _) / k;\n\n    if (w >= 0) {\n      a(w, j(P, S, V, L, B, E, M), t, !1);\n    }\n  }\n}\n\nconst I = s(),\n      T = s();\n\nfunction j(t, e, n, s, c, f, a) {\n  return i(I, t, e, n), i(T, s, c, f), o(a, I, T), r(a, a), a;\n}\n\nfunction A(t, e, n) {\n  return i(n, 1 / (e[0] - t[0]), 1 / (e[1] - t[1]), 1 / (e[2] - t[2]));\n}\n\nfunction O(t, e, n, i) {\n  return N(t, e, n, i, 1 / 0);\n}\n\nfunction N(t, e, n, i, o) {\n  const r = (t[0] - i - e[0]) * n[0],\n        s = (t[3] + i - e[0]) * n[0];\n  let c = Math.min(r, s),\n      f = Math.max(r, s);\n  const a = (t[1] - i - e[1]) * n[1],\n        l = (t[4] + i - e[1]) * n[1];\n  if (f = Math.min(f, Math.max(a, l)), f < 0) return !1;\n  if (c = Math.max(c, Math.min(a, l)), c > f) return !1;\n  const u = (t[2] - i - e[2]) * n[2],\n        m = (t[5] + i - e[2]) * n[2];\n  return f = Math.min(f, Math.max(u, m)), !(f < 0) && (c = Math.max(c, Math.min(u, m)), !(c > f) && c < o);\n}\n\nfunction P(e, n, i, o, r) {\n  let s = (i.screenLength || 0) * e.pixelRatio;\n  r && (s = u(s, o, n, r));\n  const c = s * Math.tan(.5 * e.fovY) / (.5 * e.fullHeight);\n  return t(c * n, i.minWorldLength || 0, null != i.maxWorldLength ? i.maxWorldLength : 1 / 0);\n}\n\nfunction S(t, e, n) {\n  if (!t) return;\n  const i = t.parameters,\n        o = t.paddingPixelsOverride;\n  e.setUniform4f(n, i.divisor, i.offset, i.minPixelSize, o);\n}\n\nfunction V(t, e) {\n  const n = e ? V(e) : {};\n\n  for (const i in t) {\n    let e = t[i];\n    e && e.forEach && (e = E(e)), null == e && i in n || (n[i] = e);\n  }\n\n  return n;\n}\n\nfunction L(t, e) {\n  let n = !1;\n\n  for (const i in e) {\n    const o = e[i];\n    void 0 !== o && (n = !0, Array.isArray(o) ? t[i] = o.slice() : t[i] = o);\n  }\n\n  return n;\n}\n\nfunction B(e, n, i, o, r, s) {\n  if (!n.options.selectionMode) return;\n  const c = e.vertexAttributes.get(p.POSITION).data,\n        f = e.vertexAttributes.get(p.SIZE),\n        a = f && f.data[0],\n        l = o[0],\n        u = o[1],\n        m = ((a + r) / 2 + 4) * e.screenToWorldRatio;\n  let h = Number.MAX_VALUE,\n      d = 0;\n\n  for (let p = 0; p < c.length - 5; p += 3) {\n    const e = c[p],\n          n = c[p + 1],\n          i = l - e,\n          o = u - n,\n          r = c[p + 3] - e,\n          s = c[p + 4] - n,\n          f = t((r * i + s * o) / (r * r + s * s), 0, 1),\n          a = r * f - i,\n          m = s * f - o,\n          g = a * a + m * m;\n    g < h && (h = g, d = p / 3);\n  }\n\n  h < m * m && s(i.dist, i.normal, d, !1);\n}\n\nfunction E(t) {\n  const e = [];\n  return t.forEach(t => e.push(t)), e;\n}\n\nconst U = {\n  multiply: 1,\n  ignore: 2,\n  replace: 3,\n  tint: 4\n},\n      z = 1e3;\nexport { S as bindScreenSizePerspective, U as colorMixModes, A as computeInvDir, j as computeNormal, V as copyParameters, O as intersectAabbInvDir, N as intersectAabbInvDirBefore, B as intersectDrapedRenderLineGeometry, g as intersectTriangleGeometry, v as intersectTriangles, L as updateParameters, P as verticalOffsetAtDistance };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/views/3d/webgl-engine/materials/internal/MaterialUtil.js"],"names":["clamp","t","isNone","e","isSome","n","s","i","c","o","r","create","setMin","f","setMax","a","PrimitiveType","l","scale","u","assert","m","VertexAttribute","p","isInstanceHidden","h","d","g","boundingInfo","primitiveType","Triangle","tolerance","b","indices","get","POSITION","vertexAttributes","v","length","x","A","getBBMin","getBBMax","applyToAabb","O","primitiveIndices","position","z","getChildren","M","y","data","stride","size","I","T","applyToVertex","N","P","S","V","L","B","E","U","Math","abs","Number","EPSILON","W","k","R","C","H","X","Y","Z","_","j","q","w","min","max","screenLength","pixelRatio","tan","fovY","fullHeight","minWorldLength","maxWorldLength","parameters","paddingPixelsOverride","setUniform4f","divisor","offset","minPixelSize","forEach","Array","isArray","slice","options","selectionMode","SIZE","screenToWorldRatio","MAX_VALUE","dist","normal","push","multiply","ignore","replace","tint","bindScreenSizePerspective","colorMixModes","computeInvDir","computeNormal","copyParameters","intersectAabbInvDir","intersectAabbInvDirBefore","intersectDrapedRenderLineGeometry","intersectTriangleGeometry","intersectTriangles","updateParameters","verticalOffsetAtDistance"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{clamp as t}from\"../../../../../core/mathUtils.js\";import{isNone as e,isSome as n}from\"../../../../../core/maybe.js\";import{s as i,c as o,n as r}from\"../../../../../chunks/vec3.js\";import{c as s}from\"../../../../../chunks/vec3f64.js\";import{create as c,setMin as f,setMax as a}from\"../../../../../geometry/support/aaBoundingBox.js\";import{PrimitiveType as l}from\"../../lib/basicInterfaces.js\";import{scale as u}from\"../../lib/screenSizePerspectiveUtils.js\";import{assert as m}from\"../../lib/Util.js\";import{VertexAttribute as p}from\"../../lib/VertexAttribute.js\";import{isInstanceHidden as h}from\"../renderers/utils.js\";const d=c();function g(t,e,n,i,o,r,s){if(!h(e))if(t.boundingInfo){m(t.primitiveType===l.Triangle);const e=n.tolerance;b(t.boundingInfo,i,o,e,r,s)}else{const e=t.indices.get(p.POSITION),n=t.vertexAttributes.get(p.POSITION);v(i,o,0,e.length/3,e,n,void 0,r,s)}}const x=s();function b(t,i,o,r,s,c){if(e(t))return;const l=A(i,o,x);if(f(d,t.getBBMin()),a(d,t.getBBMax()),n(s)&&s.applyToAabb(d),O(d,i,l,r)){const{primitiveIndices:e,indices:n,position:f}=t,a=e?e.length:n.length/3;if(a>z){const e=t.getChildren();if(void 0!==e){for(let t=0;t<8;++t)void 0!==e[t]&&b(e[t],i,o,r,s,c);return}}v(i,o,0,a,n,f,e,s,c)}}const M=s();function v(t,e,i,o,r,s,c,f,a){if(c)return y(t,e,i,o,r,s,c,f,a);const l=s.data,u=s.stride||s.size,m=t[0],p=t[1],h=t[2],d=e[0]-m,g=e[1]-p,x=e[2]-h;for(let b=i,v=3*i;b<o;++b){let t=u*r[v++],e=l[t++],i=l[t++],o=l[t];t=u*r[v++];let s=l[t++],c=l[t++],y=l[t];t=u*r[v++];let I=l[t++],T=l[t++],A=l[t];n(f)&&([e,i,o]=f.applyToVertex(e,i,o,b),[s,c,y]=f.applyToVertex(s,c,y,b),[I,T,A]=f.applyToVertex(I,T,A,b));const O=s-e,N=c-i,P=y-o,S=I-e,V=T-i,L=A-o,B=g*L-V*x,E=x*S-L*d,U=d*V-S*g,z=O*B+N*E+P*U;if(Math.abs(z)<=Number.EPSILON)continue;const W=m-e,k=p-i,R=h-o,C=W*B+k*E+R*U;if(z>0){if(C<0||C>z)continue}else if(C>0||C<z)continue;const H=k*P-N*R,X=R*O-P*W,Y=W*N-O*k,Z=d*H+g*X+x*Y;if(z>0){if(Z<0||C+Z>z)continue}else if(Z>0||C+Z<z)continue;const _=(S*H+V*X+L*Y)/z;if(_>=0){a(_,j(O,N,P,S,V,L,M),b,!1)}}}function y(t,e,i,o,r,s,c,f,a){const l=s.data,u=s.stride||s.size,m=t[0],p=t[1],h=t[2],d=e[0]-m,g=e[1]-p,x=e[2]-h;for(let b=i;b<o;++b){const t=c[b];let e=3*t,i=u*r[e++],o=l[i++],s=l[i++],v=l[i];i=u*r[e++];let y=l[i++],I=l[i++],T=l[i];i=u*r[e];let A=l[i++],O=l[i++],N=l[i];n(f)&&([o,s,v]=f.applyToVertex(o,s,v,b),[y,I,T]=f.applyToVertex(y,I,T,b),[A,O,N]=f.applyToVertex(A,O,N,b));const P=y-o,S=I-s,V=T-v,L=A-o,B=O-s,E=N-v,U=g*E-B*x,z=x*L-E*d,W=d*B-L*g,k=P*U+S*z+V*W;if(Math.abs(k)<=Number.EPSILON)continue;const R=m-o,C=p-s,H=h-v,X=R*U+C*z+H*W;if(k>0){if(X<0||X>k)continue}else if(X>0||X<k)continue;const Y=C*V-S*H,Z=H*P-V*R,_=R*S-P*C,q=d*Y+g*Z+x*_;if(k>0){if(q<0||X+q>k)continue}else if(q>0||X+q<k)continue;const w=(L*Y+B*Z+E*_)/k;if(w>=0){a(w,j(P,S,V,L,B,E,M),t,!1)}}}const I=s(),T=s();function j(t,e,n,s,c,f,a){return i(I,t,e,n),i(T,s,c,f),o(a,I,T),r(a,a),a}function A(t,e,n){return i(n,1/(e[0]-t[0]),1/(e[1]-t[1]),1/(e[2]-t[2]))}function O(t,e,n,i){return N(t,e,n,i,1/0)}function N(t,e,n,i,o){const r=(t[0]-i-e[0])*n[0],s=(t[3]+i-e[0])*n[0];let c=Math.min(r,s),f=Math.max(r,s);const a=(t[1]-i-e[1])*n[1],l=(t[4]+i-e[1])*n[1];if(f=Math.min(f,Math.max(a,l)),f<0)return!1;if(c=Math.max(c,Math.min(a,l)),c>f)return!1;const u=(t[2]-i-e[2])*n[2],m=(t[5]+i-e[2])*n[2];return f=Math.min(f,Math.max(u,m)),!(f<0)&&(c=Math.max(c,Math.min(u,m)),!(c>f)&&c<o)}function P(e,n,i,o,r){let s=(i.screenLength||0)*e.pixelRatio;r&&(s=u(s,o,n,r));const c=s*Math.tan(.5*e.fovY)/(.5*e.fullHeight);return t(c*n,i.minWorldLength||0,null!=i.maxWorldLength?i.maxWorldLength:1/0)}function S(t,e,n){if(!t)return;const i=t.parameters,o=t.paddingPixelsOverride;e.setUniform4f(n,i.divisor,i.offset,i.minPixelSize,o)}function V(t,e){const n=e?V(e):{};for(const i in t){let e=t[i];e&&e.forEach&&(e=E(e)),null==e&&i in n||(n[i]=e)}return n}function L(t,e){let n=!1;for(const i in e){const o=e[i];void 0!==o&&(n=!0,Array.isArray(o)?t[i]=o.slice():t[i]=o)}return n}function B(e,n,i,o,r,s){if(!n.options.selectionMode)return;const c=e.vertexAttributes.get(p.POSITION).data,f=e.vertexAttributes.get(p.SIZE),a=f&&f.data[0],l=o[0],u=o[1],m=((a+r)/2+4)*e.screenToWorldRatio;let h=Number.MAX_VALUE,d=0;for(let p=0;p<c.length-5;p+=3){const e=c[p],n=c[p+1],i=l-e,o=u-n,r=c[p+3]-e,s=c[p+4]-n,f=t((r*i+s*o)/(r*r+s*s),0,1),a=r*f-i,m=s*f-o,g=a*a+m*m;g<h&&(h=g,d=p/3)}h<m*m&&s(i.dist,i.normal,d,!1)}function E(t){const e=[];return t.forEach((t=>e.push(t))),e}const U={multiply:1,ignore:2,replace:3,tint:4},z=1e3;export{S as bindScreenSizePerspective,U as colorMixModes,A as computeInvDir,j as computeNormal,V as copyParameters,O as intersectAabbInvDir,N as intersectAabbInvDirBefore,B as intersectDrapedRenderLineGeometry,g as intersectTriangleGeometry,v as intersectTriangles,L as updateParameters,P as verticalOffsetAtDistance};\n"]},"metadata":{},"sourceType":"module"}