{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport { validateLanguage as n, findScriptDependencies as e, checkScript as r, findFieldLiterals as t, validateScript as o, findExpectedFieldLiterals as i, referencesMember as c, referencesFunction as l } from \"./treeAnalysis.js\";\nimport { parse as u } from \"./lib/arcade-parser.js\";\n\nfunction a(r) {\n  let t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  const o = u(\"function _() { \" + r + \"\\n}\");\n  if (null === o.body || void 0 === o.body) throw new Error(\"No formula provided.\");\n  if (0 === o.body.length) throw new Error(\"No formula provided.\");\n  if (0 === o.body.length) throw new Error(\"No formula provided.\");\n  if (\"BlockStatement\" !== o.body[0].body.type) throw new Error(\"Invalid formula content.\");\n  const i = n(o);\n  if (\"\" !== i) throw new Error(i);\n  return e(o, t), o;\n}\n\nfunction s(n, e, t, o, i) {\n  const c = [],\n        l = \"function _() { \\n\".length - 1,\n        a = \"function _() { \\n\" + n + \"\\n}\";\n\n  try {\n    const n = u(a, {\n      tolerant: !0,\n      loc: !0,\n      range: !0\n    }),\n          s = n.errors;\n    if (s.length > 0) for (let e = 0; e < s.length; e++) c.push({\n      line: s[e].lineNumber - 2,\n      character: s[e].column,\n      reason: s[e].description\n    });\n    const f = r(n, e, t, o, i);\n\n    for (let e = 0; e < f.length; e++) f[e].line = f[e].line - 2, f[e].range && (f[e].range = [f[e][0] - l, f[e][1] - l]), f[e].loc && (f[e].loc.start.line = f[e].loc.start.line - 2, f[e].loc.end.line = f[e].loc.end.line - 2), c.push(f[e]);\n  } catch (s) {\n    try {\n      if (\"Unexpected token }\" === s.description) {\n        const n = a.split(\"\\n\").length;\n        s.lineNumber === n ? (s.index = a.length - 1, c.push({\n          line: s.lineNumber - 4,\n          character: s.column,\n          reason: \"Unexpected end of script\"\n        })) : (s.index = a.length - 1, c.push({\n          line: s.lineNumber - 2,\n          character: s.column,\n          reason: \"Unexpected end of script\"\n        }));\n      } else c.push({\n        line: s.lineNumber - 2,\n        character: s.column,\n        reason: s.description\n      });\n    } catch (f) {}\n  }\n\n  return c;\n}\n\nfunction f(n, e) {\n  return t(n);\n}\n\nfunction d(n, e, r) {\n  return o(n, e, r);\n}\n\nfunction h(n) {\n  return i(n);\n}\n\nfunction p(n, e) {\n  return c(n, e);\n}\n\nfunction m(n, e) {\n  return l(n, e);\n}\n\nexport { h as extractExpectedFieldLiterals, f as extractFieldLiterals, a as parseScript, m as referencesFunction, p as referencesMember, s as scriptCheck, d as validateScript };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/arcade/parser.js"],"names":["validateLanguage","n","findScriptDependencies","e","checkScript","r","findFieldLiterals","t","validateScript","o","findExpectedFieldLiterals","i","referencesMember","c","referencesFunction","l","parse","u","a","body","Error","length","type","s","tolerant","loc","range","errors","push","line","lineNumber","character","column","reason","description","f","start","end","split","index","d","h","p","m","extractExpectedFieldLiterals","extractFieldLiterals","parseScript","scriptCheck"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{validateLanguage as n,findScriptDependencies as e,checkScript as r,findFieldLiterals as t,validateScript as o,findExpectedFieldLiterals as i,referencesMember as c,referencesFunction as l}from\"./treeAnalysis.js\";import{parse as u}from\"./lib/arcade-parser.js\";function a(r,t=[]){const o=u(\"function _() { \"+r+\"\\n}\");if(null===o.body||void 0===o.body)throw new Error(\"No formula provided.\");if(0===o.body.length)throw new Error(\"No formula provided.\");if(0===o.body.length)throw new Error(\"No formula provided.\");if(\"BlockStatement\"!==o.body[0].body.type)throw new Error(\"Invalid formula content.\");const i=n(o);if(\"\"!==i)throw new Error(i);return e(o,t),o}function s(n,e,t,o,i){const c=[],l=\"function _() { \\n\".length-1,a=\"function _() { \\n\"+n+\"\\n}\";try{const n=u(a,{tolerant:!0,loc:!0,range:!0}),s=n.errors;if(s.length>0)for(let e=0;e<s.length;e++)c.push({line:s[e].lineNumber-2,character:s[e].column,reason:s[e].description});const f=r(n,e,t,o,i);for(let e=0;e<f.length;e++)f[e].line=f[e].line-2,f[e].range&&(f[e].range=[f[e][0]-l,f[e][1]-l]),f[e].loc&&(f[e].loc.start.line=f[e].loc.start.line-2,f[e].loc.end.line=f[e].loc.end.line-2),c.push(f[e])}catch(s){try{if(\"Unexpected token }\"===s.description){const n=a.split(\"\\n\").length;s.lineNumber===n?(s.index=a.length-1,c.push({line:s.lineNumber-4,character:s.column,reason:\"Unexpected end of script\"})):(s.index=a.length-1,c.push({line:s.lineNumber-2,character:s.column,reason:\"Unexpected end of script\"}))}else c.push({line:s.lineNumber-2,character:s.column,reason:s.description})}catch(f){}}return c}function f(n,e){return t(n)}function d(n,e,r){return o(n,e,r)}function h(n){return i(n)}function p(n,e){return c(n,e)}function m(n,e){return l(n,e)}export{h as extractExpectedFieldLiterals,f as extractFieldLiterals,a as parseScript,m as referencesFunction,p as referencesMember,s as scriptCheck,d as validateScript};\n"]},"metadata":{},"sourceType":"module"}