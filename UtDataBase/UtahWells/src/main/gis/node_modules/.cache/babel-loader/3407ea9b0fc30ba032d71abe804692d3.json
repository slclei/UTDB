{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../chunks/tslib.es6.js\";\nimport t from \"../../../core/Collection.js\";\nimport { referenceSetter as s } from \"../../../core/collectionUtils.js\";\nimport i from \"../../../core/Error.js\";\nimport { watch as r, syncAndInitial as a, on as o } from \"../../../core/reactiveUtils.js\";\nimport { property as p } from \"../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../core/arrayUtils.js\";\nimport \"../../../core/has.js\";\nimport \"../../../core/accessorSupport/ensureType.js\";\nimport { subclass as n } from \"../../../core/accessorSupport/decorators/subclass.js\";\nimport { Container as l } from \"../engine/Container.js\";\nimport h from \"../../layers/support/ClipArea.js\";\nimport c from \"../../layers/support/ClipRect.js\";\nimport d from \"../../layers/support/Geometry.js\";\nimport u from \"../../layers/support/Path.js\";\n\nconst y = t.ofType({\n  key: \"type\",\n  base: h,\n  typeMap: {\n    rect: c,\n    path: u,\n    geometry: d\n  }\n}),\n      f = t => {\n  let h = class extends t {\n    constructor() {\n      super(...arguments), this.attached = !1, this.clips = new y(), this.lastUpdateId = -1, this.moving = !1, this.updateRequested = !1;\n    }\n\n    initialize() {\n      var e, t, s, p;\n      const n = null == (e = null == (t = this.view) ? void 0 : t.spatialReferenceLocked) || e;\n      (null == (s = this.view) ? void 0 : s.spatialReference) && n && !this.spatialReferenceSupported ? this.addResolvingPromise(Promise.reject(new i(\"layerview:spatial-reference-incompatible\", \"The spatial reference of this layer does not meet the requirements of the view\", {\n        layer: this.layer\n      }))) : (this.container || (this.container = new l()), this.container.fadeTransitionEnabled = !0, this.container.opacity = 0, this.container.clips = this.clips, this.handles.add([r(() => this.suspended, e => {\n        this.container && (this.container.visible = !e), this.view && !e && this.updateRequested && this.view.requestUpdate();\n      }, a), r(() => {\n        var e, t;\n        return null != (e = null == (t = this.layer) ? void 0 : t.opacity) ? e : 1;\n      }, e => {\n        this.container && (this.container.opacity = e);\n      }, a), r(() => this.layer && \"blendMode\" in this.layer ? this.layer.blendMode : \"normal\", e => {\n        this.container && (this.container.blendMode = e);\n      }, a), r(() => this.layer && \"effect\" in this.layer ? this.layer.effect : null, e => {\n        this.container && (this.container.effect = e);\n      }, a), o(() => this.clips, \"change\", () => {\n        this.container && (this.container.clips = this.clips);\n      })]), null != (p = this.view) && p.whenLayerView ? this.view.whenLayerView(this.layer).then(e => {\n        e === this && this.processAttach();\n      }, () => {}) : this.when().then(() => {\n        this.processAttach();\n      }, () => {}));\n    }\n\n    destroy() {\n      this.processDetach(), this.updateRequested = !1;\n    }\n\n    get spatialReferenceSupported() {\n      var e;\n      const t = null == (e = this.view) ? void 0 : e.spatialReference;\n      return null == t || this.supportsSpatialReference(t);\n    }\n\n    get updating() {\n      var e;\n      return this.spatialReferenceSupported && (!this.attached || !this.suspended && (this.updateRequested || this.isUpdating()) || !(null == (e = this.updatingHandles) || !e.updating));\n    }\n\n    get visibleAtCurrentScale() {\n      return this.isVisibleAtScale(this.view.scale);\n    }\n\n    processAttach() {\n      this.isResolved() && !this.attached && !this.destroyed && this.spatialReferenceSupported && (this.attach(), this.attached = !0, this.requestUpdate());\n    }\n\n    processDetach() {\n      this.attached && (this.attached = !1, this.detach(), this.updateRequested = !1);\n    }\n\n    isVisibleAtScale(e) {\n      const t = this.layer && \"effectiveScaleRange\" in this.layer ? this.layer.effectiveScaleRange : null;\n      if (!t) return !0;\n      const {\n        minScale: s,\n        maxScale: i\n      } = t;\n      return (0 === s || e <= s) && (0 === i || e >= i);\n    }\n\n    requestUpdate() {\n      this.destroyed || this.updateRequested || (this.updateRequested = !0, this.suspended || this.view.requestUpdate());\n    }\n\n    processUpdate(e) {\n      !this.isFulfilled() || this.isResolved() ? (this._set(\"updateParameters\", e), this.updateRequested && !this.suspended && (this.updateRequested = !1, this.update(e))) : this.updateRequested = !1;\n    }\n\n    hitTest(e, t) {\n      return Promise.resolve(null);\n    }\n\n    supportsSpatialReference(e) {\n      return !0;\n    }\n\n    canResume() {\n      return !!this.spatialReferenceSupported && !!super.canResume() && this.visibleAtCurrentScale;\n    }\n\n    getSuspendInfo() {\n      const e = super.getSuspendInfo(),\n            t = !this.spatialReferenceSupported,\n            s = this.visibleAtCurrentScale;\n      return t && (e.spatialReferenceNotSupported = t), s && (e.outsideScaleRange = s), e;\n    }\n\n  };\n  return e([p()], h.prototype, \"attached\", void 0), e([p({\n    type: y,\n\n    set(e) {\n      const t = s(e, this._get(\"clips\"), y);\n\n      this._set(\"clips\", t);\n    }\n\n  })], h.prototype, \"clips\", void 0), e([p()], h.prototype, \"container\", void 0), e([p()], h.prototype, \"moving\", void 0), e([p({\n    readOnly: !0\n  })], h.prototype, \"spatialReferenceSupported\", null), e([p({\n    readOnly: !0\n  })], h.prototype, \"updateParameters\", void 0), e([p()], h.prototype, \"updateRequested\", void 0), e([p()], h.prototype, \"updating\", null), e([p()], h.prototype, \"view\", void 0), e([p({\n    readOnly: !0\n  })], h.prototype, \"visibleAtCurrentScale\", null), h = e([n(\"esri.views.2d.layers.LayerView2D\")], h), h;\n};\n\nexport { f as LayerView2DMixin };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/views/2d/layers/LayerView2D.js"],"names":["_","e","t","referenceSetter","s","i","watch","r","syncAndInitial","a","on","o","property","p","subclass","n","Container","l","h","c","d","u","y","ofType","key","base","typeMap","rect","path","geometry","f","constructor","arguments","attached","clips","lastUpdateId","moving","updateRequested","initialize","view","spatialReferenceLocked","spatialReference","spatialReferenceSupported","addResolvingPromise","Promise","reject","layer","container","fadeTransitionEnabled","opacity","handles","add","suspended","visible","requestUpdate","blendMode","effect","whenLayerView","then","processAttach","when","destroy","processDetach","supportsSpatialReference","updating","isUpdating","updatingHandles","visibleAtCurrentScale","isVisibleAtScale","scale","isResolved","destroyed","attach","detach","effectiveScaleRange","minScale","maxScale","processUpdate","isFulfilled","_set","update","hitTest","resolve","canResume","getSuspendInfo","spatialReferenceNotSupported","outsideScaleRange","prototype","type","set","_get","readOnly","LayerView2DMixin"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/Collection.js\";import{referenceSetter as s}from\"../../../core/collectionUtils.js\";import i from\"../../../core/Error.js\";import{watch as r,syncAndInitial as a,on as o}from\"../../../core/reactiveUtils.js\";import{property as p}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import{subclass as n}from\"../../../core/accessorSupport/decorators/subclass.js\";import{Container as l}from\"../engine/Container.js\";import h from\"../../layers/support/ClipArea.js\";import c from\"../../layers/support/ClipRect.js\";import d from\"../../layers/support/Geometry.js\";import u from\"../../layers/support/Path.js\";const y=t.ofType({key:\"type\",base:h,typeMap:{rect:c,path:u,geometry:d}}),f=t=>{let h=class extends t{constructor(){super(...arguments),this.attached=!1,this.clips=new y,this.lastUpdateId=-1,this.moving=!1,this.updateRequested=!1}initialize(){var e,t,s,p;const n=null==(e=null==(t=this.view)?void 0:t.spatialReferenceLocked)||e;(null==(s=this.view)?void 0:s.spatialReference)&&n&&!this.spatialReferenceSupported?this.addResolvingPromise(Promise.reject(new i(\"layerview:spatial-reference-incompatible\",\"The spatial reference of this layer does not meet the requirements of the view\",{layer:this.layer}))):(this.container||(this.container=new l),this.container.fadeTransitionEnabled=!0,this.container.opacity=0,this.container.clips=this.clips,this.handles.add([r((()=>this.suspended),(e=>{this.container&&(this.container.visible=!e),this.view&&!e&&this.updateRequested&&this.view.requestUpdate()}),a),r((()=>{var e,t;return null!=(e=null==(t=this.layer)?void 0:t.opacity)?e:1}),(e=>{this.container&&(this.container.opacity=e)}),a),r((()=>this.layer&&\"blendMode\"in this.layer?this.layer.blendMode:\"normal\"),(e=>{this.container&&(this.container.blendMode=e)}),a),r((()=>this.layer&&\"effect\"in this.layer?this.layer.effect:null),(e=>{this.container&&(this.container.effect=e)}),a),o((()=>this.clips),\"change\",(()=>{this.container&&(this.container.clips=this.clips)}))]),null!=(p=this.view)&&p.whenLayerView?this.view.whenLayerView(this.layer).then((e=>{e===this&&this.processAttach()}),(()=>{})):this.when().then((()=>{this.processAttach()}),(()=>{})))}destroy(){this.processDetach(),this.updateRequested=!1}get spatialReferenceSupported(){var e;const t=null==(e=this.view)?void 0:e.spatialReference;return null==t||this.supportsSpatialReference(t)}get updating(){var e;return this.spatialReferenceSupported&&(!this.attached||!this.suspended&&(this.updateRequested||this.isUpdating())||!(null==(e=this.updatingHandles)||!e.updating))}get visibleAtCurrentScale(){return this.isVisibleAtScale(this.view.scale)}processAttach(){this.isResolved()&&!this.attached&&!this.destroyed&&this.spatialReferenceSupported&&(this.attach(),this.attached=!0,this.requestUpdate())}processDetach(){this.attached&&(this.attached=!1,this.detach(),this.updateRequested=!1)}isVisibleAtScale(e){const t=this.layer&&\"effectiveScaleRange\"in this.layer?this.layer.effectiveScaleRange:null;if(!t)return!0;const{minScale:s,maxScale:i}=t;return(0===s||e<=s)&&(0===i||e>=i)}requestUpdate(){this.destroyed||this.updateRequested||(this.updateRequested=!0,this.suspended||this.view.requestUpdate())}processUpdate(e){!this.isFulfilled()||this.isResolved()?(this._set(\"updateParameters\",e),this.updateRequested&&!this.suspended&&(this.updateRequested=!1,this.update(e))):this.updateRequested=!1}hitTest(e,t){return Promise.resolve(null)}supportsSpatialReference(e){return!0}canResume(){return!!this.spatialReferenceSupported&&(!!super.canResume()&&this.visibleAtCurrentScale)}getSuspendInfo(){const e=super.getSuspendInfo(),t=!this.spatialReferenceSupported,s=this.visibleAtCurrentScale;return t&&(e.spatialReferenceNotSupported=t),s&&(e.outsideScaleRange=s),e}};return e([p()],h.prototype,\"attached\",void 0),e([p({type:y,set(e){const t=s(e,this._get(\"clips\"),y);this._set(\"clips\",t)}})],h.prototype,\"clips\",void 0),e([p()],h.prototype,\"container\",void 0),e([p()],h.prototype,\"moving\",void 0),e([p({readOnly:!0})],h.prototype,\"spatialReferenceSupported\",null),e([p({readOnly:!0})],h.prototype,\"updateParameters\",void 0),e([p()],h.prototype,\"updateRequested\",void 0),e([p()],h.prototype,\"updating\",null),e([p()],h.prototype,\"view\",void 0),e([p({readOnly:!0})],h.prototype,\"visibleAtCurrentScale\",null),h=e([n(\"esri.views.2d.layers.LayerView2D\")],h),h};export{f as LayerView2DMixin};\n"]},"metadata":{},"sourceType":"module"}