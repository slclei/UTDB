{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../chunks/tslib.es6.js\";\nimport t from \"../../../core/Error.js\";\nimport { isNone as r, isSome as s } from \"../../../core/maybe.js\";\nimport { property as i } from \"../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../core/arrayUtils.js\";\nimport \"../../../core/has.js\";\nimport \"../../../core/accessorSupport/ensureType.js\";\nimport { subclass as o } from \"../../../core/accessorSupport/decorators/subclass.js\";\nimport a from \"../../../rest/support/FeatureSet.js\";\nimport n from \"./FeatureLayerView2D.js\";\nimport { toJSONGeometryType as c } from \"./support/util.js\";\n\nfunction p(e, t) {\n  if (r(e) && r(t)) return null;\n  const i = {};\n  return s(t) && (i.geometry = t.toJSON()), s(e) && (i.where = e), i;\n}\n\nlet l = class extends n {\n  constructor() {\n    super(...arguments), this._enabledDataReceived = !1, this.errorString = null, this.connectionStatus = \"disconnected\";\n  }\n\n  initialize() {\n    this.handles.add([this.layer.watch(\"purgeOptions\", () => this._update()), this.watch(\"suspended\", e => {\n      e ? this._proxy.pauseStream() : this._proxy.resumeStream();\n    })]);\n  }\n\n  get connectionError() {\n    if (this.errorString) return new t(\"stream-controller\", this.errorString);\n  }\n\n  on(e, t) {\n    \"data-received\" === e && (this._enabledDataReceived = !0, this._proxy.enableEvent(\"data-received\", !0));\n    const r = super.on(e, t),\n          s = this;\n    return {\n      remove() {\n        r.remove(), \"data-received\" === e && (s._proxy.closed || s.hasEventListener(\"data-received\") || s._proxy.enableEvent(\"data-received\", !1));\n      }\n\n    };\n  }\n\n  queryLatestObservations(e, r) {\n    if (!(this.layer.timeInfo.endField || this.layer.timeInfo.startField)) throw new t(\"streamlayer-no-timeField\", \"queryLatestObservation can only be used with services that define a TrackIdField\");\n    return this._proxy.queryLatestObservations(this._cleanUpQuery(e), r).then(e => {\n      const t = a.fromJSON(e);\n      return t.features.forEach(e => {\n        e.layer = this.layer, e.sourceLayer = this.layer;\n      }), t;\n    });\n  }\n\n  detach() {\n    super.detach(), this.connectionStatus = \"disconnected\";\n  }\n\n  _createClientOptions() {\n    return { ...super._createClientOptions(),\n      setProperty: e => {\n        this.set(e.propertyName, e.value);\n      }\n    };\n  }\n\n  _createTileRendererHash(e) {\n    const t = `${JSON.stringify(this.layer.purgeOptions)}.${JSON.stringify(p(this.layer.definitionExpression, this.layer.geometryDefinition))})`;\n    return super._createTileRendererHash(e) + t;\n  }\n\n  async _createServiceOptions() {\n    const e = this.layer,\n          {\n      objectIdField: t\n    } = e,\n          r = e.fields.map(e => e.toJSON()),\n          s = c(e.geometryType),\n          i = e.timeInfo && e.timeInfo.toJSON() || null,\n          o = e.spatialReference ? e.spatialReference.toJSON() : null;\n    return {\n      type: \"stream\",\n      fields: r,\n      geometryType: s,\n      objectIdField: t,\n      timeInfo: i,\n      source: this.layer.parsedUrl,\n      serviceFilter: p(this.layer.definitionExpression, this.layer.geometryDefinition),\n      purgeOptions: this.layer.purgeOptions.toJSON(),\n      enableDataReceived: this._enabledDataReceived,\n      spatialReference: o,\n      maxReconnectionAttempts: this.layer.maxReconnectionAttempts,\n      maxReconnectionInterval: this.layer.maxReconnectionInterval,\n      updateInterval: this.layer.updateInterval,\n      customParameters: e.customParameters\n    };\n  }\n\n};\ne([i()], l.prototype, \"errorString\", void 0), e([i({\n  readOnly: !0\n})], l.prototype, \"connectionError\", null), e([i()], l.prototype, \"connectionStatus\", void 0), l = e([o(\"esri.views.2d.layers.StreamLayerView2D\")], l);\nconst d = l;\nexport { d as default };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/views/2d/layers/StreamLayerView2D.js"],"names":["_","e","t","isNone","r","isSome","s","property","i","subclass","o","a","n","toJSONGeometryType","c","p","geometry","toJSON","where","l","constructor","arguments","_enabledDataReceived","errorString","connectionStatus","initialize","handles","add","layer","watch","_update","_proxy","pauseStream","resumeStream","connectionError","on","enableEvent","remove","closed","hasEventListener","queryLatestObservations","timeInfo","endField","startField","_cleanUpQuery","then","fromJSON","features","forEach","sourceLayer","detach","_createClientOptions","setProperty","set","propertyName","value","_createTileRendererHash","JSON","stringify","purgeOptions","definitionExpression","geometryDefinition","_createServiceOptions","objectIdField","fields","map","geometryType","spatialReference","type","source","parsedUrl","serviceFilter","enableDataReceived","maxReconnectionAttempts","maxReconnectionInterval","updateInterval","customParameters","prototype","readOnly","d","default"],"mappings":"AAAA;AACA;AACA;AACA;AACA,SAAOA,CAAC,IAAIC,CAAZ,QAAkB,8BAAlB;AAAiD,OAAOC,CAAP,MAAa,wBAAb;AAAsC,SAAOC,MAAM,IAAIC,CAAjB,EAAmBC,MAAM,IAAIC,CAA7B,QAAmC,wBAAnC;AAA4D,SAAOC,QAAQ,IAAIC,CAAnB,QAAyB,sDAAzB;AAAgF,OAAM,6BAAN;AAAoC,OAAM,sBAAN;AAA6B,OAAM,6CAAN;AAAoD,SAAOC,QAAQ,IAAIC,CAAnB,QAAyB,sDAAzB;AAAgF,OAAOC,CAAP,MAAa,qCAAb;AAAmD,OAAOC,CAAP,MAAa,yBAAb;AAAuC,SAAOC,kBAAkB,IAAIC,CAA7B,QAAmC,mBAAnC;;AAAuD,SAASC,CAAT,CAAWd,CAAX,EAAaC,CAAb,EAAe;AAAC,MAAGE,CAAC,CAACH,CAAD,CAAD,IAAMG,CAAC,CAACF,CAAD,CAAV,EAAc,OAAO,IAAP;AAAY,QAAMM,CAAC,GAAC,EAAR;AAAW,SAAOF,CAAC,CAACJ,CAAD,CAAD,KAAOM,CAAC,CAACQ,QAAF,GAAWd,CAAC,CAACe,MAAF,EAAlB,GAA8BX,CAAC,CAACL,CAAD,CAAD,KAAOO,CAAC,CAACU,KAAF,GAAQjB,CAAf,CAA9B,EAAgDO,CAAvD;AAAyD;;AAAA,IAAIW,CAAC,GAAC,cAAcP,CAAd,CAAe;AAACQ,EAAAA,WAAW,GAAE;AAAC,UAAM,GAAGC,SAAT,GAAoB,KAAKC,oBAAL,GAA0B,CAAC,CAA/C,EAAiD,KAAKC,WAAL,GAAiB,IAAlE,EAAuE,KAAKC,gBAAL,GAAsB,cAA7F;AAA4G;;AAAAC,EAAAA,UAAU,GAAE;AAAC,SAAKC,OAAL,CAAaC,GAAb,CAAiB,CAAC,KAAKC,KAAL,CAAWC,KAAX,CAAiB,cAAjB,EAAiC,MAAI,KAAKC,OAAL,EAArC,CAAD,EAAuD,KAAKD,KAAL,CAAW,WAAX,EAAwB5B,CAAC,IAAE;AAACA,MAAAA,CAAC,GAAC,KAAK8B,MAAL,CAAYC,WAAZ,EAAD,GAA2B,KAAKD,MAAL,CAAYE,YAAZ,EAA5B;AAAuD,KAAnF,CAAvD,CAAjB;AAAgK;;AAAmB,MAAfC,eAAe,GAAE;AAAC,QAAG,KAAKX,WAAR,EAAoB,OAAO,IAAIrB,CAAJ,CAAM,mBAAN,EAA0B,KAAKqB,WAA/B,CAAP;AAAmD;;AAAAY,EAAAA,EAAE,CAAClC,CAAD,EAAGC,CAAH,EAAK;AAAC,wBAAkBD,CAAlB,KAAsB,KAAKqB,oBAAL,GAA0B,CAAC,CAA3B,EAA6B,KAAKS,MAAL,CAAYK,WAAZ,CAAwB,eAAxB,EAAwC,CAAC,CAAzC,CAAnD;AAAgG,UAAMhC,CAAC,GAAC,MAAM+B,EAAN,CAASlC,CAAT,EAAWC,CAAX,CAAR;AAAA,UAAsBI,CAAC,GAAC,IAAxB;AAA6B,WAAM;AAAC+B,MAAAA,MAAM,GAAE;AAACjC,QAAAA,CAAC,CAACiC,MAAF,IAAW,oBAAkBpC,CAAlB,KAAsBK,CAAC,CAACyB,MAAF,CAASO,MAAT,IAAiBhC,CAAC,CAACiC,gBAAF,CAAmB,eAAnB,CAAjB,IAAsDjC,CAAC,CAACyB,MAAF,CAASK,WAAT,CAAqB,eAArB,EAAqC,CAAC,CAAtC,CAA5E,CAAX;AAAiI;;AAA3I,KAAN;AAAmJ;;AAAAI,EAAAA,uBAAuB,CAACvC,CAAD,EAAGG,CAAH,EAAK;AAAC,QAAG,EAAE,KAAKwB,KAAL,CAAWa,QAAX,CAAoBC,QAApB,IAA8B,KAAKd,KAAL,CAAWa,QAAX,CAAoBE,UAApD,CAAH,EAAmE,MAAM,IAAIzC,CAAJ,CAAM,0BAAN,EAAiC,kFAAjC,CAAN;AAA2H,WAAO,KAAK6B,MAAL,CAAYS,uBAAZ,CAAoC,KAAKI,aAAL,CAAmB3C,CAAnB,CAApC,EAA0DG,CAA1D,EAA6DyC,IAA7D,CAAmE5C,CAAC,IAAE;AAAC,YAAMC,CAAC,GAACS,CAAC,CAACmC,QAAF,CAAW7C,CAAX,CAAR;AAAsB,aAAOC,CAAC,CAAC6C,QAAF,CAAWC,OAAX,CAAoB/C,CAAC,IAAE;AAACA,QAAAA,CAAC,CAAC2B,KAAF,GAAQ,KAAKA,KAAb,EAAmB3B,CAAC,CAACgD,WAAF,GAAc,KAAKrB,KAAtC;AAA4C,OAApE,GAAuE1B,CAA9E;AAAgF,KAA7K,CAAP;AAAuL;;AAAAgD,EAAAA,MAAM,GAAE;AAAC,UAAMA,MAAN,IAAe,KAAK1B,gBAAL,GAAsB,cAArC;AAAoD;;AAAA2B,EAAAA,oBAAoB,GAAE;AAAC,WAAM,EAAC,GAAG,MAAMA,oBAAN,EAAJ;AAAiCC,MAAAA,WAAW,EAACnD,CAAC,IAAE;AAAC,aAAKoD,GAAL,CAASpD,CAAC,CAACqD,YAAX,EAAwBrD,CAAC,CAACsD,KAA1B;AAAiC;AAAlF,KAAN;AAA0F;;AAAAC,EAAAA,uBAAuB,CAACvD,CAAD,EAAG;AAAC,UAAMC,CAAC,GAAE,GAAEuD,IAAI,CAACC,SAAL,CAAe,KAAK9B,KAAL,CAAW+B,YAA1B,CAAwC,IAAGF,IAAI,CAACC,SAAL,CAAe3C,CAAC,CAAC,KAAKa,KAAL,CAAWgC,oBAAZ,EAAiC,KAAKhC,KAAL,CAAWiC,kBAA5C,CAAhB,CAAiF,GAAvI;AAA0I,WAAO,MAAML,uBAAN,CAA8BvD,CAA9B,IAAiCC,CAAxC;AAA0C;;AAA2B,QAArB4D,qBAAqB,GAAE;AAAC,UAAM7D,CAAC,GAAC,KAAK2B,KAAb;AAAA,UAAmB;AAACmC,MAAAA,aAAa,EAAC7D;AAAf,QAAkBD,CAArC;AAAA,UAAuCG,CAAC,GAACH,CAAC,CAAC+D,MAAF,CAASC,GAAT,CAAchE,CAAC,IAAEA,CAAC,CAACgB,MAAF,EAAjB,CAAzC;AAAA,UAAuEX,CAAC,GAACQ,CAAC,CAACb,CAAC,CAACiE,YAAH,CAA1E;AAAA,UAA2F1D,CAAC,GAACP,CAAC,CAACwC,QAAF,IAAYxC,CAAC,CAACwC,QAAF,CAAWxB,MAAX,EAAZ,IAAiC,IAA9H;AAAA,UAAmIP,CAAC,GAACT,CAAC,CAACkE,gBAAF,GAAmBlE,CAAC,CAACkE,gBAAF,CAAmBlD,MAAnB,EAAnB,GAA+C,IAApL;AAAyL,WAAM;AAACmD,MAAAA,IAAI,EAAC,QAAN;AAAeJ,MAAAA,MAAM,EAAC5D,CAAtB;AAAwB8D,MAAAA,YAAY,EAAC5D,CAArC;AAAuCyD,MAAAA,aAAa,EAAC7D,CAArD;AAAuDuC,MAAAA,QAAQ,EAACjC,CAAhE;AAAkE6D,MAAAA,MAAM,EAAC,KAAKzC,KAAL,CAAW0C,SAApF;AAA8FC,MAAAA,aAAa,EAACxD,CAAC,CAAC,KAAKa,KAAL,CAAWgC,oBAAZ,EAAiC,KAAKhC,KAAL,CAAWiC,kBAA5C,CAA7G;AAA6KF,MAAAA,YAAY,EAAC,KAAK/B,KAAL,CAAW+B,YAAX,CAAwB1C,MAAxB,EAA1L;AAA2NuD,MAAAA,kBAAkB,EAAC,KAAKlD,oBAAnP;AAAwQ6C,MAAAA,gBAAgB,EAACzD,CAAzR;AAA2R+D,MAAAA,uBAAuB,EAAC,KAAK7C,KAAL,CAAW6C,uBAA9T;AAAsVC,MAAAA,uBAAuB,EAAC,KAAK9C,KAAL,CAAW8C,uBAAzX;AAAiZC,MAAAA,cAAc,EAAC,KAAK/C,KAAL,CAAW+C,cAA3a;AAA0bC,MAAAA,gBAAgB,EAAC3E,CAAC,CAAC2E;AAA7c,KAAN;AAAqe;;AAAxmE,CAArB;AAA+nE3E,CAAC,CAAC,CAACO,CAAC,EAAF,CAAD,EAAOW,CAAC,CAAC0D,SAAT,EAAmB,aAAnB,EAAiC,KAAK,CAAtC,CAAD,EAA0C5E,CAAC,CAAC,CAACO,CAAC,CAAC;AAACsE,EAAAA,QAAQ,EAAC,CAAC;AAAX,CAAD,CAAF,CAAD,EAAoB3D,CAAC,CAAC0D,SAAtB,EAAgC,iBAAhC,EAAkD,IAAlD,CAA3C,EAAmG5E,CAAC,CAAC,CAACO,CAAC,EAAF,CAAD,EAAOW,CAAC,CAAC0D,SAAT,EAAmB,kBAAnB,EAAsC,KAAK,CAA3C,CAApG,EAAkJ1D,CAAC,GAAClB,CAAC,CAAC,CAACS,CAAC,CAAC,wCAAD,CAAF,CAAD,EAA+CS,CAA/C,CAArJ;AAAuM,MAAM4D,CAAC,GAAC5D,CAAR;AAAU,SAAO4D,CAAC,IAAIC,OAAZ","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/Error.js\";import{isNone as r,isSome as s}from\"../../../core/maybe.js\";import{property as i}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import{subclass as o}from\"../../../core/accessorSupport/decorators/subclass.js\";import a from\"../../../rest/support/FeatureSet.js\";import n from\"./FeatureLayerView2D.js\";import{toJSONGeometryType as c}from\"./support/util.js\";function p(e,t){if(r(e)&&r(t))return null;const i={};return s(t)&&(i.geometry=t.toJSON()),s(e)&&(i.where=e),i}let l=class extends n{constructor(){super(...arguments),this._enabledDataReceived=!1,this.errorString=null,this.connectionStatus=\"disconnected\"}initialize(){this.handles.add([this.layer.watch(\"purgeOptions\",(()=>this._update())),this.watch(\"suspended\",(e=>{e?this._proxy.pauseStream():this._proxy.resumeStream()}))])}get connectionError(){if(this.errorString)return new t(\"stream-controller\",this.errorString)}on(e,t){\"data-received\"===e&&(this._enabledDataReceived=!0,this._proxy.enableEvent(\"data-received\",!0));const r=super.on(e,t),s=this;return{remove(){r.remove(),\"data-received\"===e&&(s._proxy.closed||s.hasEventListener(\"data-received\")||s._proxy.enableEvent(\"data-received\",!1))}}}queryLatestObservations(e,r){if(!(this.layer.timeInfo.endField||this.layer.timeInfo.startField))throw new t(\"streamlayer-no-timeField\",\"queryLatestObservation can only be used with services that define a TrackIdField\");return this._proxy.queryLatestObservations(this._cleanUpQuery(e),r).then((e=>{const t=a.fromJSON(e);return t.features.forEach((e=>{e.layer=this.layer,e.sourceLayer=this.layer})),t}))}detach(){super.detach(),this.connectionStatus=\"disconnected\"}_createClientOptions(){return{...super._createClientOptions(),setProperty:e=>{this.set(e.propertyName,e.value)}}}_createTileRendererHash(e){const t=`${JSON.stringify(this.layer.purgeOptions)}.${JSON.stringify(p(this.layer.definitionExpression,this.layer.geometryDefinition))})`;return super._createTileRendererHash(e)+t}async _createServiceOptions(){const e=this.layer,{objectIdField:t}=e,r=e.fields.map((e=>e.toJSON())),s=c(e.geometryType),i=e.timeInfo&&e.timeInfo.toJSON()||null,o=e.spatialReference?e.spatialReference.toJSON():null;return{type:\"stream\",fields:r,geometryType:s,objectIdField:t,timeInfo:i,source:this.layer.parsedUrl,serviceFilter:p(this.layer.definitionExpression,this.layer.geometryDefinition),purgeOptions:this.layer.purgeOptions.toJSON(),enableDataReceived:this._enabledDataReceived,spatialReference:o,maxReconnectionAttempts:this.layer.maxReconnectionAttempts,maxReconnectionInterval:this.layer.maxReconnectionInterval,updateInterval:this.layer.updateInterval,customParameters:e.customParameters}}};e([i()],l.prototype,\"errorString\",void 0),e([i({readOnly:!0})],l.prototype,\"connectionError\",null),e([i()],l.prototype,\"connectionStatus\",void 0),l=e([o(\"esri.views.2d.layers.StreamLayerView2D\")],l);const d=l;export{d as default};\n"]},"metadata":{},"sourceType":"module"}