{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport { c as e } from \"../../../../../../chunks/vec3f64.js\";\nimport { ShaderOutput as r } from \"../ShaderOutputOptions.js\";\nimport { DoublePrecision as i } from \"../util/DoublePrecision.glsl.js\";\nimport { glsl as o } from \"../../shaderModules/interfaces.js\";\nimport { VertexAttribute as n } from \"../../../lib/VertexAttribute.js\";\nimport { encodeDoubleArraySplit as t } from \"../../../../../webgl/doublePrecisionUtils.js\";\n\nfunction a(e, t) {\n  t.instanced && t.instancedDoublePrecision && (e.attributes.add(n.MODELORIGINHI, \"vec3\"), e.attributes.add(n.MODELORIGINLO, \"vec3\"), e.attributes.add(n.MODEL, \"mat3\"), e.attributes.add(n.MODELNORMAL, \"mat3\")), t.instancedDoublePrecision && (e.vertex.include(i, t), e.vertex.uniforms.add(\"viewOriginHi\", \"vec3\"), e.vertex.uniforms.add(\"viewOriginLo\", \"vec3\"));\n  const a = [o`\n    vec3 calculateVPos() {\n      ${t.instancedDoublePrecision ? \"return model * localPosition().xyz;\" : \"return localPosition().xyz;\"}\n    }\n    `, o`\n    vec3 subtractOrigin(vec3 _pos) {\n      ${t.instancedDoublePrecision ? o`\n          vec3 originDelta = dpAdd(viewOriginHi, viewOriginLo, -modelOriginHi, -modelOriginLo);\n          return _pos - originDelta;` : \"return vpos;\"}\n    }\n    `, o`\n    vec3 dpNormal(vec4 _normal) {\n      ${t.instancedDoublePrecision ? \"return normalize(modelNormal * _normal.xyz);\" : \"return normalize(_normal.xyz);\"}\n    }\n    `, o`\n    vec3 dpNormalView(vec4 _normal) {\n      ${t.instancedDoublePrecision ? \"return normalize((viewNormal * vec4(modelNormal * _normal.xyz, 1.0)).xyz);\" : \"return normalize((viewNormal * _normal).xyz);\"}\n    }\n    `, t.vertexTangents ? o`\n    vec4 dpTransformVertexTangent(vec4 _tangent) {\n      ${t.instancedDoublePrecision ? \"return vec4(modelNormal * _tangent.xyz, _tangent.w);\" : \"return _tangent;\"}\n\n    }\n    ` : o``];\n  e.vertex.code.add(a[0]), e.vertex.code.add(a[1]), e.vertex.code.add(a[2]), t.output === r.Normal && e.vertex.code.add(a[3]), e.vertex.code.add(a[4]);\n}\n\nclass c {}\n\nfunction d(e, r) {\n  t(r, s, l, 3), e.setUniform3fv(\"viewOriginHi\", s), e.setUniform3fv(\"viewOriginLo\", l);\n}\n\nconst s = e(),\n      l = e();\nexport { a as InstancedDoublePrecision, c as InstancedDoublePrecisionUniforms, d as bindCustomOrigin };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/attributes/InstancedDoublePrecision.glsl.js"],"names":["c","e","ShaderOutput","r","DoublePrecision","i","glsl","o","VertexAttribute","n","encodeDoubleArraySplit","t","a","instanced","instancedDoublePrecision","attributes","add","MODELORIGINHI","MODELORIGINLO","MODEL","MODELNORMAL","vertex","include","uniforms","vertexTangents","code","output","Normal","d","s","l","setUniform3fv","InstancedDoublePrecision","InstancedDoublePrecisionUniforms","bindCustomOrigin"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{c as e}from\"../../../../../../chunks/vec3f64.js\";import{ShaderOutput as r}from\"../ShaderOutputOptions.js\";import{DoublePrecision as i}from\"../util/DoublePrecision.glsl.js\";import{glsl as o}from\"../../shaderModules/interfaces.js\";import{VertexAttribute as n}from\"../../../lib/VertexAttribute.js\";import{encodeDoubleArraySplit as t}from\"../../../../../webgl/doublePrecisionUtils.js\";function a(e,t){t.instanced&&t.instancedDoublePrecision&&(e.attributes.add(n.MODELORIGINHI,\"vec3\"),e.attributes.add(n.MODELORIGINLO,\"vec3\"),e.attributes.add(n.MODEL,\"mat3\"),e.attributes.add(n.MODELNORMAL,\"mat3\")),t.instancedDoublePrecision&&(e.vertex.include(i,t),e.vertex.uniforms.add(\"viewOriginHi\",\"vec3\"),e.vertex.uniforms.add(\"viewOriginLo\",\"vec3\"));const a=[o`\n    vec3 calculateVPos() {\n      ${t.instancedDoublePrecision?\"return model * localPosition().xyz;\":\"return localPosition().xyz;\"}\n    }\n    `,o`\n    vec3 subtractOrigin(vec3 _pos) {\n      ${t.instancedDoublePrecision?o`\n          vec3 originDelta = dpAdd(viewOriginHi, viewOriginLo, -modelOriginHi, -modelOriginLo);\n          return _pos - originDelta;`:\"return vpos;\"}\n    }\n    `,o`\n    vec3 dpNormal(vec4 _normal) {\n      ${t.instancedDoublePrecision?\"return normalize(modelNormal * _normal.xyz);\":\"return normalize(_normal.xyz);\"}\n    }\n    `,o`\n    vec3 dpNormalView(vec4 _normal) {\n      ${t.instancedDoublePrecision?\"return normalize((viewNormal * vec4(modelNormal * _normal.xyz, 1.0)).xyz);\":\"return normalize((viewNormal * _normal).xyz);\"}\n    }\n    `,t.vertexTangents?o`\n    vec4 dpTransformVertexTangent(vec4 _tangent) {\n      ${t.instancedDoublePrecision?\"return vec4(modelNormal * _tangent.xyz, _tangent.w);\":\"return _tangent;\"}\n\n    }\n    `:o``];e.vertex.code.add(a[0]),e.vertex.code.add(a[1]),e.vertex.code.add(a[2]),t.output===r.Normal&&e.vertex.code.add(a[3]),e.vertex.code.add(a[4])}class c{}function d(e,r){t(r,s,l,3),e.setUniform3fv(\"viewOriginHi\",s),e.setUniform3fv(\"viewOriginLo\",l)}const s=e(),l=e();export{a as InstancedDoublePrecision,c as InstancedDoublePrecisionUniforms,d as bindCustomOrigin};\n"]},"metadata":{},"sourceType":"module"}