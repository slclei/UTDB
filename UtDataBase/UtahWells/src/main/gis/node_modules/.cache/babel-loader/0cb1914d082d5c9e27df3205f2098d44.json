{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport { packFloatRGBA as t } from \"../../core/floatRGBA.js\";\nimport { isExtent as n } from \"../../geometry/support/jsonUtils.js\";\nimport o from \"./Rect.js\";\n\nfunction r(t) {\n  if (!t) return null;\n\n  switch (t.type) {\n    case \"CIMPointSymbol\":\n      {\n        const n = t.symbolLayers;\n        return n && 1 === n.length ? r(n[0]) : null;\n      }\n\n    case \"CIMVectorMarker\":\n      {\n        var n;\n        const o = t.markerGraphics;\n        if (!o || 1 !== o.length) return null;\n        const r = o[0];\n        if (!r) return null;\n        const l = r.geometry;\n        if (!l) return null;\n        const e = r.symbol;\n        return !e || \"CIMPolygonSymbol\" !== e.type && \"CIMLineSymbol\" !== e.type || null != (n = e.symbolLayers) && n.some(t => !!t.effects) ? null : {\n          geom: l,\n          asFill: \"CIMPolygonSymbol\" === e.type\n        };\n      }\n\n    case \"sdf\":\n      return {\n        geom: t.geom,\n        asFill: t.asFill\n      };\n  }\n\n  return null;\n}\n\nfunction l(t) {\n  const n = t.markerGraphics;\n  if (!n || 1 !== n.length) return null;\n  const o = n[0];\n  if (!o) return null;\n  const r = o.symbol;\n  return !r || \"CIMPolygonSymbol\" !== r.type && \"CIMLineSymbol\" !== r.type ? null : r;\n}\n\nfunction e(t) {\n  return t ? t.rings ? t.rings : t.paths ? t.paths : void 0 !== t.xmin && void 0 !== t.ymin && void 0 !== t.xmax && void 0 !== t.ymax ? [[[t.xmin, t.ymin], [t.xmin, t.ymax], [t.xmax, t.ymax], [t.xmax, t.ymin], [t.xmin, t.ymin]]] : null : null;\n}\n\nfunction s(t) {\n  let n = 1 / 0,\n      r = -1 / 0,\n      l = 1 / 0,\n      e = -1 / 0;\n\n  for (const o of t) for (const t of o) t[0] < n && (n = t[0]), t[0] > r && (r = t[0]), t[1] < l && (l = t[1]), t[1] > e && (e = t[1]);\n\n  return new o(n, l, r - n, e - l);\n}\n\nfunction i(t) {\n  let n = 1 / 0,\n      o = -1 / 0,\n      r = 1 / 0,\n      l = -1 / 0;\n\n  for (const e of t) for (const t of e) t[0] < n && (n = t[0]), t[0] > o && (o = t[0]), t[1] < r && (r = t[1]), t[1] > l && (l = t[1]);\n\n  return [n, r, o, l];\n}\n\nfunction f(t) {\n  return t ? t.rings ? i(t.rings) : t.paths ? i(t.paths) : n(t) ? [t.xmin, t.ymin, t.xmax, t.ymax] : null : null;\n}\n\nfunction a(t, n, o, r, l) {\n  const [e, s, i, f] = t;\n  if (i < e || f < s) return [0, 0, 0];\n  const a = i - e,\n        m = f - s,\n        u = 128,\n        c = 1,\n        y = Math.floor(.5 * (.5 * u - c)),\n        h = (u - 2 * (y + c)) / Math.max(a, m),\n        x = Math.round(a * h) + 2 * y,\n        M = Math.round(m * h) + 2 * y;\n  let g = 1;\n\n  if (n) {\n    g = M / h / (n.ymax - n.ymin);\n  }\n\n  let p = 0,\n      d = 0;\n  if (r) if (l) {\n    if (n && o && n.ymax - n.ymin > 0) {\n      const t = (n.xmax - n.xmin) / (n.ymax - n.ymin);\n      p = r.x / (o * t), d = r.y / o;\n    }\n  } else p = r.x, d = r.y;\n  p = .5 * (n.xmax + n.xmin) + p * (n.xmax - n.xmin), d = .5 * (n.ymax + n.ymin) + d * (n.ymax - n.ymin), p -= e, d -= s, p *= h, d *= h, p += y, d += y;\n  return [g, p / x - .5, -(d / M - .5)];\n}\n\nfunction m(t) {\n  const n = e(t.geom),\n        o = s(n),\n        r = 128,\n        l = 1,\n        i = Math.floor(.5 * (.5 * r - l)),\n        f = (r - 2 * (i + l)) / Math.max(o.width, o.height),\n        a = Math.round(o.width * f) + 2 * i,\n        m = Math.round(o.height * f) + 2 * i,\n        h = [];\n\n  for (const e of n) if (e && e.length > 1) {\n    const n = [];\n\n    for (const r of e) {\n      let [l, e] = r;\n      l -= o.x, e -= o.y, l *= f, e *= f, l += i - .5, e += i - .5, t.asFill ? n.push([l, e]) : n.push([Math.round(l), Math.round(e)]);\n    }\n\n    if (t.asFill) {\n      const t = n.length - 1;\n      n[0][0] === n[t][0] && n[0][1] === n[t][1] || n.push(n[0]);\n    }\n\n    h.push(n);\n  }\n\n  const x = u(h, a, m, i);\n  return t.asFill && c(h, a, m, i, x), [y(x, i), a, m];\n}\n\nfunction u(t, n, o, r) {\n  const l = n * o,\n        e = new Array(l),\n        s = r * r + 1;\n\n  for (let i = 0; i < l; ++i) e[i] = s;\n\n  for (const i of t) {\n    const t = i.length;\n\n    for (let l = 1; l < t; ++l) {\n      const t = i[l - 1],\n            s = i[l];\n      let f, a, m, u;\n      t[0] < s[0] ? (f = t[0], a = s[0]) : (f = s[0], a = t[0]), t[1] < s[1] ? (m = t[1], u = s[1]) : (m = s[1], u = t[1]);\n      let c = Math.floor(f) - r,\n          y = Math.floor(a) + r,\n          h = Math.floor(m) - r,\n          x = Math.floor(u) + r;\n      c < 0 && (c = 0), y > n && (y = n), h < 0 && (h = 0), x > o && (x = o);\n      const M = s[0] - t[0],\n            g = s[1] - t[1],\n            p = M * M + g * g;\n\n      for (let r = c; r < y; r++) for (let l = h; l < x; l++) {\n        let i,\n            f,\n            a = (r - t[0]) * M + (l - t[1]) * g;\n        a < 0 ? (i = t[0], f = t[1]) : a > p ? (i = s[0], f = s[1]) : (a /= p, i = t[0] + a * M, f = t[1] + a * g);\n        const m = (r - i) * (r - i) + (l - f) * (l - f),\n              u = (o - l - 1) * n + r;\n        m < e[u] && (e[u] = m);\n      }\n    }\n  }\n\n  for (let i = 0; i < l; ++i) e[i] = Math.sqrt(e[i]);\n\n  return e;\n}\n\nfunction c(t, n, o, r, l) {\n  for (const e of t) {\n    const t = e.length;\n\n    for (let s = 1; s < t; ++s) {\n      const t = e[s - 1],\n            i = e[s];\n      let f, a, m, u;\n      t[0] < i[0] ? (f = t[0], a = i[0]) : (f = i[0], a = t[0]), t[1] < i[1] ? (m = t[1], u = i[1]) : (m = i[1], u = t[1]);\n      let c = Math.floor(f),\n          y = Math.floor(a) + 1,\n          h = Math.floor(m),\n          x = Math.floor(u) + 1;\n      c < r && (c = r), y > n - r && (y = n - r), h < r && (h = r), x > o - r && (x = o - r);\n\n      for (let e = h; e < x; ++e) {\n        if (t[1] > e == i[1] > e) continue;\n        const s = (o - e - 1) * n;\n\n        for (let n = c; n < y; ++n) n < (i[0] - t[0]) * (e - t[1]) / (i[1] - t[1]) + t[0] && (l[s + n] = -l[s + n]);\n\n        for (let t = r; t < c; ++t) l[s + t] = -l[s + t];\n      }\n    }\n  }\n}\n\nfunction y(n, o) {\n  const r = 2 * o,\n        l = n.length,\n        e = new Uint8Array(4 * l);\n\n  for (let s = 0; s < l; ++s) {\n    const o = .5 - n[s] / r;\n    t(o, e, 4 * s);\n  }\n\n  return e;\n}\n\nexport { m as buildSDF, f as getExtent, r as getSDFInfo, a as getSDFMetrics, l as getSDFSymbol };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/symbols/cim/SDFHelper.js"],"names":["packFloatRGBA","t","isExtent","n","o","r","type","symbolLayers","length","markerGraphics","l","geometry","e","symbol","some","effects","geom","asFill","rings","paths","xmin","ymin","xmax","ymax","s","i","f","a","m","u","c","y","Math","floor","h","max","x","round","M","g","p","d","width","height","push","Array","sqrt","Uint8Array","buildSDF","getExtent","getSDFInfo","getSDFMetrics","getSDFSymbol"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{packFloatRGBA as t}from\"../../core/floatRGBA.js\";import{isExtent as n}from\"../../geometry/support/jsonUtils.js\";import o from\"./Rect.js\";function r(t){if(!t)return null;switch(t.type){case\"CIMPointSymbol\":{const n=t.symbolLayers;return n&&1===n.length?r(n[0]):null}case\"CIMVectorMarker\":{var n;const o=t.markerGraphics;if(!o||1!==o.length)return null;const r=o[0];if(!r)return null;const l=r.geometry;if(!l)return null;const e=r.symbol;return!e||\"CIMPolygonSymbol\"!==e.type&&\"CIMLineSymbol\"!==e.type||null!=(n=e.symbolLayers)&&n.some((t=>!!t.effects))?null:{geom:l,asFill:\"CIMPolygonSymbol\"===e.type}}case\"sdf\":return{geom:t.geom,asFill:t.asFill}}return null}function l(t){const n=t.markerGraphics;if(!n||1!==n.length)return null;const o=n[0];if(!o)return null;const r=o.symbol;return!r||\"CIMPolygonSymbol\"!==r.type&&\"CIMLineSymbol\"!==r.type?null:r}function e(t){return t?t.rings?t.rings:t.paths?t.paths:void 0!==t.xmin&&void 0!==t.ymin&&void 0!==t.xmax&&void 0!==t.ymax?[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]:null:null}function s(t){let n=1/0,r=-1/0,l=1/0,e=-1/0;for(const o of t)for(const t of o)t[0]<n&&(n=t[0]),t[0]>r&&(r=t[0]),t[1]<l&&(l=t[1]),t[1]>e&&(e=t[1]);return new o(n,l,r-n,e-l)}function i(t){let n=1/0,o=-1/0,r=1/0,l=-1/0;for(const e of t)for(const t of e)t[0]<n&&(n=t[0]),t[0]>o&&(o=t[0]),t[1]<r&&(r=t[1]),t[1]>l&&(l=t[1]);return[n,r,o,l]}function f(t){return t?t.rings?i(t.rings):t.paths?i(t.paths):n(t)?[t.xmin,t.ymin,t.xmax,t.ymax]:null:null}function a(t,n,o,r,l){const[e,s,i,f]=t;if(i<e||f<s)return[0,0,0];const a=i-e,m=f-s,u=128,c=1,y=Math.floor(.5*(.5*u-c)),h=(u-2*(y+c))/Math.max(a,m),x=Math.round(a*h)+2*y,M=Math.round(m*h)+2*y;let g=1;if(n){g=M/h/(n.ymax-n.ymin)}let p=0,d=0;if(r)if(l){if(n&&o&&n.ymax-n.ymin>0){const t=(n.xmax-n.xmin)/(n.ymax-n.ymin);p=r.x/(o*t),d=r.y/o}}else p=r.x,d=r.y;p=.5*(n.xmax+n.xmin)+p*(n.xmax-n.xmin),d=.5*(n.ymax+n.ymin)+d*(n.ymax-n.ymin),p-=e,d-=s,p*=h,d*=h,p+=y,d+=y;return[g,p/x-.5,-(d/M-.5)]}function m(t){const n=e(t.geom),o=s(n),r=128,l=1,i=Math.floor(.5*(.5*r-l)),f=(r-2*(i+l))/Math.max(o.width,o.height),a=Math.round(o.width*f)+2*i,m=Math.round(o.height*f)+2*i,h=[];for(const e of n)if(e&&e.length>1){const n=[];for(const r of e){let[l,e]=r;l-=o.x,e-=o.y,l*=f,e*=f,l+=i-.5,e+=i-.5,t.asFill?n.push([l,e]):n.push([Math.round(l),Math.round(e)])}if(t.asFill){const t=n.length-1;n[0][0]===n[t][0]&&n[0][1]===n[t][1]||n.push(n[0])}h.push(n)}const x=u(h,a,m,i);return t.asFill&&c(h,a,m,i,x),[y(x,i),a,m]}function u(t,n,o,r){const l=n*o,e=new Array(l),s=r*r+1;for(let i=0;i<l;++i)e[i]=s;for(const i of t){const t=i.length;for(let l=1;l<t;++l){const t=i[l-1],s=i[l];let f,a,m,u;t[0]<s[0]?(f=t[0],a=s[0]):(f=s[0],a=t[0]),t[1]<s[1]?(m=t[1],u=s[1]):(m=s[1],u=t[1]);let c=Math.floor(f)-r,y=Math.floor(a)+r,h=Math.floor(m)-r,x=Math.floor(u)+r;c<0&&(c=0),y>n&&(y=n),h<0&&(h=0),x>o&&(x=o);const M=s[0]-t[0],g=s[1]-t[1],p=M*M+g*g;for(let r=c;r<y;r++)for(let l=h;l<x;l++){let i,f,a=(r-t[0])*M+(l-t[1])*g;a<0?(i=t[0],f=t[1]):a>p?(i=s[0],f=s[1]):(a/=p,i=t[0]+a*M,f=t[1]+a*g);const m=(r-i)*(r-i)+(l-f)*(l-f),u=(o-l-1)*n+r;m<e[u]&&(e[u]=m)}}}for(let i=0;i<l;++i)e[i]=Math.sqrt(e[i]);return e}function c(t,n,o,r,l){for(const e of t){const t=e.length;for(let s=1;s<t;++s){const t=e[s-1],i=e[s];let f,a,m,u;t[0]<i[0]?(f=t[0],a=i[0]):(f=i[0],a=t[0]),t[1]<i[1]?(m=t[1],u=i[1]):(m=i[1],u=t[1]);let c=Math.floor(f),y=Math.floor(a)+1,h=Math.floor(m),x=Math.floor(u)+1;c<r&&(c=r),y>n-r&&(y=n-r),h<r&&(h=r),x>o-r&&(x=o-r);for(let e=h;e<x;++e){if(t[1]>e==i[1]>e)continue;const s=(o-e-1)*n;for(let n=c;n<y;++n)n<(i[0]-t[0])*(e-t[1])/(i[1]-t[1])+t[0]&&(l[s+n]=-l[s+n]);for(let t=r;t<c;++t)l[s+t]=-l[s+t]}}}}function y(n,o){const r=2*o,l=n.length,e=new Uint8Array(4*l);for(let s=0;s<l;++s){const o=.5-n[s]/r;t(o,e,4*s)}return e}export{m as buildSDF,f as getExtent,r as getSDFInfo,a as getSDFMetrics,l as getSDFSymbol};\n"]},"metadata":{},"sourceType":"module"}