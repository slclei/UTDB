{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport e from \"../../VertexStream.js\";\nimport { BlendFactor as t, TextureType as s, PixelFormat as r, PixelType as i, TextureWrapMode as a, TextureSamplingMode as o } from \"../../../../../webgl/enums.js\";\nimport { Texture as n } from \"../../../../../webgl/Texture.js\";\n\nclass l {\n  constructor() {\n    this._size = [0, 0], this._programDesc = {\n      vsPath: \"post-processing/pp\",\n      fsPath: \"post-processing/filterEffect\",\n      attributes: new Map([[\"a_position\", 0]])\n    };\n  }\n\n  dispose() {\n    this._layerFBOTexture && (this._layerFBOTexture.dispose(), this._layerFBOTexture = null);\n  }\n\n  draw(e, s, r) {\n    const {\n      width: i,\n      height: a\n    } = s;\n\n    this._createOrResizeResources(e, i, a);\n\n    const {\n      context: o,\n      painter: n\n    } = e,\n          {\n      materialManager: l\n    } = n,\n          _ = this._programDesc,\n          c = this._quad,\n          h = r.colorMatrix;\n    c.bind();\n    const u = this._layerFBOTexture;\n    o.bindFramebuffer(s), s.copyToTexture(0, 0, i, a, 0, 0, u), o.setBlendingEnabled(!1), o.setStencilTestEnabled(!1);\n    const d = l.getProgram(e, _);\n    o.useProgram(d), o.bindTexture(u, 2), d.setUniformMatrix4fv(\"u_coefficients\", h), d.setUniform1i(\"u_colorTexture\", 2), c.draw(), o.setBlendingEnabled(!0), o.setBlendFunction(t.ONE, t.ONE_MINUS_SRC_ALPHA), o.setStencilTestEnabled(!0), c.unbind();\n  }\n\n  _createOrResizeResources(t, l, _) {\n    const {\n      context: c\n    } = t;\n    this._layerFBOTexture && this._size[0] === l && this._size[1] === _ || (this._size[0] = l, this._size[1] = _, this._layerFBOTexture ? this._layerFBOTexture.resize(l, _) : this._layerFBOTexture = new n(c, {\n      target: s.TEXTURE_2D,\n      pixelFormat: r.RGBA,\n      internalFormat: r.RGBA,\n      dataType: i.UNSIGNED_BYTE,\n      wrapMode: a.CLAMP_TO_EDGE,\n      samplingMode: o.LINEAR,\n      flipped: !1,\n      width: l,\n      height: _\n    }), this._quad || (this._quad = new e(c, [-1, -1, 1, -1, -1, 1, 1, 1])));\n  }\n\n}\n\nexport { l as Colorize };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/views/2d/engine/webgl/effects/post-processing/Colorize.js"],"names":["e","BlendFactor","t","TextureType","s","PixelFormat","r","PixelType","i","TextureWrapMode","a","TextureSamplingMode","o","Texture","n","l","constructor","_size","_programDesc","vsPath","fsPath","attributes","Map","dispose","_layerFBOTexture","draw","width","height","_createOrResizeResources","context","painter","materialManager","_","c","_quad","h","colorMatrix","bind","u","bindFramebuffer","copyToTexture","setBlendingEnabled","setStencilTestEnabled","d","getProgram","useProgram","bindTexture","setUniformMatrix4fv","setUniform1i","setBlendFunction","ONE","ONE_MINUS_SRC_ALPHA","unbind","resize","target","TEXTURE_2D","pixelFormat","RGBA","internalFormat","dataType","UNSIGNED_BYTE","wrapMode","CLAMP_TO_EDGE","samplingMode","LINEAR","flipped","Colorize"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport e from\"../../VertexStream.js\";import{BlendFactor as t,TextureType as s,PixelFormat as r,PixelType as i,TextureWrapMode as a,TextureSamplingMode as o}from\"../../../../../webgl/enums.js\";import{Texture as n}from\"../../../../../webgl/Texture.js\";class l{constructor(){this._size=[0,0],this._programDesc={vsPath:\"post-processing/pp\",fsPath:\"post-processing/filterEffect\",attributes:new Map([[\"a_position\",0]])}}dispose(){this._layerFBOTexture&&(this._layerFBOTexture.dispose(),this._layerFBOTexture=null)}draw(e,s,r){const{width:i,height:a}=s;this._createOrResizeResources(e,i,a);const{context:o,painter:n}=e,{materialManager:l}=n,_=this._programDesc,c=this._quad,h=r.colorMatrix;c.bind();const u=this._layerFBOTexture;o.bindFramebuffer(s),s.copyToTexture(0,0,i,a,0,0,u),o.setBlendingEnabled(!1),o.setStencilTestEnabled(!1);const d=l.getProgram(e,_);o.useProgram(d),o.bindTexture(u,2),d.setUniformMatrix4fv(\"u_coefficients\",h),d.setUniform1i(\"u_colorTexture\",2),c.draw(),o.setBlendingEnabled(!0),o.setBlendFunction(t.ONE,t.ONE_MINUS_SRC_ALPHA),o.setStencilTestEnabled(!0),c.unbind()}_createOrResizeResources(t,l,_){const{context:c}=t;this._layerFBOTexture&&this._size[0]===l&&this._size[1]===_||(this._size[0]=l,this._size[1]=_,this._layerFBOTexture?this._layerFBOTexture.resize(l,_):this._layerFBOTexture=new n(c,{target:s.TEXTURE_2D,pixelFormat:r.RGBA,internalFormat:r.RGBA,dataType:i.UNSIGNED_BYTE,wrapMode:a.CLAMP_TO_EDGE,samplingMode:o.LINEAR,flipped:!1,width:l,height:_}),this._quad||(this._quad=new e(c,[-1,-1,1,-1,-1,1,1,1])))}}export{l as Colorize};\n"]},"metadata":{},"sourceType":"module"}