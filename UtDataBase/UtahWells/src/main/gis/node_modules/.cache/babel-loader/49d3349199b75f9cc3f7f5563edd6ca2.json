{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../chunks/tslib.es6.js\";\nimport \"../../geometry.js\";\nimport r from \"../../PopupTemplate.js\";\nimport \"../../renderers/ClassBreaksRenderer.js\";\nimport \"../../renderers/DictionaryRenderer.js\";\nimport \"../../renderers/DotDensityRenderer.js\";\nimport \"../../renderers/HeatmapRenderer.js\";\nimport \"../../renderers/Renderer.js\";\nimport \"../../renderers/SimpleRenderer.js\";\nimport \"../../renderers/UniqueValueRenderer.js\";\nimport \"../../renderers/support/jsonUtils.js\";\nimport { rendererTypes as i, webSceneRendererTypes as t } from \"../../renderers/support/types.js\";\nimport o from \"../../request.js\";\nimport { isSymbol3D as l } from \"../../symbols.js\";\nimport s from \"../../core/Collection.js\";\nimport a from \"../../core/Error.js\";\nimport { HandleOwnerMixin as n } from \"../../core/HandleOwner.js\";\nimport { IdentifiableMixin as p } from \"../../core/Identifiable.js\";\nimport { clone as y } from \"../../core/lang.js\";\nimport d from \"../../core/Loadable.js\";\nimport u from \"../../core/Logger.js\";\nimport { isSome as c } from \"../../core/maybe.js\";\nimport { MultiOriginJSONMixin as f } from \"../../core/MultiOriginJSONSupport.js\";\nimport { objectToQuery as m } from \"../../core/urlUtils.js\";\nimport { property as h } from \"../../core/accessorSupport/decorators/property.js\";\nimport { getProperties as b } from \"../../core/accessorSupport/utils.js\";\nimport { cast as g } from \"../../core/accessorSupport/decorators/cast.js\";\nimport { reader as S } from \"../../core/accessorSupport/decorators/reader.js\";\nimport { subclass as I } from \"../../core/accessorSupport/decorators/subclass.js\";\nimport { writer as v } from \"../../core/accessorSupport/decorators/writer.js\";\nimport { ensureInteger as w, ensureType as j, Integer as D, ensureClass as L } from \"../../core/accessorSupport/ensureType.js\";\nimport { OriginId as E, nameToId as F } from \"../../core/accessorSupport/PropertyOrigin.js\";\nimport x from \"./FeatureType.js\";\nimport O from \"./Field.js\";\nimport P from \"./FieldsIndex.js\";\nimport _ from \"./LabelClass.js\";\nimport T from \"./LayerFloorInfo.js\";\nimport { DataLayerSource as N } from \"./source/DataLayerSource.js\";\nimport { MapLayerSource as M } from \"./source/MapLayerSource.js\";\nimport V from \"../../rest/support/Query.js\";\nimport { createPopupTemplate as A } from \"../../support/popupUtils.js\";\nimport { combineFloorsDefinitionExpression as U } from \"../../views/support/floorFilterUtils.js\";\nimport C from \"../../geometry/Extent.js\";\nvar R;\n\nfunction k(e) {\n  return e && \"esriSMS\" === e.type;\n}\n\nfunction q(e, r, i) {\n  var t;\n  const o = this.originIdOf(r) >= F(i.origin);\n  return {\n    ignoreOrigin: !0,\n    allowNull: o,\n    enabled: !!i && \"map-image\" === (null == (t = i.layer) ? void 0 : t.type) && (i.writeSublayerStructure || o)\n  };\n}\n\nfunction $(e, r, i) {\n  var t;\n  return {\n    enabled: !!i && \"tile\" === (null == (t = i.layer) ? void 0 : t.type) && this._isOverridden(r)\n  };\n}\n\nfunction J(e, r, i) {\n  return {\n    ignoreOrigin: !0,\n    enabled: i && i.writeSublayerStructure || !1\n  };\n}\n\nfunction B(e, r, i) {\n  return {\n    ignoreOrigin: !0,\n    enabled: !!i && (i.writeSublayerStructure || this.originIdOf(r) >= F(i.origin))\n  };\n}\n\nconst Q = u.getLogger(\"esri.layers.support.Sublayer\");\nlet G = 0;\nconst H = new Set();\nH.add(\"layer\"), H.add(\"parent\"), H.add(\"loaded\"), H.add(\"loadStatus\"), H.add(\"loadError\"), H.add(\"loadWarnings\");\nlet K = R = class extends n(f(p(d))) {\n  constructor(e) {\n    super(e), this.capabilities = void 0, this.fields = null, this.fullExtent = null, this.globalIdField = null, this.legendEnabled = !0, this.objectIdField = null, this.popupEnabled = !0, this.popupTemplate = null, this.sourceJSON = null, this.title = null, this.typeIdField = null, this.types = null;\n  }\n\n  async load(e) {\n    return this.addResolvingPromise((async () => {\n      var r;\n      if (!this.layer && !this.url) throw new a(\"sublayer:missing-layer\", \"Sublayer can't be loaded without being part of a layer\", {\n        sublayer: this\n      });\n      let i = null;\n\n      if (!this.layer || this.originIdOf(\"url\") > E.SERVICE || \"data-layer\" === (null == (r = this.source) ? void 0 : r.type)) {\n        i = (await o(this.url, {\n          responseType: \"json\",\n          query: {\n            f: \"json\"\n          },\n          ...e\n        })).data;\n      } else {\n        var t;\n        let r = this.id;\n        \"map-layer\" === (null == (t = this.source) ? void 0 : t.type) && (r = this.source.mapLayerId), i = await this.layer.fetchSublayerInfo(r, e);\n      }\n\n      i && (this.sourceJSON = i, this.read({\n        layerDefinition: i\n      }, {\n        origin: \"service\"\n      }));\n    })()), this;\n  }\n\n  readCapabilities(e, r) {\n    const i = (e = (r = r.layerDefinition || r).capabilities || e) ? e.toLowerCase().split(\",\").map(e => e.trim()) : [];\n    return {\n      exportMap: {\n        supportsModification: !!r.canModifyLayer\n      },\n      operations: {\n        supportsQuery: -1 !== i.indexOf(\"query\")\n      }\n    };\n  }\n\n  set definitionExpression(e) {\n    this._setAndNotifyLayer(\"definitionExpression\", e);\n  }\n\n  get fieldsIndex() {\n    return new P(this.fields || []);\n  }\n\n  set floorInfo(e) {\n    this._setAndNotifyLayer(\"floorInfo\", e);\n  }\n\n  readGlobalIdFieldFromService(e, r) {\n    if ((r = r.layerDefinition || r).globalIdField) return r.globalIdField;\n    if (r.fields) for (const i of r.fields) if (\"esriFieldTypeGlobalID\" === i.type) return i.name;\n  }\n\n  get id() {\n    const e = this._get(\"id\");\n\n    return null == e ? G++ : e;\n  }\n\n  set id(e) {\n    this._get(\"id\") !== e && (!1 !== this.get(\"layer.capabilities.exportMap.supportsDynamicLayers\") ? this._set(\"id\", e) : this._logLockedError(\"id\", \"capability not available 'layer.capabilities.exportMap.supportsDynamicLayers'\"));\n  }\n\n  set labelingInfo(e) {\n    this._setAndNotifyLayer(\"labelingInfo\", e);\n  }\n\n  writeLabelingInfo(e, r, i, t) {\n    e && e.length && (r.layerDefinition = {\n      drawingInfo: {\n        labelingInfo: e.map(e => e.write({}, t))\n      }\n    });\n  }\n\n  set labelsVisible(e) {\n    this._setAndNotifyLayer(\"labelsVisible\", e);\n  }\n\n  set layer(e) {\n    this._set(\"layer\", e), this.sublayers && this.sublayers.forEach(r => r.layer = e);\n  }\n\n  set listMode(e) {\n    this._set(\"listMode\", e);\n  }\n\n  set minScale(e) {\n    this._setAndNotifyLayer(\"minScale\", e);\n  }\n\n  readMinScale(e, r) {\n    return r.minScale || r.layerDefinition && r.layerDefinition.minScale || 0;\n  }\n\n  set maxScale(e) {\n    this._setAndNotifyLayer(\"maxScale\", e);\n  }\n\n  readMaxScale(e, r) {\n    return r.maxScale || r.layerDefinition && r.layerDefinition.maxScale || 0;\n  }\n\n  get effectiveScaleRange() {\n    const {\n      minScale: e,\n      maxScale: r\n    } = this;\n    return {\n      minScale: e,\n      maxScale: r\n    };\n  }\n\n  readObjectIdFieldFromService(e, r) {\n    if ((r = r.layerDefinition || r).objectIdField) return r.objectIdField;\n    if (r.fields) for (const i of r.fields) if (\"esriFieldTypeOID\" === i.type) return i.name;\n  }\n\n  set opacity(e) {\n    this._setAndNotifyLayer(\"opacity\", e);\n  }\n\n  readOpacity(e, r) {\n    const i = r.layerDefinition;\n    return 1 - .01 * (null != i.transparency ? i.transparency : i.drawingInfo.transparency);\n  }\n\n  writeOpacity(e, r, i, t) {\n    r.layerDefinition = {\n      drawingInfo: {\n        transparency: 100 - 100 * e\n      }\n    };\n  }\n\n  writeParent(e, r) {\n    this.parent && this.parent !== this.layer ? r.parentLayerId = w(this.parent.id) : r.parentLayerId = -1;\n  }\n\n  get defaultPopupTemplate() {\n    return this.createPopupTemplate();\n  }\n\n  set renderer(e) {\n    if (e) for (const r of e.getSymbols()) if (l(r)) {\n      Q.warn(\"Sublayer renderer should use 2D symbols\");\n      break;\n    }\n\n    this._setAndNotifyLayer(\"renderer\", e);\n  }\n\n  get source() {\n    return this._get(\"source\") || new M({\n      mapLayerId: this.id\n    });\n  }\n\n  set source(e) {\n    this._setAndNotifyLayer(\"source\", e);\n  }\n\n  set sublayers(e) {\n    this._handleSublayersChange(e, this._get(\"sublayers\")), this._set(\"sublayers\", e);\n  }\n\n  castSublayers(e) {\n    return j(s.ofType(R), e);\n  }\n\n  writeSublayers(e, r, i) {\n    this.get(\"sublayers.length\") && (r[i] = this.sublayers.map(e => e.id).toArray().reverse());\n  }\n\n  readTypeIdField(e, r) {\n    let i = (r = r.layerDefinition || r).typeIdField;\n\n    if (i && r.fields) {\n      i = i.toLowerCase();\n      const e = r.fields.find(e => e.name.toLowerCase() === i);\n      e && (i = e.name);\n    }\n\n    return null;\n  }\n\n  get url() {\n    var e, r;\n    const i = null != (e = null == (r = this.layer) ? void 0 : r.parsedUrl) ? e : this._lastParsedUrl,\n          t = this.source;\n    if (!i) return null;\n    if (this._lastParsedUrl = i, \"map-layer\" === (null == t ? void 0 : t.type)) return `${i.path}/${t.mapLayerId}`;\n    const o = {\n      layer: JSON.stringify({\n        source: this.source\n      })\n    };\n    return `${i.path}/dynamicLayer?${m(o)}`;\n  }\n\n  set url(e) {\n    e ? this._override(\"url\", e) : this._clearOverride(\"url\");\n  }\n\n  set visible(e) {\n    this._setAndNotifyLayer(\"visible\", e);\n  }\n\n  writeVisible(e, r, i, t) {\n    r[i] = this.getAtOrigin(\"defaultVisibility\", \"service\") || e;\n  }\n\n  clone() {\n    const {\n      store: e\n    } = b(this),\n          r = new R();\n    return b(r).store = e.clone(H), this.commitProperty(\"url\"), r._lastParsedUrl = this._lastParsedUrl, r;\n  }\n\n  createPopupTemplate(e) {\n    return A(this, e);\n  }\n\n  createQuery() {\n    return new V({\n      returnGeometry: !0,\n      where: this.definitionExpression || \"1=1\"\n    });\n  }\n\n  async createFeatureLayer() {\n    var e, r;\n    if (this.hasOwnProperty(\"sublayers\")) return null;\n    const i = null == (e = this.layer) ? void 0 : e.parsedUrl,\n          t = new (0, (await import(\"../FeatureLayer.js\")).default)({\n      url: i.path\n    });\n    return i && this.source && (\"map-layer\" === this.source.type ? t.layerId = this.source.mapLayerId : t.dynamicDataSource = this.source), null != this.layer.refreshInterval && (t.refreshInterval = this.layer.refreshInterval), this.definitionExpression && (t.definitionExpression = this.definitionExpression), this.floorInfo && (t.floorInfo = y(this.floorInfo)), this.originIdOf(\"labelingInfo\") > E.SERVICE && (t.labelingInfo = y(this.labelingInfo)), this.originIdOf(\"labelsVisible\") > E.DEFAULTS && (t.labelsVisible = this.labelsVisible), this.originIdOf(\"legendEnabled\") > E.DEFAULTS && (t.legendEnabled = this.legendEnabled), this.originIdOf(\"visible\") > E.DEFAULTS && (t.visible = this.visible), this.originIdOf(\"minScale\") > E.DEFAULTS && (t.minScale = this.minScale), this.originIdOf(\"maxScale\") > E.DEFAULTS && (t.maxScale = this.maxScale), this.originIdOf(\"opacity\") > E.DEFAULTS && (t.opacity = this.opacity), this.originIdOf(\"popupTemplate\") > E.DEFAULTS && (t.popupTemplate = y(this.popupTemplate)), this.originIdOf(\"renderer\") > E.SERVICE && (t.renderer = y(this.renderer)), \"data-layer\" === (null == (r = this.source) ? void 0 : r.type) && (t.dynamicDataSource = this.source.clone()), this.originIdOf(\"title\") > E.DEFAULTS && (t.title = this.title), \"map-image\" === this.layer.type && this.layer.originIdOf(\"customParameters\") > E.DEFAULTS && (t.customParameters = this.layer.customParameters), \"tile\" === this.layer.type && this.layer.originIdOf(\"customParameters\") > E.DEFAULTS && (t.customParameters = this.layer.customParameters), t;\n  }\n\n  getField(e) {\n    return this.fieldsIndex.get(e);\n  }\n\n  getFeatureType(e) {\n    const {\n      typeIdField: r,\n      types: i\n    } = this;\n    if (!r || !e) return null;\n    const t = e.attributes ? e.attributes[r] : void 0;\n    if (null == t) return null;\n    let o = null;\n    return i.some(e => {\n      const {\n        id: r\n      } = e;\n      return null != r && (r.toString() === t.toString() && (o = e), !!o);\n    }), o;\n  }\n\n  getFieldDomain(e, r) {\n    const i = r && r.feature,\n          t = this.getFeatureType(i);\n\n    if (t) {\n      const r = t.domains && t.domains[e];\n      if (r && \"inherited\" !== r.type) return r;\n    }\n\n    return this._getLayerDomain(e);\n  }\n\n  async queryFeatures() {\n    let e = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.createQuery();\n    let r = arguments.length > 1 ? arguments[1] : undefined;\n    var i, t, o, l;\n    if (await this.load(), !this.get(\"capabilities.operations.supportsQuery\")) throw new a(\"Sublayer.queryFeatures\", \"this layer doesn't support queries.\");\n    const [{\n      executeQuery: s\n    }, {\n      default: n\n    }] = await Promise.all([import(\"../../rest/query/operations/query.js\"), import(\"../../rest/support/FeatureSet.js\")]),\n          p = await s(this.url, V.from(e), null != (i = null == (t = this.layer) ? void 0 : t.spatialReference) ? i : null, { ...r,\n      query: { ...(null == (o = this.layer) ? void 0 : o.customParameters),\n        token: null == (l = this.layer) ? void 0 : l.apiKey\n      }\n    }),\n          y = n.fromJSON(p.data);\n    if (null != y && y.features) for (const a of y.features) a.sourceLayer = this;\n    return y;\n  }\n\n  toExportImageJSON(e) {\n    var r;\n    const i = {\n      id: this.id,\n      source: (null == (r = this.source) ? void 0 : r.toJSON()) || {\n        mapLayerId: this.id,\n        type: \"mapLayer\"\n      }\n    };\n\n    if (this.definitionExpression) {\n      const r = c(e) ? U(e, this) : this.definitionExpression;\n      i.definitionExpression = r;\n    } else c(e) && (i.definitionExpression = e);\n\n    const t = [\"renderer\", \"labelingInfo\", \"opacity\", \"labelsVisible\"].reduce((e, r) => (e[r] = this.originIdOf(r), e), {}),\n          o = Object.keys(t).some(e => t[e] > E.SERVICE);\n\n    if (o) {\n      const e = i.drawingInfo = {};\n      t.renderer > E.SERVICE && (e.renderer = this.renderer ? this.renderer.toJSON() : null), t.labelsVisible > E.SERVICE && (e.showLabels = this.labelsVisible), this.labelsVisible && t.labelingInfo > E.SERVICE && (e.labelingInfo = this.labelingInfo ? this.labelingInfo.map(e => e.write({}, {\n        origin: \"service\",\n        layer: this.layer\n      })) : null, e.showLabels = !0), t.opacity > E.SERVICE && (e.transparency = 100 - 100 * this.opacity), this._assignDefaultSymbolColors(e.renderer);\n    }\n\n    return i;\n  }\n\n  _assignDefaultSymbolColors(e) {\n    this._forEachSimpleMarkerSymbols(e, e => {\n      e.color || \"esriSMSX\" !== e.style && \"esriSMSCross\" !== e.style || (e.outline && e.outline.color ? e.color = e.outline.color : e.color = [0, 0, 0, 0]);\n    });\n  }\n\n  _forEachSimpleMarkerSymbols(e, r) {\n    if (e) {\n      const i = \"uniqueValueInfos\" in e ? e.uniqueValueInfos : \"classBreakInfos\" in e ? e.classBreakInfos : [];\n\n      for (const e of i) k(e.symbol) && r(e.symbol);\n\n      \"symbol\" in e && k(e.symbol) && r(e.symbol), \"defaultSymbol\" in e && k(e.defaultSymbol) && r(e.defaultSymbol);\n    }\n  }\n\n  _setAndNotifyLayer(e, r) {\n    const i = this.layer,\n          t = this._get(e);\n\n    let o, l;\n\n    switch (e) {\n      case \"definitionExpression\":\n      case \"floorInfo\":\n        o = \"supportsSublayerDefinitionExpression\";\n\n      case \"minScale\":\n      case \"maxScale\":\n      case \"visible\":\n        o = \"supportsSublayerVisibility\";\n        break;\n\n      case \"labelingInfo\":\n      case \"labelsVisible\":\n      case \"opacity\":\n      case \"renderer\":\n      case \"source\":\n        o = \"supportsDynamicLayers\", l = \"supportsModification\";\n    }\n\n    const s = b(this).getDefaultOrigin();\n\n    if (\"service\" !== s) {\n      if (o && !1 === this.get(`layer.capabilities.exportMap.${o}`)) return void this._logLockedError(e, `capability not available 'layer.capabilities.exportMap.${o}'`);\n      if (l && !1 === this.get(`capabilities.exportMap.${l}`)) return void this._logLockedError(e, `capability not available 'capabilities.exportMap.${l}'`);\n    }\n\n    \"source\" !== e || \"not-loaded\" === this.loadStatus ? (this._set(e, r), \"service\" !== s && t !== r && i && i.emit && i.emit(\"sublayer-update\", {\n      propertyName: e,\n      target: this\n    })) : this._logLockedError(e, \"'source' can't be changed after calling sublayer.load()\");\n  }\n\n  _handleSublayersChange(e, r) {\n    r && (r.forEach(e => {\n      e.parent = null, e.layer = null;\n    }), this.handles.removeAll()), e && (e.forEach(e => {\n      e.parent = this, e.layer = this.layer;\n    }), this.handles.add([e.on(\"after-add\", _ref => {\n      let {\n        item: e\n      } = _ref;\n      e.parent = this, e.layer = this.layer;\n    }), e.on(\"after-remove\", _ref2 => {\n      let {\n        item: e\n      } = _ref2;\n      e.parent = null, e.layer = null;\n    }), e.on(\"before-changes\", e => {\n      const r = this.get(\"layer.capabilities.exportMap.supportsSublayersChanges\");\n      null == r || r || (Q.error(new a(\"sublayer:sublayers-non-modifiable\", \"Sublayer can't be added, moved, or removed from the layer's sublayers\", {\n        sublayer: this,\n        layer: this.layer\n      })), e.preventDefault());\n    })]));\n  }\n\n  _logLockedError(e, r) {\n    Q.error(new a(\"sublayer:locked\", `Property '${e}' can't be changed on Sublayer from the layer '${this.layer.id}'`, {\n      reason: r,\n      sublayer: this,\n      layer: this.layer\n    }));\n  }\n\n  _getLayerDomain(e) {\n    const r = this.fieldsIndex.get(e);\n    return r ? r.domain : null;\n  }\n\n};\nK.test = {\n  isMapImageLayerOverridePolicy: e => e === J || e === q,\n  isTileImageLayerOverridePolicy: e => e === $\n}, e([h({\n  readOnly: !0\n})], K.prototype, \"capabilities\", void 0), e([S(\"service\", \"capabilities\", [\"layerDefinition.canModifyLayer\", \"layerDefinition.capabilities\"])], K.prototype, \"readCapabilities\", null), e([h({\n  type: String,\n  value: null,\n  json: {\n    name: \"layerDefinition.definitionExpression\",\n    write: {\n      allowNull: !0,\n      overridePolicy: q\n    }\n  }\n})], K.prototype, \"definitionExpression\", null), e([h({\n  type: [O],\n  json: {\n    origins: {\n      service: {\n        read: {\n          source: \"layerDefinition.fields\"\n        }\n      }\n    }\n  }\n})], K.prototype, \"fields\", void 0), e([h({\n  readOnly: !0\n})], K.prototype, \"fieldsIndex\", null), e([h({\n  type: T,\n  value: null,\n  json: {\n    name: \"layerDefinition.floorInfo\",\n    read: {\n      source: \"layerDefinition.floorInfo\"\n    },\n    write: {\n      target: \"layerDefinition.floorInfo\",\n      overridePolicy: q\n    },\n    origins: {\n      \"web-scene\": {\n        read: !1,\n        write: !1\n      }\n    }\n  }\n})], K.prototype, \"floorInfo\", null), e([h({\n  type: C,\n  json: {\n    read: {\n      source: \"layerDefinition.extent\"\n    }\n  }\n})], K.prototype, \"fullExtent\", void 0), e([h({\n  type: String\n})], K.prototype, \"globalIdField\", void 0), e([S(\"service\", \"globalIdField\", [\"layerDefinition.globalIdField\", \"layerDefinition.fields\"])], K.prototype, \"readGlobalIdFieldFromService\", null), e([h({\n  type: D,\n  json: {\n    write: {\n      ignoreOrigin: !0\n    }\n  }\n})], K.prototype, \"id\", null), e([h({\n  value: null,\n  type: [_],\n  json: {\n    read: {\n      source: \"layerDefinition.drawingInfo.labelingInfo\"\n    },\n    write: {\n      target: \"layerDefinition.drawingInfo.labelingInfo\",\n      overridePolicy: J\n    }\n  }\n})], K.prototype, \"labelingInfo\", null), e([v(\"labelingInfo\")], K.prototype, \"writeLabelingInfo\", null), e([h({\n  type: Boolean,\n  value: !0,\n  json: {\n    read: {\n      source: \"layerDefinition.drawingInfo.showLabels\"\n    },\n    write: {\n      target: \"layerDefinition.drawingInfo.showLabels\",\n      overridePolicy: J\n    }\n  }\n})], K.prototype, \"labelsVisible\", null), e([h({\n  value: null\n})], K.prototype, \"layer\", null), e([h({\n  type: Boolean,\n  value: !0,\n  json: {\n    origins: {\n      service: {\n        read: {\n          enabled: !1\n        }\n      }\n    },\n    read: {\n      source: \"showLegend\"\n    },\n    write: {\n      target: \"showLegend\",\n      overridePolicy: B\n    }\n  }\n})], K.prototype, \"legendEnabled\", void 0), e([h({\n  type: [\"show\", \"hide\", \"hide-children\"],\n  value: \"show\",\n  json: {\n    read: !1,\n    write: !1,\n    origins: {\n      \"web-scene\": {\n        read: !0,\n        write: !0\n      }\n    }\n  }\n})], K.prototype, \"listMode\", null), e([h({\n  type: Number,\n  value: 0,\n  json: {\n    write: {\n      overridePolicy: J\n    }\n  }\n})], K.prototype, \"minScale\", null), e([S(\"minScale\", [\"minScale\", \"layerDefinition.minScale\"])], K.prototype, \"readMinScale\", null), e([h({\n  type: Number,\n  value: 0,\n  json: {\n    write: {\n      overridePolicy: J\n    }\n  }\n})], K.prototype, \"maxScale\", null), e([S(\"maxScale\", [\"maxScale\", \"layerDefinition.maxScale\"])], K.prototype, \"readMaxScale\", null), e([h({\n  readOnly: !0\n})], K.prototype, \"effectiveScaleRange\", null), e([h({\n  type: String\n})], K.prototype, \"objectIdField\", void 0), e([S(\"service\", \"objectIdField\", [\"layerDefinition.objectIdField\", \"layerDefinition.fields\"])], K.prototype, \"readObjectIdFieldFromService\", null), e([h({\n  type: Number,\n  value: 1,\n  json: {\n    write: {\n      target: \"layerDefinition.drawingInfo.transparency\",\n      overridePolicy: J\n    }\n  }\n})], K.prototype, \"opacity\", null), e([S(\"opacity\", [\"layerDefinition.drawingInfo.transparency\", \"layerDefinition.transparency\"])], K.prototype, \"readOpacity\", null), e([v(\"opacity\")], K.prototype, \"writeOpacity\", null), e([h({\n  json: {\n    type: D,\n    write: {\n      target: \"parentLayerId\",\n      writerEnsuresNonNull: !0,\n      overridePolicy: J\n    }\n  }\n})], K.prototype, \"parent\", void 0), e([v(\"parent\")], K.prototype, \"writeParent\", null), e([h({\n  type: Boolean,\n  value: !0,\n  json: {\n    read: {\n      source: \"disablePopup\",\n      reader: (e, r) => !r.disablePopup\n    },\n    write: {\n      target: \"disablePopup\",\n      overridePolicy: B,\n\n      writer(e, r, i) {\n        r[i] = !e;\n      }\n\n    }\n  }\n})], K.prototype, \"popupEnabled\", void 0), e([h({\n  type: r,\n  json: {\n    read: {\n      source: \"popupInfo\"\n    },\n    write: {\n      target: \"popupInfo\",\n      overridePolicy: B\n    }\n  }\n})], K.prototype, \"popupTemplate\", void 0), e([h({\n  readOnly: !0\n})], K.prototype, \"defaultPopupTemplate\", null), e([h({\n  types: i,\n  value: null,\n  json: {\n    name: \"layerDefinition.drawingInfo.renderer\",\n    write: {\n      overridePolicy: J\n    },\n    origins: {\n      \"web-scene\": {\n        types: t,\n        name: \"layerDefinition.drawingInfo.renderer\",\n        write: {\n          overridePolicy: J\n        }\n      }\n    }\n  }\n})], K.prototype, \"renderer\", null), e([h({\n  types: {\n    key: \"type\",\n    base: null,\n    typeMap: {\n      \"data-layer\": N,\n      \"map-layer\": M\n    }\n  },\n\n  cast(e) {\n    if (e) {\n      if (\"mapLayerId\" in e) return L(M, e);\n      if (\"dataSource\" in e) return L(N, e);\n    }\n\n    return e;\n  },\n\n  json: {\n    name: \"layerDefinition.source\",\n    write: {\n      overridePolicy: J\n    }\n  }\n})], K.prototype, \"source\", null), e([h()], K.prototype, \"sourceJSON\", void 0), e([h({\n  value: null,\n  json: {\n    type: [D],\n    write: {\n      target: \"subLayerIds\",\n      allowNull: !0,\n      overridePolicy: J\n    }\n  }\n})], K.prototype, \"sublayers\", null), e([g(\"sublayers\")], K.prototype, \"castSublayers\", null), e([v(\"sublayers\")], K.prototype, \"writeSublayers\", null), e([h({\n  type: String,\n  json: {\n    name: \"name\",\n    write: {\n      overridePolicy: B\n    }\n  }\n})], K.prototype, \"title\", void 0), e([h({\n  type: String\n})], K.prototype, \"typeIdField\", void 0), e([S(\"typeIdField\", [\"layerDefinition.typeIdField\"])], K.prototype, \"readTypeIdField\", null), e([h({\n  type: [x],\n  json: {\n    origins: {\n      service: {\n        read: {\n          source: \"layerDefinition.types\"\n        }\n      }\n    }\n  }\n})], K.prototype, \"types\", void 0), e([h({\n  type: String,\n  json: {\n    read: {\n      source: \"layerUrl\"\n    },\n    write: {\n      target: \"layerUrl\",\n      overridePolicy: $\n    }\n  }\n})], K.prototype, \"url\", null), e([h({\n  type: Boolean,\n  value: !0,\n  json: {\n    read: {\n      source: \"defaultVisibility\"\n    },\n    write: {\n      target: \"defaultVisibility\",\n      overridePolicy: J\n    }\n  }\n})], K.prototype, \"visible\", null), e([v(\"visible\")], K.prototype, \"writeVisible\", null), K = R = e([I(\"esri.layers.support.Sublayer\")], K);\nconst W = K;\nexport { W as default };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/layers/support/Sublayer.js"],"names":["_","e","r","rendererTypes","i","webSceneRendererTypes","t","o","isSymbol3D","l","s","a","HandleOwnerMixin","n","IdentifiableMixin","p","clone","y","d","u","isSome","c","MultiOriginJSONMixin","f","objectToQuery","m","property","h","getProperties","b","cast","g","reader","S","subclass","I","writer","v","ensureInteger","w","ensureType","j","Integer","D","ensureClass","L","OriginId","E","nameToId","F","x","O","P","T","DataLayerSource","N","MapLayerSource","M","V","createPopupTemplate","A","combineFloorsDefinitionExpression","U","C","R","k","type","q","originIdOf","origin","ignoreOrigin","allowNull","enabled","layer","writeSublayerStructure","$","_isOverridden","J","B","Q","getLogger","G","H","Set","add","K","constructor","capabilities","fields","fullExtent","globalIdField","legendEnabled","objectIdField","popupEnabled","popupTemplate","sourceJSON","title","typeIdField","types","load","addResolvingPromise","url","sublayer","SERVICE","source","responseType","query","data","id","mapLayerId","fetchSublayerInfo","read","layerDefinition","readCapabilities","toLowerCase","split","map","trim","exportMap","supportsModification","canModifyLayer","operations","supportsQuery","indexOf","definitionExpression","_setAndNotifyLayer","fieldsIndex","floorInfo","readGlobalIdFieldFromService","name","_get","get","_set","_logLockedError","labelingInfo","writeLabelingInfo","length","drawingInfo","write","labelsVisible","sublayers","forEach","listMode","minScale","readMinScale","maxScale","readMaxScale","effectiveScaleRange","readObjectIdFieldFromService","opacity","readOpacity","transparency","writeOpacity","writeParent","parent","parentLayerId","defaultPopupTemplate","renderer","getSymbols","warn","_handleSublayersChange","castSublayers","ofType","writeSublayers","toArray","reverse","readTypeIdField","find","parsedUrl","_lastParsedUrl","path","JSON","stringify","_override","_clearOverride","visible","writeVisible","getAtOrigin","store","commitProperty","createQuery","returnGeometry","where","createFeatureLayer","hasOwnProperty","default","layerId","dynamicDataSource","refreshInterval","DEFAULTS","customParameters","getField","getFeatureType","attributes","some","toString","getFieldDomain","feature","domains","_getLayerDomain","queryFeatures","executeQuery","Promise","all","from","spatialReference","token","apiKey","fromJSON","features","sourceLayer","toExportImageJSON","toJSON","reduce","Object","keys","showLabels","_assignDefaultSymbolColors","_forEachSimpleMarkerSymbols","color","style","outline","uniqueValueInfos","classBreakInfos","symbol","defaultSymbol","getDefaultOrigin","loadStatus","emit","propertyName","target","handles","removeAll","on","item","error","preventDefault","reason","domain","test","isMapImageLayerOverridePolicy","isTileImageLayerOverridePolicy","readOnly","prototype","String","value","json","overridePolicy","origins","service","Boolean","Number","writerEnsuresNonNull","disablePopup","key","base","typeMap","W"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import\"../../geometry.js\";import r from\"../../PopupTemplate.js\";import\"../../renderers/ClassBreaksRenderer.js\";import\"../../renderers/DictionaryRenderer.js\";import\"../../renderers/DotDensityRenderer.js\";import\"../../renderers/HeatmapRenderer.js\";import\"../../renderers/Renderer.js\";import\"../../renderers/SimpleRenderer.js\";import\"../../renderers/UniqueValueRenderer.js\";import\"../../renderers/support/jsonUtils.js\";import{rendererTypes as i,webSceneRendererTypes as t}from\"../../renderers/support/types.js\";import o from\"../../request.js\";import{isSymbol3D as l}from\"../../symbols.js\";import s from\"../../core/Collection.js\";import a from\"../../core/Error.js\";import{HandleOwnerMixin as n}from\"../../core/HandleOwner.js\";import{IdentifiableMixin as p}from\"../../core/Identifiable.js\";import{clone as y}from\"../../core/lang.js\";import d from\"../../core/Loadable.js\";import u from\"../../core/Logger.js\";import{isSome as c}from\"../../core/maybe.js\";import{MultiOriginJSONMixin as f}from\"../../core/MultiOriginJSONSupport.js\";import{objectToQuery as m}from\"../../core/urlUtils.js\";import{property as h}from\"../../core/accessorSupport/decorators/property.js\";import{getProperties as b}from\"../../core/accessorSupport/utils.js\";import{cast as g}from\"../../core/accessorSupport/decorators/cast.js\";import{reader as S}from\"../../core/accessorSupport/decorators/reader.js\";import{subclass as I}from\"../../core/accessorSupport/decorators/subclass.js\";import{writer as v}from\"../../core/accessorSupport/decorators/writer.js\";import{ensureInteger as w,ensureType as j,Integer as D,ensureClass as L}from\"../../core/accessorSupport/ensureType.js\";import{OriginId as E,nameToId as F}from\"../../core/accessorSupport/PropertyOrigin.js\";import x from\"./FeatureType.js\";import O from\"./Field.js\";import P from\"./FieldsIndex.js\";import _ from\"./LabelClass.js\";import T from\"./LayerFloorInfo.js\";import{DataLayerSource as N}from\"./source/DataLayerSource.js\";import{MapLayerSource as M}from\"./source/MapLayerSource.js\";import V from\"../../rest/support/Query.js\";import{createPopupTemplate as A}from\"../../support/popupUtils.js\";import{combineFloorsDefinitionExpression as U}from\"../../views/support/floorFilterUtils.js\";import C from\"../../geometry/Extent.js\";var R;function k(e){return e&&\"esriSMS\"===e.type}function q(e,r,i){var t;const o=this.originIdOf(r)>=F(i.origin);return{ignoreOrigin:!0,allowNull:o,enabled:!!i&&(\"map-image\"===(null==(t=i.layer)?void 0:t.type)&&(i.writeSublayerStructure||o))}}function $(e,r,i){var t;return{enabled:!!i&&(\"tile\"===(null==(t=i.layer)?void 0:t.type)&&this._isOverridden(r))}}function J(e,r,i){return{ignoreOrigin:!0,enabled:i&&i.writeSublayerStructure||!1}}function B(e,r,i){return{ignoreOrigin:!0,enabled:!!i&&(i.writeSublayerStructure||this.originIdOf(r)>=F(i.origin))}}const Q=u.getLogger(\"esri.layers.support.Sublayer\");let G=0;const H=new Set;H.add(\"layer\"),H.add(\"parent\"),H.add(\"loaded\"),H.add(\"loadStatus\"),H.add(\"loadError\"),H.add(\"loadWarnings\");let K=R=class extends(n(f(p(d)))){constructor(e){super(e),this.capabilities=void 0,this.fields=null,this.fullExtent=null,this.globalIdField=null,this.legendEnabled=!0,this.objectIdField=null,this.popupEnabled=!0,this.popupTemplate=null,this.sourceJSON=null,this.title=null,this.typeIdField=null,this.types=null}async load(e){return this.addResolvingPromise((async()=>{var r;if(!this.layer&&!this.url)throw new a(\"sublayer:missing-layer\",\"Sublayer can't be loaded without being part of a layer\",{sublayer:this});let i=null;if(!this.layer||this.originIdOf(\"url\")>E.SERVICE||\"data-layer\"===(null==(r=this.source)?void 0:r.type)){i=(await o(this.url,{responseType:\"json\",query:{f:\"json\"},...e})).data}else{var t;let r=this.id;\"map-layer\"===(null==(t=this.source)?void 0:t.type)&&(r=this.source.mapLayerId),i=await this.layer.fetchSublayerInfo(r,e)}i&&(this.sourceJSON=i,this.read({layerDefinition:i},{origin:\"service\"}))})()),this}readCapabilities(e,r){const i=(e=(r=r.layerDefinition||r).capabilities||e)?e.toLowerCase().split(\",\").map((e=>e.trim())):[];return{exportMap:{supportsModification:!!r.canModifyLayer},operations:{supportsQuery:-1!==i.indexOf(\"query\")}}}set definitionExpression(e){this._setAndNotifyLayer(\"definitionExpression\",e)}get fieldsIndex(){return new P(this.fields||[])}set floorInfo(e){this._setAndNotifyLayer(\"floorInfo\",e)}readGlobalIdFieldFromService(e,r){if((r=r.layerDefinition||r).globalIdField)return r.globalIdField;if(r.fields)for(const i of r.fields)if(\"esriFieldTypeGlobalID\"===i.type)return i.name}get id(){const e=this._get(\"id\");return null==e?G++:e}set id(e){this._get(\"id\")!==e&&(!1!==this.get(\"layer.capabilities.exportMap.supportsDynamicLayers\")?this._set(\"id\",e):this._logLockedError(\"id\",\"capability not available 'layer.capabilities.exportMap.supportsDynamicLayers'\"))}set labelingInfo(e){this._setAndNotifyLayer(\"labelingInfo\",e)}writeLabelingInfo(e,r,i,t){e&&e.length&&(r.layerDefinition={drawingInfo:{labelingInfo:e.map((e=>e.write({},t)))}})}set labelsVisible(e){this._setAndNotifyLayer(\"labelsVisible\",e)}set layer(e){this._set(\"layer\",e),this.sublayers&&this.sublayers.forEach((r=>r.layer=e))}set listMode(e){this._set(\"listMode\",e)}set minScale(e){this._setAndNotifyLayer(\"minScale\",e)}readMinScale(e,r){return r.minScale||r.layerDefinition&&r.layerDefinition.minScale||0}set maxScale(e){this._setAndNotifyLayer(\"maxScale\",e)}readMaxScale(e,r){return r.maxScale||r.layerDefinition&&r.layerDefinition.maxScale||0}get effectiveScaleRange(){const{minScale:e,maxScale:r}=this;return{minScale:e,maxScale:r}}readObjectIdFieldFromService(e,r){if((r=r.layerDefinition||r).objectIdField)return r.objectIdField;if(r.fields)for(const i of r.fields)if(\"esriFieldTypeOID\"===i.type)return i.name}set opacity(e){this._setAndNotifyLayer(\"opacity\",e)}readOpacity(e,r){const i=r.layerDefinition;return 1-.01*(null!=i.transparency?i.transparency:i.drawingInfo.transparency)}writeOpacity(e,r,i,t){r.layerDefinition={drawingInfo:{transparency:100-100*e}}}writeParent(e,r){this.parent&&this.parent!==this.layer?r.parentLayerId=w(this.parent.id):r.parentLayerId=-1}get defaultPopupTemplate(){return this.createPopupTemplate()}set renderer(e){if(e)for(const r of e.getSymbols())if(l(r)){Q.warn(\"Sublayer renderer should use 2D symbols\");break}this._setAndNotifyLayer(\"renderer\",e)}get source(){return this._get(\"source\")||new M({mapLayerId:this.id})}set source(e){this._setAndNotifyLayer(\"source\",e)}set sublayers(e){this._handleSublayersChange(e,this._get(\"sublayers\")),this._set(\"sublayers\",e)}castSublayers(e){return j(s.ofType(R),e)}writeSublayers(e,r,i){this.get(\"sublayers.length\")&&(r[i]=this.sublayers.map((e=>e.id)).toArray().reverse())}readTypeIdField(e,r){let i=(r=r.layerDefinition||r).typeIdField;if(i&&r.fields){i=i.toLowerCase();const e=r.fields.find((e=>e.name.toLowerCase()===i));e&&(i=e.name)}return null}get url(){var e,r;const i=null!=(e=null==(r=this.layer)?void 0:r.parsedUrl)?e:this._lastParsedUrl,t=this.source;if(!i)return null;if(this._lastParsedUrl=i,\"map-layer\"===(null==t?void 0:t.type))return`${i.path}/${t.mapLayerId}`;const o={layer:JSON.stringify({source:this.source})};return`${i.path}/dynamicLayer?${m(o)}`}set url(e){e?this._override(\"url\",e):this._clearOverride(\"url\")}set visible(e){this._setAndNotifyLayer(\"visible\",e)}writeVisible(e,r,i,t){r[i]=this.getAtOrigin(\"defaultVisibility\",\"service\")||e}clone(){const{store:e}=b(this),r=new R;return b(r).store=e.clone(H),this.commitProperty(\"url\"),r._lastParsedUrl=this._lastParsedUrl,r}createPopupTemplate(e){return A(this,e)}createQuery(){return new V({returnGeometry:!0,where:this.definitionExpression||\"1=1\"})}async createFeatureLayer(){var e,r;if(this.hasOwnProperty(\"sublayers\"))return null;const i=null==(e=this.layer)?void 0:e.parsedUrl,t=new(0,(await import(\"../FeatureLayer.js\")).default)({url:i.path});return i&&this.source&&(\"map-layer\"===this.source.type?t.layerId=this.source.mapLayerId:t.dynamicDataSource=this.source),null!=this.layer.refreshInterval&&(t.refreshInterval=this.layer.refreshInterval),this.definitionExpression&&(t.definitionExpression=this.definitionExpression),this.floorInfo&&(t.floorInfo=y(this.floorInfo)),this.originIdOf(\"labelingInfo\")>E.SERVICE&&(t.labelingInfo=y(this.labelingInfo)),this.originIdOf(\"labelsVisible\")>E.DEFAULTS&&(t.labelsVisible=this.labelsVisible),this.originIdOf(\"legendEnabled\")>E.DEFAULTS&&(t.legendEnabled=this.legendEnabled),this.originIdOf(\"visible\")>E.DEFAULTS&&(t.visible=this.visible),this.originIdOf(\"minScale\")>E.DEFAULTS&&(t.minScale=this.minScale),this.originIdOf(\"maxScale\")>E.DEFAULTS&&(t.maxScale=this.maxScale),this.originIdOf(\"opacity\")>E.DEFAULTS&&(t.opacity=this.opacity),this.originIdOf(\"popupTemplate\")>E.DEFAULTS&&(t.popupTemplate=y(this.popupTemplate)),this.originIdOf(\"renderer\")>E.SERVICE&&(t.renderer=y(this.renderer)),\"data-layer\"===(null==(r=this.source)?void 0:r.type)&&(t.dynamicDataSource=this.source.clone()),this.originIdOf(\"title\")>E.DEFAULTS&&(t.title=this.title),\"map-image\"===this.layer.type&&this.layer.originIdOf(\"customParameters\")>E.DEFAULTS&&(t.customParameters=this.layer.customParameters),\"tile\"===this.layer.type&&this.layer.originIdOf(\"customParameters\")>E.DEFAULTS&&(t.customParameters=this.layer.customParameters),t}getField(e){return this.fieldsIndex.get(e)}getFeatureType(e){const{typeIdField:r,types:i}=this;if(!r||!e)return null;const t=e.attributes?e.attributes[r]:void 0;if(null==t)return null;let o=null;return i.some((e=>{const{id:r}=e;return null!=r&&(r.toString()===t.toString()&&(o=e),!!o)})),o}getFieldDomain(e,r){const i=r&&r.feature,t=this.getFeatureType(i);if(t){const r=t.domains&&t.domains[e];if(r&&\"inherited\"!==r.type)return r}return this._getLayerDomain(e)}async queryFeatures(e=this.createQuery(),r){var i,t,o,l;if(await this.load(),!this.get(\"capabilities.operations.supportsQuery\"))throw new a(\"Sublayer.queryFeatures\",\"this layer doesn't support queries.\");const[{executeQuery:s},{default:n}]=await Promise.all([import(\"../../rest/query/operations/query.js\"),import(\"../../rest/support/FeatureSet.js\")]),p=await s(this.url,V.from(e),null!=(i=null==(t=this.layer)?void 0:t.spatialReference)?i:null,{...r,query:{...null==(o=this.layer)?void 0:o.customParameters,token:null==(l=this.layer)?void 0:l.apiKey}}),y=n.fromJSON(p.data);if(null!=y&&y.features)for(const a of y.features)a.sourceLayer=this;return y}toExportImageJSON(e){var r;const i={id:this.id,source:(null==(r=this.source)?void 0:r.toJSON())||{mapLayerId:this.id,type:\"mapLayer\"}};if(this.definitionExpression){const r=c(e)?U(e,this):this.definitionExpression;i.definitionExpression=r}else c(e)&&(i.definitionExpression=e);const t=[\"renderer\",\"labelingInfo\",\"opacity\",\"labelsVisible\"].reduce(((e,r)=>(e[r]=this.originIdOf(r),e)),{}),o=Object.keys(t).some((e=>t[e]>E.SERVICE));if(o){const e=i.drawingInfo={};t.renderer>E.SERVICE&&(e.renderer=this.renderer?this.renderer.toJSON():null),t.labelsVisible>E.SERVICE&&(e.showLabels=this.labelsVisible),this.labelsVisible&&t.labelingInfo>E.SERVICE&&(e.labelingInfo=this.labelingInfo?this.labelingInfo.map((e=>e.write({},{origin:\"service\",layer:this.layer}))):null,e.showLabels=!0),t.opacity>E.SERVICE&&(e.transparency=100-100*this.opacity),this._assignDefaultSymbolColors(e.renderer)}return i}_assignDefaultSymbolColors(e){this._forEachSimpleMarkerSymbols(e,(e=>{e.color||\"esriSMSX\"!==e.style&&\"esriSMSCross\"!==e.style||(e.outline&&e.outline.color?e.color=e.outline.color:e.color=[0,0,0,0])}))}_forEachSimpleMarkerSymbols(e,r){if(e){const i=\"uniqueValueInfos\"in e?e.uniqueValueInfos:\"classBreakInfos\"in e?e.classBreakInfos:[];for(const e of i)k(e.symbol)&&r(e.symbol);\"symbol\"in e&&k(e.symbol)&&r(e.symbol),\"defaultSymbol\"in e&&k(e.defaultSymbol)&&r(e.defaultSymbol)}}_setAndNotifyLayer(e,r){const i=this.layer,t=this._get(e);let o,l;switch(e){case\"definitionExpression\":case\"floorInfo\":o=\"supportsSublayerDefinitionExpression\";case\"minScale\":case\"maxScale\":case\"visible\":o=\"supportsSublayerVisibility\";break;case\"labelingInfo\":case\"labelsVisible\":case\"opacity\":case\"renderer\":case\"source\":o=\"supportsDynamicLayers\",l=\"supportsModification\"}const s=b(this).getDefaultOrigin();if(\"service\"!==s){if(o&&!1===this.get(`layer.capabilities.exportMap.${o}`))return void this._logLockedError(e,`capability not available 'layer.capabilities.exportMap.${o}'`);if(l&&!1===this.get(`capabilities.exportMap.${l}`))return void this._logLockedError(e,`capability not available 'capabilities.exportMap.${l}'`)}\"source\"!==e||\"not-loaded\"===this.loadStatus?(this._set(e,r),\"service\"!==s&&t!==r&&i&&i.emit&&i.emit(\"sublayer-update\",{propertyName:e,target:this})):this._logLockedError(e,\"'source' can't be changed after calling sublayer.load()\")}_handleSublayersChange(e,r){r&&(r.forEach((e=>{e.parent=null,e.layer=null})),this.handles.removeAll()),e&&(e.forEach((e=>{e.parent=this,e.layer=this.layer})),this.handles.add([e.on(\"after-add\",(({item:e})=>{e.parent=this,e.layer=this.layer})),e.on(\"after-remove\",(({item:e})=>{e.parent=null,e.layer=null})),e.on(\"before-changes\",(e=>{const r=this.get(\"layer.capabilities.exportMap.supportsSublayersChanges\");null==r||r||(Q.error(new a(\"sublayer:sublayers-non-modifiable\",\"Sublayer can't be added, moved, or removed from the layer's sublayers\",{sublayer:this,layer:this.layer})),e.preventDefault())}))]))}_logLockedError(e,r){Q.error(new a(\"sublayer:locked\",`Property '${e}' can't be changed on Sublayer from the layer '${this.layer.id}'`,{reason:r,sublayer:this,layer:this.layer}))}_getLayerDomain(e){const r=this.fieldsIndex.get(e);return r?r.domain:null}};K.test={isMapImageLayerOverridePolicy:e=>e===J||e===q,isTileImageLayerOverridePolicy:e=>e===$},e([h({readOnly:!0})],K.prototype,\"capabilities\",void 0),e([S(\"service\",\"capabilities\",[\"layerDefinition.canModifyLayer\",\"layerDefinition.capabilities\"])],K.prototype,\"readCapabilities\",null),e([h({type:String,value:null,json:{name:\"layerDefinition.definitionExpression\",write:{allowNull:!0,overridePolicy:q}}})],K.prototype,\"definitionExpression\",null),e([h({type:[O],json:{origins:{service:{read:{source:\"layerDefinition.fields\"}}}}})],K.prototype,\"fields\",void 0),e([h({readOnly:!0})],K.prototype,\"fieldsIndex\",null),e([h({type:T,value:null,json:{name:\"layerDefinition.floorInfo\",read:{source:\"layerDefinition.floorInfo\"},write:{target:\"layerDefinition.floorInfo\",overridePolicy:q},origins:{\"web-scene\":{read:!1,write:!1}}}})],K.prototype,\"floorInfo\",null),e([h({type:C,json:{read:{source:\"layerDefinition.extent\"}}})],K.prototype,\"fullExtent\",void 0),e([h({type:String})],K.prototype,\"globalIdField\",void 0),e([S(\"service\",\"globalIdField\",[\"layerDefinition.globalIdField\",\"layerDefinition.fields\"])],K.prototype,\"readGlobalIdFieldFromService\",null),e([h({type:D,json:{write:{ignoreOrigin:!0}}})],K.prototype,\"id\",null),e([h({value:null,type:[_],json:{read:{source:\"layerDefinition.drawingInfo.labelingInfo\"},write:{target:\"layerDefinition.drawingInfo.labelingInfo\",overridePolicy:J}}})],K.prototype,\"labelingInfo\",null),e([v(\"labelingInfo\")],K.prototype,\"writeLabelingInfo\",null),e([h({type:Boolean,value:!0,json:{read:{source:\"layerDefinition.drawingInfo.showLabels\"},write:{target:\"layerDefinition.drawingInfo.showLabels\",overridePolicy:J}}})],K.prototype,\"labelsVisible\",null),e([h({value:null})],K.prototype,\"layer\",null),e([h({type:Boolean,value:!0,json:{origins:{service:{read:{enabled:!1}}},read:{source:\"showLegend\"},write:{target:\"showLegend\",overridePolicy:B}}})],K.prototype,\"legendEnabled\",void 0),e([h({type:[\"show\",\"hide\",\"hide-children\"],value:\"show\",json:{read:!1,write:!1,origins:{\"web-scene\":{read:!0,write:!0}}}})],K.prototype,\"listMode\",null),e([h({type:Number,value:0,json:{write:{overridePolicy:J}}})],K.prototype,\"minScale\",null),e([S(\"minScale\",[\"minScale\",\"layerDefinition.minScale\"])],K.prototype,\"readMinScale\",null),e([h({type:Number,value:0,json:{write:{overridePolicy:J}}})],K.prototype,\"maxScale\",null),e([S(\"maxScale\",[\"maxScale\",\"layerDefinition.maxScale\"])],K.prototype,\"readMaxScale\",null),e([h({readOnly:!0})],K.prototype,\"effectiveScaleRange\",null),e([h({type:String})],K.prototype,\"objectIdField\",void 0),e([S(\"service\",\"objectIdField\",[\"layerDefinition.objectIdField\",\"layerDefinition.fields\"])],K.prototype,\"readObjectIdFieldFromService\",null),e([h({type:Number,value:1,json:{write:{target:\"layerDefinition.drawingInfo.transparency\",overridePolicy:J}}})],K.prototype,\"opacity\",null),e([S(\"opacity\",[\"layerDefinition.drawingInfo.transparency\",\"layerDefinition.transparency\"])],K.prototype,\"readOpacity\",null),e([v(\"opacity\")],K.prototype,\"writeOpacity\",null),e([h({json:{type:D,write:{target:\"parentLayerId\",writerEnsuresNonNull:!0,overridePolicy:J}}})],K.prototype,\"parent\",void 0),e([v(\"parent\")],K.prototype,\"writeParent\",null),e([h({type:Boolean,value:!0,json:{read:{source:\"disablePopup\",reader:(e,r)=>!r.disablePopup},write:{target:\"disablePopup\",overridePolicy:B,writer(e,r,i){r[i]=!e}}}})],K.prototype,\"popupEnabled\",void 0),e([h({type:r,json:{read:{source:\"popupInfo\"},write:{target:\"popupInfo\",overridePolicy:B}}})],K.prototype,\"popupTemplate\",void 0),e([h({readOnly:!0})],K.prototype,\"defaultPopupTemplate\",null),e([h({types:i,value:null,json:{name:\"layerDefinition.drawingInfo.renderer\",write:{overridePolicy:J},origins:{\"web-scene\":{types:t,name:\"layerDefinition.drawingInfo.renderer\",write:{overridePolicy:J}}}}})],K.prototype,\"renderer\",null),e([h({types:{key:\"type\",base:null,typeMap:{\"data-layer\":N,\"map-layer\":M}},cast(e){if(e){if(\"mapLayerId\"in e)return L(M,e);if(\"dataSource\"in e)return L(N,e)}return e},json:{name:\"layerDefinition.source\",write:{overridePolicy:J}}})],K.prototype,\"source\",null),e([h()],K.prototype,\"sourceJSON\",void 0),e([h({value:null,json:{type:[D],write:{target:\"subLayerIds\",allowNull:!0,overridePolicy:J}}})],K.prototype,\"sublayers\",null),e([g(\"sublayers\")],K.prototype,\"castSublayers\",null),e([v(\"sublayers\")],K.prototype,\"writeSublayers\",null),e([h({type:String,json:{name:\"name\",write:{overridePolicy:B}}})],K.prototype,\"title\",void 0),e([h({type:String})],K.prototype,\"typeIdField\",void 0),e([S(\"typeIdField\",[\"layerDefinition.typeIdField\"])],K.prototype,\"readTypeIdField\",null),e([h({type:[x],json:{origins:{service:{read:{source:\"layerDefinition.types\"}}}}})],K.prototype,\"types\",void 0),e([h({type:String,json:{read:{source:\"layerUrl\"},write:{target:\"layerUrl\",overridePolicy:$}}})],K.prototype,\"url\",null),e([h({type:Boolean,value:!0,json:{read:{source:\"defaultVisibility\"},write:{target:\"defaultVisibility\",overridePolicy:J}}})],K.prototype,\"visible\",null),e([v(\"visible\")],K.prototype,\"writeVisible\",null),K=R=e([I(\"esri.layers.support.Sublayer\")],K);const W=K;export{W as default};\n"]},"metadata":{},"sourceType":"module"}