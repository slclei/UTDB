{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../../chunks/tslib.es6.js\";\nimport { isSome as r } from \"../../../../core/maybe.js\";\nimport { property as t } from \"../../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../../core/arrayUtils.js\";\nimport \"../../../../core/has.js\";\nimport \"../../../../core/accessorSupport/ensureType.js\";\nimport { subclass as s } from \"../../../../core/accessorSupport/decorators/subclass.js\";\nimport { RasterTileContainer as i } from \"../../engine/imagery/RasterTileContainer.js\";\nimport { BaseImageryTileSubView2D as o } from \"./BaseImageryTileSubView2D.js\";\nimport { canUseMajorityInterpolationOnDataSource as a } from \"../support/util.js\";\nlet l = class extends o {\n  constructor() {\n    super(...arguments), this.container = null, this.layer = null, this.type = \"raster\";\n  }\n\n  attach() {\n    super.attach(), this.container = new i(this._tileInfoView), this.container.isCustomTilingScheme = this._isCustomTilingScheme;\n  }\n\n  detach() {\n    super.detach(), this.container.removeAllChildren(), this.container = null;\n  }\n\n  canUseWebGLForProcessing() {\n    return this.useWebGLForProcessing && this.layer.symbolizer.canRenderInWebGL && !(\"majority\" === this.layer.interpolation && a(this.layer));\n  }\n\n  fetchTile(e, r) {\n    return this.layer.fetchTile(e.level, e.row, e.col, r);\n  }\n\n  async updateTileSource(e, t) {\n    const {\n      bandIds: s\n    } = this.layer,\n          i = this._getLayerInterpolation(),\n          o = this.canUseWebGLForProcessing(),\n          {\n      source: a,\n      symbolizerParams: l,\n      globalSymbolizerParams: n,\n      suspended: c,\n      coords: p,\n      resolution: u\n    } = t,\n          {\n      bitmap: d\n    } = e;\n\n    if ([d.x, d.y] = p, d.resolution = u, a && r(a) && r(a.pixelBlock)) {\n      const e = {\n        extent: a.extent,\n        pixelBlock: a.pixelBlock\n      };\n      if (d.rawPixelData = e, o) d.source = a.pixelBlock, d.isRendereredSource = !1;else {\n        const r = await this.layer.applyRenderer(e, \"stretch\" === (null == n ? void 0 : n.type) ? n : null);\n        d.source = r, d.isRendereredSource = !0;\n      }\n      d.symbolizerParameters = o ? l : null, o ? d.transformGrid || (d.transformGrid = a.transformGrid) : d.transformGrid = null;\n    } else {\n      const e = this.createEmptyTilePixelBlock();\n      d.source = e, d.symbolizerParameters = o ? l : null, d.transformGrid = null;\n    }\n\n    d.bandIds = o ? s : null, d.width = this._tileInfoView.tileInfo.size[0], d.height = this._tileInfoView.tileInfo.size[1], d.interpolation = i, d.suspended = c, d.invalidateTexture();\n  }\n\n  async updateTileSymbolizerParameters(e, t) {\n    const {\n      local: s,\n      global: i\n    } = t,\n          {\n      bandIds: o\n    } = this.layer,\n          a = this._getLayerInterpolation(),\n          l = this.canUseWebGLForProcessing(),\n          {\n      bitmap: n\n    } = e,\n          {\n      rawPixelData: c\n    } = n;\n\n    !l && r(c) ? (n.source = await this.layer.applyRenderer(c, \"stretch\" === (null == i ? void 0 : i.type) ? i : null), n.isRendereredSource = !0) : (n.isRendereredSource && r(c) && (n.source = c.pixelBlock), n.isRendereredSource = !1), n.symbolizerParameters = l ? i || s : null, n.bandIds = l ? o : null, n.interpolation = a, n.suspended = !1;\n  }\n\n  _getLayerInterpolation() {\n    const e = this.layer.renderer.type;\n    if (\"raster-colormap\" === e || \"unique-value\" === e || \"class-breaks\" === e) return \"nearest\";\n    const {\n      interpolation: r\n    } = this.layer,\n          {\n      renderer: t\n    } = this.layer;\n    return \"raster-stretch\" === t.type && null != t.colorRamp ? \"bilinear\" === r || \"cubic\" === r ? \"bilinear\" : \"nearest\" : r;\n  }\n\n};\ne([t()], l.prototype, \"container\", void 0), e([t()], l.prototype, \"layer\", void 0), e([t()], l.prototype, \"type\", void 0), l = e([s(\"esri.views.2d.layers.imagery.ImageryTileView2D\")], l);\nconst n = l;\nexport { n as default };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/views/2d/layers/imagery/ImageryTileView2D.js"],"names":["_","e","isSome","r","property","t","subclass","s","RasterTileContainer","i","BaseImageryTileSubView2D","o","canUseMajorityInterpolationOnDataSource","a","l","constructor","arguments","container","layer","type","attach","_tileInfoView","isCustomTilingScheme","_isCustomTilingScheme","detach","removeAllChildren","canUseWebGLForProcessing","useWebGLForProcessing","symbolizer","canRenderInWebGL","interpolation","fetchTile","level","row","col","updateTileSource","bandIds","_getLayerInterpolation","source","symbolizerParams","globalSymbolizerParams","n","suspended","c","coords","p","resolution","u","bitmap","d","x","y","pixelBlock","extent","rawPixelData","isRendereredSource","applyRenderer","symbolizerParameters","transformGrid","createEmptyTilePixelBlock","width","tileInfo","size","height","invalidateTexture","updateTileSymbolizerParameters","local","global","renderer","colorRamp","prototype","default"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import{isSome as r}from\"../../../../core/maybe.js\";import{property as t}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/arrayUtils.js\";import\"../../../../core/has.js\";import\"../../../../core/accessorSupport/ensureType.js\";import{subclass as s}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{RasterTileContainer as i}from\"../../engine/imagery/RasterTileContainer.js\";import{BaseImageryTileSubView2D as o}from\"./BaseImageryTileSubView2D.js\";import{canUseMajorityInterpolationOnDataSource as a}from\"../support/util.js\";let l=class extends o{constructor(){super(...arguments),this.container=null,this.layer=null,this.type=\"raster\"}attach(){super.attach(),this.container=new i(this._tileInfoView),this.container.isCustomTilingScheme=this._isCustomTilingScheme}detach(){super.detach(),this.container.removeAllChildren(),this.container=null}canUseWebGLForProcessing(){return this.useWebGLForProcessing&&this.layer.symbolizer.canRenderInWebGL&&!(\"majority\"===this.layer.interpolation&&a(this.layer))}fetchTile(e,r){return this.layer.fetchTile(e.level,e.row,e.col,r)}async updateTileSource(e,t){const{bandIds:s}=this.layer,i=this._getLayerInterpolation(),o=this.canUseWebGLForProcessing(),{source:a,symbolizerParams:l,globalSymbolizerParams:n,suspended:c,coords:p,resolution:u}=t,{bitmap:d}=e;if([d.x,d.y]=p,d.resolution=u,a&&r(a)&&r(a.pixelBlock)){const e={extent:a.extent,pixelBlock:a.pixelBlock};if(d.rawPixelData=e,o)d.source=a.pixelBlock,d.isRendereredSource=!1;else{const r=await this.layer.applyRenderer(e,\"stretch\"===(null==n?void 0:n.type)?n:null);d.source=r,d.isRendereredSource=!0}d.symbolizerParameters=o?l:null,o?d.transformGrid||(d.transformGrid=a.transformGrid):d.transformGrid=null}else{const e=this.createEmptyTilePixelBlock();d.source=e,d.symbolizerParameters=o?l:null,d.transformGrid=null}d.bandIds=o?s:null,d.width=this._tileInfoView.tileInfo.size[0],d.height=this._tileInfoView.tileInfo.size[1],d.interpolation=i,d.suspended=c,d.invalidateTexture()}async updateTileSymbolizerParameters(e,t){const{local:s,global:i}=t,{bandIds:o}=this.layer,a=this._getLayerInterpolation(),l=this.canUseWebGLForProcessing(),{bitmap:n}=e,{rawPixelData:c}=n;!l&&r(c)?(n.source=await this.layer.applyRenderer(c,\"stretch\"===(null==i?void 0:i.type)?i:null),n.isRendereredSource=!0):(n.isRendereredSource&&r(c)&&(n.source=c.pixelBlock),n.isRendereredSource=!1),n.symbolizerParameters=l?i||s:null,n.bandIds=l?o:null,n.interpolation=a,n.suspended=!1}_getLayerInterpolation(){const e=this.layer.renderer.type;if(\"raster-colormap\"===e||\"unique-value\"===e||\"class-breaks\"===e)return\"nearest\";const{interpolation:r}=this.layer,{renderer:t}=this.layer;return\"raster-stretch\"===t.type&&null!=t.colorRamp?\"bilinear\"===r||\"cubic\"===r?\"bilinear\":\"nearest\":r}};e([t()],l.prototype,\"container\",void 0),e([t()],l.prototype,\"layer\",void 0),e([t()],l.prototype,\"type\",void 0),l=e([s(\"esri.views.2d.layers.imagery.ImageryTileView2D\")],l);const n=l;export{n as default};\n"]},"metadata":{},"sourceType":"module"}