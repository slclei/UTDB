{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport { lerp as e, deg2rad as t, clamp as a } from \"../../../../core/mathUtils.js\";\nimport { ViewingMode as i } from \"../../../ViewingMode.js\";\n\nfunction r(e, t) {\n  return new p(e, h, t);\n}\n\nfunction n(e, t) {\n  const {\n    curvatureDependent: a,\n    scaleStart: i,\n    scaleFallOffRange: r\n  } = h;\n  return new p(e, {\n    curvatureDependent: {\n      min: {\n        curvature: a.min.curvature,\n        tiltAngle: a.min.tiltAngle,\n        scaleFallOffFactor: v.curvatureDependent.min.scaleFallOffFactor\n      },\n      max: {\n        curvature: a.max.curvature,\n        tiltAngle: a.max.tiltAngle,\n        scaleFallOffFactor: v.curvatureDependent.max.scaleFallOffFactor\n      }\n    },\n    scaleStart: i,\n    scaleFallOffRange: r,\n    minPixelSize: v.minPixelSize\n  }, t);\n}\n\nfunction l(e) {\n  return Math.abs(e * e * e);\n}\n\nfunction s(e, t, a) {\n  const i = a.parameters,\n        r = a.paddingPixelsOverride;\n  return x.scale = Math.min(i.divisor / (t - i.offset), 1), x.factor = l(e), x.minPixelSize = i.minPixelSize, x.paddingPixels = r, x;\n}\n\nfunction c(e, t) {\n  return 0 === e ? t.minPixelSize : t.minPixelSize * (1 + 2 * t.paddingPixels / e);\n}\n\nfunction o(t, a) {\n  return Math.max(e(t * a.scale, t, a.factor), c(t, a));\n}\n\nfunction u(e, t, a) {\n  const i = s(e, t, a);\n  return i.minPixelSize = 0, i.paddingPixels = 0, o(1, i);\n}\n\nfunction d(e, t, a, i) {\n  i.scale = u(e, t, a), i.factor = 0, i.minPixelSize = a.parameters.minPixelSize, i.paddingPixels = a.paddingPixelsOverride;\n}\n\nfunction f(e, t) {\n  let a = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [0, 0];\n  const i = Math.min(Math.max(t.scale, c(e[1], t) / Math.max(1e-5, e[1])), 1);\n  return a[0] = e[0] * i, a[1] = e[1] * i, a;\n}\n\nfunction m(e, t, a, i) {\n  return o(e, s(t, a, i));\n}\n\nclass p {\n  constructor(e, t, a) {\n    let r = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : g();\n    let n = arguments.length > 4 ? arguments[4] : undefined;\n    this.viewingMode = e, this.description = t, this.ellipsoidRadius = a, this.parameters = r, this._paddingPixelsOverride = n, this.viewingMode === i.Local ? (this.coverageCompensation = this._surfaceCoverageCompensationLocal, this.calculateCurvatureDependentParameters = this._calculateCurvatureDependentParametersLocal) : (this.coverageCompensation = this._surfaceCoverageCompensationGlobal, this.calculateCurvatureDependentParameters = this._calculateCurvatureDependentParametersGlobal);\n  }\n\n  get paddingPixelsOverride() {\n    return this._paddingPixelsOverride || this.parameters.paddingPixels;\n  }\n\n  update(e) {\n    return (!this.parameters || this.parameters.camera.fovY !== e.fovY || this.parameters.camera.distance !== e.distance) && (this._calculateParameters(e, this.ellipsoidRadius, this.parameters), !0);\n  }\n\n  overridePadding(e) {\n    return e !== this.paddingPixelsOverride ? new p(this.viewingMode, this.description, this.ellipsoidRadius, this.parameters, e) : this;\n  }\n\n  _calculateParameters(e, t, a) {\n    const {\n      scaleStart: i,\n      scaleFallOffRange: r,\n      minPixelSize: n\n    } = this.description,\n          {\n      fovY: l,\n      distance: s\n    } = e,\n          c = this.calculateCurvatureDependentParameters(e, t),\n          o = this.coverageCompensation(e, t, c),\n          {\n      tiltAngle: u,\n      scaleFallOffFactor: d\n    } = c,\n          f = Math.sin(u) * s,\n          m = .5 * Math.PI - u - l * (.5 - i * o),\n          p = f / Math.cos(m),\n          h = m + l * r * o,\n          v = (p - d * (f / Math.cos(h))) / (1 - d);\n    return a.camera.fovY = e.fovY, a.camera.distance = e.distance, a.offset = v, a.divisor = p - v, a.minPixelSize = n, a;\n  }\n\n  _calculateCurvatureDependentParametersLocal(e, t) {\n    let a = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : P;\n    return a.tiltAngle = this.description.curvatureDependent.min.tiltAngle, a.scaleFallOffFactor = this.description.curvatureDependent.min.scaleFallOffFactor, a;\n  }\n\n  _calculateCurvatureDependentParametersGlobal(t, i) {\n    let r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : P;\n    const n = this.description.curvatureDependent,\n          l = 1 + t.distance / i,\n          s = Math.sqrt(l * l - 1),\n          [c, o] = [n.min.curvature, n.max.curvature],\n          u = a((s - c) / (o - c), 0, 1),\n          [d, f] = [n.min, n.max];\n    return r.tiltAngle = e(d.tiltAngle, f.tiltAngle, u), r.scaleFallOffFactor = e(d.scaleFallOffFactor, f.scaleFallOffFactor, u), r;\n  }\n\n  _surfaceCoverageCompensationLocal(e, t, a) {\n    return (e.fovY - a.tiltAngle) / e.fovY;\n  }\n\n  _surfaceCoverageCompensationGlobal(e, t, a) {\n    const i = t * t,\n          r = a.tiltAngle + .5 * Math.PI,\n          {\n      fovY: n,\n      distance: l\n    } = e,\n          s = l * l + i - 2 * Math.cos(r) * l * t,\n          c = Math.sqrt(s),\n          o = Math.sqrt(s - i);\n    return (Math.acos(o / c) - Math.asin(t / (c / Math.sin(r))) + .5 * n) / n;\n  }\n\n}\n\nconst h = {\n  curvatureDependent: {\n    min: {\n      curvature: t(10),\n      tiltAngle: t(12),\n      scaleFallOffFactor: .5\n    },\n    max: {\n      curvature: t(70),\n      tiltAngle: t(40),\n      scaleFallOffFactor: .8\n    }\n  },\n  scaleStart: .3,\n  scaleFallOffRange: .65,\n  minPixelSize: 0\n},\n      v = {\n  curvatureDependent: {\n    min: {\n      scaleFallOffFactor: .7\n    },\n    max: {\n      scaleFallOffFactor: .95\n    }\n  },\n  minPixelSize: 14\n};\n\nfunction g() {\n  return {\n    camera: {\n      distance: 0,\n      fovY: 0\n    },\n    divisor: 0,\n    offset: 0,\n    minPixelSize: 0,\n    paddingPixels: 0\n  };\n}\n\nconst x = {\n  scale: 0,\n  factor: 0,\n  minPixelSize: 0,\n  paddingPixels: 0\n},\n      P = {\n  tiltAngle: 0,\n  scaleFallOffFactor: 0\n};\nexport { f as applyPrecomputedScaleFactor, o as applyScaleFactor, n as getLabelSettings, r as getSettings, d as precomputeScaleFactor, m as scale };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/views/3d/webgl-engine/lib/screenSizePerspectiveUtils.js"],"names":["lerp","e","deg2rad","t","clamp","a","ViewingMode","i","r","p","h","n","curvatureDependent","scaleStart","scaleFallOffRange","min","curvature","tiltAngle","scaleFallOffFactor","v","max","minPixelSize","l","Math","abs","s","parameters","paddingPixelsOverride","x","scale","divisor","offset","factor","paddingPixels","c","o","u","d","f","m","constructor","g","viewingMode","description","ellipsoidRadius","_paddingPixelsOverride","Local","coverageCompensation","_surfaceCoverageCompensationLocal","calculateCurvatureDependentParameters","_calculateCurvatureDependentParametersLocal","_surfaceCoverageCompensationGlobal","_calculateCurvatureDependentParametersGlobal","update","camera","fovY","distance","_calculateParameters","overridePadding","sin","PI","cos","P","sqrt","acos","asin","applyPrecomputedScaleFactor","applyScaleFactor","getLabelSettings","getSettings","precomputeScaleFactor"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{lerp as e,deg2rad as t,clamp as a}from\"../../../../core/mathUtils.js\";import{ViewingMode as i}from\"../../../ViewingMode.js\";function r(e,t){return new p(e,h,t)}function n(e,t){const{curvatureDependent:a,scaleStart:i,scaleFallOffRange:r}=h;return new p(e,{curvatureDependent:{min:{curvature:a.min.curvature,tiltAngle:a.min.tiltAngle,scaleFallOffFactor:v.curvatureDependent.min.scaleFallOffFactor},max:{curvature:a.max.curvature,tiltAngle:a.max.tiltAngle,scaleFallOffFactor:v.curvatureDependent.max.scaleFallOffFactor}},scaleStart:i,scaleFallOffRange:r,minPixelSize:v.minPixelSize},t)}function l(e){return Math.abs(e*e*e)}function s(e,t,a){const i=a.parameters,r=a.paddingPixelsOverride;return x.scale=Math.min(i.divisor/(t-i.offset),1),x.factor=l(e),x.minPixelSize=i.minPixelSize,x.paddingPixels=r,x}function c(e,t){return 0===e?t.minPixelSize:t.minPixelSize*(1+2*t.paddingPixels/e)}function o(t,a){return Math.max(e(t*a.scale,t,a.factor),c(t,a))}function u(e,t,a){const i=s(e,t,a);return i.minPixelSize=0,i.paddingPixels=0,o(1,i)}function d(e,t,a,i){i.scale=u(e,t,a),i.factor=0,i.minPixelSize=a.parameters.minPixelSize,i.paddingPixels=a.paddingPixelsOverride}function f(e,t,a=[0,0]){const i=Math.min(Math.max(t.scale,c(e[1],t)/Math.max(1e-5,e[1])),1);return a[0]=e[0]*i,a[1]=e[1]*i,a}function m(e,t,a,i){return o(e,s(t,a,i))}class p{constructor(e,t,a,r=g(),n){this.viewingMode=e,this.description=t,this.ellipsoidRadius=a,this.parameters=r,this._paddingPixelsOverride=n,this.viewingMode===i.Local?(this.coverageCompensation=this._surfaceCoverageCompensationLocal,this.calculateCurvatureDependentParameters=this._calculateCurvatureDependentParametersLocal):(this.coverageCompensation=this._surfaceCoverageCompensationGlobal,this.calculateCurvatureDependentParameters=this._calculateCurvatureDependentParametersGlobal)}get paddingPixelsOverride(){return this._paddingPixelsOverride||this.parameters.paddingPixels}update(e){return(!this.parameters||this.parameters.camera.fovY!==e.fovY||this.parameters.camera.distance!==e.distance)&&(this._calculateParameters(e,this.ellipsoidRadius,this.parameters),!0)}overridePadding(e){return e!==this.paddingPixelsOverride?new p(this.viewingMode,this.description,this.ellipsoidRadius,this.parameters,e):this}_calculateParameters(e,t,a){const{scaleStart:i,scaleFallOffRange:r,minPixelSize:n}=this.description,{fovY:l,distance:s}=e,c=this.calculateCurvatureDependentParameters(e,t),o=this.coverageCompensation(e,t,c),{tiltAngle:u,scaleFallOffFactor:d}=c,f=Math.sin(u)*s,m=.5*Math.PI-u-l*(.5-i*o),p=f/Math.cos(m),h=m+l*r*o,v=(p-d*(f/Math.cos(h)))/(1-d);return a.camera.fovY=e.fovY,a.camera.distance=e.distance,a.offset=v,a.divisor=p-v,a.minPixelSize=n,a}_calculateCurvatureDependentParametersLocal(e,t,a=P){return a.tiltAngle=this.description.curvatureDependent.min.tiltAngle,a.scaleFallOffFactor=this.description.curvatureDependent.min.scaleFallOffFactor,a}_calculateCurvatureDependentParametersGlobal(t,i,r=P){const n=this.description.curvatureDependent,l=1+t.distance/i,s=Math.sqrt(l*l-1),[c,o]=[n.min.curvature,n.max.curvature],u=a((s-c)/(o-c),0,1),[d,f]=[n.min,n.max];return r.tiltAngle=e(d.tiltAngle,f.tiltAngle,u),r.scaleFallOffFactor=e(d.scaleFallOffFactor,f.scaleFallOffFactor,u),r}_surfaceCoverageCompensationLocal(e,t,a){return(e.fovY-a.tiltAngle)/e.fovY}_surfaceCoverageCompensationGlobal(e,t,a){const i=t*t,r=a.tiltAngle+.5*Math.PI,{fovY:n,distance:l}=e,s=l*l+i-2*Math.cos(r)*l*t,c=Math.sqrt(s),o=Math.sqrt(s-i);return(Math.acos(o/c)-Math.asin(t/(c/Math.sin(r)))+.5*n)/n}}const h={curvatureDependent:{min:{curvature:t(10),tiltAngle:t(12),scaleFallOffFactor:.5},max:{curvature:t(70),tiltAngle:t(40),scaleFallOffFactor:.8}},scaleStart:.3,scaleFallOffRange:.65,minPixelSize:0},v={curvatureDependent:{min:{scaleFallOffFactor:.7},max:{scaleFallOffFactor:.95}},minPixelSize:14};function g(){return{camera:{distance:0,fovY:0},divisor:0,offset:0,minPixelSize:0,paddingPixels:0}}const x={scale:0,factor:0,minPixelSize:0,paddingPixels:0},P={tiltAngle:0,scaleFallOffFactor:0};export{f as applyPrecomputedScaleFactor,o as applyScaleFactor,n as getLabelSettings,r as getSettings,d as precomputeScaleFactor,m as scale};\n"]},"metadata":{},"sourceType":"module"}