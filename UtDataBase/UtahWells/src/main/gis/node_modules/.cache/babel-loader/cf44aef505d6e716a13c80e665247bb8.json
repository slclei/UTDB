{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport { isNone as e } from \"../../../../core/maybe.js\";\nimport t from \"../webgl/brushes/WGLBrush.js\";\nimport { CompareFunction as n, BlendFactor as r, PrimitiveType as a, DataType as s } from \"../../../webgl/enums.js\";\n\nclass i extends t {\n  dispose() {}\n\n  prepareState(e) {\n    const {\n      context: t\n    } = e;\n    t.setColorMask(!0, !0, !0, !0), t.setStencilFunction(n.EQUAL, 0, 255);\n  }\n\n  draw(t, n) {\n    const {\n      context: i\n    } = t,\n          {\n      displayData: o\n    } = n;\n    if (e(o)) return;\n    if (\"loaded\" === o.state.name && o.prepareForRendering(i), \"attached\" !== o.state.name) return;\n    const f = o.state.resources;\n    i.setFaceCullingEnabled(!1), i.setBlendingEnabled(!0), i.setBlendFunctionSeparate(r.ONE, r.ONE_MINUS_SRC_ALPHA, r.ONE, r.ONE);\n    const d = [];\n    \"ramp\" === f.values.lineColor.kind && d.push(\"vvLineColor\"), \"ramp\" === f.values.lineOpacity.kind && d.push(\"vvLineOpacity\"), \"ramp\" === f.values.lineRenderWidth.kind && d.push(\"vvLineRenderWidth\");\n    const u = t.painter.materialManager.getProgram(t, {\n      vsPath: \"raster/flow\",\n      fsPath: \"raster/flow\",\n      attributes: f.locations\n    }, d);\n    i.useProgram(u), u.setUniform1f(\"u_time\", t.time / 1e3), u.setUniform1f(\"u_fadeDuration\", o.flowStyle.renderSettings.fadeDuration), u.setUniform1f(\"u_lineSpeed\", o.flowStyle.renderSettings.lineSpeed), u.setUniformMatrix3fv(\"u_dvsMat3\", n.transforms.dvs), u.setUniformMatrix3fv(\"u_displayViewMat3\", t.state.displayViewMat3), l(u, \"lineColor\", \"vec4\", o.flowStyle.renderSettings.lineColor), l(u, \"lineOpacity\", \"float\", o.flowStyle.renderSettings.lineOpacity), l(u, \"lineRenderWidth\", \"float\", o.flowStyle.renderSettings.lineRenderWidth), i.bindVAO(f.vertexArray), i.drawElements(a.TRIANGLES, f.indexBuffer.size, s.UNSIGNED_INT, 0), o.flowStyle.animated && n.requestRender();\n  }\n\n}\n\nfunction o(e, t, n, r) {\n  switch (t) {\n    case \"int\":\n      e.setUniform1iv(n, r);\n      break;\n\n    case \"float\":\n      e.setUniform1fv(n, r);\n      break;\n\n    case \"vec2\":\n      e.setUniform2fv(n, r);\n      break;\n\n    case \"vec3\":\n      e.setUniform3fv(n, r);\n      break;\n\n    case \"vec4\":\n      e.setUniform4fv(n, r);\n  }\n}\n\nfunction l(e, t, n, r) {\n  \"constant\" === r.kind ? o(e, n, `u_${t}`, r.value) : (o(e, \"float\", `u_${t}_stops`, r.stops), o(e, n, `u_${t}_values`, r.values), o(e, \"int\", `u_${t}_count`, [r.count]));\n}\n\nexport { i as default };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/views/2d/engine/flow/BrushFlow.js"],"names":["isNone","e","t","CompareFunction","n","BlendFactor","r","PrimitiveType","a","DataType","s","i","dispose","prepareState","context","setColorMask","setStencilFunction","EQUAL","draw","displayData","o","state","name","prepareForRendering","f","resources","setFaceCullingEnabled","setBlendingEnabled","setBlendFunctionSeparate","ONE","ONE_MINUS_SRC_ALPHA","d","values","lineColor","kind","push","lineOpacity","lineRenderWidth","u","painter","materialManager","getProgram","vsPath","fsPath","attributes","locations","useProgram","setUniform1f","time","flowStyle","renderSettings","fadeDuration","lineSpeed","setUniformMatrix3fv","transforms","dvs","displayViewMat3","l","bindVAO","vertexArray","drawElements","TRIANGLES","indexBuffer","size","UNSIGNED_INT","animated","requestRender","setUniform1iv","setUniform1fv","setUniform2fv","setUniform3fv","setUniform4fv","value","stops","count","default"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{isNone as e}from\"../../../../core/maybe.js\";import t from\"../webgl/brushes/WGLBrush.js\";import{CompareFunction as n,BlendFactor as r,PrimitiveType as a,DataType as s}from\"../../../webgl/enums.js\";class i extends t{dispose(){}prepareState(e){const{context:t}=e;t.setColorMask(!0,!0,!0,!0),t.setStencilFunction(n.EQUAL,0,255)}draw(t,n){const{context:i}=t,{displayData:o}=n;if(e(o))return;if(\"loaded\"===o.state.name&&o.prepareForRendering(i),\"attached\"!==o.state.name)return;const f=o.state.resources;i.setFaceCullingEnabled(!1),i.setBlendingEnabled(!0),i.setBlendFunctionSeparate(r.ONE,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE);const d=[];\"ramp\"===f.values.lineColor.kind&&d.push(\"vvLineColor\"),\"ramp\"===f.values.lineOpacity.kind&&d.push(\"vvLineOpacity\"),\"ramp\"===f.values.lineRenderWidth.kind&&d.push(\"vvLineRenderWidth\");const u=t.painter.materialManager.getProgram(t,{vsPath:\"raster/flow\",fsPath:\"raster/flow\",attributes:f.locations},d);i.useProgram(u),u.setUniform1f(\"u_time\",t.time/1e3),u.setUniform1f(\"u_fadeDuration\",o.flowStyle.renderSettings.fadeDuration),u.setUniform1f(\"u_lineSpeed\",o.flowStyle.renderSettings.lineSpeed),u.setUniformMatrix3fv(\"u_dvsMat3\",n.transforms.dvs),u.setUniformMatrix3fv(\"u_displayViewMat3\",t.state.displayViewMat3),l(u,\"lineColor\",\"vec4\",o.flowStyle.renderSettings.lineColor),l(u,\"lineOpacity\",\"float\",o.flowStyle.renderSettings.lineOpacity),l(u,\"lineRenderWidth\",\"float\",o.flowStyle.renderSettings.lineRenderWidth),i.bindVAO(f.vertexArray),i.drawElements(a.TRIANGLES,f.indexBuffer.size,s.UNSIGNED_INT,0),o.flowStyle.animated&&n.requestRender()}}function o(e,t,n,r){switch(t){case\"int\":e.setUniform1iv(n,r);break;case\"float\":e.setUniform1fv(n,r);break;case\"vec2\":e.setUniform2fv(n,r);break;case\"vec3\":e.setUniform3fv(n,r);break;case\"vec4\":e.setUniform4fv(n,r)}}function l(e,t,n,r){\"constant\"===r.kind?o(e,n,`u_${t}`,r.value):(o(e,\"float\",`u_${t}_stops`,r.stops),o(e,n,`u_${t}_values`,r.values),o(e,\"int\",`u_${t}_count`,[r.count]))}export{i as default};\n"]},"metadata":{},"sourceType":"module"}