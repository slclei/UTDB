{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport e from \"../../config.js\";\nimport r from \"../../request.js\";\nimport { throwIfAborted as s } from \"../../core/promiseUtils.js\";\nimport { removeTrailingSlash as t, getOrigin as o, isProtocolRelative as l, isAbsolute as i, join as n, normalize as u, removeFile as c, getAppBaseUrl as a, addQueryParameters as f } from \"../../core/urlUtils.js\";\nimport p from \"../../views/2d/engine/vectorTiles/style/VectorTileSource.js\";\nconst m = e.defaults && e.defaults.io.corsEnabledServers;\n\nasync function y(e, r) {\n  const s = {\n    source: null,\n    sourceBase: null,\n    sourceUrl: null,\n    validatedSource: null,\n    style: null,\n    styleBase: null,\n    styleUrl: null,\n    sourceNameToSource: {},\n    primarySourceName: \"\",\n    spriteFormat: \"png\"\n  },\n        [t, o] = \"string\" == typeof e ? [e, null] : [null, e.jsonUrl];\n  await h(s, \"esri\", e, o, r);\n  const l = {\n    layerDefinition: s.validatedSource,\n    url: t,\n    serviceUrl: s.sourceUrl,\n    style: s.style,\n    styleUrl: s.styleUrl,\n    spriteUrl: s.style.sprite && S(s.styleBase, s.style.sprite),\n    spriteFormat: s.spriteFormat,\n    glyphsUrl: s.style.glyphs && S(s.styleBase, s.style.glyphs),\n    sourceNameToSource: s.sourceNameToSource,\n    primarySourceName: s.primarySourceName\n  };\n  return d(l.spriteUrl), d(l.glyphsUrl), l;\n}\n\nfunction d(e) {\n  if (!e) return;\n  const r = o(e);\n  m && !m.includes(r) && m.push(r);\n}\n\nfunction S() {\n  let r;\n\n  for (var _len = arguments.length, e = new Array(_len), _key = 0; _key < _len; _key++) {\n    e[_key] = arguments[_key];\n  }\n\n  for (let s = 0; s < e.length; ++s) if (l(e[s])) {\n    if (r) {\n      const t = r.split(\"://\")[0];\n      r = t + \":\" + e[s].trim();\n    }\n  } else r = i(e[s]) ? e[s] : n(r, e[s]);\n\n  return t(r);\n}\n\nasync function h(e, t, o, l, i) {\n  let n, c, a;\n\n  if (s(i), \"string\" == typeof o) {\n    const e = u(o);\n    d(e), a = await r(e, { ...i,\n      responseType: \"json\",\n      query: {\n        f: \"json\",\n        ...(null == i ? void 0 : i.query)\n      }\n    }), a.ssl && (n && (n = n.replace(/^http:/i, \"https:\")), c && (c = c.replace(/^http:/i, \"https:\"))), n = e, c = e;\n  } else a = {\n    data: o\n  }, n = o.jsonUrl || null, c = l;\n\n  const f = a.data;\n  return U(f) ? (e.styleUrl = n || null, v(e, f, c, i)) : x(f) ? e.sourceUrl ? w(e, f, c, !1, t, i) : (e.sourceUrl = n || null, w(e, f, c, !0, t, i)) : Promise.reject(\"You must specify the URL or the JSON for a service or for a style.\");\n}\n\nfunction U(e) {\n  return !!e.sources;\n}\n\nfunction x(e) {\n  return !U(e);\n}\n\nasync function v(e, r, s, t) {\n  const o = s ? c(s) : a();\n  e.styleBase = o, e.style = r, e.styleUrl && d(e.styleUrl), r[\"sprite-format\"] && \"webp\" === r[\"sprite-format\"].toLowerCase() && (e.spriteFormat = \"webp\");\n  const l = [];\n\n  if (r.sources && r.sources.esri) {\n    const s = r.sources.esri;\n    s.url ? await h(e, \"esri\", S(o, s.url), void 0, t) : l.push(h(e, \"esri\", s, o, t));\n  }\n\n  for (const i of Object.keys(r.sources)) \"esri\" !== i && \"vector\" === r.sources[i].type && (r.sources[i].url ? l.push(h(e, i, S(o, r.sources[i].url), void 0, t)) : r.sources[i].tiles && l.push(h(e, i, r.sources[i], o, t)));\n\n  await Promise.all(l);\n}\n\nasync function w(e, r, s, o, l, i) {\n  const n = s ? t(s) + \"/\" : a(),\n        u = g(r, n),\n        c = new p(l, f(n, null == i ? void 0 : i.query), u);\n\n  if (!o && e.primarySourceName in e.sourceNameToSource) {\n    const r = e.sourceNameToSource[e.primarySourceName];\n    if (!r.isCompatibleWith(c)) return Promise.resolve();\n    null != c.fullExtent && (null != r.fullExtent ? r.fullExtent.union(c.fullExtent) : r.fullExtent = c.fullExtent.clone()), r.tileInfo.lods.length < c.tileInfo.lods.length && (r.tileInfo = c.tileInfo);\n  }\n\n  if (o ? (e.sourceBase = n, e.source = r, e.validatedSource = u, e.primarySourceName = l, e.sourceUrl && d(e.sourceUrl)) : d(n), e.sourceNameToSource[l] = c, !e.style) return null == r.defaultStyles ? Promise.reject() : \"string\" == typeof r.defaultStyles ? h(e, \"\", S(n, r.defaultStyles, \"root.json\"), void 0, i) : h(e, \"\", r.defaultStyles, S(n, \"root.json\"), i);\n}\n\nfunction g(e, r) {\n  if (e.hasOwnProperty(\"tileInfo\")) return e;\n  const s = {\n    xmin: -20037507.067161843,\n    ymin: -20037507.067161843,\n    xmax: 20037507.067161843,\n    ymax: 20037507.067161843,\n    spatialReference: {\n      wkid: 102100\n    }\n  },\n        t = 512;\n  let o = 78271.51696400007,\n      l = 295828763.7957775;\n  const i = [],\n        n = e.hasOwnProperty(\"minzoom\") ? +e.minzoom : 0,\n        u = e.hasOwnProperty(\"maxzoom\") ? +e.maxzoom : 22;\n\n  for (let c = 0; c <= u; c++) c >= n && i.push({\n    level: c,\n    scale: l,\n    resolution: o\n  }), o /= 2, l /= 2;\n\n  for (const c of e.tiles) d(S(r, c));\n\n  return {\n    capabilities: \"TilesOnly\",\n    initialExtent: s,\n    fullExtent: s,\n    minScale: 0,\n    maxScale: 0,\n    tiles: e.tiles,\n    tileInfo: {\n      rows: t,\n      cols: t,\n      dpi: 96,\n      format: \"pbf\",\n      origin: {\n        x: -20037508.342787,\n        y: 20037508.342787\n      },\n      lods: i,\n      spatialReference: {\n        wkid: 102100\n      }\n    }\n  };\n}\n\nexport { y as loadMetadata };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/layers/support/vectorTileLayerLoader.js"],"names":["e","r","throwIfAborted","s","removeTrailingSlash","t","getOrigin","o","isProtocolRelative","l","isAbsolute","i","join","n","normalize","u","removeFile","c","getAppBaseUrl","a","addQueryParameters","f","p","m","defaults","io","corsEnabledServers","y","source","sourceBase","sourceUrl","validatedSource","style","styleBase","styleUrl","sourceNameToSource","primarySourceName","spriteFormat","jsonUrl","h","layerDefinition","url","serviceUrl","spriteUrl","sprite","S","glyphsUrl","glyphs","d","includes","push","length","split","trim","responseType","query","ssl","replace","data","U","v","x","w","Promise","reject","sources","toLowerCase","esri","Object","keys","type","tiles","all","g","isCompatibleWith","resolve","fullExtent","union","clone","tileInfo","lods","defaultStyles","hasOwnProperty","xmin","ymin","xmax","ymax","spatialReference","wkid","minzoom","maxzoom","level","scale","resolution","capabilities","initialExtent","minScale","maxScale","rows","cols","dpi","format","origin","loadMetadata"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport e from\"../../config.js\";import r from\"../../request.js\";import{throwIfAborted as s}from\"../../core/promiseUtils.js\";import{removeTrailingSlash as t,getOrigin as o,isProtocolRelative as l,isAbsolute as i,join as n,normalize as u,removeFile as c,getAppBaseUrl as a,addQueryParameters as f}from\"../../core/urlUtils.js\";import p from\"../../views/2d/engine/vectorTiles/style/VectorTileSource.js\";const m=e.defaults&&e.defaults.io.corsEnabledServers;async function y(e,r){const s={source:null,sourceBase:null,sourceUrl:null,validatedSource:null,style:null,styleBase:null,styleUrl:null,sourceNameToSource:{},primarySourceName:\"\",spriteFormat:\"png\"},[t,o]=\"string\"==typeof e?[e,null]:[null,e.jsonUrl];await h(s,\"esri\",e,o,r);const l={layerDefinition:s.validatedSource,url:t,serviceUrl:s.sourceUrl,style:s.style,styleUrl:s.styleUrl,spriteUrl:s.style.sprite&&S(s.styleBase,s.style.sprite),spriteFormat:s.spriteFormat,glyphsUrl:s.style.glyphs&&S(s.styleBase,s.style.glyphs),sourceNameToSource:s.sourceNameToSource,primarySourceName:s.primarySourceName};return d(l.spriteUrl),d(l.glyphsUrl),l}function d(e){if(!e)return;const r=o(e);m&&!m.includes(r)&&m.push(r)}function S(...e){let r;for(let s=0;s<e.length;++s)if(l(e[s])){if(r){const t=r.split(\"://\")[0];r=t+\":\"+e[s].trim()}}else r=i(e[s])?e[s]:n(r,e[s]);return t(r)}async function h(e,t,o,l,i){let n,c,a;if(s(i),\"string\"==typeof o){const e=u(o);d(e),a=await r(e,{...i,responseType:\"json\",query:{f:\"json\",...null==i?void 0:i.query}}),a.ssl&&(n&&(n=n.replace(/^http:/i,\"https:\")),c&&(c=c.replace(/^http:/i,\"https:\"))),n=e,c=e}else a={data:o},n=o.jsonUrl||null,c=l;const f=a.data;return U(f)?(e.styleUrl=n||null,v(e,f,c,i)):x(f)?e.sourceUrl?w(e,f,c,!1,t,i):(e.sourceUrl=n||null,w(e,f,c,!0,t,i)):Promise.reject(\"You must specify the URL or the JSON for a service or for a style.\")}function U(e){return!!e.sources}function x(e){return!U(e)}async function v(e,r,s,t){const o=s?c(s):a();e.styleBase=o,e.style=r,e.styleUrl&&d(e.styleUrl),r[\"sprite-format\"]&&\"webp\"===r[\"sprite-format\"].toLowerCase()&&(e.spriteFormat=\"webp\");const l=[];if(r.sources&&r.sources.esri){const s=r.sources.esri;s.url?await h(e,\"esri\",S(o,s.url),void 0,t):l.push(h(e,\"esri\",s,o,t))}for(const i of Object.keys(r.sources))\"esri\"!==i&&\"vector\"===r.sources[i].type&&(r.sources[i].url?l.push(h(e,i,S(o,r.sources[i].url),void 0,t)):r.sources[i].tiles&&l.push(h(e,i,r.sources[i],o,t)));await Promise.all(l)}async function w(e,r,s,o,l,i){const n=s?t(s)+\"/\":a(),u=g(r,n),c=new p(l,f(n,null==i?void 0:i.query),u);if(!o&&e.primarySourceName in e.sourceNameToSource){const r=e.sourceNameToSource[e.primarySourceName];if(!r.isCompatibleWith(c))return Promise.resolve();null!=c.fullExtent&&(null!=r.fullExtent?r.fullExtent.union(c.fullExtent):r.fullExtent=c.fullExtent.clone()),r.tileInfo.lods.length<c.tileInfo.lods.length&&(r.tileInfo=c.tileInfo)}if(o?(e.sourceBase=n,e.source=r,e.validatedSource=u,e.primarySourceName=l,e.sourceUrl&&d(e.sourceUrl)):d(n),e.sourceNameToSource[l]=c,!e.style)return null==r.defaultStyles?Promise.reject():\"string\"==typeof r.defaultStyles?h(e,\"\",S(n,r.defaultStyles,\"root.json\"),void 0,i):h(e,\"\",r.defaultStyles,S(n,\"root.json\"),i)}function g(e,r){if(e.hasOwnProperty(\"tileInfo\"))return e;const s={xmin:-20037507.067161843,ymin:-20037507.067161843,xmax:20037507.067161843,ymax:20037507.067161843,spatialReference:{wkid:102100}},t=512;let o=78271.51696400007,l=295828763.7957775;const i=[],n=e.hasOwnProperty(\"minzoom\")?+e.minzoom:0,u=e.hasOwnProperty(\"maxzoom\")?+e.maxzoom:22;for(let c=0;c<=u;c++)c>=n&&i.push({level:c,scale:l,resolution:o}),o/=2,l/=2;for(const c of e.tiles)d(S(r,c));return{capabilities:\"TilesOnly\",initialExtent:s,fullExtent:s,minScale:0,maxScale:0,tiles:e.tiles,tileInfo:{rows:t,cols:t,dpi:96,format:\"pbf\",origin:{x:-20037508.342787,y:20037508.342787},lods:i,spatialReference:{wkid:102100}}}}export{y as loadMetadata};\n"]},"metadata":{},"sourceType":"module"}