{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport { isSome as r } from \"../../../../core/maybe.js\";\nimport { WGLDrawPhase as e } from \"./enums.js\";\nimport { createProgramTemplate as t } from \"./shaders/MaterialPrograms.js\";\n\nconst a = r => r === e.HITTEST || r === e.LABEL_ALPHA,\n      s = r => (a(r) ? 1 : 0) | (r === e.HIGHLIGHT ? 2 : 0),\n      o = (_ref, a, o, i) => {\n  let {\n    rendererInfo: e,\n    drawPhase: t\n  } = _ref;\n  return `${a.getVariationHash()}-${i.join(\".\")}-${s(t)}-${e.getVariationHash()}-${r(o) && o.join(\".\")}`;\n},\n      i = (t, s, o, i) => {\n  const h = i.reduce((r, e) => ({ ...r,\n    [e]: t.context.driverTest[e]\n  }), {}),\n        n = { ...s.getVariation(),\n    ...t.rendererInfo.getVariation(),\n    highlight: t.drawPhase === e.HIGHLIGHT,\n    id: a(t.drawPhase),\n    ...h\n  };\n  if (r(o)) for (const r of o) n[r] = !0;\n  return n;\n};\n\nclass h {\n  constructor(r) {\n    this._rctx = r, this._programByKey = new Map();\n  }\n\n  dispose() {\n    this._programByKey.forEach(r => r.dispose()), this._programByKey.clear();\n  }\n\n  getProgram(r, e) {\n    let a = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n    let s = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : [];\n    const o = e.vsPath + \".\" + e.fsPath + JSON.stringify(a) + s.join(\".\");\n    if (this._programByKey.has(o)) return this._programByKey.get(o);\n\n    const i = s.reduce((e, t) => ({ ...e,\n      [t]: r.context.driverTest[t]\n    }), {}),\n          h = { ...a.map(r => \"string\" == typeof r ? {\n        name: r,\n        value: !0\n      } : r).reduce((r, e) => ({ ...r,\n        [e.name]: e.value\n      }), {}),\n      ...i\n    },\n          {\n      vsPath: n,\n      fsPath: g,\n      attributes: m\n    } = e,\n          c = t(n, g, m, h),\n          y = this._rctx.programCache.acquire(c.shaders.vertexShader, c.shaders.fragmentShader, c.attributes);\n\n    if (!y) throw new Error(\"Unable to get program for key: ${key}\");\n    return this._programByKey.set(o, y), y;\n  }\n\n  getMaterialProgram(r, e, a, s, h) {\n    let n = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : [\"ignoresSamplerPrecision\"];\n    const g = o(r, e, h, n);\n    if (this._programByKey.has(g)) return this._programByKey.get(g);\n\n    const m = i(r, e, h, n),\n          c = t(a, a, s, m),\n          y = this._rctx.programCache.acquire(c.shaders.vertexShader, c.shaders.fragmentShader, c.attributes);\n\n    if (!y) throw new Error(\"Unable to get program for key: ${key}\");\n    return this._programByKey.set(g, y), y;\n  }\n\n}\n\nexport { h as default };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/views/2d/engine/webgl/MaterialManager.js"],"names":["isSome","r","WGLDrawPhase","e","createProgramTemplate","t","a","HITTEST","LABEL_ALPHA","s","HIGHLIGHT","o","i","rendererInfo","drawPhase","getVariationHash","join","h","reduce","context","driverTest","n","getVariation","highlight","id","constructor","_rctx","_programByKey","Map","dispose","forEach","clear","getProgram","vsPath","fsPath","JSON","stringify","has","get","map","name","value","g","attributes","m","c","y","programCache","acquire","shaders","vertexShader","fragmentShader","Error","set","getMaterialProgram","default"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{isSome as r}from\"../../../../core/maybe.js\";import{WGLDrawPhase as e}from\"./enums.js\";import{createProgramTemplate as t}from\"./shaders/MaterialPrograms.js\";const a=r=>r===e.HITTEST||r===e.LABEL_ALPHA,s=r=>(a(r)?1:0)|(r===e.HIGHLIGHT?2:0),o=({rendererInfo:e,drawPhase:t},a,o,i)=>`${a.getVariationHash()}-${i.join(\".\")}-${s(t)}-${e.getVariationHash()}-${r(o)&&o.join(\".\")}`,i=(t,s,o,i)=>{const h=i.reduce(((r,e)=>({...r,[e]:t.context.driverTest[e]})),{}),n={...s.getVariation(),...t.rendererInfo.getVariation(),highlight:t.drawPhase===e.HIGHLIGHT,id:a(t.drawPhase),...h};if(r(o))for(const r of o)n[r]=!0;return n};class h{constructor(r){this._rctx=r,this._programByKey=new Map}dispose(){this._programByKey.forEach((r=>r.dispose())),this._programByKey.clear()}getProgram(r,e,a=[],s=[]){const o=e.vsPath+\".\"+e.fsPath+JSON.stringify(a)+s.join(\".\");if(this._programByKey.has(o))return this._programByKey.get(o);const i=s.reduce(((e,t)=>({...e,[t]:r.context.driverTest[t]})),{}),h={...a.map((r=>\"string\"==typeof r?{name:r,value:!0}:r)).reduce(((r,e)=>({...r,[e.name]:e.value})),{}),...i},{vsPath:n,fsPath:g,attributes:m}=e,c=t(n,g,m,h),y=this._rctx.programCache.acquire(c.shaders.vertexShader,c.shaders.fragmentShader,c.attributes);if(!y)throw new Error(\"Unable to get program for key: ${key}\");return this._programByKey.set(o,y),y}getMaterialProgram(r,e,a,s,h,n=[\"ignoresSamplerPrecision\"]){const g=o(r,e,h,n);if(this._programByKey.has(g))return this._programByKey.get(g);const m=i(r,e,h,n),c=t(a,a,s,m),y=this._rctx.programCache.acquire(c.shaders.vertexShader,c.shaders.fragmentShader,c.attributes);if(!y)throw new Error(\"Unable to get program for key: ${key}\");return this._programByKey.set(g,y),y}}export{h as default};\n"]},"metadata":{},"sourceType":"module"}