{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport t from \"./Dictionary.js\";\nimport e from \"./ImmutableArray.js\";\nimport { i, j as s, f as r, u as o, y as a, o as n, w as l } from \"../chunks/languageUtils.js\";\nimport { resolve as u } from \"../core/promiseUtils.js\";\nimport h from \"../geometry/Geometry.js\";\nimport f from \"../geometry/Point.js\";\nimport { fromJSON as y } from \"../geometry/support/jsonUtils.js\";\nimport { convertToGeometry as c } from \"../layers/graphics/featureConversionUtils.js\";\nimport { isSome as m, unwrap as d } from \"../core/maybe.js\";\n\nclass _ {\n  constructor() {\n    this.arcadeDeclaredClass = \"esri.arcade.Feature\", this._optimizedGeomDefinition = null, this._geometry = null, this.attributes = null, this._layer = null, this._datesfixed = !0, this.immutable = !0, this._datefields = null, this.immutable = !0;\n  }\n\n  static createFromGraphic(t) {\n    const e = new _();\n    return e._geometry = m(t.geometry) ? t.geometry : null, void 0 === t.attributes || null === t.attributes ? e.attributes = {} : e.attributes = t.attributes, t._sourceLayer ? (e._layer = t._sourceLayer, e._datesfixed = !1) : t._layer ? (e._layer = t._layer, e._datesfixed = !1) : t.layer && \"fields\" in t.layer ? (e._layer = t.layer, e._datesfixed = !1) : t.sourceLayer && \"fields\" in t.sourceLayer && (e._layer = t.sourceLayer, e._datesfixed = !1), e;\n  }\n\n  static createFromArcadeFeature(t) {\n    const e = new _();\n    return e._datesfixed = t._datesfixed, e.attributes = t.attributes, e._geometry = t._geometry, e._optimizedGeomDefinition = t._optimizedGeomDefinition, t._layer && (e._layer = t._layer), e;\n  }\n\n  static createFromOptimisedFeature(t, e, i) {\n    const s = new _();\n    return s._geometry = t.geometry ? {\n      geometry: t.geometry\n    } : null, s._optimizedGeomDefinition = i, s.attributes = t.attributes || {}, s._layer = e, s._datesfixed = !1, s;\n  }\n\n  static createFromArcadeDictionary(e) {\n    const i = new _();\n    return i.attributes = e.field(\"attributes\"), null !== i.attributes && i.attributes instanceof t ? (i.attributes = i.attributes.attributes, null === i.attributes && (i.attributes = {})) : i.attributes = {}, i._geometry = e.field(\"geometry\"), null !== i._geometry && (i._geometry instanceof t ? i._geometry = _.parseGeometryFromDictionary(i._geometry) : i._geometry instanceof h || (i._geometry = null)), i;\n  }\n\n  static createFromGraphicLikeObject(t, e) {\n    let i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    const s = new _();\n    return null === e && (e = {}), s.attributes = e, s._geometry = m(t) ? t : null, s._layer = i, s._layer && (s._datesfixed = !1), s;\n  }\n\n  repurposeFromGraphicLikeObject(t, e) {\n    let i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    null === e && (e = {}), this.attributes = e, this._geometry = t || null, this._layer = i, this._layer ? this._datesfixed = !1 : this._datesfixed = !0;\n  }\n\n  castToText() {\n    let t = \"\";\n    !1 === this._datesfixed && this._fixDates();\n\n    for (const a in this.attributes) {\n      \"\" !== t && (t += \",\");\n      const n = this.attributes[a];\n      null == n ? t += JSON.stringify(a) + \":null\" : i(n) || s(n) || r(n) ? t += JSON.stringify(a) + \":\" + JSON.stringify(n) : n instanceof h || n instanceof e || n instanceof Array ? t += JSON.stringify(a) + \":\" + o(n) : n instanceof Date ? t += JSON.stringify(a) + \":\" + JSON.stringify(n) : null !== n && \"object\" == typeof n && void 0 !== n.castToText && (t += JSON.stringify(a) + \":\" + n.castToText());\n    }\n\n    return '{\"geometry\":' + (null === this.geometry() ? \"null\" : o(this.geometry())) + ',\"attributes\":{' + t + \"}}\";\n  }\n\n  _fixDates() {\n    if (null !== this._datefields) return this._datefields.length > 0 && this._fixDateFields(this._datefields), void (this._datesfixed = !0);\n    const t = [];\n\n    for (let e = 0; e < this._layer.fields.length; e++) {\n      const i = this._layer.fields[e];\n      \"date\" !== i.type && \"esriFieldTypeDate\" !== i.type || t.push(i.name);\n    }\n\n    this._datefields = t, t.length > 0 && this._fixDateFields(t), this._datesfixed = !0;\n  }\n\n  _fixDateFields(t) {\n    this.attributes = { ...this.attributes\n    };\n\n    for (let e = 0; e < t.length; e++) {\n      let i = this.attributes[t[e]];\n      if (null === i) ;else if (void 0 === i) {\n        for (const s in this.attributes) if (s.toLowerCase() === t[e].toLowerCase()) {\n          i = this.attributes[s], null !== i && (i instanceof Date || (this.attributes[s] = new Date(i)));\n          break;\n        }\n      } else i instanceof Date || (this.attributes[t[e]] = new Date(i));\n    }\n  }\n\n  geometry() {\n    return null === this._geometry || this._geometry instanceof h || (this._optimizedGeomDefinition ? (this._geometry = d(y(c(this._geometry, this._optimizedGeomDefinition.geometryType, this._optimizedGeomDefinition.hasZ, this._optimizedGeomDefinition.hasM))), this._geometry.spatialReference = this._optimizedGeomDefinition.spatialReference) : this._geometry = d(y(this._geometry))), this._geometry;\n  }\n\n  field(t) {\n    !1 === this._datesfixed && this._fixDates();\n    const e = this.attributes[t];\n    if (void 0 !== e) return e;\n    const i = t.toLowerCase();\n\n    for (const s in this.attributes) if (s.toLowerCase() === i) return this.attributes[s];\n\n    if (this._hasFieldDefinition(i)) return null;\n    throw new Error(\"Field not Found : \" + t);\n  }\n\n  _hasFieldDefinition(t) {\n    if (null === this._layer) return !1;\n\n    for (let e = 0; e < this._layer.fields.length; e++) {\n      if (this._layer.fields[e].name.toLowerCase() === t) return !0;\n    }\n\n    return !1;\n  }\n\n  setField(t, e) {\n    if (this.immutable) throw new Error(\"Feature is Immutable\");\n    if (!1 === a(e)) throw new Error(\"Illegal Value Assignment to Feature\");\n    const i = t.toLowerCase();\n\n    if (void 0 === this.attributes[t]) {\n      for (const t in this.attributes) if (t.toLowerCase() === i) return void (this.attributes[t] = e);\n\n      this.attributes[t] = e;\n    } else this.attributes[t] = e;\n  }\n\n  hasField(t) {\n    const e = t.toLowerCase();\n    if (void 0 !== this.attributes[t]) return !0;\n\n    for (const i in this.attributes) if (i.toLowerCase() === e) return !0;\n\n    return !!this._hasFieldDefinition(e);\n  }\n\n  keys() {\n    let t = [];\n    const e = {};\n\n    for (const i in this.attributes) t.push(i), e[i.toLowerCase()] = 1;\n\n    if (null !== this._layer) for (let i = 0; i < this._layer.fields.length; i++) {\n      const s = this._layer.fields[i];\n      1 !== e[s.name.toLowerCase()] && t.push(s.name);\n    }\n    return t = t.sort(), t;\n  }\n\n  static parseGeometryFromDictionary(t) {\n    const e = _._convertDictionaryToJson(t, !0);\n\n    return void 0 !== e.hasm && (e.hasM = e.hasm, delete e.hasm), void 0 !== e.hasz && (e.hasZ = e.hasz, delete e.hasz), void 0 !== e.spatialreference && (e.spatialReference = e.spatialreference, delete e.spatialreference), void 0 !== e.rings && (e.rings = this._fixPathArrays(e.rings, !0 === e.hasZ, !0 === e.hasZ)), void 0 !== e.paths && (e.paths = this._fixPathArrays(e.paths, !0 === e.hasZ, !0 === e.hasM)), void 0 !== e.points && (e.points = this._fixPointArrays(e.points, !0 === e.hasZ, !0 === e.hasM)), y(e);\n  }\n\n  static _fixPathArrays(t, i, s) {\n    const r = [];\n    if (t instanceof Array) for (let e = 0; e < t.length; e++) r.push(this._fixPointArrays(t[e], i, s));else if (t instanceof e) for (let e = 0; e < t.length(); e++) r.push(this._fixPointArrays(t.get(e), i, s));\n    return r;\n  }\n\n  static _fixPointArrays(t, i, s) {\n    const r = [];\n    if (t instanceof Array) for (let o = 0; o < t.length; o++) {\n      const a = t[o];\n      a instanceof f ? i && s ? r.push([a.x, a.y, a.z, a.m]) : i ? r.push([a.x, a.y, a.z]) : s ? r.push([a.x, a.y, a.m]) : r.push([a.x, a.y]) : a instanceof e ? r.push(a.toArray()) : r.push(a);\n    } else if (t instanceof e) for (let o = 0; o < t.length(); o++) {\n      const a = t.get(o);\n      a instanceof f ? i && s ? r.push([a.x, a.y, a.z, a.m]) : i ? r.push([a.x, a.y, a.z]) : s ? r.push([a.x, a.y, a.m]) : r.push([a.x, a.y]) : a instanceof e ? r.push(a.toArray()) : r.push(a);\n    }\n    return r;\n  }\n\n  static _convertDictionaryToJson(e) {\n    let i = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !1;\n    const s = {};\n\n    for (const r in e.attributes) {\n      let o = e.attributes[r];\n      o instanceof t && (o = _._convertDictionaryToJson(o)), i ? s[r.toLowerCase()] = o : s[r] = o;\n    }\n\n    return s;\n  }\n\n  static parseAttributesFromDictionary(t) {\n    const e = {};\n\n    for (const i in t.attributes) {\n      const s = t.attributes[i];\n      if (!a(s)) throw new Error(\"Illegal Argument\");\n      e[i] = s;\n    }\n\n    return e;\n  }\n\n  static fromJson(t) {\n    let e = null;\n    null !== t.geometry && void 0 !== t.geometry && (e = y(t.geometry));\n    const o = {};\n    if (null !== t.attributes && void 0 !== t.attributes) for (const a in t.attributes) {\n      const e = t.attributes[a];\n      if (null === e) o[a] = e;else {\n        if (!(r(e) || s(e) || i(e) || n(e))) throw new Error(\"Illegal Argument\");\n        o[a] = e;\n      }\n    }\n    return _.createFromGraphicLikeObject(e, o, null);\n  }\n\n  fullSchema() {\n    return this._layer;\n  }\n\n  gdbVersion() {\n    if (null === this._layer) return \"\";\n    const t = this._layer.gdbVersion;\n    return void 0 === t ? \"\" : \"\" === t && this._layer.capabilities && this._layer.capabilities.isVersioned ? \"SDE.DEFAULT\" : t;\n  }\n\n  castAsJson(t) {\n    const e = {\n      attributes: {},\n      geometry: !0 === (null == t ? void 0 : t.keepGeometryType) ? this.geometry() : this.geometry().toJSON()\n    };\n\n    for (const i in this.attributes) {\n      const s = this.attributes[i];\n      void 0 !== s && (e.attributes[i] = l(s, t));\n    }\n\n    return e;\n  }\n\n  castAsJsonAsync() {\n    let t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n    let e = arguments.length > 1 ? arguments[1] : undefined;\n    return u(this.castAsJson(e));\n  }\n\n}\n\nexport { _ as default };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/arcade/Feature.js"],"names":["t","e","i","j","s","f","r","u","o","y","a","n","w","l","resolve","h","fromJSON","convertToGeometry","c","isSome","m","unwrap","d","_","constructor","arcadeDeclaredClass","_optimizedGeomDefinition","_geometry","attributes","_layer","_datesfixed","immutable","_datefields","createFromGraphic","geometry","_sourceLayer","layer","sourceLayer","createFromArcadeFeature","createFromOptimisedFeature","createFromArcadeDictionary","field","parseGeometryFromDictionary","createFromGraphicLikeObject","repurposeFromGraphicLikeObject","castToText","_fixDates","JSON","stringify","Array","Date","length","_fixDateFields","fields","type","push","name","toLowerCase","geometryType","hasZ","hasM","spatialReference","_hasFieldDefinition","Error","setField","hasField","keys","sort","_convertDictionaryToJson","hasm","hasz","spatialreference","rings","_fixPathArrays","paths","points","_fixPointArrays","get","x","z","toArray","parseAttributesFromDictionary","fromJson","fullSchema","gdbVersion","capabilities","isVersioned","castAsJson","keepGeometryType","toJSON","castAsJsonAsync","default"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport t from\"./Dictionary.js\";import e from\"./ImmutableArray.js\";import{i,j as s,f as r,u as o,y as a,o as n,w as l}from\"../chunks/languageUtils.js\";import{resolve as u}from\"../core/promiseUtils.js\";import h from\"../geometry/Geometry.js\";import f from\"../geometry/Point.js\";import{fromJSON as y}from\"../geometry/support/jsonUtils.js\";import{convertToGeometry as c}from\"../layers/graphics/featureConversionUtils.js\";import{isSome as m,unwrap as d}from\"../core/maybe.js\";class _{constructor(){this.arcadeDeclaredClass=\"esri.arcade.Feature\",this._optimizedGeomDefinition=null,this._geometry=null,this.attributes=null,this._layer=null,this._datesfixed=!0,this.immutable=!0,this._datefields=null,this.immutable=!0}static createFromGraphic(t){const e=new _;return e._geometry=m(t.geometry)?t.geometry:null,void 0===t.attributes||null===t.attributes?e.attributes={}:e.attributes=t.attributes,t._sourceLayer?(e._layer=t._sourceLayer,e._datesfixed=!1):t._layer?(e._layer=t._layer,e._datesfixed=!1):t.layer&&\"fields\"in t.layer?(e._layer=t.layer,e._datesfixed=!1):t.sourceLayer&&\"fields\"in t.sourceLayer&&(e._layer=t.sourceLayer,e._datesfixed=!1),e}static createFromArcadeFeature(t){const e=new _;return e._datesfixed=t._datesfixed,e.attributes=t.attributes,e._geometry=t._geometry,e._optimizedGeomDefinition=t._optimizedGeomDefinition,t._layer&&(e._layer=t._layer),e}static createFromOptimisedFeature(t,e,i){const s=new _;return s._geometry=t.geometry?{geometry:t.geometry}:null,s._optimizedGeomDefinition=i,s.attributes=t.attributes||{},s._layer=e,s._datesfixed=!1,s}static createFromArcadeDictionary(e){const i=new _;return i.attributes=e.field(\"attributes\"),null!==i.attributes&&i.attributes instanceof t?(i.attributes=i.attributes.attributes,null===i.attributes&&(i.attributes={})):i.attributes={},i._geometry=e.field(\"geometry\"),null!==i._geometry&&(i._geometry instanceof t?i._geometry=_.parseGeometryFromDictionary(i._geometry):i._geometry instanceof h||(i._geometry=null)),i}static createFromGraphicLikeObject(t,e,i=null){const s=new _;return null===e&&(e={}),s.attributes=e,s._geometry=m(t)?t:null,s._layer=i,s._layer&&(s._datesfixed=!1),s}repurposeFromGraphicLikeObject(t,e,i=null){null===e&&(e={}),this.attributes=e,this._geometry=t||null,this._layer=i,this._layer?this._datesfixed=!1:this._datesfixed=!0}castToText(){let t=\"\";!1===this._datesfixed&&this._fixDates();for(const a in this.attributes){\"\"!==t&&(t+=\",\");const n=this.attributes[a];null==n?t+=JSON.stringify(a)+\":null\":i(n)||s(n)||r(n)?t+=JSON.stringify(a)+\":\"+JSON.stringify(n):n instanceof h||n instanceof e||n instanceof Array?t+=JSON.stringify(a)+\":\"+o(n):n instanceof Date?t+=JSON.stringify(a)+\":\"+JSON.stringify(n):null!==n&&\"object\"==typeof n&&void 0!==n.castToText&&(t+=JSON.stringify(a)+\":\"+n.castToText())}return'{\"geometry\":'+(null===this.geometry()?\"null\":o(this.geometry()))+',\"attributes\":{'+t+\"}}\"}_fixDates(){if(null!==this._datefields)return this._datefields.length>0&&this._fixDateFields(this._datefields),void(this._datesfixed=!0);const t=[];for(let e=0;e<this._layer.fields.length;e++){const i=this._layer.fields[e];\"date\"!==i.type&&\"esriFieldTypeDate\"!==i.type||t.push(i.name)}this._datefields=t,t.length>0&&this._fixDateFields(t),this._datesfixed=!0}_fixDateFields(t){this.attributes={...this.attributes};for(let e=0;e<t.length;e++){let i=this.attributes[t[e]];if(null===i);else if(void 0===i){for(const s in this.attributes)if(s.toLowerCase()===t[e].toLowerCase()){i=this.attributes[s],null!==i&&(i instanceof Date||(this.attributes[s]=new Date(i)));break}}else i instanceof Date||(this.attributes[t[e]]=new Date(i))}}geometry(){return null===this._geometry||this._geometry instanceof h||(this._optimizedGeomDefinition?(this._geometry=d(y(c(this._geometry,this._optimizedGeomDefinition.geometryType,this._optimizedGeomDefinition.hasZ,this._optimizedGeomDefinition.hasM))),this._geometry.spatialReference=this._optimizedGeomDefinition.spatialReference):this._geometry=d(y(this._geometry))),this._geometry}field(t){!1===this._datesfixed&&this._fixDates();const e=this.attributes[t];if(void 0!==e)return e;const i=t.toLowerCase();for(const s in this.attributes)if(s.toLowerCase()===i)return this.attributes[s];if(this._hasFieldDefinition(i))return null;throw new Error(\"Field not Found : \"+t)}_hasFieldDefinition(t){if(null===this._layer)return!1;for(let e=0;e<this._layer.fields.length;e++){if(this._layer.fields[e].name.toLowerCase()===t)return!0}return!1}setField(t,e){if(this.immutable)throw new Error(\"Feature is Immutable\");if(!1===a(e))throw new Error(\"Illegal Value Assignment to Feature\");const i=t.toLowerCase();if(void 0===this.attributes[t]){for(const t in this.attributes)if(t.toLowerCase()===i)return void(this.attributes[t]=e);this.attributes[t]=e}else this.attributes[t]=e}hasField(t){const e=t.toLowerCase();if(void 0!==this.attributes[t])return!0;for(const i in this.attributes)if(i.toLowerCase()===e)return!0;return!!this._hasFieldDefinition(e)}keys(){let t=[];const e={};for(const i in this.attributes)t.push(i),e[i.toLowerCase()]=1;if(null!==this._layer)for(let i=0;i<this._layer.fields.length;i++){const s=this._layer.fields[i];1!==e[s.name.toLowerCase()]&&t.push(s.name)}return t=t.sort(),t}static parseGeometryFromDictionary(t){const e=_._convertDictionaryToJson(t,!0);return void 0!==e.hasm&&(e.hasM=e.hasm,delete e.hasm),void 0!==e.hasz&&(e.hasZ=e.hasz,delete e.hasz),void 0!==e.spatialreference&&(e.spatialReference=e.spatialreference,delete e.spatialreference),void 0!==e.rings&&(e.rings=this._fixPathArrays(e.rings,!0===e.hasZ,!0===e.hasZ)),void 0!==e.paths&&(e.paths=this._fixPathArrays(e.paths,!0===e.hasZ,!0===e.hasM)),void 0!==e.points&&(e.points=this._fixPointArrays(e.points,!0===e.hasZ,!0===e.hasM)),y(e)}static _fixPathArrays(t,i,s){const r=[];if(t instanceof Array)for(let e=0;e<t.length;e++)r.push(this._fixPointArrays(t[e],i,s));else if(t instanceof e)for(let e=0;e<t.length();e++)r.push(this._fixPointArrays(t.get(e),i,s));return r}static _fixPointArrays(t,i,s){const r=[];if(t instanceof Array)for(let o=0;o<t.length;o++){const a=t[o];a instanceof f?i&&s?r.push([a.x,a.y,a.z,a.m]):i?r.push([a.x,a.y,a.z]):s?r.push([a.x,a.y,a.m]):r.push([a.x,a.y]):a instanceof e?r.push(a.toArray()):r.push(a)}else if(t instanceof e)for(let o=0;o<t.length();o++){const a=t.get(o);a instanceof f?i&&s?r.push([a.x,a.y,a.z,a.m]):i?r.push([a.x,a.y,a.z]):s?r.push([a.x,a.y,a.m]):r.push([a.x,a.y]):a instanceof e?r.push(a.toArray()):r.push(a)}return r}static _convertDictionaryToJson(e,i=!1){const s={};for(const r in e.attributes){let o=e.attributes[r];o instanceof t&&(o=_._convertDictionaryToJson(o)),i?s[r.toLowerCase()]=o:s[r]=o}return s}static parseAttributesFromDictionary(t){const e={};for(const i in t.attributes){const s=t.attributes[i];if(!a(s))throw new Error(\"Illegal Argument\");e[i]=s}return e}static fromJson(t){let e=null;null!==t.geometry&&void 0!==t.geometry&&(e=y(t.geometry));const o={};if(null!==t.attributes&&void 0!==t.attributes)for(const a in t.attributes){const e=t.attributes[a];if(null===e)o[a]=e;else{if(!(r(e)||s(e)||i(e)||n(e)))throw new Error(\"Illegal Argument\");o[a]=e}}return _.createFromGraphicLikeObject(e,o,null)}fullSchema(){return this._layer}gdbVersion(){if(null===this._layer)return\"\";const t=this._layer.gdbVersion;return void 0===t?\"\":\"\"===t&&this._layer.capabilities&&this._layer.capabilities.isVersioned?\"SDE.DEFAULT\":t}castAsJson(t){const e={attributes:{},geometry:!0===(null==t?void 0:t.keepGeometryType)?this.geometry():this.geometry().toJSON()};for(const i in this.attributes){const s=this.attributes[i];void 0!==s&&(e.attributes[i]=l(s,t))}return e}castAsJsonAsync(t=null,e){return u(this.castAsJson(e))}}export{_ as default};\n"]},"metadata":{},"sourceType":"module"}