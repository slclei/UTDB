{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport \"../../../../geometry.js\";\nimport e from \"../../../../request.js\";\nimport t from \"../../../../core/Error.js\";\nimport i from \"../../../../core/Logger.js\";\nimport { _parseInfo as n } from \"../../../../core/number.js\";\nimport { createTask as r, isAbortError as s } from \"../../../../core/promiseUtils.js\";\nimport { urlToObject as o, getFilename as a } from \"../../../../core/urlUtils.js\";\nimport { projectMany as l } from \"../../../../geometry/projection.js\";\nimport { jsonAdapter as u } from \"../../../../geometry/geometryAdapters/json.js\";\nimport { equals as d, isWebMercator as c, WGS84 as m } from \"../../../../geometry/support/spatialReferenceUtils.js\";\nimport { lngLatToXY as f } from \"../../../../geometry/support/webMercatorUtils.js\";\nimport { OptimizedFeature as p } from \"../../OptimizedFeature.js\";\nimport y from \"../../OptimizedGeometry.js\";\nimport h from \"../../data/FeatureStore.js\";\nimport { checkProjectionSupport as g } from \"../../data/projectionSupport.js\";\nimport F from \"../../data/QueryEngine.js\";\nimport { readRows as _, parseRows as I, inferDelimiter as N } from \"../csv/csv.js\";\nimport { createDefaultAttributesFunction as w, createDrawingInfo as b } from \"./clientSideDefaults.js\";\nimport T from \"../../../support/FieldsIndex.js\";\nimport { getFieldDefaultValue as x } from \"../../../support/fieldUtils.js\";\nimport E from \"../../../../geometry/SpatialReference.js\";\nconst j = b(\"esriGeometryPoint\"),\n      S = [\"csv\"],\n      q = [0, 0];\n\nclass v {\n  constructor(e, t) {\n    this.x = e, this.y = t;\n  }\n\n}\n\nclass C {\n  constructor() {\n    this._queryEngine = null, this._snapshotFeatures = async e => {\n      const t = await this._fetch(e);\n      return this._createFeatures(t);\n    };\n  }\n\n  destroy() {\n    var e;\n    null == (e = this._queryEngine) || e.destroy(), this._queryEngine = null;\n  }\n\n  async load(e) {\n    let t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var i;\n    this.loadOptions = e;\n    const [n] = await Promise.all([this._fetch(t.signal), this._checkProjection(null == e || null == (i = e.parsingOptions) ? void 0 : i.spatialReference)]),\n          r = D(n, e);\n    this.locationInfo = r.locationInfo, this.delimiter = r.delimiter, this._queryEngine = this._createQueryEngine(r);\n    const s = await this._createFeatures(n);\n\n    if (this._queryEngine.featureStore.addMany(s), r.layerDefinition.extent = this._queryEngine.fullExtent, r.layerDefinition.timeInfo) {\n      const {\n        start: e,\n        end: t\n      } = this._queryEngine.timeExtent;\n      r.layerDefinition.timeInfo.timeExtent = [e, t];\n    }\n\n    return r;\n  }\n\n  async applyEdits() {\n    throw new t(\"csv-layer:editing-not-supported\", \"applyEdits() is not supported on CSVLayer\");\n  }\n\n  async queryFeatures() {\n    let e = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    let t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    return await this._waitSnapshotComplete(), this._queryEngine.executeQuery(e, t.signal);\n  }\n\n  async queryFeatureCount() {\n    let e = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    let t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    return await this._waitSnapshotComplete(), this._queryEngine.executeQueryForCount(e, t.signal);\n  }\n\n  async queryObjectIds() {\n    let e = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    let t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    return await this._waitSnapshotComplete(), this._queryEngine.executeQueryForIds(e, t.signal);\n  }\n\n  async queryExtent() {\n    let e = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    let t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    return await this._waitSnapshotComplete(), this._queryEngine.executeQueryForExtent(e, t.signal);\n  }\n\n  async querySnapping(e) {\n    let t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    return await this._waitSnapshotComplete(), this._queryEngine.executeQueryForSnapping(e, t.signal);\n  }\n\n  async refresh(e) {\n    var n;\n    return this.loadOptions.customParameters = e, null == (n = this._snapshotTask) || n.abort(), this._snapshotTask = r(this._snapshotFeatures), this._snapshotTask.promise.then(e => {\n      this._queryEngine.featureStore.clear(), e && this._queryEngine.featureStore.addMany(e);\n    }, e => {\n      this._queryEngine.featureStore.clear(), s(e) || i.getLogger(\"esri.layers.CSVLayer\").error(new t(\"csv-layer:refresh\", \"An error occurred during refresh\", {\n        error: e\n      }));\n    }), await this._waitSnapshotComplete(), {\n      extent: this._queryEngine.fullExtent,\n      timeExtent: this._queryEngine.timeExtent\n    };\n  }\n\n  async _waitSnapshotComplete() {\n    if (this._snapshotTask && !this._snapshotTask.finished) {\n      try {\n        await this._snapshotTask.promise;\n      } catch {}\n\n      return this._waitSnapshotComplete();\n    }\n  }\n\n  async _fetch(i) {\n    const {\n      url: n,\n      customParameters: r\n    } = this.loadOptions;\n    if (!n) throw new t(\"csv-layer:invalid-source\", \"url not defined\");\n    const s = o(n);\n    return (await e(s.path, {\n      query: { ...s.query,\n        ...r\n      },\n      responseType: \"text\",\n      signal: i\n    })).data;\n  }\n\n  _createQueryEngine(e) {\n    const {\n      objectIdField: t,\n      fields: i,\n      extent: n,\n      timeInfo: r\n    } = e.layerDefinition,\n          s = new h({\n      geometryType: \"esriGeometryPoint\",\n      hasM: !1,\n      hasZ: !1\n    });\n    return new F({\n      fields: i,\n      geometryType: \"esriGeometryPoint\",\n      hasM: !1,\n      hasZ: !1,\n      timeInfo: r,\n      objectIdField: t,\n      spatialReference: n.spatialReference || {\n        wkid: 4326\n      },\n      cacheSpatialQueries: !0,\n      featureStore: s\n    });\n  }\n\n  async _createFeatures(e) {\n    const {\n      latitudeFieldName: t,\n      longitudeFieldName: i\n    } = this.locationInfo,\n          {\n      objectIdField: n,\n      fieldsIndex: r,\n      spatialReference: s\n    } = this._queryEngine;\n    let o = [];\n    const a = [],\n          m = r.fields.filter(e => e.name !== n).map(e => e.name);\n    let h = 0;\n\n    const g = _(e);\n\n    g.next();\n    const F = {};\n\n    for (const l of r.fields) if (\"esriFieldTypeOID\" !== l.type && \"esriFieldTypeGlobalID\" !== l.type) {\n      const e = x(l);\n      void 0 !== e && (F[l.name] = e);\n    }\n\n    const N = I(g, m, this.delimiter, w(F, n));\n\n    for (const l of N) {\n      const e = this._parseCoordinateValue(l[t]),\n            s = this._parseCoordinateValue(l[i]);\n\n      if (null != s && null != e && !isNaN(e) && !isNaN(s)) {\n        l[t] = e, l[i] = s;\n\n        for (const e in l) if (e !== t && e !== i) if (r.isDateField(e)) {\n          const t = new Date(l[e]);\n          l[e] = L(t, l[e]) ? t.getTime() : null;\n        } else if (r.isNumericField(e)) {\n          const t = M(l[e]);\n          isNaN(t) ? l[e] = null : l[e] = t;\n        }\n\n        l[n] = h, h++, o.push(new v(s, e)), a.push(l);\n      }\n    }\n\n    if (!d({\n      wkid: 4326\n    }, s)) if (c(s)) for (const l of o) [l.x, l.y] = f(l.x, l.y, q);else o = l(u, o, E.WGS84, s, null);\n    const b = [];\n\n    for (let l = 0; l < o.length; l++) {\n      const {\n        x: e,\n        y: t\n      } = o[l],\n            i = a[l];\n      i[n] = l + 1, b.push(new p(new y([], [e, t]), i, null, i[n]));\n    }\n\n    return b;\n  }\n\n  _parseCoordinateValue(e) {\n    if (null == e || \"\" === e) return null;\n    let t = M(e);\n    return (isNaN(t) || Math.abs(t) > 181) && (t = parseFloat(e)), t;\n  }\n\n  async _checkProjection(e) {\n    try {\n      await g(m, e);\n    } catch {\n      throw new t(\"csv-layer:projection-not-supported\", \"Projection not supported\");\n    }\n  }\n\n}\n\nfunction D(e, i) {\n  const n = i.parsingOptions || {},\n        r = {\n    delimiter: n.delimiter,\n    layerDefinition: null,\n    locationInfo: {\n      latitudeFieldName: n.latitudeField,\n      longitudeFieldName: n.longitudeField\n    }\n  },\n        s = _(e);\n\n  let o = s.next().value;\n  if (!o) throw new t(\"csv-layer:empty-csv\", \"CSV is empty\", {\n    csv: e\n  });\n\n  if (o = o.trim(), !n.delimiter) {\n    const e = N(o);\n    if (!e) throw new t(\"csv-layer:invalid-delimiter\", \"Unable to detect the delimiter from CSV\");\n    r.delimiter = e;\n  }\n\n  const l = o.split(r.delimiter).filter(e => !!e),\n        u = r.layerDefinition = {\n    name: a(i.url, S) || \"csv\",\n    drawingInfo: j,\n    geometryType: \"esriGeometryPoint\",\n    objectIdField: null,\n    fields: [],\n    timeInfo: n.timeInfo,\n    extent: {\n      xmin: Number.POSITIVE_INFINITY,\n      ymin: Number.POSITIVE_INFINITY,\n      xmax: Number.NEGATIVE_INFINITY,\n      ymax: Number.NEGATIVE_INFINITY,\n      spatialReference: n.spatialReference || {\n        wkid: 102100\n      }\n    }\n  };\n\n  if (!n.latitudeField || !n.longitudeField) {\n    const e = P(l);\n    if (!n.longitudeField && !e.longitudeFieldName || !n.latitudeField && !e.latitudeFieldName) throw new t(\"csv-layer:location-fields-not-found\", \"Unable to identify latitude and longitude fields from the CSV file\");\n    r.locationInfo = {\n      longitudeFieldName: n.longitudeField || e.longitudeFieldName,\n      latitudeFieldName: n.latitudeField || e.latitudeFieldName\n    };\n  }\n\n  const d = V(s, r.delimiter, l, r.locationInfo);\n\n  if (n.fields && n.fields.length) {\n    const e = new Map();\n\n    for (const t of n.fields) e.set(t.name.toLowerCase(), t);\n\n    for (const t of d) {\n      const i = e.get(t.name.toLowerCase());\n\n      if (i) {\n        const e = t.name;\n        Object.assign(t, i), t.name = e;\n      }\n    }\n  }\n\n  u.fields = d;\n\n  if (!u.fields.some(e => \"esriFieldTypeOID\" === e.type && (u.objectIdField = e.name, !0))) {\n    const e = {\n      name: \"__OBJECTID\",\n      alias: \"__OBJECTID\",\n      type: \"esriFieldTypeOID\",\n      editable: !1,\n      nullable: !1\n    };\n    u.objectIdField = e.name, u.fields.unshift(e);\n  }\n\n  if (u.timeInfo) {\n    const e = new T(u.fields),\n          t = u.timeInfo;\n\n    if (t.startTimeField) {\n      const i = e.get(t.startTimeField);\n      i ? (t.startTimeField = i.name, i.type = \"esriFieldTypeDate\") : t.startTimeField = null;\n    }\n\n    if (t.endTimeField) {\n      const i = e.get(t.endTimeField);\n      i ? (t.endTimeField = i.name, i.type = \"esriFieldTypeDate\") : t.endTimeField = null;\n    }\n\n    if (t.trackIdField) {\n      const i = e.get(t.trackIdField);\n      t.trackIdField = i ? i.name : null;\n    }\n\n    t.startTimeField || t.endTimeField || (u.timeInfo = null);\n  }\n\n  return r;\n}\n\nconst O = [\"lat\", \"latitude\", \"latitude83\", \"latdecdeg\", \"lat_dd\", \"y\", \"ycenter\", \"point-y\"],\n      k = [\"lon\", \"lng\", \"long\", \"longitude\", \"longitude83\", \"longdecdeg\", \"long_dd\", \"x\", \"xcenter\", \"point-x\"];\n\nfunction P(e) {\n  const t = e.map(e => e.toLowerCase());\n  return {\n    longitudeFieldName: e[t.indexOf(k.find(e => t.includes(e)))],\n    latitudeFieldName: e[t.indexOf(O.find(e => t.includes(e)))]\n  };\n}\n\nfunction V(e, t, i, n) {\n  const r = [],\n        s = I(e, i, t),\n        o = [];\n\n  for (const a of s) {\n    if (10 === o.length) break;\n    o.push(a);\n  }\n\n  for (const a of i) if (a === n.longitudeFieldName || a === n.latitudeFieldName) r.push({\n    name: a,\n    type: \"esriFieldTypeDouble\",\n    alias: a\n  });else {\n    const e = R(o.map(e => e[a])),\n          t = {\n      name: a,\n      type: null,\n      alias: a\n    };\n\n    switch (e) {\n      case \"integer\":\n        t.type = \"esriFieldTypeInteger\";\n        break;\n\n      case \"double\":\n        t.type = \"esriFieldTypeDouble\";\n        break;\n\n      case \"date\":\n        t.type = \"esriFieldTypeDate\", t.length = 36;\n        break;\n\n      default:\n        t.type = \"esriFieldTypeString\", t.length = 255;\n    }\n\n    r.push(t);\n  }\n\n  return r;\n}\n\nfunction R(e) {\n  if (!e.length) return \"string\";\n  const t = /[^+-.,0-9]/;\n  return e.map(e => {\n    let i = !1;\n\n    if (\"\" !== e) {\n      if (t.test(e)) i = !0;else {\n        let t = M(e);\n        if (!isNaN(t)) return /[.,]/.test(e) || !Number.isInteger(t) || t > 214783647 || t < -214783648 ? \"double\" : \"integer\";\n        if (-1 === e.indexOf(\"E\")) i = !0;else {\n          if (t = Number(e), !isNaN(t)) return \"double\";\n          if (-1 === e.indexOf(\",\")) i = !0;else {\n            if (e = e.replace(\",\", \".\"), t = Number(e), !isNaN(t)) return \"double\";\n            i = !0;\n          }\n        }\n      }\n\n      if (i) {\n        if (!/^[-]?\\d*[.,]?\\d*$/.test(e)) {\n          return L(new Date(e), e) ? \"date\" : \"string\";\n        }\n\n        return \"string\";\n      }\n\n      return \"string\";\n    }\n  }).reduce((e, t) => void 0 === e || e === t ? t : \"string\" === e || \"string\" === t ? \"string\" : \"double\" === e || \"double\" === t ? \"double\" : void 0);\n}\n\nconst G = /^((jan(uary)?)|(feb(ruary)?)|(mar(ch)?)|(apr(il)?)|(may)|(jun(e)?)|(jul(y)?)|(aug(ust)?)|(sep(tember)?)|(oct(ober)?)|(nov(ember)?)|(dec(ember)?)|(am)|(pm)|(gmt)|(utc))$/i,\n      Q = Number.isNaN(new Date(\"technology 10\").getTime());\n\nfunction L(e, t) {\n  if (!e || \"[object Date]\" !== Object.prototype.toString.call(e) || isNaN(e.getTime())) return !1;\n  let i = !0;\n\n  if (!Q && /\\d+\\W*$/.test(t)) {\n    const e = t.match(/[a-zA-Z]{2,}/);\n\n    if (e) {\n      let t = !1,\n          n = 0;\n\n      for (; !t && n <= e.length;) t = !G.test(e[n]), n++;\n\n      i = !t;\n    }\n  }\n\n  return i;\n}\n\nconst M = function () {\n  const e = n(),\n        t = new RegExp(\"^\" + e.regexp + \"$\"),\n        i = new RegExp(\"[\" + e.group + \"\\\\s\\\\xa0]\", \"g\"),\n        r = e.factor;\n  return function (n) {\n    const s = t.exec(n);\n    if (e.factor = r, !s) return NaN;\n    let o = s[1];\n\n    if (!s[1]) {\n      if (!s[2]) return NaN;\n      o = s[2], e.factor *= -1;\n    }\n\n    return o = o.replace(i, \"\").replace(e.decimal, \".\"), +o * e.factor;\n  };\n}();\n\nexport { C as default, R as inferFieldType, V as inferFields, P as inferLocationInfo };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/layers/graphics/sources/support/CSVSourceWorker.js"],"names":["e","t","i","_parseInfo","n","createTask","r","isAbortError","s","urlToObject","o","getFilename","a","projectMany","l","jsonAdapter","u","equals","d","isWebMercator","c","WGS84","m","lngLatToXY","f","OptimizedFeature","p","y","h","checkProjectionSupport","g","F","readRows","_","parseRows","I","inferDelimiter","N","createDefaultAttributesFunction","w","createDrawingInfo","b","T","getFieldDefaultValue","x","E","j","S","q","v","constructor","C","_queryEngine","_snapshotFeatures","_fetch","_createFeatures","destroy","load","loadOptions","Promise","all","signal","_checkProjection","parsingOptions","spatialReference","D","locationInfo","delimiter","_createQueryEngine","featureStore","addMany","layerDefinition","extent","fullExtent","timeInfo","start","end","timeExtent","applyEdits","queryFeatures","_waitSnapshotComplete","executeQuery","queryFeatureCount","executeQueryForCount","queryObjectIds","executeQueryForIds","queryExtent","executeQueryForExtent","querySnapping","executeQueryForSnapping","refresh","customParameters","_snapshotTask","abort","promise","then","clear","getLogger","error","finished","url","path","query","responseType","data","objectIdField","fields","geometryType","hasM","hasZ","wkid","cacheSpatialQueries","latitudeFieldName","longitudeFieldName","fieldsIndex","filter","name","map","next","type","_parseCoordinateValue","isNaN","isDateField","Date","L","getTime","isNumericField","M","push","length","Math","abs","parseFloat","latitudeField","longitudeField","value","csv","trim","split","drawingInfo","xmin","Number","POSITIVE_INFINITY","ymin","xmax","NEGATIVE_INFINITY","ymax","P","V","Map","set","toLowerCase","get","Object","assign","some","alias","editable","nullable","unshift","startTimeField","endTimeField","trackIdField","O","k","indexOf","find","includes","R","test","isInteger","replace","reduce","G","Q","prototype","toString","call","match","RegExp","regexp","group","factor","exec","NaN","decimal","default","inferFieldType","inferFields","inferLocationInfo"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport\"../../../../geometry.js\";import e from\"../../../../request.js\";import t from\"../../../../core/Error.js\";import i from\"../../../../core/Logger.js\";import{_parseInfo as n}from\"../../../../core/number.js\";import{createTask as r,isAbortError as s}from\"../../../../core/promiseUtils.js\";import{urlToObject as o,getFilename as a}from\"../../../../core/urlUtils.js\";import{projectMany as l}from\"../../../../geometry/projection.js\";import{jsonAdapter as u}from\"../../../../geometry/geometryAdapters/json.js\";import{equals as d,isWebMercator as c,WGS84 as m}from\"../../../../geometry/support/spatialReferenceUtils.js\";import{lngLatToXY as f}from\"../../../../geometry/support/webMercatorUtils.js\";import{OptimizedFeature as p}from\"../../OptimizedFeature.js\";import y from\"../../OptimizedGeometry.js\";import h from\"../../data/FeatureStore.js\";import{checkProjectionSupport as g}from\"../../data/projectionSupport.js\";import F from\"../../data/QueryEngine.js\";import{readRows as _,parseRows as I,inferDelimiter as N}from\"../csv/csv.js\";import{createDefaultAttributesFunction as w,createDrawingInfo as b}from\"./clientSideDefaults.js\";import T from\"../../../support/FieldsIndex.js\";import{getFieldDefaultValue as x}from\"../../../support/fieldUtils.js\";import E from\"../../../../geometry/SpatialReference.js\";const j=b(\"esriGeometryPoint\"),S=[\"csv\"],q=[0,0];class v{constructor(e,t){this.x=e,this.y=t}}class C{constructor(){this._queryEngine=null,this._snapshotFeatures=async e=>{const t=await this._fetch(e);return this._createFeatures(t)}}destroy(){var e;null==(e=this._queryEngine)||e.destroy(),this._queryEngine=null}async load(e,t={}){var i;this.loadOptions=e;const[n]=await Promise.all([this._fetch(t.signal),this._checkProjection(null==e||null==(i=e.parsingOptions)?void 0:i.spatialReference)]),r=D(n,e);this.locationInfo=r.locationInfo,this.delimiter=r.delimiter,this._queryEngine=this._createQueryEngine(r);const s=await this._createFeatures(n);if(this._queryEngine.featureStore.addMany(s),r.layerDefinition.extent=this._queryEngine.fullExtent,r.layerDefinition.timeInfo){const{start:e,end:t}=this._queryEngine.timeExtent;r.layerDefinition.timeInfo.timeExtent=[e,t]}return r}async applyEdits(){throw new t(\"csv-layer:editing-not-supported\",\"applyEdits() is not supported on CSVLayer\")}async queryFeatures(e={},t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQuery(e,t.signal)}async queryFeatureCount(e={},t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForCount(e,t.signal)}async queryObjectIds(e={},t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForIds(e,t.signal)}async queryExtent(e={},t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForExtent(e,t.signal)}async querySnapping(e,t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForSnapping(e,t.signal)}async refresh(e){var n;return this.loadOptions.customParameters=e,null==(n=this._snapshotTask)||n.abort(),this._snapshotTask=r(this._snapshotFeatures),this._snapshotTask.promise.then((e=>{this._queryEngine.featureStore.clear(),e&&this._queryEngine.featureStore.addMany(e)}),(e=>{this._queryEngine.featureStore.clear(),s(e)||i.getLogger(\"esri.layers.CSVLayer\").error(new t(\"csv-layer:refresh\",\"An error occurred during refresh\",{error:e}))})),await this._waitSnapshotComplete(),{extent:this._queryEngine.fullExtent,timeExtent:this._queryEngine.timeExtent}}async _waitSnapshotComplete(){if(this._snapshotTask&&!this._snapshotTask.finished){try{await this._snapshotTask.promise}catch{}return this._waitSnapshotComplete()}}async _fetch(i){const{url:n,customParameters:r}=this.loadOptions;if(!n)throw new t(\"csv-layer:invalid-source\",\"url not defined\");const s=o(n);return(await e(s.path,{query:{...s.query,...r},responseType:\"text\",signal:i})).data}_createQueryEngine(e){const{objectIdField:t,fields:i,extent:n,timeInfo:r}=e.layerDefinition,s=new h({geometryType:\"esriGeometryPoint\",hasM:!1,hasZ:!1});return new F({fields:i,geometryType:\"esriGeometryPoint\",hasM:!1,hasZ:!1,timeInfo:r,objectIdField:t,spatialReference:n.spatialReference||{wkid:4326},cacheSpatialQueries:!0,featureStore:s})}async _createFeatures(e){const{latitudeFieldName:t,longitudeFieldName:i}=this.locationInfo,{objectIdField:n,fieldsIndex:r,spatialReference:s}=this._queryEngine;let o=[];const a=[],m=r.fields.filter((e=>e.name!==n)).map((e=>e.name));let h=0;const g=_(e);g.next();const F={};for(const l of r.fields)if(\"esriFieldTypeOID\"!==l.type&&\"esriFieldTypeGlobalID\"!==l.type){const e=x(l);void 0!==e&&(F[l.name]=e)}const N=I(g,m,this.delimiter,w(F,n));for(const l of N){const e=this._parseCoordinateValue(l[t]),s=this._parseCoordinateValue(l[i]);if(null!=s&&null!=e&&!isNaN(e)&&!isNaN(s)){l[t]=e,l[i]=s;for(const e in l)if(e!==t&&e!==i)if(r.isDateField(e)){const t=new Date(l[e]);l[e]=L(t,l[e])?t.getTime():null}else if(r.isNumericField(e)){const t=M(l[e]);isNaN(t)?l[e]=null:l[e]=t}l[n]=h,h++,o.push(new v(s,e)),a.push(l)}}if(!d({wkid:4326},s))if(c(s))for(const l of o)[l.x,l.y]=f(l.x,l.y,q);else o=l(u,o,E.WGS84,s,null);const b=[];for(let l=0;l<o.length;l++){const{x:e,y:t}=o[l],i=a[l];i[n]=l+1,b.push(new p(new y([],[e,t]),i,null,i[n]))}return b}_parseCoordinateValue(e){if(null==e||\"\"===e)return null;let t=M(e);return(isNaN(t)||Math.abs(t)>181)&&(t=parseFloat(e)),t}async _checkProjection(e){try{await g(m,e)}catch{throw new t(\"csv-layer:projection-not-supported\",\"Projection not supported\")}}}function D(e,i){const n=i.parsingOptions||{},r={delimiter:n.delimiter,layerDefinition:null,locationInfo:{latitudeFieldName:n.latitudeField,longitudeFieldName:n.longitudeField}},s=_(e);let o=s.next().value;if(!o)throw new t(\"csv-layer:empty-csv\",\"CSV is empty\",{csv:e});if(o=o.trim(),!n.delimiter){const e=N(o);if(!e)throw new t(\"csv-layer:invalid-delimiter\",\"Unable to detect the delimiter from CSV\");r.delimiter=e}const l=o.split(r.delimiter).filter((e=>!!e)),u=r.layerDefinition={name:a(i.url,S)||\"csv\",drawingInfo:j,geometryType:\"esriGeometryPoint\",objectIdField:null,fields:[],timeInfo:n.timeInfo,extent:{xmin:Number.POSITIVE_INFINITY,ymin:Number.POSITIVE_INFINITY,xmax:Number.NEGATIVE_INFINITY,ymax:Number.NEGATIVE_INFINITY,spatialReference:n.spatialReference||{wkid:102100}}};if(!n.latitudeField||!n.longitudeField){const e=P(l);if(!n.longitudeField&&!e.longitudeFieldName||!n.latitudeField&&!e.latitudeFieldName)throw new t(\"csv-layer:location-fields-not-found\",\"Unable to identify latitude and longitude fields from the CSV file\");r.locationInfo={longitudeFieldName:n.longitudeField||e.longitudeFieldName,latitudeFieldName:n.latitudeField||e.latitudeFieldName}}const d=V(s,r.delimiter,l,r.locationInfo);if(n.fields&&n.fields.length){const e=new Map;for(const t of n.fields)e.set(t.name.toLowerCase(),t);for(const t of d){const i=e.get(t.name.toLowerCase());if(i){const e=t.name;Object.assign(t,i),t.name=e}}}u.fields=d;if(!u.fields.some((e=>\"esriFieldTypeOID\"===e.type&&(u.objectIdField=e.name,!0)))){const e={name:\"__OBJECTID\",alias:\"__OBJECTID\",type:\"esriFieldTypeOID\",editable:!1,nullable:!1};u.objectIdField=e.name,u.fields.unshift(e)}if(u.timeInfo){const e=new T(u.fields),t=u.timeInfo;if(t.startTimeField){const i=e.get(t.startTimeField);i?(t.startTimeField=i.name,i.type=\"esriFieldTypeDate\"):t.startTimeField=null}if(t.endTimeField){const i=e.get(t.endTimeField);i?(t.endTimeField=i.name,i.type=\"esriFieldTypeDate\"):t.endTimeField=null}if(t.trackIdField){const i=e.get(t.trackIdField);t.trackIdField=i?i.name:null}t.startTimeField||t.endTimeField||(u.timeInfo=null)}return r}const O=[\"lat\",\"latitude\",\"latitude83\",\"latdecdeg\",\"lat_dd\",\"y\",\"ycenter\",\"point-y\"],k=[\"lon\",\"lng\",\"long\",\"longitude\",\"longitude83\",\"longdecdeg\",\"long_dd\",\"x\",\"xcenter\",\"point-x\"];function P(e){const t=e.map((e=>e.toLowerCase()));return{longitudeFieldName:e[t.indexOf(k.find((e=>t.includes(e))))],latitudeFieldName:e[t.indexOf(O.find((e=>t.includes(e))))]}}function V(e,t,i,n){const r=[],s=I(e,i,t),o=[];for(const a of s){if(10===o.length)break;o.push(a)}for(const a of i)if(a===n.longitudeFieldName||a===n.latitudeFieldName)r.push({name:a,type:\"esriFieldTypeDouble\",alias:a});else{const e=R(o.map((e=>e[a]))),t={name:a,type:null,alias:a};switch(e){case\"integer\":t.type=\"esriFieldTypeInteger\";break;case\"double\":t.type=\"esriFieldTypeDouble\";break;case\"date\":t.type=\"esriFieldTypeDate\",t.length=36;break;default:t.type=\"esriFieldTypeString\",t.length=255}r.push(t)}return r}function R(e){if(!e.length)return\"string\";const t=/[^+-.,0-9]/;return e.map((e=>{let i=!1;if(\"\"!==e){if(t.test(e))i=!0;else{let t=M(e);if(!isNaN(t))return/[.,]/.test(e)||!Number.isInteger(t)||t>214783647||t<-214783648?\"double\":\"integer\";if(-1===e.indexOf(\"E\"))i=!0;else{if(t=Number(e),!isNaN(t))return\"double\";if(-1===e.indexOf(\",\"))i=!0;else{if(e=e.replace(\",\",\".\"),t=Number(e),!isNaN(t))return\"double\";i=!0}}}if(i){if(!/^[-]?\\d*[.,]?\\d*$/.test(e)){return L(new Date(e),e)?\"date\":\"string\"}return\"string\"}return\"string\"}})).reduce(((e,t)=>void 0===e||e===t?t:\"string\"===e||\"string\"===t?\"string\":\"double\"===e||\"double\"===t?\"double\":void 0))}const G=/^((jan(uary)?)|(feb(ruary)?)|(mar(ch)?)|(apr(il)?)|(may)|(jun(e)?)|(jul(y)?)|(aug(ust)?)|(sep(tember)?)|(oct(ober)?)|(nov(ember)?)|(dec(ember)?)|(am)|(pm)|(gmt)|(utc))$/i,Q=Number.isNaN(new Date(\"technology 10\").getTime());function L(e,t){if(!e||\"[object Date]\"!==Object.prototype.toString.call(e)||isNaN(e.getTime()))return!1;let i=!0;if(!Q&&/\\d+\\W*$/.test(t)){const e=t.match(/[a-zA-Z]{2,}/);if(e){let t=!1,n=0;for(;!t&&n<=e.length;)t=!G.test(e[n]),n++;i=!t}}return i}const M=function(){const e=n(),t=new RegExp(\"^\"+e.regexp+\"$\"),i=new RegExp(\"[\"+e.group+\"\\\\s\\\\xa0]\",\"g\"),r=e.factor;return function(n){const s=t.exec(n);if(e.factor=r,!s)return NaN;let o=s[1];if(!s[1]){if(!s[2])return NaN;o=s[2],e.factor*=-1}return o=o.replace(i,\"\").replace(e.decimal,\".\"),+o*e.factor}}();export{C as default,R as inferFieldType,V as inferFields,P as inferLocationInfo};\n"]},"metadata":{},"sourceType":"module"}