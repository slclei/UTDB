{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport { PathTransformationCursor as e, getCoord2D as t, reversePath as n } from \"../CIMCursor.js\";\nimport { CurveHelper as i } from \"../CurveHelper.js\";\nimport { PlacementOnLineRelativeTo as s } from \"../enums.js\";\nconst r = .001;\n\nclass l {\n  static local() {\n    return null === l.instance && (l.instance = new l()), l.instance;\n  }\n\n  execute(e, t, n, i) {\n    return new o(e, t, n);\n  }\n\n}\n\nl.instance = null;\n\nclass o extends e {\n  constructor(e, t, n) {\n    super(e, !0, !0), this._curveHelper = new i(), this._angleToLine = void 0 === t.angleToLine || t.angleToLine, this._offset = void 0 !== t.offset ? t.offset * n : 0, this._relativeTo = t.relativeTo, this._position = void 0 !== t.startPointOffset ? t.startPointOffset * n : 0, this._epsilon = r * n;\n  }\n\n  processPath(e) {\n    const i = this._position;\n\n    if (this._relativeTo === s.SegmentMidpoint) {\n      for (this.iteratePath || (this._segmentCount = e.length, this._curSegment = 1, this.iteratePath = !0); this._curSegment < this._segmentCount;) {\n        const n = this._curSegment;\n        this._curSegment++;\n\n        const i = e[n - 1],\n              s = e[n],\n              r = this._curveHelper.calculateLength(i, s);\n\n        if (r < this._epsilon) continue;\n\n        const l = .5 + this._position / r,\n              [o, a] = this._curveHelper.getAngleCS(i, s, l),\n              h = t(i, s, l);\n\n        return this.internalPlacement.setTranslate(h[0] - this._offset * a, h[1] + this._offset * o), this._angleToLine && this.internalPlacement.setRotateCS(o, a), this.internalPlacement;\n      }\n\n      return this.iteratePath = !1, null;\n    }\n\n    this._relativeTo === s.LineEnd && n(e);\n    const r = this.onLine(e, i);\n    return this._relativeTo === s.LineEnd && n(e), r;\n  }\n\n  onLine(e, n) {\n    let i,\n        r = !1;\n\n    switch (this._relativeTo) {\n      case s.LineMiddle:\n      default:\n        i = this._curveHelper.calculatePathLength(e) / 2 + n;\n        break;\n\n      case s.LineBeginning:\n        i = n;\n        break;\n\n      case s.LineEnd:\n        i = n, r = !0;\n    }\n\n    const l = e.length;\n    let o,\n        a = 0,\n        h = e[0];\n\n    for (let s = 1; s < l; ++s) {\n      o = h, h = e[s];\n\n      const n = this._curveHelper.calculateLength(o, h);\n\n      if (a + n > i) {\n        const e = (i - a) / n,\n              [s, l] = this._curveHelper.getAngleCS(o, h, e),\n              c = t(o, h, e),\n              u = r ? -this._offset : this._offset;\n\n        return this.internalPlacement.setTranslate(c[0] - u * l, c[1] + u * s), this._angleToLine && (r ? this.internalPlacement.setRotateCS(-s, -l) : this.internalPlacement.setRotateCS(s, l)), this.internalPlacement;\n      }\n\n      a += n;\n    }\n\n    return null;\n  }\n\n}\n\nexport { l as PlacementOnLine };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/symbols/cim/placements/PlacementOnLine.js"],"names":["PathTransformationCursor","e","getCoord2D","t","reversePath","n","CurveHelper","i","PlacementOnLineRelativeTo","s","r","l","local","instance","execute","o","constructor","_curveHelper","_angleToLine","angleToLine","_offset","offset","_relativeTo","relativeTo","_position","startPointOffset","_epsilon","processPath","SegmentMidpoint","iteratePath","_segmentCount","length","_curSegment","calculateLength","a","getAngleCS","h","internalPlacement","setTranslate","setRotateCS","LineEnd","onLine","LineMiddle","calculatePathLength","LineBeginning","c","u","PlacementOnLine"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{PathTransformationCursor as e,getCoord2D as t,reversePath as n}from\"../CIMCursor.js\";import{CurveHelper as i}from\"../CurveHelper.js\";import{PlacementOnLineRelativeTo as s}from\"../enums.js\";const r=.001;class l{static local(){return null===l.instance&&(l.instance=new l),l.instance}execute(e,t,n,i){return new o(e,t,n)}}l.instance=null;class o extends e{constructor(e,t,n){super(e,!0,!0),this._curveHelper=new i,this._angleToLine=void 0===t.angleToLine||t.angleToLine,this._offset=void 0!==t.offset?t.offset*n:0,this._relativeTo=t.relativeTo,this._position=void 0!==t.startPointOffset?t.startPointOffset*n:0,this._epsilon=r*n}processPath(e){const i=this._position;if(this._relativeTo===s.SegmentMidpoint){for(this.iteratePath||(this._segmentCount=e.length,this._curSegment=1,this.iteratePath=!0);this._curSegment<this._segmentCount;){const n=this._curSegment;this._curSegment++;const i=e[n-1],s=e[n],r=this._curveHelper.calculateLength(i,s);if(r<this._epsilon)continue;const l=.5+this._position/r,[o,a]=this._curveHelper.getAngleCS(i,s,l),h=t(i,s,l);return this.internalPlacement.setTranslate(h[0]-this._offset*a,h[1]+this._offset*o),this._angleToLine&&this.internalPlacement.setRotateCS(o,a),this.internalPlacement}return this.iteratePath=!1,null}this._relativeTo===s.LineEnd&&n(e);const r=this.onLine(e,i);return this._relativeTo===s.LineEnd&&n(e),r}onLine(e,n){let i,r=!1;switch(this._relativeTo){case s.LineMiddle:default:i=this._curveHelper.calculatePathLength(e)/2+n;break;case s.LineBeginning:i=n;break;case s.LineEnd:i=n,r=!0}const l=e.length;let o,a=0,h=e[0];for(let s=1;s<l;++s){o=h,h=e[s];const n=this._curveHelper.calculateLength(o,h);if(a+n>i){const e=(i-a)/n,[s,l]=this._curveHelper.getAngleCS(o,h,e),c=t(o,h,e),u=r?-this._offset:this._offset;return this.internalPlacement.setTranslate(c[0]-u*l,c[1]+u*s),this._angleToLine&&(r?this.internalPlacement.setRotateCS(-s,-l):this.internalPlacement.setRotateCS(s,l)),this.internalPlacement}a+=n}return null}}export{l as PlacementOnLine};\n"]},"metadata":{},"sourceType":"module"}