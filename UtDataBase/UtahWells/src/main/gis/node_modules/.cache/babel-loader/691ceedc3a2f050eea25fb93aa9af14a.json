{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport { px2pt as e } from \"../../core/screenUtils.js\";\nimport { CIMSymbolRasterizer as t } from \"../cim/CIMSymbolRasterizer.js\";\nimport { getCIMSymbolSize as l, scaleCIMSymbolTo as i } from \"./cimSymbolUtils.js\";\nimport { SymbolSizeDefaults as a } from \"./previewUtils.js\";\nimport { renderSymbol as o } from \"./renderUtils.js\";\nconst n = new t(null, !0),\n      s = a.maxSize;\n\nasync function r(t) {\n  let a = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  const {\n    size: r,\n    maxSize: c,\n    node: m,\n    opacity: f\n  } = a,\n        p = a.cimOptions || a,\n        {\n    feature: u,\n    fieldMap: y,\n    geometryType: h,\n    style: d\n  } = p,\n        g = l(t),\n        w = \"number\" == typeof r ? r : null,\n        b = Math.min(null != w ? w : g, null != c ? c : e(s));\n  b !== g && (t = t.clone(), i(t, b, {\n    preserveOutlineWidth: !0\n  }));\n  let M = 3;\n  t && t.data && t.data.symbol && \"CIMPointSymbol\" !== t.data.symbol.type && (M = 1);\n  const S = await n.rasterizeCIMSymbolAsync(t, u, y, h, {\n    scaleFactor: M,\n    style: d\n  }),\n        j = document.createElement(\"canvas\");\n  j.width = S.imageData.width, j.height = S.imageData.height;\n  j.getContext(\"2d\").putImageData(S.imageData, 0, 0);\n  let v = j.width / M,\n      x = j.height / M;\n\n  if (null != r && (null == (null == a ? void 0 : a.scale) || (null == a ? void 0 : a.scale))) {\n    const e = v / x;\n    v = e <= 1 ? Math.ceil(b * e) : b, x = e <= 1 ? b : Math.ceil(b / e);\n  }\n\n  const z = new Image(v, x);\n  z.src = j.toDataURL(), null != f && (z.style.opacity = `${f}`);\n  let C = z;\n\n  if (null != a.effectView) {\n    const e = {\n      shape: {\n        type: \"image\",\n        x: 0,\n        y: 0,\n        width: v,\n        height: x,\n        src: z.src\n      },\n      fill: null,\n      stroke: null,\n      offset: [0, 0]\n    };\n    C = o([[e]], [v, x], {\n      effectView: a.effectView\n    });\n  }\n\n  return m && m.appendChild(C), C;\n}\n\nexport { r as previewCIMSymbol };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/symbols/support/previewCIMSymbol.js"],"names":["px2pt","e","CIMSymbolRasterizer","t","getCIMSymbolSize","l","scaleCIMSymbolTo","i","SymbolSizeDefaults","a","renderSymbol","o","n","s","maxSize","r","size","c","node","m","opacity","f","p","cimOptions","feature","u","fieldMap","y","geometryType","h","style","d","g","w","b","Math","min","clone","preserveOutlineWidth","M","data","symbol","type","S","rasterizeCIMSymbolAsync","scaleFactor","j","document","createElement","width","imageData","height","getContext","putImageData","v","x","scale","ceil","z","Image","src","toDataURL","C","effectView","shape","fill","stroke","offset","appendChild","previewCIMSymbol"],"mappings":"AAAA;AACA;AACA;AACA;AACA,SAAOA,KAAK,IAAIC,CAAhB,QAAsB,2BAAtB;AAAkD,SAAOC,mBAAmB,IAAIC,CAA9B,QAAoC,+BAApC;AAAoE,SAAOC,gBAAgB,IAAIC,CAA3B,EAA6BC,gBAAgB,IAAIC,CAAjD,QAAuD,qBAAvD;AAA6E,SAAOC,kBAAkB,IAAIC,CAA7B,QAAmC,mBAAnC;AAAuD,SAAOC,YAAY,IAAIC,CAAvB,QAA6B,kBAA7B;AAAgD,MAAMC,CAAC,GAAC,IAAIT,CAAJ,CAAM,IAAN,EAAW,CAAC,CAAZ,CAAR;AAAA,MAAuBU,CAAC,GAACJ,CAAC,CAACK,OAA3B;;AAAmC,eAAeC,CAAf,CAAiBZ,CAAjB,EAAwB;AAAA,MAALM,CAAK,uEAAH,EAAG;AAAC,QAAK;AAACO,IAAAA,IAAI,EAACD,CAAN;AAAQD,IAAAA,OAAO,EAACG,CAAhB;AAAkBC,IAAAA,IAAI,EAACC,CAAvB;AAAyBC,IAAAA,OAAO,EAACC;AAAjC,MAAoCZ,CAAzC;AAAA,QAA2Ca,CAAC,GAACb,CAAC,CAACc,UAAF,IAAcd,CAA3D;AAAA,QAA6D;AAACe,IAAAA,OAAO,EAACC,CAAT;AAAWC,IAAAA,QAAQ,EAACC,CAApB;AAAsBC,IAAAA,YAAY,EAACC,CAAnC;AAAqCC,IAAAA,KAAK,EAACC;AAA3C,MAA8CT,CAA3G;AAAA,QAA6GU,CAAC,GAAC3B,CAAC,CAACF,CAAD,CAAhH;AAAA,QAAoH8B,CAAC,GAAC,YAAU,OAAOlB,CAAjB,GAAmBA,CAAnB,GAAqB,IAA3I;AAAA,QAAgJmB,CAAC,GAACC,IAAI,CAACC,GAAL,CAAS,QAAMH,CAAN,GAAQA,CAAR,GAAUD,CAAnB,EAAqB,QAAMf,CAAN,GAAQA,CAAR,GAAUhB,CAAC,CAACY,CAAD,CAAhC,CAAlJ;AAAuLqB,EAAAA,CAAC,KAAGF,CAAJ,KAAQ7B,CAAC,GAACA,CAAC,CAACkC,KAAF,EAAF,EAAY9B,CAAC,CAACJ,CAAD,EAAG+B,CAAH,EAAK;AAACI,IAAAA,oBAAoB,EAAC,CAAC;AAAvB,GAAL,CAArB;AAAsD,MAAIC,CAAC,GAAC,CAAN;AAAQpC,EAAAA,CAAC,IAAEA,CAAC,CAACqC,IAAL,IAAWrC,CAAC,CAACqC,IAAF,CAAOC,MAAlB,IAA0B,qBAAmBtC,CAAC,CAACqC,IAAF,CAAOC,MAAP,CAAcC,IAA3D,KAAkEH,CAAC,GAAC,CAApE;AAAuE,QAAMI,CAAC,GAAC,MAAM/B,CAAC,CAACgC,uBAAF,CAA0BzC,CAA1B,EAA4BsB,CAA5B,EAA8BE,CAA9B,EAAgCE,CAAhC,EAAkC;AAACgB,IAAAA,WAAW,EAACN,CAAb;AAAeT,IAAAA,KAAK,EAACC;AAArB,GAAlC,CAAd;AAAA,QAAyEe,CAAC,GAACC,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAA3E;AAA4GF,EAAAA,CAAC,CAACG,KAAF,GAAQN,CAAC,CAACO,SAAF,CAAYD,KAApB,EAA0BH,CAAC,CAACK,MAAF,GAASR,CAAC,CAACO,SAAF,CAAYC,MAA/C;AAAsDL,EAAAA,CAAC,CAACM,UAAF,CAAa,IAAb,EAAmBC,YAAnB,CAAgCV,CAAC,CAACO,SAAlC,EAA4C,CAA5C,EAA8C,CAA9C;AAAiD,MAAII,CAAC,GAACR,CAAC,CAACG,KAAF,GAAQV,CAAd;AAAA,MAAgBgB,CAAC,GAACT,CAAC,CAACK,MAAF,GAASZ,CAA3B;;AAA6B,MAAG,QAAMxB,CAAN,KAAU,SAAO,QAAMN,CAAN,GAAQ,KAAK,CAAb,GAAeA,CAAC,CAAC+C,KAAxB,MAAiC,QAAM/C,CAAN,GAAQ,KAAK,CAAb,GAAeA,CAAC,CAAC+C,KAAlD,CAAV,CAAH,EAAuE;AAAC,UAAMvD,CAAC,GAACqD,CAAC,GAACC,CAAV;AAAYD,IAAAA,CAAC,GAACrD,CAAC,IAAE,CAAH,GAAKkC,IAAI,CAACsB,IAAL,CAAUvB,CAAC,GAACjC,CAAZ,CAAL,GAAoBiC,CAAtB,EAAwBqB,CAAC,GAACtD,CAAC,IAAE,CAAH,GAAKiC,CAAL,GAAOC,IAAI,CAACsB,IAAL,CAAUvB,CAAC,GAACjC,CAAZ,CAAjC;AAAgD;;AAAA,QAAMyD,CAAC,GAAC,IAAIC,KAAJ,CAAUL,CAAV,EAAYC,CAAZ,CAAR;AAAuBG,EAAAA,CAAC,CAACE,GAAF,GAAMd,CAAC,CAACe,SAAF,EAAN,EAAoB,QAAMxC,CAAN,KAAUqC,CAAC,CAAC5B,KAAF,CAAQV,OAAR,GAAiB,GAAEC,CAAE,EAA/B,CAApB;AAAsD,MAAIyC,CAAC,GAACJ,CAAN;;AAAQ,MAAG,QAAMjD,CAAC,CAACsD,UAAX,EAAsB;AAAC,UAAM9D,CAAC,GAAC;AAAC+D,MAAAA,KAAK,EAAC;AAACtB,QAAAA,IAAI,EAAC,OAAN;AAAca,QAAAA,CAAC,EAAC,CAAhB;AAAkB5B,QAAAA,CAAC,EAAC,CAApB;AAAsBsB,QAAAA,KAAK,EAACK,CAA5B;AAA8BH,QAAAA,MAAM,EAACI,CAArC;AAAuCK,QAAAA,GAAG,EAACF,CAAC,CAACE;AAA7C,OAAP;AAAyDK,MAAAA,IAAI,EAAC,IAA9D;AAAmEC,MAAAA,MAAM,EAAC,IAA1E;AAA+EC,MAAAA,MAAM,EAAC,CAAC,CAAD,EAAG,CAAH;AAAtF,KAAR;AAAqGL,IAAAA,CAAC,GAACnD,CAAC,CAAC,CAAC,CAACV,CAAD,CAAD,CAAD,EAAO,CAACqD,CAAD,EAAGC,CAAH,CAAP,EAAa;AAACQ,MAAAA,UAAU,EAACtD,CAAC,CAACsD;AAAd,KAAb,CAAH;AAA2C;;AAAA,SAAO5C,CAAC,IAAEA,CAAC,CAACiD,WAAF,CAAcN,CAAd,CAAH,EAAoBA,CAA3B;AAA6B;;AAAA,SAAO/C,CAAC,IAAIsD,gBAAZ","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{px2pt as e}from\"../../core/screenUtils.js\";import{CIMSymbolRasterizer as t}from\"../cim/CIMSymbolRasterizer.js\";import{getCIMSymbolSize as l,scaleCIMSymbolTo as i}from\"./cimSymbolUtils.js\";import{SymbolSizeDefaults as a}from\"./previewUtils.js\";import{renderSymbol as o}from\"./renderUtils.js\";const n=new t(null,!0),s=a.maxSize;async function r(t,a={}){const{size:r,maxSize:c,node:m,opacity:f}=a,p=a.cimOptions||a,{feature:u,fieldMap:y,geometryType:h,style:d}=p,g=l(t),w=\"number\"==typeof r?r:null,b=Math.min(null!=w?w:g,null!=c?c:e(s));b!==g&&(t=t.clone(),i(t,b,{preserveOutlineWidth:!0}));let M=3;t&&t.data&&t.data.symbol&&\"CIMPointSymbol\"!==t.data.symbol.type&&(M=1);const S=await n.rasterizeCIMSymbolAsync(t,u,y,h,{scaleFactor:M,style:d}),j=document.createElement(\"canvas\");j.width=S.imageData.width,j.height=S.imageData.height;j.getContext(\"2d\").putImageData(S.imageData,0,0);let v=j.width/M,x=j.height/M;if(null!=r&&(null==(null==a?void 0:a.scale)||(null==a?void 0:a.scale))){const e=v/x;v=e<=1?Math.ceil(b*e):b,x=e<=1?b:Math.ceil(b/e)}const z=new Image(v,x);z.src=j.toDataURL(),null!=f&&(z.style.opacity=`${f}`);let C=z;if(null!=a.effectView){const e={shape:{type:\"image\",x:0,y:0,width:v,height:x,src:z.src},fill:null,stroke:null,offset:[0,0]};C=o([[e]],[v,x],{effectView:a.effectView})}return m&&m.appendChild(C),C}export{r as previewCIMSymbol};\n"]},"metadata":{},"sourceType":"module"}