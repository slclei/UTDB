{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../chunks/tslib.es6.js\";\nimport \"../../geometry.js\";\nimport t from \"../../Graphic.js\";\nimport \"../../symbols.js\";\nimport s from \"../../core/Collection.js\";\nimport i from \"../../core/Error.js\";\nimport o from \"../../core/Handles.js\";\nimport r from \"../../core/Logger.js\";\nimport { unwrap as n, isNone as a } from \"../../core/maybe.js\";\nimport { init as l, watch as u, whenFalse as h } from \"../../core/watchUtils.js\";\nimport { property as c } from \"../../core/accessorSupport/decorators/property.js\";\nimport \"../../core/arrayUtils.js\";\nimport \"../../core/has.js\";\nimport \"../../core/accessorSupport/ensureType.js\";\nimport { subclass as p } from \"../../core/accessorSupport/decorators/subclass.js\";\nimport { geographicToWebMercator as d } from \"../../geometry/support/webMercatorUtils.js\";\nimport g from \"../../layers/Layer.js\";\nimport f from \"../../support/actions/ActionBase.js\";\nimport m from \"../../support/actions/ActionButton.js\";\nimport y from \"../../support/actions/ActionToggle.js\";\nimport { getDisplayedSymbol as w } from \"../../symbols/support/symbolUtils.js\";\nimport { ViewEventPriorities as v } from \"../../views/input/InputManager.js\";\nimport { highlightsSupported as F } from \"../../views/support/layerViewUtils.js\";\nimport _ from \"../Feature/FeatureViewModel.js\";\nimport { zoomToClusteredFeatures as b, browseClusteredFeatures as C, zoomToFeature as P } from \"./actions.js\";\nimport { triggerAction as E, getSelectedTarget as A, removeClusteredFeaturesForBrowsing as M, displayClusterExtent as j, browseAggregateFeatures as V } from \"./actionUtils.js\";\nimport O from \"../support/AnchorElementViewModel.js\";\nimport { GoToMixin as x } from \"../support/GoTo.js\";\nimport I from \"../../symbols/SimpleFillSymbol.js\";\nimport L from \"../../geometry/Point.js\";\n\nconst T = s.ofType({\n  key: \"type\",\n  defaultKeyValue: \"button\",\n  base: f,\n  typeMap: {\n    button: m,\n    toggle: y\n  }\n}),\n      S = () => [P.clone()],\n      B = () => [b.clone(), C.clone()],\n      R = \"esri.widgets.Popup.PopupViewModel\",\n      G = r.getLogger(R);\n\nlet z = class extends x(O) {\n  constructor(e) {\n    super(e), this._handles = new o(), this._pendingPromises = new Set(), this._fetchFeaturesController = null, this._selectedClusterFeature = null, this.featurePage = null, this.actions = new T(), this.defaultPopupTemplateEnabled = !1, this.autoCloseEnabled = !1, this.autoOpenEnabled = !0, this.browseClusterEnabled = !1, this.content = null, this.featuresPerPage = 20, this.featureViewModelAbilities = null, this.featureViewModels = [], this.highlightEnabled = !0, this.includeDefaultActions = !0, this.selectedClusterBoundaryFeature = new t({\n      symbol: new I({\n        outline: {\n          width: 1.5,\n          color: \"cyan\"\n        },\n        style: \"none\"\n      })\n    }), this.title = null, this.updateLocationEnabled = !1, this.view = null, this.visible = !1, this.zoomFactor = 4, this.zoomToLocation = null;\n  }\n\n  get isLoadingFeature() {\n    return this.featureViewModels.some(e => e.waitingForContent);\n  }\n\n  initialize() {\n    this._handles.add([l(this, [\"autoOpenEnabled\", \"view\"], () => this._autoOpenEnabledChange()), this.on(\"view-change\", () => this._autoClose()), u(this, [\"highlightEnabled\", \"selectedFeature\", \"visible\", \"view\"], () => this._highlightFeature()), u(this, \"view.animation.state\", e => this._animationStateChange(e)), u(this, \"location\", e => this._locationChange(e)), u(this, \"selectedFeature\", e => this._selectedFeatureChange(e)), u(this, [\"selectedFeatureIndex\", \"featureCount\", \"featuresPerPage\"], () => this._selectedFeatureIndexChange()), u(this, [\"featurePage\", \"selectedFeatureIndex\", \"featureCount\", \"featuresPerPage, featureViewModels\"], () => this._setGraphicOnFeatureViewModels()), u(this, \"featureViewModels\", () => this._featureViewModelsChange()), this.on(\"trigger-action\", e => E({\n      event: e,\n      view: this.view\n    })), h(this, \"waitingForResult\", () => this._waitingForResultChange(), !0), u(this, [\"features\", \"view\", \"view.map\", \"view.spatialReference\"], () => this._updateFeatureVMs()), u(this, [\"view.scale\"], this._viewScaleChange), h(this, \"visible\", () => this.browseClusterEnabled = !1), u(this, \"browseClusterEnabled\", e => e ? this.enableClusterBrowsing() : this.disableClusterBrowsing())]);\n  }\n\n  destroy() {\n    this._cancelFetchingFeatures(), this._handles.destroy(), this._handles = null, this._pendingPromises.clear(), this.browseClusterEnabled = !1, this.view = null;\n  }\n\n  get active() {\n    return !(!this.visible || this.waitingForResult);\n  }\n\n  get allActions() {\n    const e = this._get(\"allActions\") || new T();\n    e.removeAll();\n    const {\n      actions: t,\n      defaultActions: s,\n      defaultPopupTemplateEnabled: i,\n      includeDefaultActions: o,\n      selectedFeature: r\n    } = this,\n          n = o ? s.concat(t) : t,\n          a = r && (\"function\" == typeof r.getEffectivePopupTemplate && r.getEffectivePopupTemplate(i) || r.popupTemplate),\n          l = a && a.actions,\n          u = a && a.overwriteActions ? l : l ? l.concat(n) : n;\n    return u && u.filter(Boolean).forEach(t => e.add(t)), e;\n  }\n\n  get defaultActions() {\n    var e;\n    const t = this._get(\"defaultActions\") || new T();\n    return t.removeAll(), t.addMany(null != (e = this.selectedFeature) && e.isAggregate ? B() : S()), t;\n  }\n\n  get featureCount() {\n    return this.features.length;\n  }\n\n  get features() {\n    return this._get(\"features\") || [];\n  }\n\n  set features(e) {\n    const t = e || [];\n\n    this._set(\"features\", t);\n\n    const {\n      pendingPromisesCount: s,\n      promiseCount: i,\n      selectedFeatureIndex: o\n    } = this,\n          r = i && t.length;\n    r && s && -1 === o ? this.selectedFeatureIndex = 0 : r && -1 !== o || (this.selectedFeatureIndex = t.length ? 0 : -1);\n  }\n\n  get location() {\n    return this._get(\"location\") || null;\n  }\n\n  set location(e) {\n    const t = this.get(\"view.spatialReference.isWebMercator\");\n    e && e.get(\"spatialReference.isWGS84\") && t && (e = d(e)), this._set(\"location\", e);\n  }\n\n  get pendingPromisesCount() {\n    return this._pendingPromises.size;\n  }\n\n  get waitingForResult() {\n    return !(!(!!this._fetchFeaturesController || this.pendingPromisesCount > 0) || 0 !== this.featureCount);\n  }\n\n  get promiseCount() {\n    return this.promises.length;\n  }\n\n  get promises() {\n    return this._get(\"promises\") || [];\n  }\n\n  set promises(e) {\n    if (this._pendingPromises.clear(), this.features = [], !Array.isArray(e) || !e.length) return this._set(\"promises\", []), void this.notifyChange(\"pendingPromisesCount\");\n    this._set(\"promises\", e), (e = e.slice(0)).forEach(e => {\n      this._pendingPromises.add(e);\n\n      const t = t => {\n        this._pendingPromises.has(e) && this._updateFeatures(t), this._updatePendingPromises(e);\n      },\n            s = () => this._updatePendingPromises(e);\n\n      e.then(t, s);\n    }), this.notifyChange(\"pendingPromisesCount\");\n  }\n\n  get selectedFeature() {\n    const {\n      features: e,\n      selectedFeatureIndex: t\n    } = this;\n    if (-1 === t) return null;\n    return e[t] || null;\n  }\n\n  get selectedFeatureIndex() {\n    const e = this._get(\"selectedFeatureIndex\");\n\n    return \"number\" == typeof e ? e : -1;\n  }\n\n  set selectedFeatureIndex(e) {\n    const {\n      featureCount: t\n    } = this;\n    e = isNaN(e) || e < -1 || !t ? -1 : (e + t) % t, this._set(\"selectedFeatureIndex\", e);\n  }\n\n  get selectedFeatureViewModel() {\n    return this.featureViewModels[this.selectedFeatureIndex] || null;\n  }\n\n  get state() {\n    return this.get(\"view.ready\") ? \"ready\" : \"disabled\";\n  }\n\n  centerAtLocation() {\n    const {\n      view: e\n    } = this,\n          t = A(this);\n\n    if (!t) {\n      const s = new i(\"center-at-location:invalid-target-or-view\", \"Cannot center at a location without a target and view.\", {\n        target: t,\n        view: e\n      });\n      return G.error(s), Promise.reject(s);\n    }\n\n    return this.callGoTo({\n      target: {\n        target: t,\n        scale: e.scale\n      }\n    });\n  }\n\n  clear() {\n    this.set({\n      promises: [],\n      features: [],\n      content: null,\n      title: null,\n      location: null\n    });\n  }\n\n  fetchFeatures(e, t) {\n    const {\n      view: s\n    } = this;\n\n    if (!s || !e) {\n      const t = new i(\"fetch-features:invalid-screenpoint-or-view\", \"Cannot fetch features without a screenPoint and view.\", {\n        screenPoint: e,\n        view: s\n      });\n      return G.error(t), Promise.reject(t);\n    }\n\n    return s.fetchPopupFeatures(e, {\n      event: t && t.event,\n      defaultPopupTemplateEnabled: this.defaultPopupTemplateEnabled,\n      signal: t && t.signal\n    });\n  }\n\n  open(e) {\n    const t = {\n      updateLocationEnabled: !1,\n      promises: [],\n      fetchFeatures: !1,\n      ...e,\n      visible: !0\n    },\n          {\n      fetchFeatures: s\n    } = t;\n    delete t.fetchFeatures, s && this._setFetchFeaturesPromises(t.location);\n    const i = [\"actionsMenuOpen\", \"collapsed\", \"featureMenuOpen\"];\n\n    for (const o of i) delete t[o];\n\n    this.set(t);\n  }\n\n  triggerAction(e) {\n    const t = this.allActions.getItemAt(e);\n    t && !t.disabled && this.emit(\"trigger-action\", {\n      action: t\n    });\n  }\n\n  next() {\n    return this.selectedFeatureIndex = this.selectedFeatureIndex + 1, this;\n  }\n\n  previous() {\n    return this.selectedFeatureIndex = this.selectedFeatureIndex - 1, this;\n  }\n\n  disableClusterBrowsing() {\n    M(this), this._clearBrowsedClusterGraphics();\n  }\n\n  async enableClusterBrowsing() {\n    await j(this), await V(this);\n  }\n\n  _animationStateChange(e) {\n    this.zoomToLocation || (P.disabled = \"waiting-for-target\" === e);\n  }\n\n  _clearBrowsedClusterGraphics() {\n    var e;\n    const t = null == (e = this.view) ? void 0 : e.graphics;\n    t && (t.remove(this.selectedClusterBoundaryFeature), t.remove(this._selectedClusterFeature)), this._selectedClusterFeature = null, this.selectedClusterBoundaryFeature.geometry = null;\n  }\n\n  _viewScaleChange() {\n    var e;\n    if (null != (e = this.selectedFeature) && e.isAggregate) return this.browseClusterEnabled = !1, this.visible = !1, void this.clear();\n    this.browseClusterEnabled && (this.browseClusterEnabled = !1, this.features = [this.selectedFeature]);\n  }\n\n  _locationChange(e) {\n    const {\n      selectedFeature: t,\n      updateLocationEnabled: s\n    } = this;\n    s && e && (!t || t.geometry) && this.centerAtLocation();\n  }\n\n  _selectedFeatureIndexChange() {\n    this.featurePage = this.featureCount > 1 ? Math.floor(this.selectedFeatureIndex / this.featuresPerPage) + 1 : null;\n  }\n\n  _featureViewModelsChange() {\n    this.featurePage = this.featureCount > 1 ? 1 : null;\n  }\n\n  _setGraphicOnFeatureViewModels() {\n    const {\n      features: e,\n      featureCount: t,\n      featurePage: s,\n      featuresPerPage: i,\n      featureViewModels: o\n    } = this;\n    if (null === s) return;\n    const r = ((s - 1) * i + t) % t,\n          n = r + i;\n    o.slice(r, n).forEach((t, s) => {\n      t && !t.graphic && (t.graphic = e[r + s]);\n    });\n  }\n\n  async _selectedFeatureChange(e) {\n    if (!e) return;\n    const {\n      location: t,\n      updateLocationEnabled: s,\n      view: i\n    } = this;\n\n    if (this.browseClusterEnabled) {\n      if (this._selectedClusterFeature && (i.graphics.remove(this._selectedClusterFeature), this._selectedClusterFeature = null), e.isAggregate) return;\n      return e.symbol = await w(e), this._selectedClusterFeature = e, void i.graphics.add(this._selectedClusterFeature);\n    }\n\n    !s && t || !e.geometry ? s && !e.geometry && this.centerAtLocation().then(() => {\n      this.location = i.center.clone();\n    }) : this.location = n(this._getPointFromGeometry(e.geometry));\n  }\n\n  _waitingForResultChange() {\n    !this.featureCount && this.promises && (this.visible = !1);\n  }\n\n  _setFetchFeaturesPromises(e) {\n    return this._fetchFeaturesWithController(this._getScreenPoint(e || this.location)).then(e => {\n      const {\n        clientOnlyGraphics: t,\n        promisesPerLayerView: s\n      } = e,\n            i = Promise.resolve(t),\n            o = s.map(e => e.promise);\n      this.promises = [i, ...o];\n    });\n  }\n\n  _destroyFeatureVMs() {\n    this.featureViewModels.forEach(e => e && !e.destroyed && e.destroy()), this._set(\"featureViewModels\", []);\n  }\n\n  _updateFeatureVMs() {\n    const {\n      selectedFeature: e,\n      features: t,\n      featureViewModels: s\n    } = this;\n    if (null != e && e.isAggregate || (this.browseClusterEnabled = !1), this._destroyFeatureVMs(), !t || !t.length) return;\n    const i = s.slice(0),\n          o = [];\n    t.forEach((t, s) => {\n      if (!t) return;\n      let r = null;\n      if (i.some((e, s) => (e && e.graphic === t && (r = e, i.splice(s, 1)), !!r)), r) o[s] = r;else {\n        var n, a;\n        const i = new _({\n          abilities: this.featureViewModelAbilities,\n          defaultPopupTemplateEnabled: this.defaultPopupTemplateEnabled,\n          spatialReference: null == (n = this.view) ? void 0 : n.spatialReference,\n          graphic: t === e ? t : null,\n          map: null == (a = this.view) ? void 0 : a.map,\n          view: this.view\n        });\n        o[s] = i;\n      }\n    }), i.forEach(e => e && !e.destroyed && e.destroy()), this._set(\"featureViewModels\", o);\n  }\n\n  _getScreenPoint(e) {\n    const {\n      view: t\n    } = this;\n    return t && e && \"function\" == typeof t.toScreen ? t.toScreen(e) : null;\n  }\n\n  _autoOpenEnabledChange() {\n    const e = \"auto-fetch-features\",\n          {\n      _handles: t,\n      autoOpenEnabled: s\n    } = this;\n\n    if (t.remove(e), s && this.view) {\n      const s = this.view.on(\"click\", e => {\n        \"mouse\" === e.pointerType && 0 !== e.button || this._fetchFeaturesAndOpen(e);\n      }, v.WIDGET);\n      t.add(s, e);\n    }\n  }\n\n  _cancelFetchingFeatures() {\n    const e = this._fetchFeaturesController;\n    e && e.abort(), this._fetchFeaturesController = null, this.notifyChange(\"waitingForResult\");\n  }\n\n  _fetchFeaturesWithController(e, t) {\n    this._cancelFetchingFeatures();\n\n    const s = new AbortController(),\n          {\n      signal: i\n    } = s;\n    this._fetchFeaturesController = s, this.notifyChange(\"waitingForResult\");\n    const o = this.fetchFeatures(e, {\n      signal: i,\n      event: t\n    });\n    return o.catch(() => {}).then(() => {\n      this._fetchFeaturesController = null, this.notifyChange(\"waitingForResult\");\n    }), o;\n  }\n\n  _fetchFeaturesAndOpen(e) {\n    const {\n      screenPoint: t,\n      mapPoint: s\n    } = e,\n          {\n      view: i\n    } = this;\n\n    this._fetchFeaturesWithController(t, e).then(e => {\n      const {\n        clientOnlyGraphics: t,\n        promisesPerLayerView: o,\n        location: r\n      } = e,\n            n = [Promise.resolve(t), ...o.map(e => e.promise)];\n      return i.popup.open({\n        location: r || s,\n        promises: n\n      }), e;\n    });\n  }\n\n  _updatePendingPromises(e) {\n    e && this._pendingPromises.has(e) && (this._pendingPromises.delete(e), this.notifyChange(\"pendingPromisesCount\"));\n  }\n\n  _autoClose() {\n    this.autoCloseEnabled && (this.visible = !1);\n  }\n\n  _getPointFromGeometry(e) {\n    return a(e) ? null : \"point\" === e.type ? e : \"extent\" === e.type ? e.center : \"polygon\" === e.type ? e.centroid : \"multipoint\" === e.type || \"polyline\" === e.type ? e.extent.center : null;\n  }\n\n  async _getLayerView(e, t) {\n    return await e.when(), e.whenLayerView(t);\n  }\n\n  async _highlightFeature() {\n    const e = \"highlight\";\n\n    this._handles.remove(e);\n\n    const {\n      selectedFeature: t,\n      highlightEnabled: s,\n      view: i,\n      visible: o\n    } = this;\n    if (!(t && i && s && o)) return;\n    let {\n      layer: r,\n      sourceLayer: n\n    } = t;\n    if (\"map-notes\" !== (null == n ? void 0 : n.type) && \"subtype-group\" !== (null == n ? void 0 : n.type) || (r = n), !(r && r instanceof g)) return;\n\n    const a = this._getLayerView(i, r);\n\n    this._highlightPromise = a;\n    const l = await a;\n    if (!(l && F(l) && this._highlightPromise === a && this.selectedFeature && this.highlightEnabled && this.visible)) return;\n    const u = \"imagery\" === r.type ? void 0 : \"objectIdField\" in r && r.objectIdField,\n          h = t.attributes,\n          c = h && u && h[u],\n          p = l.highlight(c || t);\n\n    this._handles.add(p, e);\n  }\n\n  _updateFeatures(e) {\n    const {\n      features: t\n    } = this;\n    if (!e || !e.length) return;\n    if (!t.length) return void (this.features = e);\n    const s = e.filter(e => -1 === t.indexOf(e));\n    this.features = t.concat(s);\n  }\n\n};\ne([c()], z.prototype, \"featurePage\", void 0), e([c()], z.prototype, \"isLoadingFeature\", null), e([c({\n  type: T\n})], z.prototype, \"actions\", void 0), e([c({\n  readOnly: !0\n})], z.prototype, \"active\", null), e([c({\n  readOnly: !0\n})], z.prototype, \"allActions\", null), e([c({\n  type: Boolean\n})], z.prototype, \"defaultPopupTemplateEnabled\", void 0), e([c()], z.prototype, \"autoCloseEnabled\", void 0), e([c()], z.prototype, \"autoOpenEnabled\", void 0), e([c()], z.prototype, \"browseClusterEnabled\", void 0), e([c()], z.prototype, \"content\", void 0), e([c({\n  type: T,\n  readOnly: !0\n})], z.prototype, \"defaultActions\", null), e([c({\n  readOnly: !0\n})], z.prototype, \"featureCount\", null), e([c()], z.prototype, \"features\", null), e([c()], z.prototype, \"featuresPerPage\", void 0), e([c()], z.prototype, \"featureViewModelAbilities\", void 0), e([c({\n  readOnly: !0\n})], z.prototype, \"featureViewModels\", void 0), e([c()], z.prototype, \"highlightEnabled\", void 0), e([c()], z.prototype, \"includeDefaultActions\", void 0), e([c({\n  type: L\n})], z.prototype, \"location\", null), e([c({\n  readOnly: !0\n})], z.prototype, \"pendingPromisesCount\", null), e([c({\n  readOnly: !0\n})], z.prototype, \"selectedClusterBoundaryFeature\", void 0), e([c({\n  readOnly: !0\n})], z.prototype, \"waitingForResult\", null), e([c({\n  readOnly: !0\n})], z.prototype, \"promiseCount\", null), e([c()], z.prototype, \"promises\", null), e([c({\n  value: null,\n  readOnly: !0\n})], z.prototype, \"selectedFeature\", null), e([c({\n  value: -1\n})], z.prototype, \"selectedFeatureIndex\", null), e([c({\n  readOnly: !0\n})], z.prototype, \"selectedFeatureViewModel\", null), e([c({\n  readOnly: !0\n})], z.prototype, \"state\", null), e([c()], z.prototype, \"title\", void 0), e([c()], z.prototype, \"updateLocationEnabled\", void 0), e([c()], z.prototype, \"view\", void 0), e([c()], z.prototype, \"visible\", void 0), e([c()], z.prototype, \"zoomFactor\", void 0), e([c()], z.prototype, \"zoomToLocation\", void 0), e([c()], z.prototype, \"centerAtLocation\", null), z = e([p(R)], z);\nconst U = z;\nexport { U as default };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/widgets/Popup/PopupViewModel.js"],"names":["_","e","t","s","i","o","r","unwrap","n","isNone","a","init","l","watch","u","whenFalse","h","property","c","subclass","p","geographicToWebMercator","d","g","f","m","y","getDisplayedSymbol","w","ViewEventPriorities","v","highlightsSupported","F","zoomToClusteredFeatures","b","browseClusteredFeatures","C","zoomToFeature","P","triggerAction","E","getSelectedTarget","A","removeClusteredFeaturesForBrowsing","M","displayClusterExtent","j","browseAggregateFeatures","V","O","GoToMixin","x","I","L","T","ofType","key","defaultKeyValue","base","typeMap","button","toggle","S","clone","B","R","G","getLogger","z","constructor","_handles","_pendingPromises","Set","_fetchFeaturesController","_selectedClusterFeature","featurePage","actions","defaultPopupTemplateEnabled","autoCloseEnabled","autoOpenEnabled","browseClusterEnabled","content","featuresPerPage","featureViewModelAbilities","featureViewModels","highlightEnabled","includeDefaultActions","selectedClusterBoundaryFeature","symbol","outline","width","color","style","title","updateLocationEnabled","view","visible","zoomFactor","zoomToLocation","isLoadingFeature","some","waitingForContent","initialize","add","_autoOpenEnabledChange","on","_autoClose","_highlightFeature","_animationStateChange","_locationChange","_selectedFeatureChange","_selectedFeatureIndexChange","_setGraphicOnFeatureViewModels","_featureViewModelsChange","event","_waitingForResultChange","_updateFeatureVMs","_viewScaleChange","enableClusterBrowsing","disableClusterBrowsing","destroy","_cancelFetchingFeatures","clear","active","waitingForResult","allActions","_get","removeAll","defaultActions","selectedFeature","concat","getEffectivePopupTemplate","popupTemplate","overwriteActions","filter","Boolean","forEach","addMany","isAggregate","featureCount","features","length","_set","pendingPromisesCount","promiseCount","selectedFeatureIndex","location","get","size","promises","Array","isArray","notifyChange","slice","has","_updateFeatures","_updatePendingPromises","then","isNaN","selectedFeatureViewModel","state","centerAtLocation","target","error","Promise","reject","callGoTo","scale","set","fetchFeatures","screenPoint","fetchPopupFeatures","signal","open","_setFetchFeaturesPromises","getItemAt","disabled","emit","action","next","previous","_clearBrowsedClusterGraphics","graphics","remove","geometry","Math","floor","graphic","center","_getPointFromGeometry","_fetchFeaturesWithController","_getScreenPoint","clientOnlyGraphics","promisesPerLayerView","resolve","map","promise","_destroyFeatureVMs","destroyed","splice","abilities","spatialReference","toScreen","pointerType","_fetchFeaturesAndOpen","WIDGET","abort","AbortController","catch","mapPoint","popup","delete","type","centroid","extent","_getLayerView","when","whenLayerView","layer","sourceLayer","_highlightPromise","objectIdField","attributes","highlight","indexOf","prototype","readOnly","value","U","default"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import\"../../geometry.js\";import t from\"../../Graphic.js\";import\"../../symbols.js\";import s from\"../../core/Collection.js\";import i from\"../../core/Error.js\";import o from\"../../core/Handles.js\";import r from\"../../core/Logger.js\";import{unwrap as n,isNone as a}from\"../../core/maybe.js\";import{init as l,watch as u,whenFalse as h}from\"../../core/watchUtils.js\";import{property as c}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as p}from\"../../core/accessorSupport/decorators/subclass.js\";import{geographicToWebMercator as d}from\"../../geometry/support/webMercatorUtils.js\";import g from\"../../layers/Layer.js\";import f from\"../../support/actions/ActionBase.js\";import m from\"../../support/actions/ActionButton.js\";import y from\"../../support/actions/ActionToggle.js\";import{getDisplayedSymbol as w}from\"../../symbols/support/symbolUtils.js\";import{ViewEventPriorities as v}from\"../../views/input/InputManager.js\";import{highlightsSupported as F}from\"../../views/support/layerViewUtils.js\";import _ from\"../Feature/FeatureViewModel.js\";import{zoomToClusteredFeatures as b,browseClusteredFeatures as C,zoomToFeature as P}from\"./actions.js\";import{triggerAction as E,getSelectedTarget as A,removeClusteredFeaturesForBrowsing as M,displayClusterExtent as j,browseAggregateFeatures as V}from\"./actionUtils.js\";import O from\"../support/AnchorElementViewModel.js\";import{GoToMixin as x}from\"../support/GoTo.js\";import I from\"../../symbols/SimpleFillSymbol.js\";import L from\"../../geometry/Point.js\";const T=s.ofType({key:\"type\",defaultKeyValue:\"button\",base:f,typeMap:{button:m,toggle:y}}),S=()=>[P.clone()],B=()=>[b.clone(),C.clone()],R=\"esri.widgets.Popup.PopupViewModel\",G=r.getLogger(R);let z=class extends(x(O)){constructor(e){super(e),this._handles=new o,this._pendingPromises=new Set,this._fetchFeaturesController=null,this._selectedClusterFeature=null,this.featurePage=null,this.actions=new T,this.defaultPopupTemplateEnabled=!1,this.autoCloseEnabled=!1,this.autoOpenEnabled=!0,this.browseClusterEnabled=!1,this.content=null,this.featuresPerPage=20,this.featureViewModelAbilities=null,this.featureViewModels=[],this.highlightEnabled=!0,this.includeDefaultActions=!0,this.selectedClusterBoundaryFeature=new t({symbol:new I({outline:{width:1.5,color:\"cyan\"},style:\"none\"})}),this.title=null,this.updateLocationEnabled=!1,this.view=null,this.visible=!1,this.zoomFactor=4,this.zoomToLocation=null}get isLoadingFeature(){return this.featureViewModels.some((e=>e.waitingForContent))}initialize(){this._handles.add([l(this,[\"autoOpenEnabled\",\"view\"],(()=>this._autoOpenEnabledChange())),this.on(\"view-change\",(()=>this._autoClose())),u(this,[\"highlightEnabled\",\"selectedFeature\",\"visible\",\"view\"],(()=>this._highlightFeature())),u(this,\"view.animation.state\",(e=>this._animationStateChange(e))),u(this,\"location\",(e=>this._locationChange(e))),u(this,\"selectedFeature\",(e=>this._selectedFeatureChange(e))),u(this,[\"selectedFeatureIndex\",\"featureCount\",\"featuresPerPage\"],(()=>this._selectedFeatureIndexChange())),u(this,[\"featurePage\",\"selectedFeatureIndex\",\"featureCount\",\"featuresPerPage, featureViewModels\"],(()=>this._setGraphicOnFeatureViewModels())),u(this,\"featureViewModels\",(()=>this._featureViewModelsChange())),this.on(\"trigger-action\",(e=>E({event:e,view:this.view}))),h(this,\"waitingForResult\",(()=>this._waitingForResultChange()),!0),u(this,[\"features\",\"view\",\"view.map\",\"view.spatialReference\"],(()=>this._updateFeatureVMs())),u(this,[\"view.scale\"],this._viewScaleChange),h(this,\"visible\",(()=>this.browseClusterEnabled=!1)),u(this,\"browseClusterEnabled\",(e=>e?this.enableClusterBrowsing():this.disableClusterBrowsing()))])}destroy(){this._cancelFetchingFeatures(),this._handles.destroy(),this._handles=null,this._pendingPromises.clear(),this.browseClusterEnabled=!1,this.view=null}get active(){return!(!this.visible||this.waitingForResult)}get allActions(){const e=this._get(\"allActions\")||new T;e.removeAll();const{actions:t,defaultActions:s,defaultPopupTemplateEnabled:i,includeDefaultActions:o,selectedFeature:r}=this,n=o?s.concat(t):t,a=r&&(\"function\"==typeof r.getEffectivePopupTemplate&&r.getEffectivePopupTemplate(i)||r.popupTemplate),l=a&&a.actions,u=a&&a.overwriteActions?l:l?l.concat(n):n;return u&&u.filter(Boolean).forEach((t=>e.add(t))),e}get defaultActions(){var e;const t=this._get(\"defaultActions\")||new T;return t.removeAll(),t.addMany(null!=(e=this.selectedFeature)&&e.isAggregate?B():S()),t}get featureCount(){return this.features.length}get features(){return this._get(\"features\")||[]}set features(e){const t=e||[];this._set(\"features\",t);const{pendingPromisesCount:s,promiseCount:i,selectedFeatureIndex:o}=this,r=i&&t.length;r&&s&&-1===o?this.selectedFeatureIndex=0:r&&-1!==o||(this.selectedFeatureIndex=t.length?0:-1)}get location(){return this._get(\"location\")||null}set location(e){const t=this.get(\"view.spatialReference.isWebMercator\");e&&e.get(\"spatialReference.isWGS84\")&&t&&(e=d(e)),this._set(\"location\",e)}get pendingPromisesCount(){return this._pendingPromises.size}get waitingForResult(){return!(!(!!this._fetchFeaturesController||this.pendingPromisesCount>0)||0!==this.featureCount)}get promiseCount(){return this.promises.length}get promises(){return this._get(\"promises\")||[]}set promises(e){if(this._pendingPromises.clear(),this.features=[],!Array.isArray(e)||!e.length)return this._set(\"promises\",[]),void this.notifyChange(\"pendingPromisesCount\");this._set(\"promises\",e),(e=e.slice(0)).forEach((e=>{this._pendingPromises.add(e);const t=t=>{this._pendingPromises.has(e)&&this._updateFeatures(t),this._updatePendingPromises(e)},s=()=>this._updatePendingPromises(e);e.then(t,s)})),this.notifyChange(\"pendingPromisesCount\")}get selectedFeature(){const{features:e,selectedFeatureIndex:t}=this;if(-1===t)return null;return e[t]||null}get selectedFeatureIndex(){const e=this._get(\"selectedFeatureIndex\");return\"number\"==typeof e?e:-1}set selectedFeatureIndex(e){const{featureCount:t}=this;e=isNaN(e)||e<-1||!t?-1:(e+t)%t,this._set(\"selectedFeatureIndex\",e)}get selectedFeatureViewModel(){return this.featureViewModels[this.selectedFeatureIndex]||null}get state(){return this.get(\"view.ready\")?\"ready\":\"disabled\"}centerAtLocation(){const{view:e}=this,t=A(this);if(!t){const s=new i(\"center-at-location:invalid-target-or-view\",\"Cannot center at a location without a target and view.\",{target:t,view:e});return G.error(s),Promise.reject(s)}return this.callGoTo({target:{target:t,scale:e.scale}})}clear(){this.set({promises:[],features:[],content:null,title:null,location:null})}fetchFeatures(e,t){const{view:s}=this;if(!s||!e){const t=new i(\"fetch-features:invalid-screenpoint-or-view\",\"Cannot fetch features without a screenPoint and view.\",{screenPoint:e,view:s});return G.error(t),Promise.reject(t)}return s.fetchPopupFeatures(e,{event:t&&t.event,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,signal:t&&t.signal})}open(e){const t={updateLocationEnabled:!1,promises:[],fetchFeatures:!1,...e,visible:!0},{fetchFeatures:s}=t;delete t.fetchFeatures,s&&this._setFetchFeaturesPromises(t.location);const i=[\"actionsMenuOpen\",\"collapsed\",\"featureMenuOpen\"];for(const o of i)delete t[o];this.set(t)}triggerAction(e){const t=this.allActions.getItemAt(e);t&&!t.disabled&&this.emit(\"trigger-action\",{action:t})}next(){return this.selectedFeatureIndex=this.selectedFeatureIndex+1,this}previous(){return this.selectedFeatureIndex=this.selectedFeatureIndex-1,this}disableClusterBrowsing(){M(this),this._clearBrowsedClusterGraphics()}async enableClusterBrowsing(){await j(this),await V(this)}_animationStateChange(e){this.zoomToLocation||(P.disabled=\"waiting-for-target\"===e)}_clearBrowsedClusterGraphics(){var e;const t=null==(e=this.view)?void 0:e.graphics;t&&(t.remove(this.selectedClusterBoundaryFeature),t.remove(this._selectedClusterFeature)),this._selectedClusterFeature=null,this.selectedClusterBoundaryFeature.geometry=null}_viewScaleChange(){var e;if(null!=(e=this.selectedFeature)&&e.isAggregate)return this.browseClusterEnabled=!1,this.visible=!1,void this.clear();this.browseClusterEnabled&&(this.browseClusterEnabled=!1,this.features=[this.selectedFeature])}_locationChange(e){const{selectedFeature:t,updateLocationEnabled:s}=this;s&&e&&(!t||t.geometry)&&this.centerAtLocation()}_selectedFeatureIndexChange(){this.featurePage=this.featureCount>1?Math.floor(this.selectedFeatureIndex/this.featuresPerPage)+1:null}_featureViewModelsChange(){this.featurePage=this.featureCount>1?1:null}_setGraphicOnFeatureViewModels(){const{features:e,featureCount:t,featurePage:s,featuresPerPage:i,featureViewModels:o}=this;if(null===s)return;const r=((s-1)*i+t)%t,n=r+i;o.slice(r,n).forEach(((t,s)=>{t&&!t.graphic&&(t.graphic=e[r+s])}))}async _selectedFeatureChange(e){if(!e)return;const{location:t,updateLocationEnabled:s,view:i}=this;if(this.browseClusterEnabled){if(this._selectedClusterFeature&&(i.graphics.remove(this._selectedClusterFeature),this._selectedClusterFeature=null),e.isAggregate)return;return e.symbol=await w(e),this._selectedClusterFeature=e,void i.graphics.add(this._selectedClusterFeature)}!s&&t||!e.geometry?s&&!e.geometry&&this.centerAtLocation().then((()=>{this.location=i.center.clone()})):this.location=n(this._getPointFromGeometry(e.geometry))}_waitingForResultChange(){!this.featureCount&&this.promises&&(this.visible=!1)}_setFetchFeaturesPromises(e){return this._fetchFeaturesWithController(this._getScreenPoint(e||this.location)).then((e=>{const{clientOnlyGraphics:t,promisesPerLayerView:s}=e,i=Promise.resolve(t),o=s.map((e=>e.promise));this.promises=[i,...o]}))}_destroyFeatureVMs(){this.featureViewModels.forEach((e=>e&&!e.destroyed&&e.destroy())),this._set(\"featureViewModels\",[])}_updateFeatureVMs(){const{selectedFeature:e,features:t,featureViewModels:s}=this;if(null!=e&&e.isAggregate||(this.browseClusterEnabled=!1),this._destroyFeatureVMs(),!t||!t.length)return;const i=s.slice(0),o=[];t.forEach(((t,s)=>{if(!t)return;let r=null;if(i.some(((e,s)=>(e&&e.graphic===t&&(r=e,i.splice(s,1)),!!r))),r)o[s]=r;else{var n,a;const i=new _({abilities:this.featureViewModelAbilities,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,spatialReference:null==(n=this.view)?void 0:n.spatialReference,graphic:t===e?t:null,map:null==(a=this.view)?void 0:a.map,view:this.view});o[s]=i}})),i.forEach((e=>e&&!e.destroyed&&e.destroy())),this._set(\"featureViewModels\",o)}_getScreenPoint(e){const{view:t}=this;return t&&e&&\"function\"==typeof t.toScreen?t.toScreen(e):null}_autoOpenEnabledChange(){const e=\"auto-fetch-features\",{_handles:t,autoOpenEnabled:s}=this;if(t.remove(e),s&&this.view){const s=this.view.on(\"click\",(e=>{\"mouse\"===e.pointerType&&0!==e.button||this._fetchFeaturesAndOpen(e)}),v.WIDGET);t.add(s,e)}}_cancelFetchingFeatures(){const e=this._fetchFeaturesController;e&&e.abort(),this._fetchFeaturesController=null,this.notifyChange(\"waitingForResult\")}_fetchFeaturesWithController(e,t){this._cancelFetchingFeatures();const s=new AbortController,{signal:i}=s;this._fetchFeaturesController=s,this.notifyChange(\"waitingForResult\");const o=this.fetchFeatures(e,{signal:i,event:t});return o.catch((()=>{})).then((()=>{this._fetchFeaturesController=null,this.notifyChange(\"waitingForResult\")})),o}_fetchFeaturesAndOpen(e){const{screenPoint:t,mapPoint:s}=e,{view:i}=this;this._fetchFeaturesWithController(t,e).then((e=>{const{clientOnlyGraphics:t,promisesPerLayerView:o,location:r}=e,n=[Promise.resolve(t),...o.map((e=>e.promise))];return i.popup.open({location:r||s,promises:n}),e}))}_updatePendingPromises(e){e&&this._pendingPromises.has(e)&&(this._pendingPromises.delete(e),this.notifyChange(\"pendingPromisesCount\"))}_autoClose(){this.autoCloseEnabled&&(this.visible=!1)}_getPointFromGeometry(e){return a(e)?null:\"point\"===e.type?e:\"extent\"===e.type?e.center:\"polygon\"===e.type?e.centroid:\"multipoint\"===e.type||\"polyline\"===e.type?e.extent.center:null}async _getLayerView(e,t){return await e.when(),e.whenLayerView(t)}async _highlightFeature(){const e=\"highlight\";this._handles.remove(e);const{selectedFeature:t,highlightEnabled:s,view:i,visible:o}=this;if(!(t&&i&&s&&o))return;let{layer:r,sourceLayer:n}=t;if(\"map-notes\"!==(null==n?void 0:n.type)&&\"subtype-group\"!==(null==n?void 0:n.type)||(r=n),!(r&&r instanceof g))return;const a=this._getLayerView(i,r);this._highlightPromise=a;const l=await a;if(!(l&&F(l)&&this._highlightPromise===a&&this.selectedFeature&&this.highlightEnabled&&this.visible))return;const u=\"imagery\"===r.type?void 0:\"objectIdField\"in r&&r.objectIdField,h=t.attributes,c=h&&u&&h[u],p=l.highlight(c||t);this._handles.add(p,e)}_updateFeatures(e){const{features:t}=this;if(!e||!e.length)return;if(!t.length)return void(this.features=e);const s=e.filter((e=>-1===t.indexOf(e)));this.features=t.concat(s)}};e([c()],z.prototype,\"featurePage\",void 0),e([c()],z.prototype,\"isLoadingFeature\",null),e([c({type:T})],z.prototype,\"actions\",void 0),e([c({readOnly:!0})],z.prototype,\"active\",null),e([c({readOnly:!0})],z.prototype,\"allActions\",null),e([c({type:Boolean})],z.prototype,\"defaultPopupTemplateEnabled\",void 0),e([c()],z.prototype,\"autoCloseEnabled\",void 0),e([c()],z.prototype,\"autoOpenEnabled\",void 0),e([c()],z.prototype,\"browseClusterEnabled\",void 0),e([c()],z.prototype,\"content\",void 0),e([c({type:T,readOnly:!0})],z.prototype,\"defaultActions\",null),e([c({readOnly:!0})],z.prototype,\"featureCount\",null),e([c()],z.prototype,\"features\",null),e([c()],z.prototype,\"featuresPerPage\",void 0),e([c()],z.prototype,\"featureViewModelAbilities\",void 0),e([c({readOnly:!0})],z.prototype,\"featureViewModels\",void 0),e([c()],z.prototype,\"highlightEnabled\",void 0),e([c()],z.prototype,\"includeDefaultActions\",void 0),e([c({type:L})],z.prototype,\"location\",null),e([c({readOnly:!0})],z.prototype,\"pendingPromisesCount\",null),e([c({readOnly:!0})],z.prototype,\"selectedClusterBoundaryFeature\",void 0),e([c({readOnly:!0})],z.prototype,\"waitingForResult\",null),e([c({readOnly:!0})],z.prototype,\"promiseCount\",null),e([c()],z.prototype,\"promises\",null),e([c({value:null,readOnly:!0})],z.prototype,\"selectedFeature\",null),e([c({value:-1})],z.prototype,\"selectedFeatureIndex\",null),e([c({readOnly:!0})],z.prototype,\"selectedFeatureViewModel\",null),e([c({readOnly:!0})],z.prototype,\"state\",null),e([c()],z.prototype,\"title\",void 0),e([c()],z.prototype,\"updateLocationEnabled\",void 0),e([c()],z.prototype,\"view\",void 0),e([c()],z.prototype,\"visible\",void 0),e([c()],z.prototype,\"zoomFactor\",void 0),e([c()],z.prototype,\"zoomToLocation\",void 0),e([c()],z.prototype,\"centerAtLocation\",null),z=e([p(R)],z);const U=z;export{U as default};\n"]},"metadata":{},"sourceType":"module"}