{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport { clamp as t } from \"../../core/mathUtils.js\";\n\nconst e = (() => {\n  if (!(\"document\" in globalThis)) return () => null;\n  const t = document.createElement(\"canvas\"),\n        e = t.getContext(\"2d\"),\n        n = 512;\n  return t.height = n, t.width = 1, n => {\n    e.clearRect(0, 0, 1, t.height);\n    const r = e.createLinearGradient(0, 0, 0, t.height);\n\n    for (const {\n      ratio: t,\n      color: e\n    } of n) r.addColorStop(Math.max(t, .001), `rgba(${e.r}, ${e.g}, ${e.b}, ${e.a})`);\n\n    return e.fillStyle = r, e.fillRect(0, 0, 1, t.height), e.getImageData(0, 0, 1, t.height).data;\n  };\n})();\n\nfunction n(t, e, n, r) {\n  const {\n    blurRadius: a,\n    fieldOffset: o,\n    field: c\n  } = e,\n        u = new Float64Array(n * r),\n        h = i(a),\n        l = Math.round(3 * a);\n  let s,\n      d = Number.NEGATIVE_INFINITY;\n  const m = f(c, o);\n\n  for (const {\n    geometry: i,\n    attributes: f\n  } of t) {\n    const t = i.x - l,\n          e = i.y - l,\n          a = Math.max(0, t),\n          o = Math.max(0, e),\n          c = Math.min(r, i.y + l),\n          g = Math.min(n, i.x + l),\n          y = +m(f);\n\n    for (let r = o; r < c; r++) {\n      const o = h[r - e];\n\n      for (let e = a; e < g; e++) {\n        const a = h[e - t];\n        s = u[r * n + e] += o * a * y, s > d && (d = s);\n      }\n    }\n  }\n\n  return {\n    matrix: u.buffer,\n    max: d\n  };\n}\n\nfunction r(t, e, n, r) {\n  const {\n    blurRadius: a,\n    fieldOffset: o,\n    field: f\n  } = e,\n        u = new Float64Array(n * r),\n        h = i(a),\n        l = Math.round(3 * a);\n  let s,\n      d = Number.NEGATIVE_INFINITY;\n  const m = c(f, o),\n        g = new Set();\n\n  for (const i of t) {\n    const t = i.getCursor();\n\n    for (; t.next();) {\n      const e = t.getObjectId();\n      if (g.has(e)) continue;\n      g.add(e);\n      const a = t.readLegacyPointGeometry(),\n            o = 128;\n      if (a.x < -o || a.x >= n + o || a.y < -o || a.y > r + o) continue;\n      const i = +m(t),\n            f = Math.round(a.x) - l,\n            c = Math.round(a.y) - l,\n            y = Math.max(0, f),\n            M = Math.max(0, c),\n            x = Math.min(r, Math.round(a.y) + l),\n            b = Math.min(n, Math.round(a.x) + l);\n\n      for (let t = M; t < x; t++) {\n        const e = h[t - c];\n\n        for (let r = y; r < b; r++) {\n          const a = h[r - f];\n          s = u[t * n + r] += e * a * i, s > d && (d = s);\n        }\n      }\n    }\n  }\n\n  return {\n    matrix: u.buffer,\n    max: d\n  };\n}\n\nfunction a(t, e, n, r, a, i) {\n  t.canvas.width = t.canvas.height = e, t.clearRect(0, 0, e, e);\n  const f = t.getImageData(0, 0, e, e);\n  n && r && f.data.set(new Uint8ClampedArray(o(e, n, r, a, i))), t.putImageData(f, 0, 0);\n}\n\nfunction o(e, n, r, a, o) {\n  const i = new Uint32Array(e * e),\n        f = \"buffer\" in n ? n : new Float64Array(n),\n        c = \"buffer\" in r ? new Uint32Array(r.buffer) : new Uint32Array(new Uint8Array(r).buffer),\n        u = c.length / (o - a);\n\n  for (let h = 0; h < f.length; h++) {\n    const e = f[h],\n          n = Math.floor((e - a) * u);\n    i[h] = c[t(n, 0, c.length - 1)];\n  }\n\n  return i.buffer;\n}\n\nfunction i(t) {\n  const e = Math.round(3 * t),\n        n = 2 * t * t,\n        r = new Float64Array(2 * e + 1);\n\n  for (let a = 0; a <= r.length; a++) r[a] = Math.exp(-((a - e) ** 2) / n) / Math.sqrt(2 * Math.PI) * (t / 2);\n\n  return r;\n}\n\nfunction f(t, e) {\n  return \"function\" == typeof t ? t : t ? \"string\" == typeof e ? e => -1 * +e[t] : n => +n[t] + e : () => 1;\n}\n\nfunction c(t, e) {\n  return null != t ? \"string\" == typeof e ? e => -1 * +e.readAttribute(t) : n => +n.readAttribute(t) + e : t => 1;\n}\n\nexport { n as calculateHeatmapIntensityInfo, r as calculateHeatmapIntensityInfoReaders, o as createHeatmapImageData, i as createKernel, f as createValueFunction, c as createValueFunctionCursor, a as drawHeatmap, e as generateGradient };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/renderers/support/heatmapUtils.js"],"names":["clamp","t","e","globalThis","document","createElement","getContext","n","height","width","clearRect","r","createLinearGradient","ratio","color","addColorStop","Math","max","g","b","a","fillStyle","fillRect","getImageData","data","blurRadius","fieldOffset","o","field","c","u","Float64Array","h","i","l","round","s","d","Number","NEGATIVE_INFINITY","m","f","geometry","attributes","x","y","min","matrix","buffer","Set","getCursor","next","getObjectId","has","add","readLegacyPointGeometry","M","canvas","set","Uint8ClampedArray","putImageData","Uint32Array","Uint8Array","length","floor","exp","sqrt","PI","readAttribute","calculateHeatmapIntensityInfo","calculateHeatmapIntensityInfoReaders","createHeatmapImageData","createKernel","createValueFunction","createValueFunctionCursor","drawHeatmap","generateGradient"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{clamp as t}from\"../../core/mathUtils.js\";const e=(()=>{if(!(\"document\"in globalThis))return()=>null;const t=document.createElement(\"canvas\"),e=t.getContext(\"2d\"),n=512;return t.height=n,t.width=1,n=>{e.clearRect(0,0,1,t.height);const r=e.createLinearGradient(0,0,0,t.height);for(const{ratio:t,color:e}of n)r.addColorStop(Math.max(t,.001),`rgba(${e.r}, ${e.g}, ${e.b}, ${e.a})`);return e.fillStyle=r,e.fillRect(0,0,1,t.height),e.getImageData(0,0,1,t.height).data}})();function n(t,e,n,r){const{blurRadius:a,fieldOffset:o,field:c}=e,u=new Float64Array(n*r),h=i(a),l=Math.round(3*a);let s,d=Number.NEGATIVE_INFINITY;const m=f(c,o);for(const{geometry:i,attributes:f}of t){const t=i.x-l,e=i.y-l,a=Math.max(0,t),o=Math.max(0,e),c=Math.min(r,i.y+l),g=Math.min(n,i.x+l),y=+m(f);for(let r=o;r<c;r++){const o=h[r-e];for(let e=a;e<g;e++){const a=h[e-t];s=u[r*n+e]+=o*a*y,s>d&&(d=s)}}}return{matrix:u.buffer,max:d}}function r(t,e,n,r){const{blurRadius:a,fieldOffset:o,field:f}=e,u=new Float64Array(n*r),h=i(a),l=Math.round(3*a);let s,d=Number.NEGATIVE_INFINITY;const m=c(f,o),g=new Set;for(const i of t){const t=i.getCursor();for(;t.next();){const e=t.getObjectId();if(g.has(e))continue;g.add(e);const a=t.readLegacyPointGeometry(),o=128;if(a.x<-o||a.x>=n+o||a.y<-o||a.y>r+o)continue;const i=+m(t),f=Math.round(a.x)-l,c=Math.round(a.y)-l,y=Math.max(0,f),M=Math.max(0,c),x=Math.min(r,Math.round(a.y)+l),b=Math.min(n,Math.round(a.x)+l);for(let t=M;t<x;t++){const e=h[t-c];for(let r=y;r<b;r++){const a=h[r-f];s=u[t*n+r]+=e*a*i,s>d&&(d=s)}}}}return{matrix:u.buffer,max:d}}function a(t,e,n,r,a,i){t.canvas.width=t.canvas.height=e,t.clearRect(0,0,e,e);const f=t.getImageData(0,0,e,e);n&&r&&f.data.set(new Uint8ClampedArray(o(e,n,r,a,i))),t.putImageData(f,0,0)}function o(e,n,r,a,o){const i=new Uint32Array(e*e),f=\"buffer\"in n?n:new Float64Array(n),c=\"buffer\"in r?new Uint32Array(r.buffer):new Uint32Array(new Uint8Array(r).buffer),u=c.length/(o-a);for(let h=0;h<f.length;h++){const e=f[h],n=Math.floor((e-a)*u);i[h]=c[t(n,0,c.length-1)]}return i.buffer}function i(t){const e=Math.round(3*t),n=2*t*t,r=new Float64Array(2*e+1);for(let a=0;a<=r.length;a++)r[a]=Math.exp(-((a-e)**2)/n)/Math.sqrt(2*Math.PI)*(t/2);return r}function f(t,e){return\"function\"==typeof t?t:t?\"string\"==typeof e?e=>-1*+e[t]:n=>+n[t]+e:()=>1}function c(t,e){return null!=t?\"string\"==typeof e?e=>-1*+e.readAttribute(t):n=>+n.readAttribute(t)+e:t=>1}export{n as calculateHeatmapIntensityInfo,r as calculateHeatmapIntensityInfoReaders,o as createHeatmapImageData,i as createKernel,f as createValueFunction,c as createValueFunctionCursor,a as drawHeatmap,e as generateGradient};\n"]},"metadata":{},"sourceType":"module"}