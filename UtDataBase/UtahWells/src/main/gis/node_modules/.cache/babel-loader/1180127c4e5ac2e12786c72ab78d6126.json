{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport \"../../core/has.js\";\nimport { isSome as e, isNone as t, unwrap as l } from \"../../core/maybe.js\";\nimport { loadArcade as i } from \"../../support/arcadeOnDemand.js\";\nimport { SymbolSizeDefaults as r } from \"./previewUtils.js\";\nimport { getCSSFilterFromEffectList as a, applyColorToSymbol as o, applySizesToSymbol as s, applyRotationToSymbol as n, getColorFromSymbol as c, applyOpacityToColor as u } from \"./utils.js\";\nlet y = null;\n\nfunction p(e, t) {\n  return Math.floor(Math.random() * (t - e + 1) + e);\n}\n\nfunction f(e, t, l) {\n  const {\n    backgroundColor: i,\n    outline: a,\n    dotSize: o\n  } = e,\n        s = l && l.swatchSize || r.size,\n        n = .8,\n        c = Math.round(s * s / o ** 2 * n),\n        u = window.devicePixelRatio,\n        f = document.createElement(\"canvas\"),\n        h = s * u;\n  f.width = h, f.height = h, f.style.width = f.width / u + \"px\", f.style.height = f.height / u + \"px\";\n  const b = f.getContext(\"2d\");\n  if (i && (b.fillStyle = i.toCss(!0), b.fillRect(0, 0, h, h), b.fill()), b.fillStyle = t.toCss(!0), y && y.length / 2 === c) for (let r = 0; r < 2 * c; r += 2) {\n    const e = y[r],\n          t = y[r + 1];\n    b.fillRect(e, t, o * u, o * u), b.fill();\n  } else {\n    y = [];\n\n    for (let e = 0; e < 2 * c; e += 2) {\n      const e = p(0, h),\n            t = p(0, h);\n      y.push(e, t), b.fillRect(e, t, o * u, o * u), b.fill();\n    }\n  }\n  a && (a.color && (b.strokeStyle = a.color.toCss(!0)), b.lineWidth = a.width, b.strokeRect(0, 0, h, h));\n  const d = new Image(s, s);\n  return d.src = f.toDataURL(), d;\n}\n\nfunction h(e) {\n  let t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  const l = 24,\n        i = 75,\n        r = \"horizontal\" === t.align,\n        a = r ? i : l,\n        o = r ? l : i,\n        {\n    width: s = a,\n    height: n = o,\n    gradient: c = !0\n  } = t,\n        u = window.devicePixelRatio,\n        y = s * u,\n        p = n * u,\n        f = document.createElement(\"canvas\");\n  f.width = y, f.height = p, f.style.width = `${s}px`, f.style.height = `${n}px`;\n  const h = f.getContext(\"2d\"),\n        d = r ? y : 0,\n        m = r ? 0 : p;\n\n  if (c) {\n    const t = h.createLinearGradient(0, 0, d, m),\n          l = e.length,\n          i = 1 === l ? 0 : 1 / (l - 1);\n    e.forEach((e, l) => t.addColorStop(l * i, e.toString())), h.fillStyle = t, h.fillRect(0, 0, y, p);\n  } else {\n    const t = r ? y / e.length : y,\n          l = r ? p : p / e.length;\n    let i = 0,\n        a = 0;\n\n    for (const o of e) h.fillStyle = o.toString(), h.fillRect(i, a, t, l), i = r ? i + t : 0, a = r ? 0 : a + l;\n  }\n\n  const g = document.createElement(\"div\");\n  return g.style.width = `${s}px`, g.style.height = `${n}px`, b(g, null == t ? void 0 : t.effectList), g.appendChild(f), g;\n}\n\nfunction b(e, t) {\n  if (!t) return;\n  e.style.filter = a(t);\n  const l = t.effects;\n  if (l) for (const i of l) if (\"drop-shadow\" === (null == i ? void 0 : i.type)) {\n    i.offsetX < 0 ? e.style.marginLeft = `${Math.abs(i.offsetX)}px` : e.style.marginRight = `${i.offsetX}px`;\n    break;\n  }\n}\n\nasync function d(e, t) {\n  switch (e.type) {\n    case \"web-style\":\n      {\n        const {\n          previewWebStyleSymbol: l\n        } = await import(\"./previewWebStyleSymbol.js\");\n        return l(e, d, t);\n      }\n\n    case \"label-3d\":\n    case \"line-3d\":\n    case \"mesh-3d\":\n    case \"point-3d\":\n    case \"polygon-3d\":\n      {\n        const {\n          previewSymbol3D: l\n        } = await import(\"./previewSymbol3D.js\");\n        return l(e, t);\n      }\n\n    case \"simple-marker\":\n    case \"simple-line\":\n    case \"simple-fill\":\n    case \"picture-marker\":\n    case \"picture-fill\":\n    case \"text\":\n      {\n        const {\n          previewSymbol2D: l\n        } = await import(\"./previewSymbol2D.js\");\n        return l(e, t);\n      }\n\n    case \"cim\":\n      {\n        const {\n          previewCIMSymbol: l\n        } = await import(\"./previewCIMSymbol.js\");\n        return l(e, t);\n      }\n\n    default:\n      return;\n  }\n}\n\nfunction m(e) {\n  return e && \"opacity\" in e ? e.opacity * m(e.parent) : 1;\n}\n\nasync function g(r, a) {\n  var c, u;\n  if (!r) return;\n  const y = r.sourceLayer,\n        p = null != (c = e(a) && null != (u = a.useSourceLayer) && u ? y : r.layer) ? c : y,\n        f = m(p);\n\n  if (e(r.symbol) && (!e(a) || !0 !== a.ignoreGraphicSymbol)) {\n    const t = \"web-style\" === r.symbol.type ? await r.symbol.fetchSymbol(e(a) ? a.abortOptions : null) : r.symbol.clone();\n    return o(t, null, f), t;\n  }\n\n  const h = e(a) && a.renderer || p && \"renderer\" in p && p.renderer;\n  let b = h && \"getSymbolAsync\" in h ? await h.getSymbolAsync(r, a) : null;\n  if (!b) return;\n  if (b = \"web-style\" === b.type ? await b.fetchSymbol(e(a) ? a.abortOptions : null) : b.clone(), !(\"visualVariables\" in h) || !h.visualVariables || !h.visualVariables.length) return o(b, null, f), b;\n\n  if (\"arcadeRequiredForVisualVariables\" in h && h.arcadeRequiredForVisualVariables && (t(a) || t(a.arcade))) {\n    const e = { ...l(a)\n    };\n    e.arcade = await i(), a = e;\n  }\n\n  const d = await import(\"../../renderers/visualVariables/support/visualVariableUtils.js\"),\n        g = [],\n        w = [],\n        v = [],\n        S = [];\n\n  for (const e of h.visualVariables) switch (e.type) {\n    case \"color\":\n      g.push(e);\n      break;\n\n    case \"opacity\":\n      w.push(e);\n      break;\n\n    case \"rotation\":\n      S.push(e);\n      break;\n\n    case \"size\":\n      e.target || v.push(e);\n  }\n\n  const V = !!g.length && g[g.length - 1],\n        x = V ? d.getColor(V, r, a) : null,\n        R = !!w.length && w[w.length - 1];\n  let C = R ? d.getOpacity(R, r, a) : null;\n\n  if (null != f && (C = null != C ? C * f : f), o(b, x, C), v.length) {\n    const e = d.getAllSizes(v, r, a);\n    await s(b, e);\n  }\n\n  for (const e of S) n(b, d.getRotationAngle(e, r, a), e.axis);\n\n  return b;\n}\n\nasync function w(r, a) {\n  var o;\n  if (!r) return;\n  const s = m(r.layer || r.sourceLayer);\n\n  if (e(r.symbol) && (!e(a) || !0 !== a.ignoreGraphicSymbol)) {\n    const t = \"web-style\" === r.symbol.type ? await r.symbol.fetchSymbol(e(a) ? a.abortOptions : null) : r.symbol.clone();\n    return c(t, s);\n  }\n\n  const n = e(a) && a.renderer || r.get(\"layer.renderer\") || r.get(\"sourceLayer.renderer\");\n  let y = await n.getSymbolAsync(r, a);\n  if (!y) return;\n  y = \"web-style\" === y.type ? await y.fetchSymbol(e(a) ? a.abortOptions : null) : y.clone();\n  const p = c(y, s);\n  if (!(\"visualVariables\" in n) || \"visualVariables\" in n && !n.visualVariables || \"visualVariables\" in n && (null == (o = n.visualVariables) || !o.length)) return p;\n\n  if (n.arcadeRequiredForVisualVariables && (t(a) || t(a.arcade))) {\n    const e = { ...l(a)\n    };\n    e.arcade = await i(), a = e;\n  }\n\n  const f = await import(\"../../renderers/visualVariables/support/visualVariableUtils.js\"),\n        h = [],\n        b = [];\n\n  for (const e of n.visualVariables) switch (e.type) {\n    case \"color\":\n      h.push(e);\n      break;\n\n    case \"opacity\":\n      b.push(e);\n  }\n\n  const d = h.length > 0 ? h[h.length - 1] : null,\n        g = d ? f.getColor(d, r, a) : p,\n        w = b.length > 0 ? b[b.length - 1] : null;\n  let v = w ? f.getOpacity(w, r, a) : null;\n  return null != s && (v = null != v ? v * s : s), g ? u(g, v) : null;\n}\n\nexport { w as getDisplayedColor, g as getDisplayedSymbol, h as renderColorRampPreviewHTML, f as renderDotDensityPreviewHTML, d as renderPreviewHTML };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/symbols/support/symbolUtils.js"],"names":["isSome","e","isNone","t","unwrap","l","loadArcade","i","SymbolSizeDefaults","r","getCSSFilterFromEffectList","a","applyColorToSymbol","o","applySizesToSymbol","s","applyRotationToSymbol","n","getColorFromSymbol","c","applyOpacityToColor","u","y","p","Math","floor","random","f","backgroundColor","outline","dotSize","swatchSize","size","round","window","devicePixelRatio","document","createElement","h","width","height","style","b","getContext","fillStyle","toCss","fillRect","fill","length","push","color","strokeStyle","lineWidth","strokeRect","d","Image","src","toDataURL","align","gradient","m","createLinearGradient","forEach","addColorStop","toString","g","effectList","appendChild","filter","effects","type","offsetX","marginLeft","abs","marginRight","previewWebStyleSymbol","previewSymbol3D","previewSymbol2D","previewCIMSymbol","opacity","parent","sourceLayer","useSourceLayer","layer","symbol","ignoreGraphicSymbol","fetchSymbol","abortOptions","clone","renderer","getSymbolAsync","visualVariables","arcadeRequiredForVisualVariables","arcade","w","v","S","target","V","x","getColor","R","C","getOpacity","getAllSizes","getRotationAngle","axis","get","getDisplayedColor","getDisplayedSymbol","renderColorRampPreviewHTML","renderDotDensityPreviewHTML","renderPreviewHTML"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport\"../../core/has.js\";import{isSome as e,isNone as t,unwrap as l}from\"../../core/maybe.js\";import{loadArcade as i}from\"../../support/arcadeOnDemand.js\";import{SymbolSizeDefaults as r}from\"./previewUtils.js\";import{getCSSFilterFromEffectList as a,applyColorToSymbol as o,applySizesToSymbol as s,applyRotationToSymbol as n,getColorFromSymbol as c,applyOpacityToColor as u}from\"./utils.js\";let y=null;function p(e,t){return Math.floor(Math.random()*(t-e+1)+e)}function f(e,t,l){const{backgroundColor:i,outline:a,dotSize:o}=e,s=l&&l.swatchSize||r.size,n=.8,c=Math.round(s*s/o**2*n),u=window.devicePixelRatio,f=document.createElement(\"canvas\"),h=s*u;f.width=h,f.height=h,f.style.width=f.width/u+\"px\",f.style.height=f.height/u+\"px\";const b=f.getContext(\"2d\");if(i&&(b.fillStyle=i.toCss(!0),b.fillRect(0,0,h,h),b.fill()),b.fillStyle=t.toCss(!0),y&&y.length/2===c)for(let r=0;r<2*c;r+=2){const e=y[r],t=y[r+1];b.fillRect(e,t,o*u,o*u),b.fill()}else{y=[];for(let e=0;e<2*c;e+=2){const e=p(0,h),t=p(0,h);y.push(e,t),b.fillRect(e,t,o*u,o*u),b.fill()}}a&&(a.color&&(b.strokeStyle=a.color.toCss(!0)),b.lineWidth=a.width,b.strokeRect(0,0,h,h));const d=new Image(s,s);return d.src=f.toDataURL(),d}function h(e,t={}){const l=24,i=75,r=\"horizontal\"===t.align,a=r?i:l,o=r?l:i,{width:s=a,height:n=o,gradient:c=!0}=t,u=window.devicePixelRatio,y=s*u,p=n*u,f=document.createElement(\"canvas\");f.width=y,f.height=p,f.style.width=`${s}px`,f.style.height=`${n}px`;const h=f.getContext(\"2d\"),d=r?y:0,m=r?0:p;if(c){const t=h.createLinearGradient(0,0,d,m),l=e.length,i=1===l?0:1/(l-1);e.forEach(((e,l)=>t.addColorStop(l*i,e.toString()))),h.fillStyle=t,h.fillRect(0,0,y,p)}else{const t=r?y/e.length:y,l=r?p:p/e.length;let i=0,a=0;for(const o of e)h.fillStyle=o.toString(),h.fillRect(i,a,t,l),i=r?i+t:0,a=r?0:a+l}const g=document.createElement(\"div\");return g.style.width=`${s}px`,g.style.height=`${n}px`,b(g,null==t?void 0:t.effectList),g.appendChild(f),g}function b(e,t){if(!t)return;e.style.filter=a(t);const l=t.effects;if(l)for(const i of l)if(\"drop-shadow\"===(null==i?void 0:i.type)){i.offsetX<0?e.style.marginLeft=`${Math.abs(i.offsetX)}px`:e.style.marginRight=`${i.offsetX}px`;break}}async function d(e,t){switch(e.type){case\"web-style\":{const{previewWebStyleSymbol:l}=await import(\"./previewWebStyleSymbol.js\");return l(e,d,t)}case\"label-3d\":case\"line-3d\":case\"mesh-3d\":case\"point-3d\":case\"polygon-3d\":{const{previewSymbol3D:l}=await import(\"./previewSymbol3D.js\");return l(e,t)}case\"simple-marker\":case\"simple-line\":case\"simple-fill\":case\"picture-marker\":case\"picture-fill\":case\"text\":{const{previewSymbol2D:l}=await import(\"./previewSymbol2D.js\");return l(e,t)}case\"cim\":{const{previewCIMSymbol:l}=await import(\"./previewCIMSymbol.js\");return l(e,t)}default:return}}function m(e){return e&&\"opacity\"in e?e.opacity*m(e.parent):1}async function g(r,a){var c,u;if(!r)return;const y=r.sourceLayer,p=null!=(c=e(a)&&null!=(u=a.useSourceLayer)&&u?y:r.layer)?c:y,f=m(p);if(e(r.symbol)&&(!e(a)||!0!==a.ignoreGraphicSymbol)){const t=\"web-style\"===r.symbol.type?await r.symbol.fetchSymbol(e(a)?a.abortOptions:null):r.symbol.clone();return o(t,null,f),t}const h=e(a)&&a.renderer||p&&\"renderer\"in p&&p.renderer;let b=h&&\"getSymbolAsync\"in h?await h.getSymbolAsync(r,a):null;if(!b)return;if(b=\"web-style\"===b.type?await b.fetchSymbol(e(a)?a.abortOptions:null):b.clone(),!(\"visualVariables\"in h)||!h.visualVariables||!h.visualVariables.length)return o(b,null,f),b;if(\"arcadeRequiredForVisualVariables\"in h&&h.arcadeRequiredForVisualVariables&&(t(a)||t(a.arcade))){const e={...l(a)};e.arcade=await i(),a=e}const d=await import(\"../../renderers/visualVariables/support/visualVariableUtils.js\"),g=[],w=[],v=[],S=[];for(const e of h.visualVariables)switch(e.type){case\"color\":g.push(e);break;case\"opacity\":w.push(e);break;case\"rotation\":S.push(e);break;case\"size\":e.target||v.push(e)}const V=!!g.length&&g[g.length-1],x=V?d.getColor(V,r,a):null,R=!!w.length&&w[w.length-1];let C=R?d.getOpacity(R,r,a):null;if(null!=f&&(C=null!=C?C*f:f),o(b,x,C),v.length){const e=d.getAllSizes(v,r,a);await s(b,e)}for(const e of S)n(b,d.getRotationAngle(e,r,a),e.axis);return b}async function w(r,a){var o;if(!r)return;const s=m(r.layer||r.sourceLayer);if(e(r.symbol)&&(!e(a)||!0!==a.ignoreGraphicSymbol)){const t=\"web-style\"===r.symbol.type?await r.symbol.fetchSymbol(e(a)?a.abortOptions:null):r.symbol.clone();return c(t,s)}const n=e(a)&&a.renderer||r.get(\"layer.renderer\")||r.get(\"sourceLayer.renderer\");let y=await n.getSymbolAsync(r,a);if(!y)return;y=\"web-style\"===y.type?await y.fetchSymbol(e(a)?a.abortOptions:null):y.clone();const p=c(y,s);if(!(\"visualVariables\"in n)||\"visualVariables\"in n&&!n.visualVariables||\"visualVariables\"in n&&(null==(o=n.visualVariables)||!o.length))return p;if(n.arcadeRequiredForVisualVariables&&(t(a)||t(a.arcade))){const e={...l(a)};e.arcade=await i(),a=e}const f=await import(\"../../renderers/visualVariables/support/visualVariableUtils.js\"),h=[],b=[];for(const e of n.visualVariables)switch(e.type){case\"color\":h.push(e);break;case\"opacity\":b.push(e)}const d=h.length>0?h[h.length-1]:null,g=d?f.getColor(d,r,a):p,w=b.length>0?b[b.length-1]:null;let v=w?f.getOpacity(w,r,a):null;return null!=s&&(v=null!=v?v*s:s),g?u(g,v):null}export{w as getDisplayedColor,g as getDisplayedSymbol,h as renderColorRampPreviewHTML,f as renderDotDensityPreviewHTML,d as renderPreviewHTML};\n"]},"metadata":{},"sourceType":"module"}