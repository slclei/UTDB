{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport { a as e } from \"../../../chunks/vec2.js\";\n\nclass t {\n  constructor(e, t, i) {\n    this.maxSize = e, this.tileInfoView = t, this.removedFunc = i, this._tilePerId = new Map(), this._tileKeysPerLevel = [];\n  }\n\n  has(e) {\n    return this._tilePerId.has(e);\n  }\n\n  get(e) {\n    return this._tilePerId.get(e);\n  }\n\n  pop(e) {\n    const t = this._tilePerId.get(e);\n\n    if (!t) return null;\n    const s = t.key.level,\n          r = this._tileKeysPerLevel[s];\n    i(this._tilePerId, e);\n\n    for (let i = 0; i < r.length; i++) if (r[i].id === e) {\n      r.splice(i, 1);\n      break;\n    }\n\n    return t.visible = !0, t;\n  }\n\n  add(e) {\n    e.visible = !1;\n    const t = e.key,\n          i = t.id;\n    if (this._tilePerId.has(i)) return;\n\n    this._tilePerId.set(i, e);\n\n    const s = t.level;\n    this._tileKeysPerLevel[s] || (this._tileKeysPerLevel[s] = []), this._tileKeysPerLevel[s].push(t);\n  }\n\n  prune(e, t, i) {\n    let s = this._tilePerId.size;\n    if (s <= this.maxSize) return;\n    let r = this._tileKeysPerLevel.length - 1;\n\n    for (; s > this.maxSize && r >= 0;) r !== e && (s = this._pruneAroundCenterTile(s, t, i, r)), r--;\n\n    s > this.maxSize && (s = this._pruneAroundCenterTile(s, t, i, e));\n  }\n\n  _pruneAroundCenterTile(t, i, s, r) {\n    const l = this._tileKeysPerLevel[r];\n    if (!l || 0 === l.length) return t;\n    const {\n      size: n,\n      origin: h\n    } = this.tileInfoView.tileInfo,\n          o = s * n[0],\n          u = s * n[1],\n          d = [0, 0],\n          _ = [0, 0];\n\n    for (l.sort((t, s) => (d[0] = h.x + o * (t.col + .5), d[1] = h.y - u * (t.row + .5), _[0] = h.x + o * (s.col + .5), _[1] = h.y - u * (s.row + .5), e(d, i) - e(_, i))); l.length > 0;) {\n      const e = l.pop();\n      if (this._removeTile(e.id), --t === this.maxSize) break;\n    }\n\n    return t;\n  }\n\n  _removeTile(e) {\n    const t = this._tilePerId.get(e);\n\n    this.removedFunc && this.removedFunc(t), i(this._tilePerId, e);\n  }\n\n}\n\nfunction i(e, t) {\n  e.delete(t);\n}\n\nexport { t as default };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/views/2d/tiling/TileCache.js"],"names":["a","e","t","constructor","i","maxSize","tileInfoView","removedFunc","_tilePerId","Map","_tileKeysPerLevel","has","get","pop","s","key","level","r","length","id","splice","visible","add","set","push","prune","size","_pruneAroundCenterTile","l","n","origin","h","tileInfo","o","u","d","_","sort","x","col","y","row","_removeTile","delete","default"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{a as e}from\"../../../chunks/vec2.js\";class t{constructor(e,t,i){this.maxSize=e,this.tileInfoView=t,this.removedFunc=i,this._tilePerId=new Map,this._tileKeysPerLevel=[]}has(e){return this._tilePerId.has(e)}get(e){return this._tilePerId.get(e)}pop(e){const t=this._tilePerId.get(e);if(!t)return null;const s=t.key.level,r=this._tileKeysPerLevel[s];i(this._tilePerId,e);for(let i=0;i<r.length;i++)if(r[i].id===e){r.splice(i,1);break}return t.visible=!0,t}add(e){e.visible=!1;const t=e.key,i=t.id;if(this._tilePerId.has(i))return;this._tilePerId.set(i,e);const s=t.level;this._tileKeysPerLevel[s]||(this._tileKeysPerLevel[s]=[]),this._tileKeysPerLevel[s].push(t)}prune(e,t,i){let s=this._tilePerId.size;if(s<=this.maxSize)return;let r=this._tileKeysPerLevel.length-1;for(;s>this.maxSize&&r>=0;)r!==e&&(s=this._pruneAroundCenterTile(s,t,i,r)),r--;s>this.maxSize&&(s=this._pruneAroundCenterTile(s,t,i,e))}_pruneAroundCenterTile(t,i,s,r){const l=this._tileKeysPerLevel[r];if(!l||0===l.length)return t;const{size:n,origin:h}=this.tileInfoView.tileInfo,o=s*n[0],u=s*n[1],d=[0,0],_=[0,0];for(l.sort(((t,s)=>(d[0]=h.x+o*(t.col+.5),d[1]=h.y-u*(t.row+.5),_[0]=h.x+o*(s.col+.5),_[1]=h.y-u*(s.row+.5),e(d,i)-e(_,i))));l.length>0;){const e=l.pop();if(this._removeTile(e.id),--t===this.maxSize)break}return t}_removeTile(e){const t=this._tilePerId.get(e);this.removedFunc&&this.removedFunc(t),i(this._tilePerId,e)}}function i(e,t){e.delete(t)}export{t as default};\n"]},"metadata":{},"sourceType":"module"}