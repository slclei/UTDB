{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport t from \"../../../../core/Error.js\";\nimport e from \"../../../../core/Logger.js\";\nimport { isSome as r, isNone as s } from \"../../../../core/maybe.js\";\nimport { c as i } from \"../../../../chunks/mat3f32.js\";\nimport { DisplayObject as o } from \"../DisplayObject.js\";\nimport h from \"./Mesh2D.js\";\nimport { VertexArrayObject as a } from \"../../../webgl/VertexArrayObject.js\";\n\nconst c = e.getLogger(\"esri.views.2d.engine.webgl.ClippingInfo\"),\n      n = t => parseFloat(t) / 100;\n\nclass m extends o {\n  constructor(t, e) {\n    super(), this._clip = e, this._cache = {}, this.stage = t, this._handle = e.watch(\"version\", () => this._invalidate()), this.ready();\n  }\n\n  static fromClipArea(t, e) {\n    return new m(t, e);\n  }\n\n  _destroyGL() {\n    r(this._cache.mesh) && (this._cache.mesh.destroy(), this._cache.mesh = null), r(this._cache.vao) && (this._cache.vao.dispose(), this._cache.vao = null);\n  }\n\n  destroy() {\n    this._destroyGL(), this._handle.remove();\n  }\n\n  getVAO(t, e, r, i) {\n    const [o, h] = e.size;\n\n    if (\"geometry\" !== this._clip.type && this._lastWidth === o && this._lastHeight === h || (this._lastWidth = o, this._lastHeight = h, this._destroyGL()), s(this._cache.vao)) {\n      const s = this._createMesh(e, this._clip),\n            o = s.getIndexBuffer(t),\n            h = s.getVertexBuffers(t);\n\n      this._cache.mesh = s, this._cache.vao = new a(t, r, i, h, o);\n    }\n\n    return this._cache.vao;\n  }\n\n  _createTransforms() {\n    return {\n      dvs: i()\n    };\n  }\n\n  _invalidate() {\n    this._destroyGL(), this.requestRender();\n  }\n\n  _createScreenRect(t, e) {\n    const [r, s] = t.size,\n          i = \"string\" == typeof e.left ? n(e.left) * r : e.left,\n          o = \"string\" == typeof e.right ? n(e.right) * r : e.right,\n          h = \"string\" == typeof e.top ? n(e.top) * s : e.top,\n          a = \"string\" == typeof e.bottom ? n(e.bottom) * s : e.bottom,\n          c = i,\n          m = h;\n    return {\n      x: c,\n      y: m,\n      width: Math.max(r - o - c, 0),\n      height: Math.max(s - a - m, 0)\n    };\n  }\n\n  _createMesh(e, r) {\n    switch (r.type) {\n      case \"rect\":\n        return h.fromRect(this._createScreenRect(e, r));\n\n      case \"path\":\n        return h.fromPath(r);\n\n      case \"geometry\":\n        return h.fromGeometry(e, r);\n\n      default:\n        return c.error(new t(\"mapview-bad-type\", \"Unable to create ClippingInfo mesh from clip of type: ${clip.type}\")), h.fromRect({\n          x: 0,\n          y: 0,\n          width: 1,\n          height: 1\n        });\n    }\n  }\n\n}\n\nexport { m as default };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/views/2d/engine/webgl/ClippingInfo.js"],"names":["t","e","isSome","r","isNone","s","c","i","DisplayObject","o","h","VertexArrayObject","a","getLogger","n","parseFloat","m","constructor","_clip","_cache","stage","_handle","watch","_invalidate","ready","fromClipArea","_destroyGL","mesh","destroy","vao","dispose","remove","getVAO","size","type","_lastWidth","_lastHeight","_createMesh","getIndexBuffer","getVertexBuffers","_createTransforms","dvs","requestRender","_createScreenRect","left","right","top","bottom","x","y","width","Math","max","height","fromRect","fromPath","fromGeometry","error","default"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport t from\"../../../../core/Error.js\";import e from\"../../../../core/Logger.js\";import{isSome as r,isNone as s}from\"../../../../core/maybe.js\";import{c as i}from\"../../../../chunks/mat3f32.js\";import{DisplayObject as o}from\"../DisplayObject.js\";import h from\"./Mesh2D.js\";import{VertexArrayObject as a}from\"../../../webgl/VertexArrayObject.js\";const c=e.getLogger(\"esri.views.2d.engine.webgl.ClippingInfo\"),n=t=>parseFloat(t)/100;class m extends o{constructor(t,e){super(),this._clip=e,this._cache={},this.stage=t,this._handle=e.watch(\"version\",(()=>this._invalidate())),this.ready()}static fromClipArea(t,e){return new m(t,e)}_destroyGL(){r(this._cache.mesh)&&(this._cache.mesh.destroy(),this._cache.mesh=null),r(this._cache.vao)&&(this._cache.vao.dispose(),this._cache.vao=null)}destroy(){this._destroyGL(),this._handle.remove()}getVAO(t,e,r,i){const[o,h]=e.size;if(\"geometry\"!==this._clip.type&&this._lastWidth===o&&this._lastHeight===h||(this._lastWidth=o,this._lastHeight=h,this._destroyGL()),s(this._cache.vao)){const s=this._createMesh(e,this._clip),o=s.getIndexBuffer(t),h=s.getVertexBuffers(t);this._cache.mesh=s,this._cache.vao=new a(t,r,i,h,o)}return this._cache.vao}_createTransforms(){return{dvs:i()}}_invalidate(){this._destroyGL(),this.requestRender()}_createScreenRect(t,e){const[r,s]=t.size,i=\"string\"==typeof e.left?n(e.left)*r:e.left,o=\"string\"==typeof e.right?n(e.right)*r:e.right,h=\"string\"==typeof e.top?n(e.top)*s:e.top,a=\"string\"==typeof e.bottom?n(e.bottom)*s:e.bottom,c=i,m=h;return{x:c,y:m,width:Math.max(r-o-c,0),height:Math.max(s-a-m,0)}}_createMesh(e,r){switch(r.type){case\"rect\":return h.fromRect(this._createScreenRect(e,r));case\"path\":return h.fromPath(r);case\"geometry\":return h.fromGeometry(e,r);default:return c.error(new t(\"mapview-bad-type\",\"Unable to create ClippingInfo mesh from clip of type: ${clip.type}\")),h.fromRect({x:0,y:0,width:1,height:1})}}}export{m as default};\n"]},"metadata":{},"sourceType":"module"}