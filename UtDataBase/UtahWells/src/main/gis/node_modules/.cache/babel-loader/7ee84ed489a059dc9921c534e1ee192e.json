{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport { isNone as e } from \"../../../../core/maybe.js\";\nimport a from \"../webgl/brushes/WGLBrush.js\";\nimport { BlendFactor as t, StencilOperation as r, CompareFunction as s, PrimitiveType as o, DataType as n } from \"../../../webgl/enums.js\";\nconst i = new Float32Array([.27058823529411763, .4588235294117647, .7098039215686275, 1, .396078431372549, .5372549019607843, .7215686274509804, 1, .5176470588235295, .6196078431372549, .7294117647058823, 1, .6352941176470588, .7058823529411765, .7411764705882353, 1, .7529411764705882, .8, .7450980392156863, 1, .8705882352941177, .8901960784313725, .7490196078431373, 1, 1, 1, .7490196078431373, 1, 1, .8627450980392157, .6313725490196078, 1, .9803921568627451, .7254901960784313, .5176470588235295, 1, .9607843137254902, .596078431372549, .4117647058823529, 1, .9294117647058824, .4588235294117647, .3176470588235294, 1, .9098039215686274, .08235294117647059, .08235294117647059, 1]),\n      l = {\n  beaufort_ft: i,\n  beaufort_m: i,\n  beaufort_km: i,\n  beaufort_mi: i,\n  beaufort_kn: new Float32Array([.1568627450980392, .5725490196078431, .7803921568627451, 1, .34901960784313724, .6352941176470588, .7294117647058823, 1, .5058823529411764, .7019607843137254, .6705882352941176, 1, .6274509803921569, .7607843137254902, .6078431372549019, 1, .7490196078431373, .8313725490196079, .5411764705882353, 1, .8549019607843137, .9019607843137255, .4666666666666667, 1, .9803921568627451, .9803921568627451, .39215686274509803, 1, .9882352941176471, .8352941176470589, .3254901960784314, 1, .9882352941176471, .7019607843137254, .4, 1, .9803921568627451, .5529411764705883, .20392156862745098, 1, .9686274509803922, .43137254901960786, .16470588235294117, 1, .9411764705882353, .2784313725490196, .11372549019607843, 1]),\n  classified_arrow: new Float32Array([.2196078431372549, .6588235294117647, 0, 1, .5450980392156862, 1.2117647058823529, 0, 1, 1, 1, 0, 1, 1, .5019607843137255, 0, 1, 1, 0, 0, 1]),\n  ocean_current_m: new Float32Array([.3058823529411765, .10196078431372549, .6, 1, .7019607843137254, .10588235294117647, .10196078431372549, 1, .792156862745098, .5019607843137255, .10196078431372549, 1, .6941176470588235, .6941176470588235, .6941176470588235, 1]),\n  ocean_current_kn: new Float32Array([0, 0, 0, 1, 0, .1450980392156863, .39215686274509803, 1, .3058823529411765, .10196078431372549, .6, 1, .592156862745098, 0, .39215686274509803, 1, .7019607843137254, .10588235294117647, .10196078431372549, 1, .6941176470588235, .3058823529411765, .10196078431372549, 1, .792156862745098, .5019607843137255, .10196078431372549, 1, .6941176470588235, .7019607843137254, .20392156862745098, 1, .6941176470588235, .6941176470588235, .6941176470588235, 1]),\n  single_arrow: new Float32Array([0, 92 / 255, 230 / 255, 1]),\n  wind_speed: new Float32Array([0, 0, 0, 1])\n};\n\nclass c extends a {\n  constructor() {\n    super(...arguments), this._desc = {\n      magdir: {\n        vsPath: \"raster/magdir\",\n        fsPath: \"raster/magdir\",\n        attributes: new Map([[\"a_pos\", 0], [\"a_offset\", 1], [\"a_vv\", 2]])\n      },\n      scalar: {\n        vsPath: \"raster/scalar\",\n        fsPath: \"raster/scalar\",\n        attributes: new Map([[\"a_pos\", 0], [\"a_offset\", 1], [\"a_vv\", 2]])\n      }\n    };\n  }\n\n  dispose() {}\n\n  prepareState(_ref, a) {\n    let {\n      context: e\n    } = _ref;\n    e.setBlendingEnabled(!0), e.setBlendFunctionSeparate(t.ONE, t.ONE_MINUS_SRC_ALPHA, t.ONE, t.ONE_MINUS_SRC_ALPHA), e.setColorMask(!0, !0, !0, !0), e.setStencilWriteMask(0), e.setStencilTestEnabled(!0), e.setStencilOp(r.KEEP, r.KEEP, r.REPLACE), e.setStencilFunction(s.EQUAL, a.stencilRef, 255);\n  }\n\n  draw(a, t) {\n    if (e(t.source) || 0 === t.source.validPixelCount) return;\n    const {\n      timeline: r\n    } = a;\n\n    if (r.begin(this.name), t.updateVectorFieldVAO(a), \"scalar\" === a.renderPass) {\n      const e = t.vaoData.scalar;\n      e && this._drawScalars(a, t, e.vao, e.elementCount);\n    } else {\n      const e = t.vaoData.magdir;\n      e && this._drawTriangles(a, t, e.vao, e.elementCount);\n    }\n\n    r.end(this.name);\n  }\n\n  _drawTriangles(e, a, t, r) {\n    const {\n      context: s,\n      painter: i\n    } = e,\n          {\n      symbolizerParameters: c\n    } = a,\n          m = c.dataRange ? [\"dataRange\"] : [];\n    \"geographic\" === c.rotationType && m.push(\"rotationGeographic\");\n    const d = i.materialManager.getProgram(e, this._desc.magdir, m);\n    s.useProgram(d);\n    const {\n      coordScale: f,\n      opacity: _,\n      transforms: u\n    } = a;\n    d.setUniform2fv(\"u_coordScale\", f), d.setUniform1f(\"u_opacity\", _), d.setUniformMatrix3fv(\"u_dvsMat3\", u.dvs);\n    const {\n      style: g,\n      dataRange: p,\n      rotation: y,\n      symbolPercentRange: b\n    } = c;\n    d.setUniform4fv(\"u_colors\", l[g] || l.single_arrow), d.setUniform2fv(\"u_dataRange\", p), d.setUniform1f(\"u_rotation\", y), d.setUniform2fv(\"u_symbolPercentRange\", b);\n\n    const S = this._getSymbolSize(e, a);\n\n    d.setUniform2fv(\"u_symbolSize\", S), s.bindVAO(t), s.drawElements(o.TRIANGLES, r, n.UNSIGNED_INT, 0);\n  }\n\n  _drawScalars(e, a, t, r) {\n    const {\n      context: s,\n      painter: i\n    } = e,\n          {\n      symbolizerParameters: l\n    } = a,\n          c = [];\n    \"wind_speed\" === l.style ? c.push(\"innerCircle\") : l.dataRange && c.push(\"dataRange\"), \"geographic\" === l.rotationType && c.push(\"rotationGeographic\");\n    const m = i.materialManager.getProgram(e, this._desc.scalar, c);\n    s.useProgram(m);\n    const {\n      coordScale: d,\n      opacity: f,\n      transforms: _\n    } = a;\n    m.setUniform2fv(\"u_coordScale\", d), m.setUniform1f(\"u_opacity\", f), m.setUniformMatrix3fv(\"u_dvsMat3\", _.dvs);\n    const {\n      dataRange: u,\n      symbolPercentRange: g\n    } = l;\n    m.setUniform2fv(\"u_dataRange\", u), m.setUniform2fv(\"u_symbolPercentRange\", g);\n\n    const p = this._getSymbolSize(e, a);\n\n    m.setUniform2fv(\"u_symbolSize\", p), s.bindVAO(t), s.drawElements(o.TRIANGLES, r, n.UNSIGNED_INT, 0);\n  }\n\n  _getSymbolSize(e, a) {\n    const t = a.key ? 2 ** (e.displayLevel - a.key.level) : a.resolution / e.state.resolution,\n          {\n      symbolTileSize: r\n    } = a.symbolizerParameters;\n    return [r / (Math.round((a.width - a.offset[0]) / r) * r) / t, r / (Math.round((a.height - a.offset[1]) / r) * r) / t];\n  }\n\n}\n\nexport { c as default };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/views/2d/engine/imagery/BrushVectorField.js"],"names":["isNone","e","a","BlendFactor","t","StencilOperation","r","CompareFunction","s","PrimitiveType","o","DataType","n","i","Float32Array","l","beaufort_ft","beaufort_m","beaufort_km","beaufort_mi","beaufort_kn","classified_arrow","ocean_current_m","ocean_current_kn","single_arrow","wind_speed","c","constructor","arguments","_desc","magdir","vsPath","fsPath","attributes","Map","scalar","dispose","prepareState","context","setBlendingEnabled","setBlendFunctionSeparate","ONE","ONE_MINUS_SRC_ALPHA","setColorMask","setStencilWriteMask","setStencilTestEnabled","setStencilOp","KEEP","REPLACE","setStencilFunction","EQUAL","stencilRef","draw","source","validPixelCount","timeline","begin","name","updateVectorFieldVAO","renderPass","vaoData","_drawScalars","vao","elementCount","_drawTriangles","end","painter","symbolizerParameters","m","dataRange","rotationType","push","d","materialManager","getProgram","useProgram","coordScale","f","opacity","_","transforms","u","setUniform2fv","setUniform1f","setUniformMatrix3fv","dvs","style","g","p","rotation","y","symbolPercentRange","b","setUniform4fv","S","_getSymbolSize","bindVAO","drawElements","TRIANGLES","UNSIGNED_INT","key","displayLevel","level","resolution","state","symbolTileSize","Math","round","width","offset","height","default"],"mappings":"AAAA;AACA;AACA;AACA;AACA,SAAOA,MAAM,IAAIC,CAAjB,QAAuB,2BAAvB;AAAmD,OAAOC,CAAP,MAAa,8BAAb;AAA4C,SAAOC,WAAW,IAAIC,CAAtB,EAAwBC,gBAAgB,IAAIC,CAA5C,EAA8CC,eAAe,IAAIC,CAAjE,EAAmEC,aAAa,IAAIC,CAApF,EAAsFC,QAAQ,IAAIC,CAAlG,QAAwG,yBAAxG;AAAkI,MAAMC,CAAC,GAAC,IAAIC,YAAJ,CAAiB,CAAC,kBAAD,EAAoB,iBAApB,EAAsC,iBAAtC,EAAwD,CAAxD,EAA0D,gBAA1D,EAA2E,iBAA3E,EAA6F,iBAA7F,EAA+G,CAA/G,EAAiH,iBAAjH,EAAmI,iBAAnI,EAAqJ,iBAArJ,EAAuK,CAAvK,EAAyK,iBAAzK,EAA2L,iBAA3L,EAA6M,iBAA7M,EAA+N,CAA/N,EAAiO,iBAAjO,EAAmP,EAAnP,EAAsP,iBAAtP,EAAwQ,CAAxQ,EAA0Q,iBAA1Q,EAA4R,iBAA5R,EAA8S,iBAA9S,EAAgU,CAAhU,EAAkU,CAAlU,EAAoU,CAApU,EAAsU,iBAAtU,EAAwV,CAAxV,EAA0V,CAA1V,EAA4V,iBAA5V,EAA8W,iBAA9W,EAAgY,CAAhY,EAAkY,iBAAlY,EAAoZ,iBAApZ,EAAsa,iBAAta,EAAwb,CAAxb,EAA0b,iBAA1b,EAA4c,gBAA5c,EAA6d,iBAA7d,EAA+e,CAA/e,EAAif,iBAAjf,EAAmgB,iBAAngB,EAAqhB,iBAArhB,EAAuiB,CAAviB,EAAyiB,iBAAziB,EAA2jB,kBAA3jB,EAA8kB,kBAA9kB,EAAimB,CAAjmB,CAAjB,CAAR;AAAA,MAA8nBC,CAAC,GAAC;AAACC,EAAAA,WAAW,EAACH,CAAb;AAAeI,EAAAA,UAAU,EAACJ,CAA1B;AAA4BK,EAAAA,WAAW,EAACL,CAAxC;AAA0CM,EAAAA,WAAW,EAACN,CAAtD;AAAwDO,EAAAA,WAAW,EAAC,IAAIN,YAAJ,CAAiB,CAAC,iBAAD,EAAmB,iBAAnB,EAAqC,iBAArC,EAAuD,CAAvD,EAAyD,kBAAzD,EAA4E,iBAA5E,EAA8F,iBAA9F,EAAgH,CAAhH,EAAkH,iBAAlH,EAAoI,iBAApI,EAAsJ,iBAAtJ,EAAwK,CAAxK,EAA0K,iBAA1K,EAA4L,iBAA5L,EAA8M,iBAA9M,EAAgO,CAAhO,EAAkO,iBAAlO,EAAoP,iBAApP,EAAsQ,iBAAtQ,EAAwR,CAAxR,EAA0R,iBAA1R,EAA4S,iBAA5S,EAA8T,iBAA9T,EAAgV,CAAhV,EAAkV,iBAAlV,EAAoW,iBAApW,EAAsX,kBAAtX,EAAyY,CAAzY,EAA2Y,iBAA3Y,EAA6Z,iBAA7Z,EAA+a,iBAA/a,EAAic,CAAjc,EAAmc,iBAAnc,EAAqd,iBAArd,EAAue,EAAve,EAA0e,CAA1e,EAA4e,iBAA5e,EAA8f,iBAA9f,EAAghB,kBAAhhB,EAAmiB,CAAniB,EAAqiB,iBAAriB,EAAujB,kBAAvjB,EAA0kB,kBAA1kB,EAA6lB,CAA7lB,EAA+lB,iBAA/lB,EAAinB,iBAAjnB,EAAmoB,kBAAnoB,EAAspB,CAAtpB,CAAjB,CAApE;AAA+uBO,EAAAA,gBAAgB,EAAC,IAAIP,YAAJ,CAAiB,CAAC,iBAAD,EAAmB,iBAAnB,EAAqC,CAArC,EAAuC,CAAvC,EAAyC,iBAAzC,EAA2D,kBAA3D,EAA8E,CAA9E,EAAgF,CAAhF,EAAkF,CAAlF,EAAoF,CAApF,EAAsF,CAAtF,EAAwF,CAAxF,EAA0F,CAA1F,EAA4F,iBAA5F,EAA8G,CAA9G,EAAgH,CAAhH,EAAkH,CAAlH,EAAoH,CAApH,EAAsH,CAAtH,EAAwH,CAAxH,CAAjB,CAAhwB;AAA64BQ,EAAAA,eAAe,EAAC,IAAIR,YAAJ,CAAiB,CAAC,iBAAD,EAAmB,kBAAnB,EAAsC,EAAtC,EAAyC,CAAzC,EAA2C,iBAA3C,EAA6D,kBAA7D,EAAgF,kBAAhF,EAAmG,CAAnG,EAAqG,gBAArG,EAAsH,iBAAtH,EAAwI,kBAAxI,EAA2J,CAA3J,EAA6J,iBAA7J,EAA+K,iBAA/K,EAAiM,iBAAjM,EAAmN,CAAnN,CAAjB,CAA75B;AAAqoCS,EAAAA,gBAAgB,EAAC,IAAIT,YAAJ,CAAiB,CAAC,CAAD,EAAG,CAAH,EAAK,CAAL,EAAO,CAAP,EAAS,CAAT,EAAW,iBAAX,EAA6B,kBAA7B,EAAgD,CAAhD,EAAkD,iBAAlD,EAAoE,kBAApE,EAAuF,EAAvF,EAA0F,CAA1F,EAA4F,gBAA5F,EAA6G,CAA7G,EAA+G,kBAA/G,EAAkI,CAAlI,EAAoI,iBAApI,EAAsJ,kBAAtJ,EAAyK,kBAAzK,EAA4L,CAA5L,EAA8L,iBAA9L,EAAgN,iBAAhN,EAAkO,kBAAlO,EAAqP,CAArP,EAAuP,gBAAvP,EAAwQ,iBAAxQ,EAA0R,kBAA1R,EAA6S,CAA7S,EAA+S,iBAA/S,EAAiU,iBAAjU,EAAmV,kBAAnV,EAAsW,CAAtW,EAAwW,iBAAxW,EAA0X,iBAA1X,EAA4Y,iBAA5Y,EAA8Z,CAA9Z,CAAjB,CAAtpC;AAAykDU,EAAAA,YAAY,EAAC,IAAIV,YAAJ,CAAiB,CAAC,CAAD,EAAG,KAAG,GAAN,EAAU,MAAI,GAAd,EAAkB,CAAlB,CAAjB,CAAtlD;AAA6nDW,EAAAA,UAAU,EAAC,IAAIX,YAAJ,CAAiB,CAAC,CAAD,EAAG,CAAH,EAAK,CAAL,EAAO,CAAP,CAAjB;AAAxoD,CAAhoB;;AAAqyE,MAAMY,CAAN,SAAgBxB,CAAhB,CAAiB;AAACyB,EAAAA,WAAW,GAAE;AAAC,UAAM,GAAGC,SAAT,GAAoB,KAAKC,KAAL,GAAW;AAACC,MAAAA,MAAM,EAAC;AAACC,QAAAA,MAAM,EAAC,eAAR;AAAwBC,QAAAA,MAAM,EAAC,eAA/B;AAA+CC,QAAAA,UAAU,EAAC,IAAIC,GAAJ,CAAQ,CAAC,CAAC,OAAD,EAAS,CAAT,CAAD,EAAa,CAAC,UAAD,EAAY,CAAZ,CAAb,EAA4B,CAAC,MAAD,EAAQ,CAAR,CAA5B,CAAR;AAA1D,OAAR;AAAoHC,MAAAA,MAAM,EAAC;AAACJ,QAAAA,MAAM,EAAC,eAAR;AAAwBC,QAAAA,MAAM,EAAC,eAA/B;AAA+CC,QAAAA,UAAU,EAAC,IAAIC,GAAJ,CAAQ,CAAC,CAAC,OAAD,EAAS,CAAT,CAAD,EAAa,CAAC,UAAD,EAAY,CAAZ,CAAb,EAA4B,CAAC,MAAD,EAAQ,CAAR,CAA5B,CAAR;AAA1D;AAA3H,KAA/B;AAAuQ;;AAAAE,EAAAA,OAAO,GAAE,CAAE;;AAAAC,EAAAA,YAAY,OAAanC,CAAb,EAAe;AAAA,QAAd;AAACoC,MAAAA,OAAO,EAACrC;AAAT,KAAc;AAACA,IAAAA,CAAC,CAACsC,kBAAF,CAAqB,CAAC,CAAtB,GAAyBtC,CAAC,CAACuC,wBAAF,CAA2BpC,CAAC,CAACqC,GAA7B,EAAiCrC,CAAC,CAACsC,mBAAnC,EAAuDtC,CAAC,CAACqC,GAAzD,EAA6DrC,CAAC,CAACsC,mBAA/D,CAAzB,EAA6GzC,CAAC,CAAC0C,YAAF,CAAe,CAAC,CAAhB,EAAkB,CAAC,CAAnB,EAAqB,CAAC,CAAtB,EAAwB,CAAC,CAAzB,CAA7G,EAAyI1C,CAAC,CAAC2C,mBAAF,CAAsB,CAAtB,CAAzI,EAAkK3C,CAAC,CAAC4C,qBAAF,CAAwB,CAAC,CAAzB,CAAlK,EAA8L5C,CAAC,CAAC6C,YAAF,CAAexC,CAAC,CAACyC,IAAjB,EAAsBzC,CAAC,CAACyC,IAAxB,EAA6BzC,CAAC,CAAC0C,OAA/B,CAA9L,EAAsO/C,CAAC,CAACgD,kBAAF,CAAqBzC,CAAC,CAAC0C,KAAvB,EAA6BhD,CAAC,CAACiD,UAA/B,EAA0C,GAA1C,CAAtO;AAAqR;;AAAAC,EAAAA,IAAI,CAAClD,CAAD,EAAGE,CAAH,EAAK;AAAC,QAAGH,CAAC,CAACG,CAAC,CAACiD,MAAH,CAAD,IAAa,MAAIjD,CAAC,CAACiD,MAAF,CAASC,eAA7B,EAA6C;AAAO,UAAK;AAACC,MAAAA,QAAQ,EAACjD;AAAV,QAAaJ,CAAlB;;AAAoB,QAAGI,CAAC,CAACkD,KAAF,CAAQ,KAAKC,IAAb,GAAmBrD,CAAC,CAACsD,oBAAF,CAAuBxD,CAAvB,CAAnB,EAA6C,aAAWA,CAAC,CAACyD,UAA7D,EAAwE;AAAC,YAAM1D,CAAC,GAACG,CAAC,CAACwD,OAAF,CAAUzB,MAAlB;AAAyBlC,MAAAA,CAAC,IAAE,KAAK4D,YAAL,CAAkB3D,CAAlB,EAAoBE,CAApB,EAAsBH,CAAC,CAAC6D,GAAxB,EAA4B7D,CAAC,CAAC8D,YAA9B,CAAH;AAA+C,KAAjJ,MAAqJ;AAAC,YAAM9D,CAAC,GAACG,CAAC,CAACwD,OAAF,CAAU9B,MAAlB;AAAyB7B,MAAAA,CAAC,IAAE,KAAK+D,cAAL,CAAoB9D,CAApB,EAAsBE,CAAtB,EAAwBH,CAAC,CAAC6D,GAA1B,EAA8B7D,CAAC,CAAC8D,YAAhC,CAAH;AAAiD;;AAAAzD,IAAAA,CAAC,CAAC2D,GAAF,CAAM,KAAKR,IAAX;AAAiB;;AAAAO,EAAAA,cAAc,CAAC/D,CAAD,EAAGC,CAAH,EAAKE,CAAL,EAAOE,CAAP,EAAS;AAAC,UAAK;AAACgC,MAAAA,OAAO,EAAC9B,CAAT;AAAW0D,MAAAA,OAAO,EAACrD;AAAnB,QAAsBZ,CAA3B;AAAA,UAA6B;AAACkE,MAAAA,oBAAoB,EAACzC;AAAtB,QAAyBxB,CAAtD;AAAA,UAAwDkE,CAAC,GAAC1C,CAAC,CAAC2C,SAAF,GAAY,CAAC,WAAD,CAAZ,GAA0B,EAApF;AAAuF,qBAAe3C,CAAC,CAAC4C,YAAjB,IAA+BF,CAAC,CAACG,IAAF,CAAO,oBAAP,CAA/B;AAA4D,UAAMC,CAAC,GAAC3D,CAAC,CAAC4D,eAAF,CAAkBC,UAAlB,CAA6BzE,CAA7B,EAA+B,KAAK4B,KAAL,CAAWC,MAA1C,EAAiDsC,CAAjD,CAAR;AAA4D5D,IAAAA,CAAC,CAACmE,UAAF,CAAaH,CAAb;AAAgB,UAAK;AAACI,MAAAA,UAAU,EAACC,CAAZ;AAAcC,MAAAA,OAAO,EAACC,CAAtB;AAAwBC,MAAAA,UAAU,EAACC;AAAnC,QAAsC/E,CAA3C;AAA6CsE,IAAAA,CAAC,CAACU,aAAF,CAAgB,cAAhB,EAA+BL,CAA/B,GAAkCL,CAAC,CAACW,YAAF,CAAe,WAAf,EAA2BJ,CAA3B,CAAlC,EAAgEP,CAAC,CAACY,mBAAF,CAAsB,WAAtB,EAAkCH,CAAC,CAACI,GAApC,CAAhE;AAAyG,UAAK;AAACC,MAAAA,KAAK,EAACC,CAAP;AAASlB,MAAAA,SAAS,EAACmB,CAAnB;AAAqBC,MAAAA,QAAQ,EAACC,CAA9B;AAAgCC,MAAAA,kBAAkB,EAACC;AAAnD,QAAsDlE,CAA3D;AAA6D8C,IAAAA,CAAC,CAACqB,aAAF,CAAgB,UAAhB,EAA2B9E,CAAC,CAACwE,CAAD,CAAD,IAAMxE,CAAC,CAACS,YAAnC,GAAiDgD,CAAC,CAACU,aAAF,CAAgB,aAAhB,EAA8BM,CAA9B,CAAjD,EAAkFhB,CAAC,CAACW,YAAF,CAAe,YAAf,EAA4BO,CAA5B,CAAlF,EAAiHlB,CAAC,CAACU,aAAF,CAAgB,sBAAhB,EAAuCU,CAAvC,CAAjH;;AAA2J,UAAME,CAAC,GAAC,KAAKC,cAAL,CAAoB9F,CAApB,EAAsBC,CAAtB,CAAR;;AAAiCsE,IAAAA,CAAC,CAACU,aAAF,CAAgB,cAAhB,EAA+BY,CAA/B,GAAkCtF,CAAC,CAACwF,OAAF,CAAU5F,CAAV,CAAlC,EAA+CI,CAAC,CAACyF,YAAF,CAAevF,CAAC,CAACwF,SAAjB,EAA2B5F,CAA3B,EAA6BM,CAAC,CAACuF,YAA/B,EAA4C,CAA5C,CAA/C;AAA8F;;AAAAtC,EAAAA,YAAY,CAAC5D,CAAD,EAAGC,CAAH,EAAKE,CAAL,EAAOE,CAAP,EAAS;AAAC,UAAK;AAACgC,MAAAA,OAAO,EAAC9B,CAAT;AAAW0D,MAAAA,OAAO,EAACrD;AAAnB,QAAsBZ,CAA3B;AAAA,UAA6B;AAACkE,MAAAA,oBAAoB,EAACpD;AAAtB,QAAyBb,CAAtD;AAAA,UAAwDwB,CAAC,GAAC,EAA1D;AAA6D,qBAAeX,CAAC,CAACuE,KAAjB,GAAuB5D,CAAC,CAAC6C,IAAF,CAAO,aAAP,CAAvB,GAA6CxD,CAAC,CAACsD,SAAF,IAAa3C,CAAC,CAAC6C,IAAF,CAAO,WAAP,CAA1D,EAA8E,iBAAexD,CAAC,CAACuD,YAAjB,IAA+B5C,CAAC,CAAC6C,IAAF,CAAO,oBAAP,CAA7G;AAA0I,UAAMH,CAAC,GAACvD,CAAC,CAAC4D,eAAF,CAAkBC,UAAlB,CAA6BzE,CAA7B,EAA+B,KAAK4B,KAAL,CAAWM,MAA1C,EAAiDT,CAAjD,CAAR;AAA4DlB,IAAAA,CAAC,CAACmE,UAAF,CAAaP,CAAb;AAAgB,UAAK;AAACQ,MAAAA,UAAU,EAACJ,CAAZ;AAAcM,MAAAA,OAAO,EAACD,CAAtB;AAAwBG,MAAAA,UAAU,EAACD;AAAnC,QAAsC7E,CAA3C;AAA6CkE,IAAAA,CAAC,CAACc,aAAF,CAAgB,cAAhB,EAA+BV,CAA/B,GAAkCJ,CAAC,CAACe,YAAF,CAAe,WAAf,EAA2BN,CAA3B,CAAlC,EAAgET,CAAC,CAACgB,mBAAF,CAAsB,WAAtB,EAAkCL,CAAC,CAACM,GAApC,CAAhE;AAAyG,UAAK;AAAChB,MAAAA,SAAS,EAACY,CAAX;AAAaU,MAAAA,kBAAkB,EAACJ;AAAhC,QAAmCxE,CAAxC;AAA0CqD,IAAAA,CAAC,CAACc,aAAF,CAAgB,aAAhB,EAA8BD,CAA9B,GAAiCb,CAAC,CAACc,aAAF,CAAgB,sBAAhB,EAAuCK,CAAvC,CAAjC;;AAA2E,UAAMC,CAAC,GAAC,KAAKO,cAAL,CAAoB9F,CAApB,EAAsBC,CAAtB,CAAR;;AAAiCkE,IAAAA,CAAC,CAACc,aAAF,CAAgB,cAAhB,EAA+BM,CAA/B,GAAkChF,CAAC,CAACwF,OAAF,CAAU5F,CAAV,CAAlC,EAA+CI,CAAC,CAACyF,YAAF,CAAevF,CAAC,CAACwF,SAAjB,EAA2B5F,CAA3B,EAA6BM,CAAC,CAACuF,YAA/B,EAA4C,CAA5C,CAA/C;AAA8F;;AAAAJ,EAAAA,cAAc,CAAC9F,CAAD,EAAGC,CAAH,EAAK;AAAC,UAAME,CAAC,GAACF,CAAC,CAACkG,GAAF,GAAM,MAAInG,CAAC,CAACoG,YAAF,GAAenG,CAAC,CAACkG,GAAF,CAAME,KAAzB,CAAN,GAAsCpG,CAAC,CAACqG,UAAF,GAAatG,CAAC,CAACuG,KAAF,CAAQD,UAAnE;AAAA,UAA8E;AAACE,MAAAA,cAAc,EAACnG;AAAhB,QAAmBJ,CAAC,CAACiE,oBAAnG;AAAwH,WAAM,CAAC7D,CAAC,IAAEoG,IAAI,CAACC,KAAL,CAAW,CAACzG,CAAC,CAAC0G,KAAF,GAAQ1G,CAAC,CAAC2G,MAAF,CAAS,CAAT,CAAT,IAAsBvG,CAAjC,IAAoCA,CAAtC,CAAD,GAA0CF,CAA3C,EAA6CE,CAAC,IAAEoG,IAAI,CAACC,KAAL,CAAW,CAACzG,CAAC,CAAC4G,MAAF,GAAS5G,CAAC,CAAC2G,MAAF,CAAS,CAAT,CAAV,IAAuBvG,CAAlC,IAAqCA,CAAvC,CAAD,GAA2CF,CAAxF,CAAN;AAAiG;;AAAzhF;;AAA0hF,SAAOsB,CAAC,IAAIqF,OAAZ","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{isNone as e}from\"../../../../core/maybe.js\";import a from\"../webgl/brushes/WGLBrush.js\";import{BlendFactor as t,StencilOperation as r,CompareFunction as s,PrimitiveType as o,DataType as n}from\"../../../webgl/enums.js\";const i=new Float32Array([.27058823529411763,.4588235294117647,.7098039215686275,1,.396078431372549,.5372549019607843,.7215686274509804,1,.5176470588235295,.6196078431372549,.7294117647058823,1,.6352941176470588,.7058823529411765,.7411764705882353,1,.7529411764705882,.8,.7450980392156863,1,.8705882352941177,.8901960784313725,.7490196078431373,1,1,1,.7490196078431373,1,1,.8627450980392157,.6313725490196078,1,.9803921568627451,.7254901960784313,.5176470588235295,1,.9607843137254902,.596078431372549,.4117647058823529,1,.9294117647058824,.4588235294117647,.3176470588235294,1,.9098039215686274,.08235294117647059,.08235294117647059,1]),l={beaufort_ft:i,beaufort_m:i,beaufort_km:i,beaufort_mi:i,beaufort_kn:new Float32Array([.1568627450980392,.5725490196078431,.7803921568627451,1,.34901960784313724,.6352941176470588,.7294117647058823,1,.5058823529411764,.7019607843137254,.6705882352941176,1,.6274509803921569,.7607843137254902,.6078431372549019,1,.7490196078431373,.8313725490196079,.5411764705882353,1,.8549019607843137,.9019607843137255,.4666666666666667,1,.9803921568627451,.9803921568627451,.39215686274509803,1,.9882352941176471,.8352941176470589,.3254901960784314,1,.9882352941176471,.7019607843137254,.4,1,.9803921568627451,.5529411764705883,.20392156862745098,1,.9686274509803922,.43137254901960786,.16470588235294117,1,.9411764705882353,.2784313725490196,.11372549019607843,1]),classified_arrow:new Float32Array([.2196078431372549,.6588235294117647,0,1,.5450980392156862,1.2117647058823529,0,1,1,1,0,1,1,.5019607843137255,0,1,1,0,0,1]),ocean_current_m:new Float32Array([.3058823529411765,.10196078431372549,.6,1,.7019607843137254,.10588235294117647,.10196078431372549,1,.792156862745098,.5019607843137255,.10196078431372549,1,.6941176470588235,.6941176470588235,.6941176470588235,1]),ocean_current_kn:new Float32Array([0,0,0,1,0,.1450980392156863,.39215686274509803,1,.3058823529411765,.10196078431372549,.6,1,.592156862745098,0,.39215686274509803,1,.7019607843137254,.10588235294117647,.10196078431372549,1,.6941176470588235,.3058823529411765,.10196078431372549,1,.792156862745098,.5019607843137255,.10196078431372549,1,.6941176470588235,.7019607843137254,.20392156862745098,1,.6941176470588235,.6941176470588235,.6941176470588235,1]),single_arrow:new Float32Array([0,92/255,230/255,1]),wind_speed:new Float32Array([0,0,0,1])};class c extends a{constructor(){super(...arguments),this._desc={magdir:{vsPath:\"raster/magdir\",fsPath:\"raster/magdir\",attributes:new Map([[\"a_pos\",0],[\"a_offset\",1],[\"a_vv\",2]])},scalar:{vsPath:\"raster/scalar\",fsPath:\"raster/scalar\",attributes:new Map([[\"a_pos\",0],[\"a_offset\",1],[\"a_vv\",2]])}}}dispose(){}prepareState({context:e},a){e.setBlendingEnabled(!0),e.setBlendFunctionSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA),e.setColorMask(!0,!0,!0,!0),e.setStencilWriteMask(0),e.setStencilTestEnabled(!0),e.setStencilOp(r.KEEP,r.KEEP,r.REPLACE),e.setStencilFunction(s.EQUAL,a.stencilRef,255)}draw(a,t){if(e(t.source)||0===t.source.validPixelCount)return;const{timeline:r}=a;if(r.begin(this.name),t.updateVectorFieldVAO(a),\"scalar\"===a.renderPass){const e=t.vaoData.scalar;e&&this._drawScalars(a,t,e.vao,e.elementCount)}else{const e=t.vaoData.magdir;e&&this._drawTriangles(a,t,e.vao,e.elementCount)}r.end(this.name)}_drawTriangles(e,a,t,r){const{context:s,painter:i}=e,{symbolizerParameters:c}=a,m=c.dataRange?[\"dataRange\"]:[];\"geographic\"===c.rotationType&&m.push(\"rotationGeographic\");const d=i.materialManager.getProgram(e,this._desc.magdir,m);s.useProgram(d);const{coordScale:f,opacity:_,transforms:u}=a;d.setUniform2fv(\"u_coordScale\",f),d.setUniform1f(\"u_opacity\",_),d.setUniformMatrix3fv(\"u_dvsMat3\",u.dvs);const{style:g,dataRange:p,rotation:y,symbolPercentRange:b}=c;d.setUniform4fv(\"u_colors\",l[g]||l.single_arrow),d.setUniform2fv(\"u_dataRange\",p),d.setUniform1f(\"u_rotation\",y),d.setUniform2fv(\"u_symbolPercentRange\",b);const S=this._getSymbolSize(e,a);d.setUniform2fv(\"u_symbolSize\",S),s.bindVAO(t),s.drawElements(o.TRIANGLES,r,n.UNSIGNED_INT,0)}_drawScalars(e,a,t,r){const{context:s,painter:i}=e,{symbolizerParameters:l}=a,c=[];\"wind_speed\"===l.style?c.push(\"innerCircle\"):l.dataRange&&c.push(\"dataRange\"),\"geographic\"===l.rotationType&&c.push(\"rotationGeographic\");const m=i.materialManager.getProgram(e,this._desc.scalar,c);s.useProgram(m);const{coordScale:d,opacity:f,transforms:_}=a;m.setUniform2fv(\"u_coordScale\",d),m.setUniform1f(\"u_opacity\",f),m.setUniformMatrix3fv(\"u_dvsMat3\",_.dvs);const{dataRange:u,symbolPercentRange:g}=l;m.setUniform2fv(\"u_dataRange\",u),m.setUniform2fv(\"u_symbolPercentRange\",g);const p=this._getSymbolSize(e,a);m.setUniform2fv(\"u_symbolSize\",p),s.bindVAO(t),s.drawElements(o.TRIANGLES,r,n.UNSIGNED_INT,0)}_getSymbolSize(e,a){const t=a.key?2**(e.displayLevel-a.key.level):a.resolution/e.state.resolution,{symbolTileSize:r}=a.symbolizerParameters;return[r/(Math.round((a.width-a.offset[0])/r)*r)/t,r/(Math.round((a.height-a.offset[1])/r)*r)/t]}}export{c as default};\n"]},"metadata":{},"sourceType":"module"}