{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport e from \"./config.js\";\nimport { id as t } from \"./kernel.js\";\nimport r from \"./core/Error.js\";\nimport s from \"./core/has.js\";\nimport { clone as o } from \"./core/lang.js\";\nimport { unwrap as n } from \"./core/maybe.js\";\nimport { onAbort as a, isAbortError as i, createAbortError as l, isAborted as u } from \"./core/promiseUtils.js\";\nimport { isDataProtocol as c, isBlobProtocol as d, normalize as p, getInterceptor as m, isTrustedServer as h, getOrigin as f, toHTTPS as y, addQueryParameter as w, objectToQuery as g, getProxyRule as b, getProxyUrl as q, addQueryParameters as T, hasSameOrigin as k, getAppUrl as O, addProxyRule as S } from \"./core/urlUtils.js\";\nimport { supportsApiKey as x } from \"./support/apiKeyUtils.js\";\nimport { loadImageAsync as v } from \"./support/requestUtils.js\";\n\nasync function C(e, t) {\n  var r;\n  const o = c(e),\n        i = d(e);\n  i || o || (e = p(e));\n  const l = {\n    url: e,\n    requestOptions: { ...n(t)\n    }\n  };\n  let u = m(e);\n\n  if (u) {\n    const e = await K(u, l);\n    if (null != e) return {\n      data: e,\n      getHeader: _,\n      requestOptions: l.requestOptions,\n      url: l.url\n    };\n    u.after || u.error || (u = null);\n  }\n\n  if (e = l.url, \"image\" === (t = l.requestOptions).responseType) {\n    if (s(\"host-webworker\") || s(\"host-node\")) throw R(\"request:invalid-parameters\", new Error(\"responseType 'image' is not supported in Web Workers or Node environment\"), l);\n  } else if (o) throw R(\"request:invalid-parameters\", new Error(\"Data URLs are not supported for responseType = \" + t.responseType), l);\n\n  if (\"head\" === t.method) {\n    if (t.body) throw R(\"request:invalid-parameters\", new Error(\"body parameter cannot be set when method is 'head'\"), l);\n    if (o || i) throw R(\"request:invalid-parameters\", new Error(\"data and blob URLs are not supported for method 'head'\"), l);\n  }\n\n  if (await H(), E) return E.execute(e, t);\n  const h = new AbortController();\n  a(t, () => h.abort());\n  const f = {\n    controller: h,\n    credential: null,\n    credentialToken: null,\n    fetchOptions: null,\n    hasToken: !1,\n    interceptor: u,\n    params: l,\n    redoRequest: !1,\n    useIdentity: L.useIdentity,\n    useProxy: !1,\n    useSSL: !1,\n    withCredentials: !1\n  },\n        y = await z(f);\n  return null == (r = u) || null == r.after || r.after(y), y;\n}\n\nlet E;\n\nconst L = e.request,\n      U = (\"FormData\" in globalThis),\n      j = [499, 498, 403, 401],\n      P = [\"COM_0056\", \"COM_0057\", \"SB_0008\"],\n      D = [/\\/arcgis\\/tokens/i, /\\/sharing(\\/rest)?\\/generatetoken/i, /\\/rest\\/info/i],\n      _ = () => null,\n      F = Symbol();\n\nfunction I(e) {\n  const t = f(e);\n  t && !C._corsServers.includes(t) && C._corsServers.push(t);\n}\n\nfunction M(e) {\n  const t = f(e);\n  return !t || t.endsWith(\".arcgis.com\") || C._corsServers.includes(t) || h(t);\n}\n\nfunction R(e, t, s, n) {\n  let a = \"Error\";\n  const u = {\n    url: s.url,\n    requestOptions: s.requestOptions,\n    getHeader: _,\n    ssl: !1\n  };\n  if (t instanceof r) return t.details ? (t.details = o(t.details), t.details.url = s.url, t.details.requestOptions = s.requestOptions) : t.details = u, t;\n\n  if (t) {\n    const e = n && (e => n.headers.get(e)),\n          r = n && n.status,\n          s = t.message;\n\n    s && (a = s), e && (u.getHeader = e), u.httpStatus = (null != t.httpCode ? t.httpCode : t.code) || r || 0, u.subCode = t.subcode, u.messageCode = t.messageCode, \"string\" == typeof t.details ? u.messages = [t.details] : u.messages = t.details, u.raw = F in t ? t[F] : t;\n  }\n\n  return i(t) ? l() : new r(e, a, u);\n}\n\nasync function H() {\n  s(\"host-webworker\") ? E || (E = await import(\"./core/workers/request.js\")) : C._abortableFetch || (C._abortableFetch = globalThis.fetch.bind(globalThis));\n}\n\nasync function A() {\n  t || (await import(\"./identity/IdentityManager.js\"));\n}\n\nasync function B(r) {\n  const s = r.params.url,\n        o = r.params.requestOptions,\n        n = r.controller.signal,\n        a = o.body;\n  let i = null,\n      l = null,\n      c = null;\n\n  if (U && \"HTMLFormElement\" in globalThis && (a instanceof FormData ? i = a : a instanceof HTMLFormElement && (l = a, i = new FormData(l))), \"string\" == typeof a && (c = a), r.fetchOptions = {\n    cache: o.cacheBust && !C._abortableFetch.polyfill ? \"no-cache\" : \"default\",\n    credentials: \"same-origin\",\n    headers: o.headers || {},\n    method: \"head\" === o.method ? \"HEAD\" : \"GET\",\n    mode: \"cors\",\n    redirect: \"follow\",\n    signal: n\n  }, (i || c) && (r.fetchOptions.body = i || c), \"anonymous\" === o.authMode && (r.useIdentity = !1), r.hasToken = !!(/token=/i.test(s) || o.query && o.query.token || i && i.get && i.get(\"token\") || l && l.elements.token), !r.hasToken && e.apiKey && x(s) && (o.query || (o.query = {}), o.query.token = e.apiKey, r.hasToken = !0), r.useIdentity && !r.hasToken && !r.credentialToken && !N(s) && !u(n)) {\n    let e;\n    \"immediate\" === o.authMode ? (await A(), e = await t.getCredential(s, {\n      signal: n\n    }), r.credential = e) : \"no-prompt\" === o.authMode ? (await A(), e = await t.getCredential(s, {\n      prompt: !1,\n      signal: n\n    }).catch(() => {}), r.credential = e) : t && (e = t.findCredential(s)), e && (r.credentialToken = e.token, r.useSSL = !!e.ssl);\n  }\n}\n\nfunction N(e) {\n  return D.some(t => t.test(e));\n}\n\nasync function $(e) {\n  let r = e.params.url;\n  const o = e.params.requestOptions,\n        n = e.fetchOptions,\n        a = d(r) || c(r),\n        i = o.responseType || \"json\",\n        u = a ? 0 : null != o.timeout ? o.timeout : L.timeout;\n  let p = !1;\n\n  if (!a) {\n    e.useSSL && (r = y(r)), o.cacheBust && \"default\" === n.cache && (r = w(r, \"request.preventCache\", Date.now()));\n    let a = { ...o.query\n    };\n    e.credentialToken && (a.token = e.credentialToken);\n    let i = g(a);\n    s(\"esri-url-encodes-apostrophe\") && (i = i.replace(/'/g, \"%27\"));\n    const l = r.length + 1 + i.length;\n    let u;\n    p = \"delete\" === o.method || \"post\" === o.method || \"put\" === o.method || !!o.body || l > L.maxUrlLength;\n    const c = o.useProxy || !!b(r);\n\n    if (c) {\n      const e = q(r);\n      u = e.path, !p && u.length + 1 + l > L.maxUrlLength && (p = !0), e.query && (a = { ...e.query,\n        ...a\n      });\n    }\n\n    if (\"HEAD\" === n.method && (p || c)) {\n      if (p) {\n        if (l > L.maxUrlLength) throw R(\"request:invalid-parameters\", new Error(\"URL exceeds maximum length\"), e.params);\n        throw R(\"request:invalid-parameters\", new Error(\"cannot use POST request when method is 'head'\"), e.params);\n      }\n\n      if (c) throw R(\"request:invalid-parameters\", new Error(\"cannot use proxy when method is 'head'\"), e.params);\n    }\n\n    if (p ? (n.method = \"delete\" === o.method ? \"DELETE\" : \"put\" === o.method ? \"PUT\" : \"POST\", o.body ? r = T(r, a) : (n.body = g(a), n.headers[\"Content-Type\"] = \"application/x-www-form-urlencoded\")) : r = T(r, a), c && (e.useProxy = !0, r = `${u}?${r}`), a.token && U && n.body instanceof FormData) {\n      const e = n.body;\n      e.set ? e.set(\"token\", a.token) : e.append(\"token\", a.token);\n    }\n\n    if (o.hasOwnProperty(\"withCredentials\")) e.withCredentials = o.withCredentials;else if (!k(r, O())) if (h(r)) e.withCredentials = !0;else if (t) {\n      const s = t.findServerInfo(r);\n      s && s.webTierAuth && (e.withCredentials = !0);\n    }\n    e.withCredentials && (n.credentials = \"include\");\n  }\n\n  let m,\n      x,\n      v = 0,\n      E = !1;\n  u > 0 && (v = setTimeout(() => {\n    E = !0, e.controller.abort();\n  }, u));\n\n  try {\n    if (\"native-request-init\" === o.responseType) x = n, x.url = r;else if (\"image\" !== o.responseType || \"default\" !== n.cache || \"GET\" !== n.method || p || W(o.headers) || !a && !e.useProxy && L.proxyUrl && !M(r)) {\n      if (m = await C._abortableFetch(r, n), e.useProxy || I(r), \"native\" === o.responseType) x = m;else if (\"HEAD\" !== n.method) if (m.ok) {\n        switch (i) {\n          case \"array-buffer\":\n            x = await m.arrayBuffer();\n            break;\n\n          case \"blob\":\n          case \"image\":\n            x = await m.blob();\n            break;\n\n          default:\n            x = await m.text();\n        }\n\n        if (v && (clearTimeout(v), v = 0), \"json\" === i || \"xml\" === i || \"document\" === i) if (x) switch (i) {\n          case \"json\":\n            x = JSON.parse(x);\n            break;\n\n          case \"xml\":\n            x = G(x, \"application/xml\");\n            break;\n\n          case \"document\":\n            x = G(x, \"text/html\");\n        } else x = null;\n\n        if (x) {\n          if (\"array-buffer\" === i || \"blob\" === i) {\n            const e = m.headers.get(\"Content-Type\");\n            if (/application\\/json|text\\/plain/i.test(e) && x[\"blob\" === i ? \"size\" : \"byteLength\"] <= 750) try {\n              const e = await new Response(x).json();\n              e.error && (x = e);\n            } catch {}\n          }\n\n          \"image\" === i && x instanceof Blob && (x = await X(URL.createObjectURL(x), e, !0));\n        }\n      } else x = await m.text();\n    } else x = await X(r, e);\n  } catch (j) {\n    if (\"AbortError\" === j.name) {\n      if (E) throw new Error(\"Timeout exceeded\");\n      throw l(\"Request canceled\");\n    }\n\n    if (!(!m && j instanceof TypeError && L.proxyUrl) || o.body || \"delete\" === o.method || \"head\" === o.method || \"post\" === o.method || \"put\" === o.method || e.useProxy || M(r)) throw j;\n    e.redoRequest = !0, S({\n      proxyUrl: L.proxyUrl,\n      urlPrefix: f(r)\n    });\n  } finally {\n    v && clearTimeout(v);\n  }\n\n  return [m, x];\n}\n\nasync function K(e, t) {\n  if (null != e.responseData) return e.responseData;\n\n  if (e.headers && (t.requestOptions.headers = { ...t.requestOptions.headers,\n    ...e.headers\n  }), e.query && (t.requestOptions.query = { ...t.requestOptions.query,\n    ...e.query\n  }), e.before) {\n    let o, n;\n\n    try {\n      n = await e.before(t);\n    } catch (s) {\n      o = R(\"request:interceptor\", s, t);\n    }\n\n    if ((n instanceof Error || n instanceof r) && (o = R(\"request:interceptor\", n, t)), o) throw e.error && e.error(o), o;\n    return n;\n  }\n}\n\nfunction W(e) {\n  if (e) for (const t of Object.getOwnPropertyNames(e)) if (e[t]) return !0;\n  return !1;\n}\n\nfunction G(e, t) {\n  let r;\n\n  try {\n    r = new DOMParser().parseFromString(e, t);\n  } catch {}\n\n  if (!r || r.getElementsByTagName(\"parsererror\").length) throw new SyntaxError(\"XML Parse error\");\n  return r;\n}\n\nasync function z(e) {\n  var r, s;\n  let o, n;\n  await B(e);\n\n  try {\n    do {\n      [o, n] = await $(e);\n    } while (!(await J(e, o, n)));\n  } catch (l) {\n    const t = R(\"request:server\", l, e.params, o);\n    throw t.details.ssl = e.useSSL, e.interceptor && e.interceptor.error && e.interceptor.error(t), t;\n  }\n\n  const a = e.params.url;\n\n  if (/\\/sharing\\/rest\\/(accounts|portals)\\/self/i.test(a) && !e.hasToken && !e.credentialToken && null != (r = n) && null != (s = r.user) && s.username && !h(a)) {\n    const e = f(a, !0);\n    e && L.trustedServers.push(e);\n  }\n\n  const i = e.credential;\n\n  if (i && t) {\n    const e = t.findServerInfo(i.server);\n    let r = e && e.owningSystemUrl;\n\n    if (r) {\n      r = r.replace(/\\/?$/, \"/sharing\");\n      const e = t.findCredential(r, i.userId);\n      e && -1 === t._getIdenticalSvcIdx(r, e) && e.resources.unshift(r);\n    }\n  }\n\n  return {\n    data: n,\n    getHeader: o ? e => o.headers.get(e) : _,\n    requestOptions: e.params.requestOptions,\n    ssl: e.useSSL,\n    url: e.params.url\n  };\n}\n\nasync function J(e, r, s) {\n  if (e.redoRequest) return e.redoRequest = !1, !1;\n  const o = e.params.requestOptions;\n  if (!r || \"native\" === o.responseType || \"native-request-init\" === o.responseType) return !0;\n  let n, a, i, l;\n  if (!r.ok) throw n = new Error(`Unable to load ${r.url} status: ${r.status}`), n[F] = s, n;\n  null != s && s.error && (n = s.error), n && (a = Number(n.code), i = n.hasOwnProperty(\"subcode\") ? Number(n.subcode) : null, l = n.messageCode, l = l && l.toUpperCase());\n  const u = o.authMode;\n\n  if (403 === a && (4 === i || n.message && n.message.toLowerCase().indexOf(\"ssl\") > -1 && -1 === n.message.toLowerCase().indexOf(\"permission\"))) {\n    if (!e.useSSL) return e.useSSL = !0, !1;\n  } else if (!e.hasToken && e.useIdentity && (\"no-prompt\" !== u || 498 === a) && -1 !== j.indexOf(a) && !N(e.params.url) && (403 !== a || -1 === P.indexOf(l) && (null == i || 2 === i && e.credentialToken))) {\n    await A();\n\n    try {\n      const r = await t.getCredential(e.params.url, {\n        error: R(\"request:server\", n, e.params),\n        prompt: \"no-prompt\" !== u,\n        signal: e.controller.signal,\n        token: e.credentialToken\n      });\n      return e.credential = r, e.credentialToken = r.token, e.useSSL = e.useSSL || r.ssl, !1;\n    } catch (c) {\n      if (\"no-prompt\" === u) return e.credential = null, e.credentialToken = null, !1;\n      n = c;\n    }\n  }\n\n  if (n) throw n;\n  return !0;\n}\n\nfunction X(e, t) {\n  let r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : !1;\n  const s = t.controller.signal,\n        o = new Image();\n  return t.withCredentials ? o.crossOrigin = \"use-credentials\" : o.crossOrigin = \"anonymous\", o.alt = \"\", o.src = e, v(o, e, r, s);\n}\n\nC._abortableFetch = null, C._corsServers = [\"https://server.arcgisonline.com\", \"https://services.arcgisonline.com\"];\nexport { C as default };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/request.js"],"names":["e","id","t","r","s","clone","o","unwrap","n","onAbort","a","isAbortError","i","createAbortError","l","isAborted","u","isDataProtocol","c","isBlobProtocol","d","normalize","p","getInterceptor","m","isTrustedServer","h","getOrigin","f","toHTTPS","y","addQueryParameter","w","objectToQuery","g","getProxyRule","b","getProxyUrl","q","addQueryParameters","T","hasSameOrigin","k","getAppUrl","O","addProxyRule","S","supportsApiKey","x","loadImageAsync","v","C","url","requestOptions","K","data","getHeader","_","after","error","responseType","R","Error","method","body","H","E","execute","AbortController","abort","controller","credential","credentialToken","fetchOptions","hasToken","interceptor","params","redoRequest","useIdentity","L","useProxy","useSSL","withCredentials","z","request","U","globalThis","j","P","D","F","Symbol","I","_corsServers","includes","push","M","endsWith","ssl","details","headers","get","status","message","httpStatus","httpCode","code","subCode","subcode","messageCode","messages","raw","_abortableFetch","fetch","bind","A","B","signal","FormData","HTMLFormElement","cache","cacheBust","polyfill","credentials","mode","redirect","authMode","test","query","token","elements","apiKey","N","getCredential","prompt","catch","findCredential","some","$","timeout","Date","now","replace","length","maxUrlLength","path","set","append","hasOwnProperty","findServerInfo","webTierAuth","setTimeout","W","proxyUrl","ok","arrayBuffer","blob","text","clearTimeout","JSON","parse","G","Response","json","Blob","X","URL","createObjectURL","name","TypeError","urlPrefix","responseData","before","Object","getOwnPropertyNames","DOMParser","parseFromString","getElementsByTagName","SyntaxError","J","user","username","trustedServers","server","owningSystemUrl","userId","_getIdenticalSvcIdx","resources","unshift","Number","toUpperCase","toLowerCase","indexOf","Image","crossOrigin","alt","src","default"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport e from\"./config.js\";import{id as t}from\"./kernel.js\";import r from\"./core/Error.js\";import s from\"./core/has.js\";import{clone as o}from\"./core/lang.js\";import{unwrap as n}from\"./core/maybe.js\";import{onAbort as a,isAbortError as i,createAbortError as l,isAborted as u}from\"./core/promiseUtils.js\";import{isDataProtocol as c,isBlobProtocol as d,normalize as p,getInterceptor as m,isTrustedServer as h,getOrigin as f,toHTTPS as y,addQueryParameter as w,objectToQuery as g,getProxyRule as b,getProxyUrl as q,addQueryParameters as T,hasSameOrigin as k,getAppUrl as O,addProxyRule as S}from\"./core/urlUtils.js\";import{supportsApiKey as x}from\"./support/apiKeyUtils.js\";import{loadImageAsync as v}from\"./support/requestUtils.js\";async function C(e,t){var r;const o=c(e),i=d(e);i||o||(e=p(e));const l={url:e,requestOptions:{...n(t)}};let u=m(e);if(u){const e=await K(u,l);if(null!=e)return{data:e,getHeader:_,requestOptions:l.requestOptions,url:l.url};u.after||u.error||(u=null)}if(e=l.url,\"image\"===(t=l.requestOptions).responseType){if(s(\"host-webworker\")||s(\"host-node\"))throw R(\"request:invalid-parameters\",new Error(\"responseType 'image' is not supported in Web Workers or Node environment\"),l)}else if(o)throw R(\"request:invalid-parameters\",new Error(\"Data URLs are not supported for responseType = \"+t.responseType),l);if(\"head\"===t.method){if(t.body)throw R(\"request:invalid-parameters\",new Error(\"body parameter cannot be set when method is 'head'\"),l);if(o||i)throw R(\"request:invalid-parameters\",new Error(\"data and blob URLs are not supported for method 'head'\"),l)}if(await H(),E)return E.execute(e,t);const h=new AbortController;a(t,(()=>h.abort()));const f={controller:h,credential:null,credentialToken:null,fetchOptions:null,hasToken:!1,interceptor:u,params:l,redoRequest:!1,useIdentity:L.useIdentity,useProxy:!1,useSSL:!1,withCredentials:!1},y=await z(f);return null==(r=u)||null==r.after||r.after(y),y}let E;const L=e.request,U=\"FormData\"in globalThis,j=[499,498,403,401],P=[\"COM_0056\",\"COM_0057\",\"SB_0008\"],D=[/\\/arcgis\\/tokens/i,/\\/sharing(\\/rest)?\\/generatetoken/i,/\\/rest\\/info/i],_=()=>null,F=Symbol();function I(e){const t=f(e);t&&!C._corsServers.includes(t)&&C._corsServers.push(t)}function M(e){const t=f(e);return!t||t.endsWith(\".arcgis.com\")||C._corsServers.includes(t)||h(t)}function R(e,t,s,n){let a=\"Error\";const u={url:s.url,requestOptions:s.requestOptions,getHeader:_,ssl:!1};if(t instanceof r)return t.details?(t.details=o(t.details),t.details.url=s.url,t.details.requestOptions=s.requestOptions):t.details=u,t;if(t){const e=n&&(e=>n.headers.get(e)),r=n&&n.status,s=t.message;s&&(a=s),e&&(u.getHeader=e),u.httpStatus=(null!=t.httpCode?t.httpCode:t.code)||r||0,u.subCode=t.subcode,u.messageCode=t.messageCode,\"string\"==typeof t.details?u.messages=[t.details]:u.messages=t.details,u.raw=F in t?t[F]:t}return i(t)?l():new r(e,a,u)}async function H(){s(\"host-webworker\")?E||(E=await import(\"./core/workers/request.js\")):C._abortableFetch||(C._abortableFetch=globalThis.fetch.bind(globalThis))}async function A(){t||await import(\"./identity/IdentityManager.js\")}async function B(r){const s=r.params.url,o=r.params.requestOptions,n=r.controller.signal,a=o.body;let i=null,l=null,c=null;if(U&&\"HTMLFormElement\"in globalThis&&(a instanceof FormData?i=a:a instanceof HTMLFormElement&&(l=a,i=new FormData(l))),\"string\"==typeof a&&(c=a),r.fetchOptions={cache:o.cacheBust&&!C._abortableFetch.polyfill?\"no-cache\":\"default\",credentials:\"same-origin\",headers:o.headers||{},method:\"head\"===o.method?\"HEAD\":\"GET\",mode:\"cors\",redirect:\"follow\",signal:n},(i||c)&&(r.fetchOptions.body=i||c),\"anonymous\"===o.authMode&&(r.useIdentity=!1),r.hasToken=!!(/token=/i.test(s)||o.query&&o.query.token||i&&i.get&&i.get(\"token\")||l&&l.elements.token),!r.hasToken&&e.apiKey&&x(s)&&(o.query||(o.query={}),o.query.token=e.apiKey,r.hasToken=!0),r.useIdentity&&!r.hasToken&&!r.credentialToken&&!N(s)&&!u(n)){let e;\"immediate\"===o.authMode?(await A(),e=await t.getCredential(s,{signal:n}),r.credential=e):\"no-prompt\"===o.authMode?(await A(),e=await t.getCredential(s,{prompt:!1,signal:n}).catch((()=>{})),r.credential=e):t&&(e=t.findCredential(s)),e&&(r.credentialToken=e.token,r.useSSL=!!e.ssl)}}function N(e){return D.some((t=>t.test(e)))}async function $(e){let r=e.params.url;const o=e.params.requestOptions,n=e.fetchOptions,a=d(r)||c(r),i=o.responseType||\"json\",u=a?0:null!=o.timeout?o.timeout:L.timeout;let p=!1;if(!a){e.useSSL&&(r=y(r)),o.cacheBust&&\"default\"===n.cache&&(r=w(r,\"request.preventCache\",Date.now()));let a={...o.query};e.credentialToken&&(a.token=e.credentialToken);let i=g(a);s(\"esri-url-encodes-apostrophe\")&&(i=i.replace(/'/g,\"%27\"));const l=r.length+1+i.length;let u;p=\"delete\"===o.method||\"post\"===o.method||\"put\"===o.method||!!o.body||l>L.maxUrlLength;const c=o.useProxy||!!b(r);if(c){const e=q(r);u=e.path,!p&&u.length+1+l>L.maxUrlLength&&(p=!0),e.query&&(a={...e.query,...a})}if(\"HEAD\"===n.method&&(p||c)){if(p){if(l>L.maxUrlLength)throw R(\"request:invalid-parameters\",new Error(\"URL exceeds maximum length\"),e.params);throw R(\"request:invalid-parameters\",new Error(\"cannot use POST request when method is 'head'\"),e.params)}if(c)throw R(\"request:invalid-parameters\",new Error(\"cannot use proxy when method is 'head'\"),e.params)}if(p?(n.method=\"delete\"===o.method?\"DELETE\":\"put\"===o.method?\"PUT\":\"POST\",o.body?r=T(r,a):(n.body=g(a),n.headers[\"Content-Type\"]=\"application/x-www-form-urlencoded\")):r=T(r,a),c&&(e.useProxy=!0,r=`${u}?${r}`),a.token&&U&&n.body instanceof FormData){const e=n.body;e.set?e.set(\"token\",a.token):e.append(\"token\",a.token)}if(o.hasOwnProperty(\"withCredentials\"))e.withCredentials=o.withCredentials;else if(!k(r,O()))if(h(r))e.withCredentials=!0;else if(t){const s=t.findServerInfo(r);s&&s.webTierAuth&&(e.withCredentials=!0)}e.withCredentials&&(n.credentials=\"include\")}let m,x,v=0,E=!1;u>0&&(v=setTimeout((()=>{E=!0,e.controller.abort()}),u));try{if(\"native-request-init\"===o.responseType)x=n,x.url=r;else if(\"image\"!==o.responseType||\"default\"!==n.cache||\"GET\"!==n.method||p||W(o.headers)||!a&&!e.useProxy&&L.proxyUrl&&!M(r)){if(m=await C._abortableFetch(r,n),e.useProxy||I(r),\"native\"===o.responseType)x=m;else if(\"HEAD\"!==n.method)if(m.ok){switch(i){case\"array-buffer\":x=await m.arrayBuffer();break;case\"blob\":case\"image\":x=await m.blob();break;default:x=await m.text()}if(v&&(clearTimeout(v),v=0),\"json\"===i||\"xml\"===i||\"document\"===i)if(x)switch(i){case\"json\":x=JSON.parse(x);break;case\"xml\":x=G(x,\"application/xml\");break;case\"document\":x=G(x,\"text/html\")}else x=null;if(x){if(\"array-buffer\"===i||\"blob\"===i){const e=m.headers.get(\"Content-Type\");if(/application\\/json|text\\/plain/i.test(e)&&x[\"blob\"===i?\"size\":\"byteLength\"]<=750)try{const e=await new Response(x).json();e.error&&(x=e)}catch{}}\"image\"===i&&x instanceof Blob&&(x=await X(URL.createObjectURL(x),e,!0))}}else x=await m.text()}else x=await X(r,e)}catch(j){if(\"AbortError\"===j.name){if(E)throw new Error(\"Timeout exceeded\");throw l(\"Request canceled\")}if(!(!m&&j instanceof TypeError&&L.proxyUrl)||o.body||\"delete\"===o.method||\"head\"===o.method||\"post\"===o.method||\"put\"===o.method||e.useProxy||M(r))throw j;e.redoRequest=!0,S({proxyUrl:L.proxyUrl,urlPrefix:f(r)})}finally{v&&clearTimeout(v)}return[m,x]}async function K(e,t){if(null!=e.responseData)return e.responseData;if(e.headers&&(t.requestOptions.headers={...t.requestOptions.headers,...e.headers}),e.query&&(t.requestOptions.query={...t.requestOptions.query,...e.query}),e.before){let o,n;try{n=await e.before(t)}catch(s){o=R(\"request:interceptor\",s,t)}if((n instanceof Error||n instanceof r)&&(o=R(\"request:interceptor\",n,t)),o)throw e.error&&e.error(o),o;return n}}function W(e){if(e)for(const t of Object.getOwnPropertyNames(e))if(e[t])return!0;return!1}function G(e,t){let r;try{r=(new DOMParser).parseFromString(e,t)}catch{}if(!r||r.getElementsByTagName(\"parsererror\").length)throw new SyntaxError(\"XML Parse error\");return r}async function z(e){var r,s;let o,n;await B(e);try{do{[o,n]=await $(e)}while(!await J(e,o,n))}catch(l){const t=R(\"request:server\",l,e.params,o);throw t.details.ssl=e.useSSL,e.interceptor&&e.interceptor.error&&e.interceptor.error(t),t}const a=e.params.url;if(/\\/sharing\\/rest\\/(accounts|portals)\\/self/i.test(a)&&!e.hasToken&&!e.credentialToken&&null!=(r=n)&&null!=(s=r.user)&&s.username&&!h(a)){const e=f(a,!0);e&&L.trustedServers.push(e)}const i=e.credential;if(i&&t){const e=t.findServerInfo(i.server);let r=e&&e.owningSystemUrl;if(r){r=r.replace(/\\/?$/,\"/sharing\");const e=t.findCredential(r,i.userId);e&&-1===t._getIdenticalSvcIdx(r,e)&&e.resources.unshift(r)}}return{data:n,getHeader:o?e=>o.headers.get(e):_,requestOptions:e.params.requestOptions,ssl:e.useSSL,url:e.params.url}}async function J(e,r,s){if(e.redoRequest)return e.redoRequest=!1,!1;const o=e.params.requestOptions;if(!r||\"native\"===o.responseType||\"native-request-init\"===o.responseType)return!0;let n,a,i,l;if(!r.ok)throw n=new Error(`Unable to load ${r.url} status: ${r.status}`),n[F]=s,n;null!=s&&s.error&&(n=s.error),n&&(a=Number(n.code),i=n.hasOwnProperty(\"subcode\")?Number(n.subcode):null,l=n.messageCode,l=l&&l.toUpperCase());const u=o.authMode;if(403===a&&(4===i||n.message&&n.message.toLowerCase().indexOf(\"ssl\")>-1&&-1===n.message.toLowerCase().indexOf(\"permission\"))){if(!e.useSSL)return e.useSSL=!0,!1}else if(!e.hasToken&&e.useIdentity&&(\"no-prompt\"!==u||498===a)&&-1!==j.indexOf(a)&&!N(e.params.url)&&(403!==a||-1===P.indexOf(l)&&(null==i||2===i&&e.credentialToken))){await A();try{const r=await t.getCredential(e.params.url,{error:R(\"request:server\",n,e.params),prompt:\"no-prompt\"!==u,signal:e.controller.signal,token:e.credentialToken});return e.credential=r,e.credentialToken=r.token,e.useSSL=e.useSSL||r.ssl,!1}catch(c){if(\"no-prompt\"===u)return e.credential=null,e.credentialToken=null,!1;n=c}}if(n)throw n;return!0}function X(e,t,r=!1){const s=t.controller.signal,o=new Image;return t.withCredentials?o.crossOrigin=\"use-credentials\":o.crossOrigin=\"anonymous\",o.alt=\"\",o.src=e,v(o,e,r,s)}C._abortableFetch=null,C._corsServers=[\"https://server.arcgisonline.com\",\"https://services.arcgisonline.com\"];export{C as default};\n"]},"metadata":{},"sourceType":"module"}