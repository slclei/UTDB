{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport { _ as t } from \"../../chunks/tslib.es6.js\";\nimport e from \"../../Graphic.js\";\nimport r from \"../../core/Error.js\";\nimport { unwrap as i, isSome as o } from \"../../core/maybe.js\";\nimport { property as s } from \"../../core/accessorSupport/decorators/property.js\";\nimport \"../../core/arrayUtils.js\";\nimport \"../../core/has.js\";\nimport \"../../core/accessorSupport/ensureType.js\";\nimport { subclass as a } from \"../../core/accessorSupport/decorators/subclass.js\";\nimport { combinedViewLayerTimeExtentProperty as n } from \"../../layers/support/commonProperties.js\";\nimport { getDefaultDatumTransformationForDataset as l, projectExtent as u } from \"../../layers/support/rasterFunctions/rasterProjectionHelper.js\";\nimport { getFetchPopupTemplate as p } from \"./support/popupUtils.js\";\n\nconst m = m => {\n  let f = class extends m {\n    constructor() {\n      super(...arguments), this._rasterFieldPrefix = \"Raster.\", this.layer = null, this.view = null, this.tileInfo = null;\n    }\n\n    get fullExtent() {\n      return this._getfullExtent();\n    }\n\n    _getfullExtent() {\n      return this.projectFullExtent(this.view.spatialReference);\n    }\n\n    get hasTilingEffects() {\n      return this.layer.renderer && \"dynamicRangeAdjustment\" in this.layer.renderer && this.layer.renderer.dynamicRangeAdjustment;\n    }\n\n    get datumTransformation() {\n      return l(i(this.layer.fullExtent), this.view.spatialReference, !0);\n    }\n\n    supportsSpatialReference(t) {\n      return !!this.projectFullExtent(t);\n    }\n\n    projectFullExtent(t) {\n      const e = i(this.layer.fullExtent),\n            r = l(e, t, !1);\n      return u(e, t, r);\n    }\n\n    async fetchPopupFeatures(t, i) {\n      const {\n        layer: s\n      } = this;\n      if (!t) return Promise.reject(new r(\"imageryTileLayerView:fetchPopupFeatures\", \"Nothing to fetch without area\", {\n        layer: s\n      }));\n      const {\n        popupEnabled: a\n      } = s,\n            n = p(s, i);\n      if (!a || !o(n)) throw new r(\"imageryTileLayerView:fetchPopupFeatures\", \"Missing required popupTemplate or popupEnabled\", {\n        popupEnabled: a,\n        popupTemplate: n\n      });\n      const l = [],\n            {\n        value: u,\n        magdirValue: m\n      } = await s.identify(t, {\n        timeExtent: this.timeExtent\n      });\n      let f = \"\";\n\n      if (u && u.length) {\n        var c, d;\n        f = \"imagery-tile\" === s.type && s.hasStandardTime() && null != u[0] ? u.map(t => s.getStandardTimeValue(t)).join(\", \") : u.join(\", \");\n        const t = {\n          ObjectId: 0\n        },\n              r = \"Raster.ServicePixelValue\";\n        t[r] = this._formatAttributeValue(f, r);\n        const i = null == (c = s.rasterInfo) || null == (d = c.attributeTable) ? void 0 : d.features;\n\n        if (i && i.length > 0) {\n          const e = i.filter(t => {\n            const e = t.attributes.value || t.attributes.Value || t.attributes.VALUE;\n            return String(e) === f;\n          });\n\n          if (e.length > 0) {\n            const r = e[0];\n            if (r) for (const e in r.attributes) if (r.attributes.hasOwnProperty(e)) {\n              const i = this._rasterFieldPrefix + e;\n              t[i] = this._formatAttributeValue(r.attributes[e], i);\n            }\n          }\n        }\n\n        const o = s.rasterInfo.dataType;\n        \"vector-magdir\" !== o && \"vector-uv\" !== o || (t[\"Raster.Magnitude\"] = null == m ? void 0 : m[0], t[\"Raster.Direction\"] = null == m ? void 0 : m[1]);\n        const a = new e(this.fullExtent.clone(), null, t);\n        a.layer = s, a.sourceLayer = a.layer, l.push(a);\n      }\n\n      return l;\n    }\n\n    _formatAttributeValue(t, e) {\n      if (\"string\" == typeof t) {\n        const r = this.layer.popupTemplate && this.layer.popupTemplate.fieldInfos,\n              i = this._getFieldInfo(r, e),\n              o = i && i.format;\n\n        if (o) {\n          let e, r;\n          return t.trim().indexOf(\",\") > -1 ? (e = \",\", r = e + \" \", this._formatDelimitedString(t, e, r, o)) : t.trim().indexOf(\" \") > -1 ? (e = r = \" \", this._formatDelimitedString(t, e, r, o)) : this._formatNumberFromString(t, o);\n        }\n      }\n\n      return t;\n    }\n\n    _getFieldInfo(t, e) {\n      if (!t || !t.length || !e) return;\n      const r = e.toLowerCase();\n      let i;\n      return t.some(t => !(!t.fieldName || t.fieldName.toLowerCase() !== r && t.fieldName.toLowerCase() !== r.replace(/ /g, \"_\")) && (i = t, !0)), i;\n    }\n\n    _formatDelimitedString(t, e, r, i) {\n      return t && e && r && i ? t.trim().split(e).map(t => this._formatNumberFromString(t, i)).join(r) : t;\n    }\n\n    _formatNumberFromString(t, e) {\n      if (!t || !e) return t;\n      const r = Number(t);\n      return isNaN(r) ? t : e.format(r);\n    }\n\n  };\n  return t([s()], f.prototype, \"layer\", void 0), t([s(n)], f.prototype, \"timeExtent\", void 0), t([s()], f.prototype, \"view\", void 0), t([s()], f.prototype, \"fullExtent\", null), t([s()], f.prototype, \"tileInfo\", void 0), t([s({\n    readOnly: !0\n  })], f.prototype, \"hasTilingEffects\", null), f = t([a(\"esri.views.layers.ImageryTileLayerView\")], f), f;\n};\n\nexport { m as ImageryTileLayerView, m as default };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/views/layers/ImageryTileLayerView.js"],"names":["_","t","e","r","unwrap","i","isSome","o","property","s","subclass","a","combinedViewLayerTimeExtentProperty","n","getDefaultDatumTransformationForDataset","l","projectExtent","u","getFetchPopupTemplate","p","m","f","constructor","arguments","_rasterFieldPrefix","layer","view","tileInfo","fullExtent","_getfullExtent","projectFullExtent","spatialReference","hasTilingEffects","renderer","dynamicRangeAdjustment","datumTransformation","supportsSpatialReference","fetchPopupFeatures","Promise","reject","popupEnabled","popupTemplate","value","magdirValue","identify","timeExtent","length","c","d","type","hasStandardTime","map","getStandardTimeValue","join","ObjectId","_formatAttributeValue","rasterInfo","attributeTable","features","filter","attributes","Value","VALUE","String","hasOwnProperty","dataType","clone","sourceLayer","push","fieldInfos","_getFieldInfo","format","trim","indexOf","_formatDelimitedString","_formatNumberFromString","toLowerCase","some","fieldName","replace","split","Number","isNaN","prototype","readOnly","ImageryTileLayerView","default"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../chunks/tslib.es6.js\";import e from\"../../Graphic.js\";import r from\"../../core/Error.js\";import{unwrap as i,isSome as o}from\"../../core/maybe.js\";import{property as s}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as a}from\"../../core/accessorSupport/decorators/subclass.js\";import{combinedViewLayerTimeExtentProperty as n}from\"../../layers/support/commonProperties.js\";import{getDefaultDatumTransformationForDataset as l,projectExtent as u}from\"../../layers/support/rasterFunctions/rasterProjectionHelper.js\";import{getFetchPopupTemplate as p}from\"./support/popupUtils.js\";const m=m=>{let f=class extends m{constructor(){super(...arguments),this._rasterFieldPrefix=\"Raster.\",this.layer=null,this.view=null,this.tileInfo=null}get fullExtent(){return this._getfullExtent()}_getfullExtent(){return this.projectFullExtent(this.view.spatialReference)}get hasTilingEffects(){return this.layer.renderer&&\"dynamicRangeAdjustment\"in this.layer.renderer&&this.layer.renderer.dynamicRangeAdjustment}get datumTransformation(){return l(i(this.layer.fullExtent),this.view.spatialReference,!0)}supportsSpatialReference(t){return!!this.projectFullExtent(t)}projectFullExtent(t){const e=i(this.layer.fullExtent),r=l(e,t,!1);return u(e,t,r)}async fetchPopupFeatures(t,i){const{layer:s}=this;if(!t)return Promise.reject(new r(\"imageryTileLayerView:fetchPopupFeatures\",\"Nothing to fetch without area\",{layer:s}));const{popupEnabled:a}=s,n=p(s,i);if(!a||!o(n))throw new r(\"imageryTileLayerView:fetchPopupFeatures\",\"Missing required popupTemplate or popupEnabled\",{popupEnabled:a,popupTemplate:n});const l=[],{value:u,magdirValue:m}=await s.identify(t,{timeExtent:this.timeExtent});let f=\"\";if(u&&u.length){var c,d;f=\"imagery-tile\"===s.type&&s.hasStandardTime()&&null!=u[0]?u.map((t=>s.getStandardTimeValue(t))).join(\", \"):u.join(\", \");const t={ObjectId:0},r=\"Raster.ServicePixelValue\";t[r]=this._formatAttributeValue(f,r);const i=null==(c=s.rasterInfo)||null==(d=c.attributeTable)?void 0:d.features;if(i&&i.length>0){const e=i.filter((t=>{const e=t.attributes.value||t.attributes.Value||t.attributes.VALUE;return String(e)===f}));if(e.length>0){const r=e[0];if(r)for(const e in r.attributes)if(r.attributes.hasOwnProperty(e)){const i=this._rasterFieldPrefix+e;t[i]=this._formatAttributeValue(r.attributes[e],i)}}}const o=s.rasterInfo.dataType;\"vector-magdir\"!==o&&\"vector-uv\"!==o||(t[\"Raster.Magnitude\"]=null==m?void 0:m[0],t[\"Raster.Direction\"]=null==m?void 0:m[1]);const a=new e(this.fullExtent.clone(),null,t);a.layer=s,a.sourceLayer=a.layer,l.push(a)}return l}_formatAttributeValue(t,e){if(\"string\"==typeof t){const r=this.layer.popupTemplate&&this.layer.popupTemplate.fieldInfos,i=this._getFieldInfo(r,e),o=i&&i.format;if(o){let e,r;return t.trim().indexOf(\",\")>-1?(e=\",\",r=e+\" \",this._formatDelimitedString(t,e,r,o)):t.trim().indexOf(\" \")>-1?(e=r=\" \",this._formatDelimitedString(t,e,r,o)):this._formatNumberFromString(t,o)}}return t}_getFieldInfo(t,e){if(!t||!t.length||!e)return;const r=e.toLowerCase();let i;return t.some((t=>!(!t.fieldName||t.fieldName.toLowerCase()!==r&&t.fieldName.toLowerCase()!==r.replace(/ /g,\"_\"))&&(i=t,!0))),i}_formatDelimitedString(t,e,r,i){return t&&e&&r&&i?t.trim().split(e).map((t=>this._formatNumberFromString(t,i))).join(r):t}_formatNumberFromString(t,e){if(!t||!e)return t;const r=Number(t);return isNaN(r)?t:e.format(r)}};return t([s()],f.prototype,\"layer\",void 0),t([s(n)],f.prototype,\"timeExtent\",void 0),t([s()],f.prototype,\"view\",void 0),t([s()],f.prototype,\"fullExtent\",null),t([s()],f.prototype,\"tileInfo\",void 0),t([s({readOnly:!0})],f.prototype,\"hasTilingEffects\",null),f=t([a(\"esri.views.layers.ImageryTileLayerView\")],f),f};export{m as ImageryTileLayerView,m as default};\n"]},"metadata":{},"sourceType":"module"}