{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport { isSome as t } from \"../../../../../../core/maybe.js\";\nimport { pt2px as e } from \"../../../../../../core/screenUtils.js\";\nimport { premultiplyAlphaRGBA as i } from \"../../color.js\";\nimport { MIN_MAX_ZOOM_PRECISION_FACTOR as s, SPRITE_PADDING as r } from \"../../definitions.js\";\nimport { i1616to32 as o } from \"../../number.js\";\nimport { LineMaterialKey as a } from \"../../materialKey/MaterialKey.js\";\nimport { isFunction as l, getLimitCosine as h, getMinMaxZoom as n } from \"./util.js\";\nimport c from \"./WGLBaseLineTemplate.js\";\nimport m from \"./WGLDynamicMeshTemplate.js\";\nimport { ok as p } from \"../../util/Result.js\";\n\nclass _ extends c(m) {\n  constructor(r, a, n) {\n    super(r), this._minMaxZoom = o(Math.round(a * s), Math.round(n * s)), this._cimLineLayer = r;\n    let c = 0;\n    l(r.width) || (c = .5 * e(r.width));\n\n    const m = (t, i, s) => l(r.width) ? .5 * e(r.width(t, i, s)) : c;\n\n    this._dynamicPropertyMap.set(\"_halfWidth\", m), l(r.cap) ? this._dynamicPropertyMap.set(\"_capType\", r.cap) : this._capType = r.cap, l(r.join) ? this._dynamicPropertyMap.set(\"_joinType\", r.join) : this._joinType = r.join;\n    const p = r.color;\n\n    if (l(p)) {\n      const t = (t, e, s) => i(p(t, e, s));\n\n      this._dynamicPropertyMap.set(\"_fillColor\", t);\n    } else this._fillColor = p && i(p) || 0;\n\n    const _ = r.miterLimit;\n\n    if (l(_)) {\n      const t = (t, e, i) => h(_(t, e, i));\n\n      this._dynamicPropertyMap.set(\"_miterLimitCosine\", t);\n    } else this._miterLimitCosine = h(_);\n\n    if (t(r.effects)) {\n      const t = r.effects;\n      l(t) ? this._dynamicPropertyMap.set(\"_effects\", t) : this._effects = t;\n    }\n\n    this._scaleFactor = r.scaleFactor || 1, this._isDashed = null != r.dashTemplate, this.tessellationProperties._bitset = (r.colorLocked ? 1 : 0) | (r.scaleDash ? 1 : 0) << 1, this._materialKey = r.materialKey, this._initializeTessellator(!0);\n  }\n\n  static fromCIMLine(t, e) {\n    const [i, s] = n(t.scaleInfo, e);\n    return new _(t, i, s);\n  }\n\n  bindFeature(t, e, i) {\n    const s = t.readLegacyFeature();\n    this._dynamicPropertyMap.forEach((t, r) => {\n      this[r] = t(s, e, i);\n    }), this._halfWidth *= this._scaleFactor;\n    const l = this._materialCache,\n          h = (0, this._cimLineLayer.materialHash)(s, e, i),\n          n = l.get(h);\n    let c = null;\n\n    if (n && p(n.spriteMosaicItem) && (c = n.spriteMosaicItem), c) {\n      this._hasPattern = !0;\n      const {\n        rect: t,\n        width: e,\n        height: i\n      } = c,\n            s = t.x + r,\n            a = t.y + r,\n            l = s + e,\n            h = a + i;\n      this.tessellationProperties._tl = o(s, a), this.tessellationProperties._br = o(l, h);\n    } else this._hasPattern = !1, this.tessellationProperties._tl = 0, this.tessellationProperties._br = 0;\n\n    this.tessellationProperties._fillColor = this._fillColor, this.tessellationProperties._halfWidth = this._halfWidth, this.tessellationProperties.offset = 0, this.tessellationProperties._halfReferenceWidth = this.tessellationProperties._halfWidth;\n    const m = a.load(this._materialKey);\n    c && (m.sdf = c.sdf, m.pattern = !0, m.textureBinding = c.textureBinding), this._materialKey = m.data;\n  }\n\n}\n\nexport { _ as default };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/views/2d/engine/webgl/mesh/templates/WGLDynamicLineTemplate.js"],"names":["isSome","t","pt2px","e","premultiplyAlphaRGBA","i","MIN_MAX_ZOOM_PRECISION_FACTOR","s","SPRITE_PADDING","r","i1616to32","o","LineMaterialKey","a","isFunction","l","getLimitCosine","h","getMinMaxZoom","n","c","m","ok","p","_","constructor","_minMaxZoom","Math","round","_cimLineLayer","width","_dynamicPropertyMap","set","cap","_capType","join","_joinType","color","_fillColor","miterLimit","_miterLimitCosine","effects","_effects","_scaleFactor","scaleFactor","_isDashed","dashTemplate","tessellationProperties","_bitset","colorLocked","scaleDash","_materialKey","materialKey","_initializeTessellator","fromCIMLine","scaleInfo","bindFeature","readLegacyFeature","forEach","_halfWidth","_materialCache","materialHash","get","spriteMosaicItem","_hasPattern","rect","height","x","y","_tl","_br","offset","_halfReferenceWidth","load","sdf","pattern","textureBinding","data","default"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{isSome as t}from\"../../../../../../core/maybe.js\";import{pt2px as e}from\"../../../../../../core/screenUtils.js\";import{premultiplyAlphaRGBA as i}from\"../../color.js\";import{MIN_MAX_ZOOM_PRECISION_FACTOR as s,SPRITE_PADDING as r}from\"../../definitions.js\";import{i1616to32 as o}from\"../../number.js\";import{LineMaterialKey as a}from\"../../materialKey/MaterialKey.js\";import{isFunction as l,getLimitCosine as h,getMinMaxZoom as n}from\"./util.js\";import c from\"./WGLBaseLineTemplate.js\";import m from\"./WGLDynamicMeshTemplate.js\";import{ok as p}from\"../../util/Result.js\";class _ extends(c(m)){constructor(r,a,n){super(r),this._minMaxZoom=o(Math.round(a*s),Math.round(n*s)),this._cimLineLayer=r;let c=0;l(r.width)||(c=.5*e(r.width));const m=(t,i,s)=>l(r.width)?.5*e(r.width(t,i,s)):c;this._dynamicPropertyMap.set(\"_halfWidth\",m),l(r.cap)?this._dynamicPropertyMap.set(\"_capType\",r.cap):this._capType=r.cap,l(r.join)?this._dynamicPropertyMap.set(\"_joinType\",r.join):this._joinType=r.join;const p=r.color;if(l(p)){const t=(t,e,s)=>i(p(t,e,s));this._dynamicPropertyMap.set(\"_fillColor\",t)}else this._fillColor=p&&i(p)||0;const _=r.miterLimit;if(l(_)){const t=(t,e,i)=>h(_(t,e,i));this._dynamicPropertyMap.set(\"_miterLimitCosine\",t)}else this._miterLimitCosine=h(_);if(t(r.effects)){const t=r.effects;l(t)?this._dynamicPropertyMap.set(\"_effects\",t):this._effects=t}this._scaleFactor=r.scaleFactor||1,this._isDashed=null!=r.dashTemplate,this.tessellationProperties._bitset=(r.colorLocked?1:0)|(r.scaleDash?1:0)<<1,this._materialKey=r.materialKey,this._initializeTessellator(!0)}static fromCIMLine(t,e){const[i,s]=n(t.scaleInfo,e);return new _(t,i,s)}bindFeature(t,e,i){const s=t.readLegacyFeature();this._dynamicPropertyMap.forEach(((t,r)=>{this[r]=t(s,e,i)})),this._halfWidth*=this._scaleFactor;const l=this._materialCache,h=(0,this._cimLineLayer.materialHash)(s,e,i),n=l.get(h);let c=null;if(n&&p(n.spriteMosaicItem)&&(c=n.spriteMosaicItem),c){this._hasPattern=!0;const{rect:t,width:e,height:i}=c,s=t.x+r,a=t.y+r,l=s+e,h=a+i;this.tessellationProperties._tl=o(s,a),this.tessellationProperties._br=o(l,h)}else this._hasPattern=!1,this.tessellationProperties._tl=0,this.tessellationProperties._br=0;this.tessellationProperties._fillColor=this._fillColor,this.tessellationProperties._halfWidth=this._halfWidth,this.tessellationProperties.offset=0,this.tessellationProperties._halfReferenceWidth=this.tessellationProperties._halfWidth;const m=a.load(this._materialKey);c&&(m.sdf=c.sdf,m.pattern=!0,m.textureBinding=c.textureBinding),this._materialKey=m.data}}export{_ as default};\n"]},"metadata":{},"sourceType":"module"}