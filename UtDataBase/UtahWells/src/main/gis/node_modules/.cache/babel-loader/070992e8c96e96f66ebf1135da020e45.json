{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport { _ as t } from \"../../chunks/tslib.es6.js\";\nimport e from \"../../core/Accessor.js\";\nimport s from \"../../core/has.js\";\nimport { clone as r } from \"../../core/lang.js\";\nimport i from \"../../core/Logger.js\";\nimport { property as n } from \"../../core/accessorSupport/decorators/property.js\";\nimport \"../../core/accessorSupport/ensureType.js\";\nimport { subclass as c } from \"../../core/accessorSupport/decorators/subclass.js\";\nimport { parse as o } from \"./parser.js\";\nimport { canInterpolateEffects as l, normalizeEffects as f } from \"./utils.js\";\nconst a = -1;\nlet h = class extends e {\n  constructor(t) {\n    super(t), this._from = null, this._to = null, this._final = null, this._current = [], this._time = 0, this.duration = s(\"mapview-transitions-duration\"), this.effects = [];\n  }\n\n  set effect(t) {\n    if (this._get(\"effect\") !== (t = t || \"\")) {\n      this._set(\"effect\", t);\n\n      try {\n        this._transitionTo(u(t));\n      } catch (e) {\n        this._transitionTo([]), i.getLogger(this.declaredClass).warn(\"Invalid Effect\", {\n          effect: t,\n          error: e\n        });\n      }\n    }\n  }\n\n  get hasEffects() {\n    return this.transitioning || !!this.effects.length;\n  }\n\n  set scale(t) {\n    this._updateForScale(t);\n  }\n\n  get transitioning() {\n    return null !== this._to;\n  }\n\n  canTransitionTo(t) {\n    try {\n      return this.scale > 0 && _(this._current, u(t), this.scale);\n    } catch {\n      return !1;\n    }\n  }\n\n  transitionStep(t, e) {\n    this._applyTimeTransition(t), this._updateForScale(e);\n  }\n\n  end() {\n    this._applyTimeTransition(this.duration);\n  }\n\n  _transitionTo(t) {\n    this.scale > 0 && _(this._current, t, this.scale) ? (this._final = t, this._to = r(t), p(this._current, this._to, this.scale), this._from = r(this._current), this._time = 0) : (this._from = this._to = this._final = null, this._current = t), this._set(\"effects\", this._current[0] ? r(this._current[0].effects) : []);\n  }\n\n  _applyTimeTransition(t) {\n    if (!(this._to && this._from && this._current && this._final)) return;\n    this._time += t;\n    const e = Math.min(1, this._time / this.duration);\n\n    for (let s = 0; s < this._current.length; s++) {\n      const t = this._current[s],\n            r = this._from[s],\n            i = this._to[s];\n      t.scale = m(r.scale, i.scale, e);\n\n      for (let s = 0; s < t.effects.length; s++) {\n        const n = t.effects[s],\n              c = r.effects[s],\n              o = i.effects[s];\n        n.interpolate(c, o, e);\n      }\n    }\n\n    1 === e && (this._current = this._final, this._set(\"effects\", this._current[0] ? r(this._current[0].effects) : []), this._from = this._to = this._final = null);\n  }\n\n  _updateForScale(t) {\n    if (this._set(\"scale\", t), 0 === this._current.length) return;\n    const e = this._current,\n          s = this._current.length - 1;\n    let r,\n        i,\n        n = 1;\n    if (1 === e.length || t >= e[0].scale) i = r = e[0].effects;else if (t <= e[s].scale) i = r = e[s].effects;else for (let c = 0; c < s; c++) {\n      const s = e[c],\n            o = e[c + 1];\n\n      if (s.scale >= t && o.scale <= t) {\n        n = (t - s.scale) / (o.scale - s.scale), r = s.effects, i = o.effects;\n        break;\n      }\n    }\n\n    for (let c = 0; c < this.effects.length; c++) {\n      this.effects[c].interpolate(r[c], i[c], n);\n    }\n  }\n\n};\n\nfunction u(t) {\n  const e = o(t) || [];\n  return g(e) ? [{\n    scale: a,\n    effects: e\n  }] : e;\n}\n\nfunction _(t, e, s) {\n  var r, i, n, c;\n  if (null == (r = t[0]) || !r.effects || null == (i = e[0]) || !i.effects) return !0;\n  return !(((null == (n = t[0]) ? void 0 : n.scale) === a || (null == (c = e[0]) ? void 0 : c.scale) === a) && (t.length > 1 || e.length > 1) && s <= 0) && l(t[0].effects, e[0].effects);\n}\n\nfunction p(t, e, s) {\n  var r, i;\n  const n = t.length > e.length ? t : e,\n        c = t.length > e.length ? e : t,\n        o = c[c.length - 1],\n        l = null != (r = null == o ? void 0 : o.scale) ? r : s,\n        h = null != (i = null == o ? void 0 : o.effects) ? i : [];\n\n  for (let f = c.length; f < n.length; f++) c.push({\n    scale: l,\n    effects: [...h]\n  });\n\n  for (let u = 0; u < n.length; u++) c[u].scale = c[u].scale === a ? s : c[u].scale, n[u].scale = n[u].scale === a ? s : n[u].scale, f(c[u].effects, n[u].effects);\n}\n\nfunction m(t, e, s) {\n  return t + (e - t) * s;\n}\n\nfunction g(t) {\n  const e = t[0];\n  return !!e && \"type\" in e;\n}\n\nt([n()], h.prototype, \"_to\", void 0), t([n()], h.prototype, \"duration\", void 0), t([n({\n  value: \"\"\n})], h.prototype, \"effect\", null), t([n({\n  readOnly: !0\n})], h.prototype, \"effects\", void 0), t([n({\n  readOnly: !0\n})], h.prototype, \"hasEffects\", null), t([n({\n  value: 0\n})], h.prototype, \"scale\", null), t([n({\n  readOnly: !0\n})], h.prototype, \"transitioning\", null), h = t([c(\"esri.layers.effects.EffectView\")], h);\nexport { h as EffectView, _ as canInterpolateEffectStops, u as convertEffectToStops, p as normalizeEffectStops };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/layers/effects/EffectView.js"],"names":["_","t","e","s","clone","r","i","property","n","subclass","c","parse","o","canInterpolateEffects","l","normalizeEffects","f","a","h","constructor","_from","_to","_final","_current","_time","duration","effects","effect","_get","_set","_transitionTo","u","getLogger","declaredClass","warn","error","hasEffects","transitioning","length","scale","_updateForScale","canTransitionTo","transitionStep","_applyTimeTransition","end","p","Math","min","m","interpolate","g","push","prototype","value","readOnly","EffectView","canInterpolateEffectStops","convertEffectToStops","normalizeEffectStops"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../chunks/tslib.es6.js\";import e from\"../../core/Accessor.js\";import s from\"../../core/has.js\";import{clone as r}from\"../../core/lang.js\";import i from\"../../core/Logger.js\";import{property as n}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as c}from\"../../core/accessorSupport/decorators/subclass.js\";import{parse as o}from\"./parser.js\";import{canInterpolateEffects as l,normalizeEffects as f}from\"./utils.js\";const a=-1;let h=class extends e{constructor(t){super(t),this._from=null,this._to=null,this._final=null,this._current=[],this._time=0,this.duration=s(\"mapview-transitions-duration\"),this.effects=[]}set effect(t){if(this._get(\"effect\")!==(t=t||\"\")){this._set(\"effect\",t);try{this._transitionTo(u(t))}catch(e){this._transitionTo([]),i.getLogger(this.declaredClass).warn(\"Invalid Effect\",{effect:t,error:e})}}}get hasEffects(){return this.transitioning||!!this.effects.length}set scale(t){this._updateForScale(t)}get transitioning(){return null!==this._to}canTransitionTo(t){try{return this.scale>0&&_(this._current,u(t),this.scale)}catch{return!1}}transitionStep(t,e){this._applyTimeTransition(t),this._updateForScale(e)}end(){this._applyTimeTransition(this.duration)}_transitionTo(t){this.scale>0&&_(this._current,t,this.scale)?(this._final=t,this._to=r(t),p(this._current,this._to,this.scale),this._from=r(this._current),this._time=0):(this._from=this._to=this._final=null,this._current=t),this._set(\"effects\",this._current[0]?r(this._current[0].effects):[])}_applyTimeTransition(t){if(!(this._to&&this._from&&this._current&&this._final))return;this._time+=t;const e=Math.min(1,this._time/this.duration);for(let s=0;s<this._current.length;s++){const t=this._current[s],r=this._from[s],i=this._to[s];t.scale=m(r.scale,i.scale,e);for(let s=0;s<t.effects.length;s++){const n=t.effects[s],c=r.effects[s],o=i.effects[s];n.interpolate(c,o,e)}}1===e&&(this._current=this._final,this._set(\"effects\",this._current[0]?r(this._current[0].effects):[]),this._from=this._to=this._final=null)}_updateForScale(t){if(this._set(\"scale\",t),0===this._current.length)return;const e=this._current,s=this._current.length-1;let r,i,n=1;if(1===e.length||t>=e[0].scale)i=r=e[0].effects;else if(t<=e[s].scale)i=r=e[s].effects;else for(let c=0;c<s;c++){const s=e[c],o=e[c+1];if(s.scale>=t&&o.scale<=t){n=(t-s.scale)/(o.scale-s.scale),r=s.effects,i=o.effects;break}}for(let c=0;c<this.effects.length;c++){this.effects[c].interpolate(r[c],i[c],n)}}};function u(t){const e=o(t)||[];return g(e)?[{scale:a,effects:e}]:e}function _(t,e,s){var r,i,n,c;if(null==(r=t[0])||!r.effects||null==(i=e[0])||!i.effects)return!0;return!(((null==(n=t[0])?void 0:n.scale)===a||(null==(c=e[0])?void 0:c.scale)===a)&&(t.length>1||e.length>1)&&s<=0)&&l(t[0].effects,e[0].effects)}function p(t,e,s){var r,i;const n=t.length>e.length?t:e,c=t.length>e.length?e:t,o=c[c.length-1],l=null!=(r=null==o?void 0:o.scale)?r:s,h=null!=(i=null==o?void 0:o.effects)?i:[];for(let f=c.length;f<n.length;f++)c.push({scale:l,effects:[...h]});for(let u=0;u<n.length;u++)c[u].scale=c[u].scale===a?s:c[u].scale,n[u].scale=n[u].scale===a?s:n[u].scale,f(c[u].effects,n[u].effects)}function m(t,e,s){return t+(e-t)*s}function g(t){const e=t[0];return!!e&&\"type\"in e}t([n()],h.prototype,\"_to\",void 0),t([n()],h.prototype,\"duration\",void 0),t([n({value:\"\"})],h.prototype,\"effect\",null),t([n({readOnly:!0})],h.prototype,\"effects\",void 0),t([n({readOnly:!0})],h.prototype,\"hasEffects\",null),t([n({value:0})],h.prototype,\"scale\",null),t([n({readOnly:!0})],h.prototype,\"transitioning\",null),h=t([c(\"esri.layers.effects.EffectView\")],h);export{h as EffectView,_ as canInterpolateEffectStops,u as convertEffectToStops,p as normalizeEffectStops};\n"]},"metadata":{},"sourceType":"module"}