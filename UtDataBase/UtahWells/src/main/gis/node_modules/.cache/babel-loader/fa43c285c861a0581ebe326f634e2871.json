{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport { isNone as e } from \"../../../../../core/maybe.js\";\nimport { TranslateAnchor as t } from \"../../vectorTiles/style/StyleDefinition.js\";\nimport { WGLDrawPhase as r } from \"../enums.js\";\nimport { u32to4Xu8 as i } from \"../number.js\";\nimport n from \"./WGLBrush.js\";\nimport { CompareFunction as a, PrimitiveType as s, DataType as o } from \"../../../../webgl/enums.js\";\n\nclass l extends n {\n  constructor() {\n    super(...arguments), this._programOptions = {\n      id: !1\n    };\n  }\n\n  dispose() {}\n\n  drawMany(n, l) {\n    const {\n      context: c,\n      displayLevel: m,\n      requiredLevel: u,\n      state: f,\n      drawPhase: d,\n      painter: p,\n      spriteMosaic: y,\n      styleLayerUID: v\n    } = n;\n    if (!l.some(e => {\n      var t, r;\n      return null != (t = null == (r = e.layerData.get(v)) ? void 0 : r.circleIndexCount) && t;\n    })) return;\n    const g = n.styleLayer,\n          E = g.circleMaterial,\n          M = p.vectorTilesMaterialManager,\n          T = 1.2,\n          x = g.getPaintValue(\"circle-translate\", m),\n          I = g.getPaintValue(\"circle-translate-anchor\", m),\n          U = d === r.HITTEST,\n          _ = this._programOptions;\n    _.id = U;\n    const h = M.getMaterialProgram(c, E, _);\n    c.useProgram(h), h.setUniformMatrix3fv(\"u_displayMat3\", I === t.VIEWPORT ? f.displayMat3 : f.displayViewMat3), h.setUniform2fv(\"u_circleTranslation\", x), h.setUniform1f(\"u_depth\", g.z), h.setUniform1f(\"u_antialiasingWidth\", T);\n    let L = -1;\n\n    if (U) {\n      const e = i(v + 1);\n      h.setUniform4fv(\"u_id\", e);\n    }\n\n    for (const t of l) {\n      if (!t.layerData.has(v)) continue;\n      t.key.level !== L && (L = t.key.level, E.setDataUniforms(h, m, g, L, y));\n      const r = t.layerData.get(v);\n      if (!r.circleIndexCount) continue;\n      r.prepareForRendering(c);\n      const i = r.circleVertexArrayObject;\n      e(i) || (c.bindVAO(i), h.setUniformMatrix3fv(\"u_dvsMat3\", t.transforms.dvs), u !== t.key.level ? c.setStencilFunction(a.EQUAL, t.stencilRef, 255) : c.setStencilFunction(a.GREATER, 255, 255), c.drawElements(s.TRIANGLES, r.circleIndexCount, o.UNSIGNED_INT, Uint32Array.BYTES_PER_ELEMENT * r.circleIndexStart), t.triangleCount += r.circleIndexCount / 3);\n    }\n  }\n\n}\n\nexport { l as WGLBrushVTLCircle };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/views/2d/engine/webgl/brushes/WGLBrushVTLCircle.js"],"names":["isNone","e","TranslateAnchor","t","WGLDrawPhase","r","u32to4Xu8","i","n","CompareFunction","a","PrimitiveType","s","DataType","o","l","constructor","arguments","_programOptions","id","dispose","drawMany","context","c","displayLevel","m","requiredLevel","u","state","f","drawPhase","d","painter","p","spriteMosaic","y","styleLayerUID","v","some","layerData","get","circleIndexCount","g","styleLayer","E","circleMaterial","M","vectorTilesMaterialManager","T","x","getPaintValue","I","U","HITTEST","_","h","getMaterialProgram","useProgram","setUniformMatrix3fv","VIEWPORT","displayMat3","displayViewMat3","setUniform2fv","setUniform1f","z","L","setUniform4fv","has","key","level","setDataUniforms","prepareForRendering","circleVertexArrayObject","bindVAO","transforms","dvs","setStencilFunction","EQUAL","stencilRef","GREATER","drawElements","TRIANGLES","UNSIGNED_INT","Uint32Array","BYTES_PER_ELEMENT","circleIndexStart","triangleCount","WGLBrushVTLCircle"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{isNone as e}from\"../../../../../core/maybe.js\";import{TranslateAnchor as t}from\"../../vectorTiles/style/StyleDefinition.js\";import{WGLDrawPhase as r}from\"../enums.js\";import{u32to4Xu8 as i}from\"../number.js\";import n from\"./WGLBrush.js\";import{CompareFunction as a,PrimitiveType as s,DataType as o}from\"../../../../webgl/enums.js\";class l extends n{constructor(){super(...arguments),this._programOptions={id:!1}}dispose(){}drawMany(n,l){const{context:c,displayLevel:m,requiredLevel:u,state:f,drawPhase:d,painter:p,spriteMosaic:y,styleLayerUID:v}=n;if(!l.some((e=>{var t,r;return null!=(t=null==(r=e.layerData.get(v))?void 0:r.circleIndexCount)&&t})))return;const g=n.styleLayer,E=g.circleMaterial,M=p.vectorTilesMaterialManager,T=1.2,x=g.getPaintValue(\"circle-translate\",m),I=g.getPaintValue(\"circle-translate-anchor\",m),U=d===r.HITTEST,_=this._programOptions;_.id=U;const h=M.getMaterialProgram(c,E,_);c.useProgram(h),h.setUniformMatrix3fv(\"u_displayMat3\",I===t.VIEWPORT?f.displayMat3:f.displayViewMat3),h.setUniform2fv(\"u_circleTranslation\",x),h.setUniform1f(\"u_depth\",g.z),h.setUniform1f(\"u_antialiasingWidth\",T);let L=-1;if(U){const e=i(v+1);h.setUniform4fv(\"u_id\",e)}for(const t of l){if(!t.layerData.has(v))continue;t.key.level!==L&&(L=t.key.level,E.setDataUniforms(h,m,g,L,y));const r=t.layerData.get(v);if(!r.circleIndexCount)continue;r.prepareForRendering(c);const i=r.circleVertexArrayObject;e(i)||(c.bindVAO(i),h.setUniformMatrix3fv(\"u_dvsMat3\",t.transforms.dvs),u!==t.key.level?c.setStencilFunction(a.EQUAL,t.stencilRef,255):c.setStencilFunction(a.GREATER,255,255),c.drawElements(s.TRIANGLES,r.circleIndexCount,o.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*r.circleIndexStart),t.triangleCount+=r.circleIndexCount/3)}}}export{l as WGLBrushVTLCircle};\n"]},"metadata":{},"sourceType":"module"}