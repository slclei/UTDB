{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport e from \"../ArcadePortal.js\";\nimport t from \"../Dictionary.js\";\nimport n from \"../Feature.js\";\nimport r from \"../featureSetCollection.js\";\nimport { getPortal as i, lookupUser as a, convertToFeatureSet as s, constructFeatureSetFromPortalItem as l, constructFeatureSet as o, constructFeatureSetFromRelationship as f, constructFeatureSetFromUrl as u, constructAssociationMetaDataFeatureSetFromUrl as c } from \"../featureSetUtils.js\";\nimport d from \"../FunctionWrapper.js\";\nimport m from \"../ImmutableArray.js\";\nimport { p, C as y, d as g, q as h, z as F, a as I, k as E, f as D, b as w, N as b, S as A, t as N, Y as x, M as S } from \"../../chunks/languageUtils.js\";\nimport { SqlExpressionAdapted as $, StringToCodeAdapted as L, FieldRename as T, AdaptedFeatureSet as v, OriginalField as j } from \"../featureset/actions/Adapted.js\";\nimport O from \"../featureset/actions/AttributeFilter.js\";\nimport C from \"../featureset/actions/OrderBy.js\";\nimport R from \"../featureset/actions/Top.js\";\nimport M from \"../featureset/sources/Empty.js\";\nimport P from \"../featureset/sources/FeatureLayerMemory.js\";\nimport k from \"../featureset/support/OrderbyClause.js\";\nimport { cloneField as G } from \"../featureset/support/shared.js\";\nimport { isSingleField as B } from \"../featureset/support/sqlUtils.js\";\nimport { calculateStat as V } from \"./fieldStats.js\";\nimport { isPromiseLike as H, resolve as z, all as W } from \"../../core/promiseUtils.js\";\nimport { WhereClause as U } from \"../../core/sql/WhereClause.js\";\nimport _ from \"../../layers/FeatureLayer.js\";\nimport q from \"../../layers/support/Field.js\";\n\nfunction J(e, t, n, r) {\n  if (1 === r.length) {\n    if (I(r[0])) return V(e, r[0], -1);\n    if (w(r[0])) return V(e, r[0].toArray(), -1);\n  }\n\n  return V(e, r, -1);\n}\n\nfunction K(e, t, n) {\n  const r = e.getVariables();\n\n  if (r.length > 0) {\n    const i = [];\n\n    for (let e = 0; e < r.length; e++) {\n      const a = {\n        name: r[e]\n      };\n      i.push(t.evaluateIdentifier(n, a));\n    }\n\n    return W(i).then(t => {\n      const n = {};\n\n      for (let e = 0; e < r.length; e++) n[r[e]] = t[e];\n\n      return e.parameters = n, e;\n    });\n  }\n\n  return z(e);\n}\n\nfunction Y(e, t) {\n  let n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n\n  for (const r in e) if (r.toLowerCase() === t.toLowerCase()) return e[r];\n\n  return n;\n}\n\nfunction Z(e) {\n  if (null === e) return null;\n  const t = {\n    type: Y(e, \"type\", \"\"),\n    name: Y(e, \"name\", \"\")\n  };\n  if (\"range\" === t.type) t.range = Y(e, \"range\", []);else {\n    t.codedValues = [];\n\n    for (const n of Y(e, \"codedValues\", [])) t.codedValues.push({\n      name: Y(n, \"name\", \"\"),\n      code: Y(n, \"code\", null)\n    });\n  }\n  return t;\n}\n\nfunction Q(e) {\n  if (null === e) return null;\n  const t = {},\n        n = Y(e, \"wkt\", null);\n  null !== n && (t.wkt = n);\n  const r = Y(e, \"wkid\", null);\n  return null !== r && (t.wkid = r), t;\n}\n\nfunction X(e) {\n  if (null === e) return null;\n  const t = {\n    hasZ: Y(e, \"hasz\", !1),\n    hasM: Y(e, \"hasm\", !1)\n  },\n        n = Y(e, \"spatialreference\", null);\n  n && (t.spatialReference = Q(n));\n  const r = Y(e, \"x\", null);\n  if (null !== r) return t.x = r, t.y = Y(e, \"y\", null), t;\n  const i = Y(e, \"rings\", null);\n  if (null !== i) return t.rings = i, t;\n  const a = Y(e, \"paths\", null);\n  if (null !== a) return t.paths = a, t;\n  const s = Y(e, \"points\", null);\n  if (null !== s) return t.points = s, t;\n\n  for (const l of [\"xmin\", \"xmax\", \"ymin\", \"ymax\", \"zmin\", \"zmax\", \"mmin\", \"mmax\"]) {\n    const n = Y(e, l, null);\n    null !== n && (t[l] = n);\n  }\n\n  return t;\n}\n\nfunction ee(e, t) {\n  for (const n of t) if (n === e) return !0;\n\n  return !1;\n}\n\nfunction te(e) {\n  return !!e.layerDefinition && !!e.featureSet && !1 !== ee(e.layerDefinition.geometryType, [\"\", \"esriGeometryPoint\", \"esriGeometryPolyline\", \"esriGeometryPolygon\", \"esriGeometryMultipoint\", \"esriGeometryEnvelope\"]) && null !== e.layerDefinition.objectIdField && \"\" !== e.layerDefinition.objectIdField && !1 !== I(e.layerDefinition.fields) && !1 !== I(e.featureSet.features);\n}\n\nfunction ne(V) {\n  \"async\" === V.mode && (V.functions.getuser = function (n, r) {\n    return V.standardFunctionAsync(n, r, (r, s, l) => {\n      p(l, 1, 2);\n      let o = y(l[1], \"\"),\n          f = !0 === o;\n\n      if (o = !0 === o || !1 === o ? \"\" : g(o), l[0] instanceof e) {\n        let e = null;\n        return n.services && n.services.portal && (e = n.services.portal), e = i(l[0], e), a(e, o, f).then(e => {\n          if (e) {\n            const n = JSON.parse(JSON.stringify(e));\n\n            for (const e of [\"lastLogin\", \"created\", \"modified\"]) void 0 !== n[e] && null !== n[e] && (n[e] = new Date(n[e]));\n\n            return t.convertObjectToArcadeDictionary(n);\n          }\n\n          return null;\n        });\n      }\n\n      let u = null;\n      if (h(l[0]) && (u = l[0]), u) return f = !1, o ? null : u.load().then(() => u.getOwningSystemUrl()).then(r => {\n        if (!r) return o ? null : u.getIdentityUser().then(e => e ? t.convertObjectToArcadeDictionary({\n          username: e\n        }) : null);\n        let s = null;\n        return n.services && n.services.portal && (s = n.services.portal), s = i(new e(r), s), a(s, o, f).then(e => {\n          if (e) {\n            const n = JSON.parse(JSON.stringify(e));\n\n            for (const e of [\"lastLogin\", \"created\", \"modified\"]) void 0 !== n[e] && null !== n[e] && (n[e] = new Date(n[e]));\n\n            return t.convertObjectToArcadeDictionary(n);\n          }\n\n          return null;\n        });\n      });\n      throw new Error(\"Invalid Parameter\");\n    });\n  }, V.signatures.push({\n    name: \"getuser\",\n    min: \"1\",\n    max: \"2\"\n  }), V.functions.featuresetbyid = function (e, t) {\n    return V.standardFunctionAsync(e, t, (e, t, n) => {\n      if (p(n, 2, 4), n[0] instanceof r) {\n        const e = g(n[1]);\n        let t = y(n[2], null);\n        const r = F(y(n[3], !0));\n        if (null === t && (t = [\"*\"]), !1 === I(t)) throw new Error(\"Invalid Parameter\");\n        return n[0].featureSetById(e, r, t);\n      }\n\n      throw new Error(\"Invalid Parameter\");\n    });\n  }, V.signatures.push({\n    name: \"featuresetbyid\",\n    min: \"2\",\n    max: \"4\"\n  }), V.functions.getfeatureset = function (e, t) {\n    return V.standardFunctionAsync(e, t, (t, n, r) => {\n      if (p(r, 1, 2), E(r[0])) {\n        let t = y(r[1], \"datasource\");\n        return null === t && (t = \"datasource\"), t = g(t).toLowerCase(), s(r[0].fullSchema(), t, e.lrucache, e.interceptor, e.spatialReference);\n      }\n\n      throw new Error(\"Invalid Parameter\");\n    });\n  }, V.signatures.push({\n    name: \"getfeatureset\",\n    min: \"1\",\n    max: \"2\"\n  }), V.functions.featuresetbyportalitem = function (t, n) {\n    return V.standardFunctionAsync(t, n, (n, r, a) => {\n      if (p(a, 2, 5), null === a[0]) throw new Error(\"Portal is required\");\n\n      if (a[0] instanceof e) {\n        const e = g(a[1]),\n              n = g(a[2]);\n        let r = y(a[3], null);\n        const s = F(y(a[4], !0));\n        if (null === r && (r = [\"*\"]), !1 === I(r)) throw new Error(\"Invalid Parameter\");\n        let o = null;\n        return t.services && t.services.portal && (o = t.services.portal), o = i(a[0], o), l(e, n, t.spatialReference, r, s, o, t.lrucache, t.interceptor);\n      }\n\n      if (!1 === D(a[0])) throw new Error(\"Portal is required\");\n      const s = g(a[0]),\n            o = g(a[1]);\n      let f = y(a[2], null);\n      const u = F(y(a[3], !0));\n      if (null === f && (f = [\"*\"]), !1 === I(f)) throw new Error(\"Invalid Parameter\");\n      if (t.services && t.services.portal) return l(s, o, t.spatialReference, f, u, t.services.portal, t.lrucache, t.interceptor);\n      throw new Error(\"Portal is required\");\n    });\n  }, V.signatures.push({\n    name: \"featuresetbyportalitem\",\n    min: \"2\",\n    max: \"5\"\n  }), V.functions.featuresetbyname = function (e, t) {\n    return V.standardFunctionAsync(e, t, (e, t, n) => {\n      if (p(n, 2, 4), n[0] instanceof r) {\n        const e = g(n[1]);\n        let t = y(n[2], null);\n        const r = F(y(n[3], !0));\n        if (null === t && (t = [\"*\"]), !1 === I(t)) throw new Error(\"Invalid Parameter\");\n        return n[0].featureSetByName(e, r, t);\n      }\n\n      throw new Error(\"Invalid Parameter\");\n    });\n  }, V.signatures.push({\n    name: \"featuresetbyname\",\n    min: \"2\",\n    max: \"4\"\n  }), V.functions.featureset = function (e, n) {\n    return V.standardFunction(e, n, (n, r, i) => {\n      p(i, 1, 1);\n      let a = i[0];\n      const s = {\n        layerDefinition: {\n          geometryType: \"\",\n          objectIdField: \"\",\n          globalIdField: \"\",\n          typeIdField: \"\",\n          fields: []\n        },\n        featureSet: {\n          geometryType: \"\",\n          features: []\n        }\n      };\n      if (D(a)) a = JSON.parse(a), void 0 !== a.layerDefinition ? (s.layerDefinition = a.layerDefinition, s.featureSet = a.featureSet, a.layerDefinition.spatialReference && (s.layerDefinition.spatialReference = a.layerDefinition.spatialReference)) : (s.featureSet.features = a.features, s.featureSet.geometryType = a.geometryType, s.layerDefinition.geometryType = s.featureSet.geometryType, s.layerDefinition.objectIdField = a.objectIdFieldName, s.layerDefinition.typeIdField = a.typeIdFieldName, s.layerDefinition.globalIdField = a.globalIdFieldName, s.layerDefinition.fields = a.fields, a.spatialReference && (s.layerDefinition.spatialReference = a.spatialReference));else {\n        if (!(i[0] instanceof t)) throw new Error(\"Invalid Parameter\");\n        {\n          a = JSON.parse(i[0].castToText());\n          const e = Y(a, \"layerdefinition\");\n\n          if (null !== e) {\n            s.layerDefinition.geometryType = Y(e, \"geometrytype\", \"\"), s.featureSet.geometryType = s.layerDefinition.geometryType, s.layerDefinition.globalIdField = Y(e, \"globalidfield\", \"\"), s.layerDefinition.objectIdField = Y(e, \"objectidfield\", \"\"), s.layerDefinition.typeIdField = Y(e, \"typeidfield\", \"\");\n            const t = Y(e, \"spatialreference\", null);\n            t && (s.layerDefinition.spatialReference = Q(t));\n\n            for (const r of Y(e, \"fields\", [])) {\n              const e = {\n                name: Y(r, \"name\", \"\"),\n                alias: Y(r, \"alias\", \"\"),\n                type: Y(r, \"type\", \"\"),\n                nullable: Y(r, \"nullable\", !0),\n                editable: Y(r, \"editable\", !0),\n                length: Y(r, \"length\", null),\n                domain: Z(Y(r, \"domain\"))\n              };\n              s.layerDefinition.fields.push(e);\n            }\n\n            const n = Y(a, \"featureset\", null);\n\n            if (n) {\n              const e = {};\n\n              for (const t of s.layerDefinition.fields) e[t.name.toLowerCase()] = t.name;\n\n              for (const t of Y(n, \"features\", [])) {\n                const n = {},\n                      r = Y(t, \"attributes\", {});\n\n                for (const t in r) n[e[t.toLowerCase()]] = r[t];\n\n                s.featureSet.features.push({\n                  attributes: n,\n                  geometry: X(Y(t, \"geometry\", null))\n                });\n              }\n            }\n          } else {\n            s.layerDefinition.geometryType = Y(a, \"geometrytype\", \"\"), s.featureSet.geometryType = s.layerDefinition.geometryType, s.layerDefinition.objectIdField = Y(a, \"objectidfieldname\", \"\"), s.layerDefinition.typeIdField = Y(a, \"typeidfieldname\", \"\");\n            const e = Y(a, \"spatialreference\", null);\n            e && (s.layerDefinition.spatialReference = Q(e));\n\n            for (const n of Y(a, \"fields\", [])) {\n              const e = {\n                name: Y(n, \"name\", \"\"),\n                alias: Y(n, \"alias\", \"\"),\n                type: Y(n, \"type\", \"\"),\n                nullable: Y(n, \"nullable\", !0),\n                editable: Y(n, \"editable\", !0),\n                length: Y(n, \"length\", null),\n                domain: Z(Y(n, \"domain\"))\n              };\n              s.layerDefinition.fields.push(e);\n            }\n\n            const t = {};\n\n            for (const n of s.layerDefinition.fields) t[n.name.toLowerCase()] = n.name;\n\n            for (const n of Y(a, \"features\", [])) {\n              const e = {},\n                    r = Y(n, \"attributes\", {});\n\n              for (const n in r) e[t[n.toLowerCase()]] = r[n];\n\n              s.featureSet.features.push({\n                attributes: e,\n                geometry: X(Y(n, \"geometry\", null))\n              });\n            }\n          }\n        }\n      }\n      if (!1 === te(s)) throw new Error(\"Invalid Parameter\");\n      return P.create(s, e.spatialReference);\n    });\n  }, V.signatures.push({\n    name: \"featureset\",\n    min: \"1\",\n    max: \"1\"\n  }), V.functions.filter = function (e, t) {\n    return V.standardFunctionAsync(e, t, (t, n, r) => {\n      if (p(r, 2, 2), I(r[0]) || w(r[0])) {\n        const t = [];\n        let n = r[0];\n        n instanceof m && (n = n.toArray());\n        let i = null;\n        if (r[1] instanceof d) i = V.arcadeCustomFunctionHandler(r[1]);else if (r[1] instanceof b) i = function () {\n          for (var _len = arguments.length, t = new Array(_len), _key = 0; _key < _len; _key++) {\n            t[_key] = arguments[_key];\n          }\n\n          return r[1].fn(e, {\n            preparsed: !0,\n            arguments: t\n          });\n        };else {\n          if (!(r[1] instanceof A)) throw new Error(\"Invalid Parameter\");\n\n          i = function () {\n            if (arguments.length !== r[1].paramCount) throw new Error(\"Invalid parameters\");\n            return r[1].fn(...arguments);\n          };\n        }\n        return n.reduce((e, r, a) => e.then(e => {\n          a > 0 && !0 === e && t.push(n[a - 1]);\n          const s = i(r);\n          return H(s) ? s : z(s);\n        }), Promise.resolve(!1)).then(e => (!0 === e && n.length > 0 && t.push(n[n.length - 1]), t));\n      }\n\n      return h(r[0]) ? r[0].load().then(t => {\n        const n = U.create(r[1], t.getFieldsIndex()),\n              i = n.getVariables();\n\n        if (i.length > 0) {\n          const t = [];\n\n          for (let n = 0; n < i.length; n++) {\n            const r = {\n              name: i[n]\n            };\n            t.push(V.evaluateIdentifier(e, r));\n          }\n\n          return W(t).then(e => {\n            const t = {};\n\n            for (let n = 0; n < i.length; n++) t[i[n]] = e[n];\n\n            return n.parameters = t, new O({\n              parentfeatureset: r[0],\n              whereclause: n\n            });\n          });\n        }\n\n        return z(new O({\n          parentfeatureset: r[0],\n          whereclause: n\n        }));\n      }) : V.failDefferred(\"Filter cannot accept this parameter type\");\n    });\n  }, V.signatures.push({\n    name: \"filter\",\n    min: \"2\",\n    max: \"2\"\n  }), V.functions.orderby = function (e, t) {\n    return V.standardFunctionAsync(e, t, (e, t, n) => {\n      if (p(n, 2, 2), h(n[0])) {\n        const e = new k(n[1]);\n        return z(new C({\n          parentfeatureset: n[0],\n          orderbyclause: e\n        }));\n      }\n\n      return V.failDefferred(\"Order cannot accept this parameter type\");\n    });\n  }, V.signatures.push({\n    name: \"orderby\",\n    min: \"2\",\n    max: \"2\"\n  }), V.functions.top = function (e, t) {\n    return V.standardFunctionAsync(e, t, (e, t, n) => (p(n, 2, 2), h(n[0]) ? z(new R({\n      parentfeatureset: n[0],\n      topnum: n[1]\n    })) : I(n[0]) ? N(n[1]) >= n[0].length ? n[0].slice(0) : n[0].slice(0, N(n[1])) : w(n[0]) ? N(n[1]) >= n[0].length() ? n[0].slice(0) : n[0].slice(0, N(n[1])) : V.failDefferred(\"Top cannot accept this parameter type\")));\n  }, V.signatures.push({\n    name: \"top\",\n    min: \"2\",\n    max: \"2\"\n  }), V.functions.first = function (e, t) {\n    return V.standardFunctionAsync(e, t, (e, t, r) => (p(r, 1, 1), h(r[0]) ? r[0].first(e.abortSignal).then(e => {\n      if (null !== e) {\n        const t = n.createFromGraphicLikeObject(e.geometry, e.attributes, r[0]);\n        t._underlyingGraphic = e, e = t;\n      }\n\n      return e;\n    }) : I(r[0]) ? 0 === r[0].length ? z(null) : z(r[0][0]) : w(r[0]) ? 0 === r[0].length() ? z(null) : z(r[0].get(0)) : null));\n  }, V.signatures.push({\n    name: \"first\",\n    min: \"1\",\n    max: \"1\"\n  }), V.functions.attachments = function (e, n) {\n    return V.standardFunctionAsync(e, n, (n, r, i) => {\n      p(i, 1, 2);\n      const a = {\n        minsize: -1,\n        maxsize: -1,\n        types: null,\n        returnMetadata: !1\n      };\n      if (i.length > 1) if (i[1] instanceof t) {\n        if (i[1].hasField(\"minsize\") && (a.minsize = N(i[1].field(\"minsize\"))), i[1].hasField(\"metadata\") && (a.returnMetadata = F(i[1].field(\"metadata\"))), i[1].hasField(\"maxsize\") && (a.maxsize = N(i[1].field(\"maxsize\"))), i[1].hasField(\"types\")) {\n          const e = x(i[1].field(\"types\"), !1);\n          e.length > 0 && (a.types = e);\n        }\n      } else if (null !== i[1]) throw new Error(\"Invalid Parameter\");\n\n      if (E(i[0])) {\n        let t = i[0]._layer;\n        return t instanceof _ && (t = o(t, e.spatialReference, [\"*\"], !0, e.lrucache, e.interceptor)), null === t || !1 === h(t) ? [] : t.load().then(() => t.queryAttachments(i[0].field(t.objectIdField), a.minsize, a.maxsize, a.types, a.returnMetadata));\n      }\n\n      if (null === i[0]) return [];\n      throw new Error(\"Invalid Parameter\");\n    });\n  }, V.signatures.push({\n    name: \"attachments\",\n    min: \"1\",\n    max: \"2\"\n  }), V.functions.featuresetbyrelationshipname = function (e, t) {\n    return V.standardFunctionAsync(e, t, (t, n, r) => {\n      p(r, 2, 4);\n      const i = r[0],\n            a = g(r[1]);\n      let s = y(r[2], null);\n      const l = F(y(r[3], !0));\n      if (null === s && (s = [\"*\"]), !1 === I(s)) throw new Error(\"Invalid Parameter\");\n      if (null === r[0]) return null;\n      if (!E(r[0])) throw new Error(\"Invalid Parameter\");\n      let c = i._layer;\n      return c instanceof _ && (c = o(c, e.spatialReference, [\"*\"], !0, e.lrucache, e.interceptor)), null === c || !1 === h(c) ? null : c.load().then(t => {\n        const n = t.relationshipMetaData().filter(e => e.name === a);\n        if (0 === n.length) return null;\n        if (void 0 !== n[0].relationshipTableId && null !== n[0].relationshipTableId && n[0].relationshipTableId > -1) return f(t, n[0], i.field(t.objectIdField), t.spatialReference, s, l, e.lrucache, e.interceptor);\n        let r = t.serviceUrl();\n        return r ? (r = \"/\" === r.charAt(r.length - 1) ? r + n[0].relatedTableId.toString() : r + \"/\" + n[0].relatedTableId.toString(), u(r, t.spatialReference, s, l, e.lrucache, e.interceptor).then(e => e.load().then(() => e.relationshipMetaData()).then(r => {\n          if (r = r.filter(e => e.id === n[0].id), !1 === i.hasField(n[0].keyField) || null === i.field(n[0].keyField)) return t.getFeatureByObjectId(i.field(t.objectIdField), [n[0].keyField]).then(t => {\n            if (t) {\n              const i = U.create(r[0].keyField + \"= @id\", e.getFieldsIndex());\n              return i.parameters = {\n                id: t.attributes[n[0].keyField]\n              }, e.filter(i);\n            }\n\n            return new M({\n              parentfeatureset: e\n            });\n          });\n          const a = U.create(r[0].keyField + \"= @id\", e.getFieldsIndex());\n          return a.parameters = {\n            id: i.field(n[0].keyField)\n          }, e.filter(a);\n        }))) : null;\n      });\n    });\n  }, V.signatures.push({\n    name: \"featuresetbyrelationshipname\",\n    min: \"2\",\n    max: \"4\"\n  }), V.functions.featuresetbyassociation = function (e, t) {\n    return V.standardFunctionAsync(e, t, (t, n, r) => {\n      p(r, 2, 3);\n      const i = r[0],\n            a = g(y(r[1], \"\")).toLowerCase(),\n            s = D(r[2]) ? g(r[2]) : null;\n      if (null === r[0]) return null;\n      if (!E(r[0])) throw new Error(\"Invalid Parameter\");\n      let l = i._layer;\n      return l instanceof _ && (l = o(l, e.spatialReference, [\"*\"], !0, e.lrucache, e.interceptor)), null === l || !1 === h(l) ? null : l.load().then(() => {\n        const t = l.serviceUrl();\n        return c(t, e.spatialReference);\n      }).then(e => {\n        let t = null,\n            n = null,\n            r = !1;\n\n        if (null !== s && \"\" !== s && void 0 !== s) {\n          for (const t of e.terminals) t.terminalName === s && (n = t.terminalId);\n\n          null === n && (r = !0);\n        }\n\n        const o = e.associations.getFieldsIndex(),\n              f = o.get(\"TOGLOBALID\").name,\n              u = o.get(\"FROMGLOBALID\").name,\n              c = o.get(\"TOTERMINALID\").name,\n              d = o.get(\"FROMTERMINALID\").name,\n              m = o.get(\"FROMNETWORKSOURCEID\").name,\n              p = o.get(\"TONETWORKSOURCEID\").name,\n              y = o.get(\"ASSOCIATIONTYPE\").name,\n              g = o.get(\"ISCONTENTVISIBLE\").name,\n              h = o.get(\"OBJECTID\").name;\n\n        for (const a of l.fields) if (\"global-id\" === a.type) {\n          t = i.field(a.name);\n          break;\n        }\n\n        let F = null,\n            I = new $(new q({\n          name: \"percentalong\",\n          alias: \"percentalong\",\n          type: \"double\"\n        }), U.create(\"0\", e.associations.getFieldsIndex())),\n            E = new $(new q({\n          name: \"side\",\n          alias: \"side\",\n          type: \"string\"\n        }), U.create(\"''\", e.associations.getFieldsIndex()));\n        const D = \"globalid\",\n              w = \"globalId\",\n              b = {};\n\n        for (const i in e.lkp) b[i] = e.lkp[i].sourceId;\n\n        const A = new L(new q({\n          name: \"classname\",\n          alias: \"classname\",\n          type: \"string\"\n        }), null, b);\n        let N = \"\";\n\n        switch (a) {\n          case \"midspan\":\n            {\n              N = `((${f}='${t}') OR ( ${u}='${t}')) AND (${y} IN (5))`, A.codefield = U.create(`CASE WHEN (${f}='${t}') THEN ${m} ELSE ${p} END`, e.associations.getFieldsIndex());\n              const n = G(v.findField(e.associations.fields, u));\n              n.name = D, n.alias = D, F = new $(n, U.create(`CASE WHEN (${u}='${t}') THEN ${f} ELSE ${u} END`, e.associations.getFieldsIndex())), I = e.unVersion >= 4 ? new j(v.findField(e.associations.fields, o.get(\"PERCENTALONG\").name)) : new $(new q({\n                name: \"percentalong\",\n                alias: \"percentalong\",\n                type: \"double\"\n              }), U.create(\"0\", e.associations.getFieldsIndex()));\n              break;\n            }\n\n          case \"junctionedge\":\n            {\n              N = `((${f}='${t}') OR ( ${u}='${t}')) AND (${y} IN (4,6))`, A.codefield = U.create(`CASE WHEN (${f}='${t}') THEN ${m} ELSE ${p} END`, e.associations.getFieldsIndex());\n              const n = G(v.findField(e.associations.fields, u));\n              n.name = D, n.alias = D, F = new $(n, U.create(`CASE WHEN (${u}='${t}') THEN ${f} ELSE ${u} END`, e.associations.getFieldsIndex())), E = new $(new q({\n                name: \"side\",\n                alias: \"side\",\n                type: \"string\"\n              }), U.create(`CASE WHEN (${y}=4) THEN 'from' ELSE 'to' END`, e.associations.getFieldsIndex()));\n              break;\n            }\n\n          case \"connected\":\n            {\n              let r = `${f}='@T'`,\n                  i = `${u}='@T'`;\n              null !== n && (r += ` AND ${c}=@A`, i += ` AND ${d}=@A`), N = \"((\" + r + \") OR (\" + i + \"))\", N = S(N, \"@T\", t), r = S(r, \"@T\", t), null !== n && (r = S(r, \"@A\", n.toString()), N = S(N, \"@A\", n.toString())), A.codefield = U.create(\"CASE WHEN \" + r + ` THEN ${m} ELSE ${p} END`, e.associations.getFieldsIndex());\n              const a = G(v.findField(e.associations.fields, u));\n              a.name = D, a.alias = D, F = new $(a, U.create(\"CASE WHEN \" + r + ` THEN ${u} ELSE ${f} END`, e.associations.getFieldsIndex()));\n              break;\n            }\n\n          case \"container\":\n            N = `${f}='${t}' AND ${y} = 2`, null !== n && (N += ` AND ${c} = ` + n.toString()), A.codefield = m, N = \"( \" + N + \" )\", F = new T(v.findField(e.associations.fields, u), D, D);\n\n          case \"content\":\n            N = `(${u}='${t}' AND ${y} = 2)`, null !== n && (N += ` AND ${d} = ` + n.toString()), A.codefield = p, N = \"( \" + N + \" )\", F = new T(v.findField(e.associations.fields, f), D, D);\n            break;\n\n          case \"structure\":\n            N = `(${f}='${t}' AND ${y} = 3)`, null !== n && (N += ` AND ${c} = ` + n.toString()), A.codefield = m, N = \"( \" + N + \" )\", F = new T(v.findField(e.associations.fields, u), D, w);\n            break;\n\n          case \"attached\":\n            N = `(${u}='${t}' AND ${y} = 3)`, null !== n && (N += ` AND ${d} = ` + n.toString()), A.codefield = p, N = \"( \" + N + \" )\", F = new T(v.findField(e.associations.fields, f), D, w);\n            break;\n\n          default:\n            throw new Error(\"Invalid Parameter\");\n        }\n\n        r && (N = \"1 <> 1\");\n        return new v({\n          parentfeatureset: e.associations,\n          adaptedFields: [new j(v.findField(e.associations.fields, h)), new j(v.findField(e.associations.fields, g)), F, E, A, I],\n          extraFilter: N ? U.create(N, e.associations.getFieldsIndex()) : null\n        });\n      });\n    });\n  }, V.signatures.push({\n    name: \"featuresetbyassociation\",\n    min: \"2\",\n    max: \"6\"\n  }), V.functions.groupby = function (e, n) {\n    return V.standardFunctionAsync(e, n, (n, r, i) => (p(i, 3, 3), h(i[0]) ? i[0].load().then(n => {\n      const r = [],\n            a = [];\n      let s = !1,\n          l = [];\n      if (D(i[1])) l.push(i[1]);else if (i[1] instanceof t) l.push(i[1]);else if (I(i[1])) l = i[1];else {\n        if (!w(i[1])) return V.failDefferred(\"Illegal Value: GroupBy\");\n        l = i[1].toArray();\n      }\n\n      for (const e of l) if (D(e)) {\n        const t = U.create(g(e), n.getFieldsIndex()),\n              i = !0 === B(t) ? g(e) : \"%%%%FIELDNAME\";\n        r.push({\n          name: i,\n          expression: t\n        }), \"%%%%FIELDNAME\" === i && (s = !0);\n      } else {\n        if (!(e instanceof t)) return V.failDefferred(\"Illegal Value: GroupBy\");\n        {\n          const t = e.hasField(\"name\") ? e.field(\"name\") : \"%%%%FIELDNAME\",\n                i = e.hasField(\"expression\") ? e.field(\"expression\") : \"\";\n          if (\"%%%%FIELDNAME\" === t && (s = !0), !t) return V.failDefferred(\"Illegal Value: GroupBy\");\n          r.push({\n            name: t,\n            expression: U.create(i || t, n.getFieldsIndex())\n          });\n        }\n      }\n\n      if (l = [], D(i[2])) l.push(i[2]);else if (I(i[2])) l = i[2];else if (w(i[2])) l = i[2].toArray();else {\n        if (!(i[2] instanceof t)) return V.failDefferred(\"Illegal Value: GroupBy\");\n        l.push(i[2]);\n      }\n\n      for (const e of l) {\n        if (!(e instanceof t)) return V.failDefferred(\"Illegal Value: GroupBy\");\n        {\n          const t = e.hasField(\"name\") ? e.field(\"name\") : \"\",\n                r = e.hasField(\"statistic\") ? e.field(\"statistic\") : \"\",\n                i = e.hasField(\"expression\") ? e.field(\"expression\") : \"\";\n          if (!t || !r || !i) return V.failDefferred(\"Illegal Value: GroupBy\");\n          a.push({\n            name: t,\n            statistic: r.toLowerCase(),\n            expression: U.create(i, n.getFieldsIndex())\n          });\n        }\n      }\n\n      if (s) {\n        const e = {};\n\n        for (const r of n.fields) e[r.name.toLowerCase()] = 1;\n\n        for (const n of r) \"%%%%FIELDNAME\" !== n.name && (e[n.name.toLowerCase()] = 1);\n\n        for (const n of a) \"%%%%FIELDNAME\" !== n.name && (e[n.name.toLowerCase()] = 1);\n\n        let t = 0;\n\n        for (const n of r) if (\"%%%%FIELDNAME\" === n.name) {\n          for (; 1 === e[\"field_\" + t.toString()];) t++;\n\n          e[\"field_\" + t.toString()] = 1, n.name = \"FIELD_\" + t.toString();\n        }\n      }\n\n      const o = [];\n\n      for (const t of r) o.push(K(t.expression, V, e));\n\n      for (const t of a) o.push(K(t.expression, V, e));\n\n      return o.length > 0 ? W(o).then(() => z(i[0].groupby(r, a))) : z(i[0].groupby(r, a));\n    }) : V.failDefferred(\"Illegal Value: GroupBy\")));\n  }, V.signatures.push({\n    name: \"groupby\",\n    min: \"3\",\n    max: \"3\"\n  }), V.functions.distinct = function (e, n) {\n    return V.standardFunctionAsync(e, n, (n, r, i) => h(i[0]) ? (p(i, 2, 2), i[0].load().then(n => {\n      const r = [];\n      let a = [];\n      if (D(i[1])) a.push(i[1]);else if (i[1] instanceof t) a.push(i[1]);else if (I(i[1])) a = i[1];else {\n        if (!w(i[1])) return V.failDefferred(\"Illegal Value: GroupBy\");\n        a = i[1].toArray();\n      }\n      let s = !1;\n\n      for (const e of a) if (D(e)) {\n        const t = U.create(g(e), n.getFieldsIndex()),\n              i = !0 === B(t) ? g(e) : \"%%%%FIELDNAME\";\n        r.push({\n          name: i,\n          expression: t\n        }), \"%%%%FIELDNAME\" === i && (s = !0);\n      } else {\n        if (!(e instanceof t)) return V.failDefferred(\"Illegal Value: GroupBy\");\n        {\n          const t = e.hasField(\"name\") ? e.field(\"name\") : \"%%%%FIELDNAME\",\n                i = e.hasField(\"expression\") ? e.field(\"expression\") : \"\";\n          if (\"%%%%FIELDNAME\" === t && (s = !0), !t) return V.failDefferred(\"Illegal Value: GroupBy\");\n          r.push({\n            name: t,\n            expression: U.create(i || t, n.getFieldsIndex())\n          });\n        }\n      }\n\n      if (s) {\n        const e = {};\n\n        for (const r of n.fields) e[r.name.toLowerCase()] = 1;\n\n        for (const n of r) \"%%%%FIELDNAME\" !== n.name && (e[n.name.toLowerCase()] = 1);\n\n        let t = 0;\n\n        for (const n of r) if (\"%%%%FIELDNAME\" === n.name) {\n          for (; 1 === e[\"field_\" + t.toString()];) t++;\n\n          e[\"field_\" + t.toString()] = 1, n.name = \"FIELD_\" + t.toString();\n        }\n      }\n\n      const l = [];\n\n      for (const t of r) l.push(K(t.expression, V, e));\n\n      return l.length > 0 ? W(l).then(() => z(i[0].groupby(r, []))) : z(i[0].groupby(r, []));\n    })) : J(\"distinct\", n, r, i));\n  });\n}\n\nexport { ne as registerFunctions };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/arcade/functions/featuresetbase.js"],"names":["e","t","n","r","getPortal","i","lookupUser","a","convertToFeatureSet","s","constructFeatureSetFromPortalItem","l","constructFeatureSet","o","constructFeatureSetFromRelationship","f","constructFeatureSetFromUrl","u","constructAssociationMetaDataFeatureSetFromUrl","c","d","m","p","C","y","g","q","h","z","F","I","k","E","D","b","w","N","S","A","Y","x","M","SqlExpressionAdapted","$","StringToCodeAdapted","L","FieldRename","T","AdaptedFeatureSet","v","OriginalField","j","O","R","P","cloneField","G","isSingleField","B","calculateStat","V","isPromiseLike","H","resolve","all","W","WhereClause","U","_","J","length","toArray","K","getVariables","name","push","evaluateIdentifier","then","parameters","toLowerCase","Z","type","range","codedValues","code","Q","wkt","wkid","X","hasZ","hasM","spatialReference","rings","paths","points","ee","te","layerDefinition","featureSet","geometryType","objectIdField","fields","features","ne","mode","functions","getuser","standardFunctionAsync","services","portal","JSON","parse","stringify","Date","convertObjectToArcadeDictionary","load","getOwningSystemUrl","getIdentityUser","username","Error","signatures","min","max","featuresetbyid","featureSetById","getfeatureset","fullSchema","lrucache","interceptor","featuresetbyportalitem","featuresetbyname","featureSetByName","featureset","standardFunction","globalIdField","typeIdField","objectIdFieldName","typeIdFieldName","globalIdFieldName","castToText","alias","nullable","editable","domain","attributes","geometry","create","filter","arcadeCustomFunctionHandler","fn","preparsed","arguments","paramCount","reduce","Promise","getFieldsIndex","parentfeatureset","whereclause","failDefferred","orderby","orderbyclause","top","topnum","slice","first","abortSignal","createFromGraphicLikeObject","_underlyingGraphic","get","attachments","minsize","maxsize","types","returnMetadata","hasField","field","_layer","queryAttachments","featuresetbyrelationshipname","relationshipMetaData","relationshipTableId","serviceUrl","charAt","relatedTableId","toString","id","keyField","getFeatureByObjectId","featuresetbyassociation","terminals","terminalName","terminalId","associations","lkp","sourceId","codefield","findField","unVersion","adaptedFields","extraFilter","groupby","expression","statistic","distinct","registerFunctions"],"mappings":"AAAA;AACA;AACA;AACA;AACA,OAAOA,CAAP,MAAa,oBAAb;AAAkC,OAAOC,CAAP,MAAa,kBAAb;AAAgC,OAAOC,CAAP,MAAa,eAAb;AAA6B,OAAOC,CAAP,MAAa,4BAAb;AAA0C,SAAOC,SAAS,IAAIC,CAApB,EAAsBC,UAAU,IAAIC,CAApC,EAAsCC,mBAAmB,IAAIC,CAA7D,EAA+DC,iCAAiC,IAAIC,CAApG,EAAsGC,mBAAmB,IAAIC,CAA7H,EAA+HC,mCAAmC,IAAIC,CAAtK,EAAwKC,0BAA0B,IAAIC,CAAtM,EAAwMC,6CAA6C,IAAIC,CAAzP,QAA+P,uBAA/P;AAAuR,OAAOC,CAAP,MAAa,uBAAb;AAAqC,OAAOC,CAAP,MAAa,sBAAb;AAAoC,SAAOC,CAAP,EAASC,CAAC,IAAIC,CAAd,EAAgBJ,CAAC,IAAIK,CAArB,EAAuBC,CAAC,IAAIC,CAA5B,EAA8BC,CAAC,IAAIC,CAAnC,EAAqCtB,CAAC,IAAIuB,CAA1C,EAA4CC,CAAC,IAAIC,CAAjD,EAAmDjB,CAAC,IAAIkB,CAAxD,EAA0DC,CAAC,IAAIC,CAA/D,EAAiEC,CAAC,IAAIF,CAAtE,EAAwEG,CAAC,IAAIC,CAA7E,EAA+ErC,CAAC,IAAImC,CAApF,EAAsFG,CAAC,IAAIC,CAA3F,EAA6FC,CAAC,IAAIJ,CAAlG,QAAwG,+BAAxG;AAAwI,SAAOK,oBAAoB,IAAIC,CAA/B,EAAiCC,mBAAmB,IAAIC,CAAxD,EAA0DC,WAAW,IAAIC,CAAzE,EAA2EC,iBAAiB,IAAIC,CAAhG,EAAkGC,aAAa,IAAIC,CAAnH,QAAyH,kCAAzH;AAA4J,OAAOC,CAAP,MAAa,0CAAb;AAAwD,OAAO7B,CAAP,MAAa,kCAAb;AAAgD,OAAO8B,CAAP,MAAa,8BAAb;AAA4C,OAAOZ,CAAP,MAAa,gCAAb;AAA8C,OAAOa,CAAP,MAAa,6CAAb;AAA2D,OAAOvB,CAAP,MAAa,wCAAb;AAAsD,SAAOwB,UAAU,IAAIC,CAArB,QAA2B,iCAA3B;AAA6D,SAAOC,aAAa,IAAIC,CAAxB,QAA8B,mCAA9B;AAAkE,SAAOC,aAAa,IAAIC,CAAxB,QAA8B,iBAA9B;AAAgD,SAAOC,aAAa,IAAIC,CAAxB,EAA0BC,OAAO,IAAInC,CAArC,EAAuCoC,GAAG,IAAIC,CAA9C,QAAoD,4BAApD;AAAiF,SAAOC,WAAW,IAAIC,CAAtB,QAA4B,+BAA5B;AAA4D,OAAOC,CAAP,MAAa,8BAAb;AAA4C,OAAO1C,CAAP,MAAa,+BAAb;;AAA6C,SAAS2C,CAAT,CAAWrE,CAAX,EAAaC,CAAb,EAAeC,CAAf,EAAiBC,CAAjB,EAAmB;AAAC,MAAG,MAAIA,CAAC,CAACmE,MAAT,EAAgB;AAAC,QAAGxC,CAAC,CAAC3B,CAAC,CAAC,CAAD,CAAF,CAAJ,EAAW,OAAOyD,CAAC,CAAC5D,CAAD,EAAGG,CAAC,CAAC,CAAD,CAAJ,EAAQ,CAAC,CAAT,CAAR;AAAoB,QAAGgC,CAAC,CAAChC,CAAC,CAAC,CAAD,CAAF,CAAJ,EAAW,OAAOyD,CAAC,CAAC5D,CAAD,EAAGG,CAAC,CAAC,CAAD,CAAD,CAAKoE,OAAL,EAAH,EAAkB,CAAC,CAAnB,CAAR;AAA8B;;AAAA,SAAOX,CAAC,CAAC5D,CAAD,EAAGG,CAAH,EAAK,CAAC,CAAN,CAAR;AAAiB;;AAAA,SAASqE,CAAT,CAAWxE,CAAX,EAAaC,CAAb,EAAeC,CAAf,EAAiB;AAAC,QAAMC,CAAC,GAACH,CAAC,CAACyE,YAAF,EAAR;;AAAyB,MAAGtE,CAAC,CAACmE,MAAF,GAAS,CAAZ,EAAc;AAAC,UAAMjE,CAAC,GAAC,EAAR;;AAAW,SAAI,IAAIL,CAAC,GAAC,CAAV,EAAYA,CAAC,GAACG,CAAC,CAACmE,MAAhB,EAAuBtE,CAAC,EAAxB,EAA2B;AAAC,YAAMO,CAAC,GAAC;AAACmE,QAAAA,IAAI,EAACvE,CAAC,CAACH,CAAD;AAAP,OAAR;AAAoBK,MAAAA,CAAC,CAACsE,IAAF,CAAO1E,CAAC,CAAC2E,kBAAF,CAAqB1E,CAArB,EAAuBK,CAAvB,CAAP;AAAkC;;AAAA,WAAO0D,CAAC,CAAC5D,CAAD,CAAD,CAAKwE,IAAL,CAAW5E,CAAC,IAAE;AAAC,YAAMC,CAAC,GAAC,EAAR;;AAAW,WAAI,IAAIF,CAAC,GAAC,CAAV,EAAYA,CAAC,GAACG,CAAC,CAACmE,MAAhB,EAAuBtE,CAAC,EAAxB,EAA2BE,CAAC,CAACC,CAAC,CAACH,CAAD,CAAF,CAAD,GAAQC,CAAC,CAACD,CAAD,CAAT;;AAAa,aAAOA,CAAC,CAAC8E,UAAF,GAAa5E,CAAb,EAAeF,CAAtB;AAAwB,KAA1F,CAAP;AAAoG;;AAAA,SAAO4B,CAAC,CAAC5B,CAAD,CAAR;AAAY;;AAAA,SAASuC,CAAT,CAAWvC,CAAX,EAAaC,CAAb,EAAsB;AAAA,MAAPC,CAAO,uEAAL,IAAK;;AAAC,OAAI,MAAMC,CAAV,IAAeH,CAAf,EAAiB,IAAGG,CAAC,CAAC4E,WAAF,OAAkB9E,CAAC,CAAC8E,WAAF,EAArB,EAAqC,OAAO/E,CAAC,CAACG,CAAD,CAAR;;AAAY,SAAOD,CAAP;AAAS;;AAAA,SAAS8E,CAAT,CAAWhF,CAAX,EAAa;AAAC,MAAG,SAAOA,CAAV,EAAY,OAAO,IAAP;AAAY,QAAMC,CAAC,GAAC;AAACgF,IAAAA,IAAI,EAAC1C,CAAC,CAACvC,CAAD,EAAG,MAAH,EAAU,EAAV,CAAP;AAAqB0E,IAAAA,IAAI,EAACnC,CAAC,CAACvC,CAAD,EAAG,MAAH,EAAU,EAAV;AAA3B,GAAR;AAAkD,MAAG,YAAUC,CAAC,CAACgF,IAAf,EAAoBhF,CAAC,CAACiF,KAAF,GAAQ3C,CAAC,CAACvC,CAAD,EAAG,OAAH,EAAW,EAAX,CAAT,CAApB,KAAgD;AAACC,IAAAA,CAAC,CAACkF,WAAF,GAAc,EAAd;;AAAiB,SAAI,MAAMjF,CAAV,IAAeqC,CAAC,CAACvC,CAAD,EAAG,aAAH,EAAiB,EAAjB,CAAhB,EAAqCC,CAAC,CAACkF,WAAF,CAAcR,IAAd,CAAmB;AAACD,MAAAA,IAAI,EAACnC,CAAC,CAACrC,CAAD,EAAG,MAAH,EAAU,EAAV,CAAP;AAAqBkF,MAAAA,IAAI,EAAC7C,CAAC,CAACrC,CAAD,EAAG,MAAH,EAAU,IAAV;AAA3B,KAAnB;AAAgE;AAAA,SAAOD,CAAP;AAAS;;AAAA,SAASoF,CAAT,CAAWrF,CAAX,EAAa;AAAC,MAAG,SAAOA,CAAV,EAAY,OAAO,IAAP;AAAY,QAAMC,CAAC,GAAC,EAAR;AAAA,QAAWC,CAAC,GAACqC,CAAC,CAACvC,CAAD,EAAG,KAAH,EAAS,IAAT,CAAd;AAA6B,WAAOE,CAAP,KAAWD,CAAC,CAACqF,GAAF,GAAMpF,CAAjB;AAAoB,QAAMC,CAAC,GAACoC,CAAC,CAACvC,CAAD,EAAG,MAAH,EAAU,IAAV,CAAT;AAAyB,SAAO,SAAOG,CAAP,KAAWF,CAAC,CAACsF,IAAF,GAAOpF,CAAlB,GAAqBF,CAA5B;AAA8B;;AAAA,SAASuF,CAAT,CAAWxF,CAAX,EAAa;AAAC,MAAG,SAAOA,CAAV,EAAY,OAAO,IAAP;AAAY,QAAMC,CAAC,GAAC;AAACwF,IAAAA,IAAI,EAAClD,CAAC,CAACvC,CAAD,EAAG,MAAH,EAAU,CAAC,CAAX,CAAP;AAAqB0F,IAAAA,IAAI,EAACnD,CAAC,CAACvC,CAAD,EAAG,MAAH,EAAU,CAAC,CAAX;AAA3B,GAAR;AAAA,QAAkDE,CAAC,GAACqC,CAAC,CAACvC,CAAD,EAAG,kBAAH,EAAsB,IAAtB,CAArD;AAAiFE,EAAAA,CAAC,KAAGD,CAAC,CAAC0F,gBAAF,GAAmBN,CAAC,CAACnF,CAAD,CAAvB,CAAD;AAA6B,QAAMC,CAAC,GAACoC,CAAC,CAACvC,CAAD,EAAG,GAAH,EAAO,IAAP,CAAT;AAAsB,MAAG,SAAOG,CAAV,EAAY,OAAOF,CAAC,CAACuC,CAAF,GAAIrC,CAAJ,EAAMF,CAAC,CAACuB,CAAF,GAAIe,CAAC,CAACvC,CAAD,EAAG,GAAH,EAAO,IAAP,CAAX,EAAwBC,CAA/B;AAAiC,QAAMI,CAAC,GAACkC,CAAC,CAACvC,CAAD,EAAG,OAAH,EAAW,IAAX,CAAT;AAA0B,MAAG,SAAOK,CAAV,EAAY,OAAOJ,CAAC,CAAC2F,KAAF,GAAQvF,CAAR,EAAUJ,CAAjB;AAAmB,QAAMM,CAAC,GAACgC,CAAC,CAACvC,CAAD,EAAG,OAAH,EAAW,IAAX,CAAT;AAA0B,MAAG,SAAOO,CAAV,EAAY,OAAON,CAAC,CAAC4F,KAAF,GAAQtF,CAAR,EAAUN,CAAjB;AAAmB,QAAMQ,CAAC,GAAC8B,CAAC,CAACvC,CAAD,EAAG,QAAH,EAAY,IAAZ,CAAT;AAA2B,MAAG,SAAOS,CAAV,EAAY,OAAOR,CAAC,CAAC6F,MAAF,GAASrF,CAAT,EAAWR,CAAlB;;AAAoB,OAAI,MAAMU,CAAV,IAAc,CAAC,MAAD,EAAQ,MAAR,EAAe,MAAf,EAAsB,MAAtB,EAA6B,MAA7B,EAAoC,MAApC,EAA2C,MAA3C,EAAkD,MAAlD,CAAd,EAAwE;AAAC,UAAMT,CAAC,GAACqC,CAAC,CAACvC,CAAD,EAAGW,CAAH,EAAK,IAAL,CAAT;AAAoB,aAAOT,CAAP,KAAWD,CAAC,CAACU,CAAD,CAAD,GAAKT,CAAhB;AAAmB;;AAAA,SAAOD,CAAP;AAAS;;AAAA,SAAS8F,EAAT,CAAY/F,CAAZ,EAAcC,CAAd,EAAgB;AAAC,OAAI,MAAMC,CAAV,IAAeD,CAAf,EAAiB,IAAGC,CAAC,KAAGF,CAAP,EAAS,OAAM,CAAC,CAAP;;AAAS,SAAM,CAAC,CAAP;AAAS;;AAAA,SAASgG,EAAT,CAAYhG,CAAZ,EAAc;AAAC,SAAM,CAAC,CAACA,CAAC,CAACiG,eAAJ,IAAsB,CAAC,CAACjG,CAAC,CAACkG,UAAJ,IAAiB,CAAC,CAAD,KAAKH,EAAE,CAAC/F,CAAC,CAACiG,eAAF,CAAkBE,YAAnB,EAAgC,CAAC,EAAD,EAAI,mBAAJ,EAAwB,sBAAxB,EAA+C,qBAA/C,EAAqE,wBAArE,EAA8F,sBAA9F,CAAhC,CAAP,IAAgK,SAAOnG,CAAC,CAACiG,eAAF,CAAkBG,aAAzB,IAAwC,OAAKpG,CAAC,CAACiG,eAAF,CAAkBG,aAA/D,IAA+E,CAAC,CAAD,KAAKtE,CAAC,CAAC9B,CAAC,CAACiG,eAAF,CAAkBI,MAAnB,CAAN,IAAkC,CAAC,CAAD,KAAKvE,CAAC,CAAC9B,CAAC,CAACkG,UAAF,CAAaI,QAAd,CAApU;AAAgW;;AAAA,SAASC,EAAT,CAAY3C,CAAZ,EAAc;AAAC,cAAUA,CAAC,CAAC4C,IAAZ,KAAmB5C,CAAC,CAAC6C,SAAF,CAAYC,OAAZ,GAAoB,UAASxG,CAAT,EAAWC,CAAX,EAAa;AAAC,WAAOyD,CAAC,CAAC+C,qBAAF,CAAwBzG,CAAxB,EAA0BC,CAA1B,EAA6B,CAACA,CAAD,EAAGM,CAAH,EAAKE,CAAL,KAAS;AAACW,MAAAA,CAAC,CAACX,CAAD,EAAG,CAAH,EAAK,CAAL,CAAD;AAAS,UAAIE,CAAC,GAACW,CAAC,CAACb,CAAC,CAAC,CAAD,CAAF,EAAM,EAAN,CAAP;AAAA,UAAiBI,CAAC,GAAC,CAAC,CAAD,KAAKF,CAAxB;;AAA0B,UAAGA,CAAC,GAAC,CAAC,CAAD,KAAKA,CAAL,IAAQ,CAAC,CAAD,KAAKA,CAAb,GAAe,EAAf,GAAkBY,CAAC,CAACZ,CAAD,CAArB,EAAyBF,CAAC,CAAC,CAAD,CAAD,YAAeX,CAA3C,EAA6C;AAAC,YAAIA,CAAC,GAAC,IAAN;AAAW,eAAOE,CAAC,CAAC0G,QAAF,IAAY1G,CAAC,CAAC0G,QAAF,CAAWC,MAAvB,KAAgC7G,CAAC,GAACE,CAAC,CAAC0G,QAAF,CAAWC,MAA7C,GAAqD7G,CAAC,GAACK,CAAC,CAACM,CAAC,CAAC,CAAD,CAAF,EAAMX,CAAN,CAAxD,EAAiEO,CAAC,CAACP,CAAD,EAAGa,CAAH,EAAKE,CAAL,CAAD,CAAS8D,IAAT,CAAe7E,CAAC,IAAE;AAAC,cAAGA,CAAH,EAAK;AAAC,kBAAME,CAAC,GAAC4G,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAehH,CAAf,CAAX,CAAR;;AAAsC,iBAAI,MAAMA,CAAV,IAAc,CAAC,WAAD,EAAa,SAAb,EAAuB,UAAvB,CAAd,EAAiD,KAAK,CAAL,KAASE,CAAC,CAACF,CAAD,CAAV,IAAe,SAAOE,CAAC,CAACF,CAAD,CAAvB,KAA6BE,CAAC,CAACF,CAAD,CAAD,GAAK,IAAIiH,IAAJ,CAAS/G,CAAC,CAACF,CAAD,CAAV,CAAlC;;AAAkD,mBAAOC,CAAC,CAACiH,+BAAF,CAAkChH,CAAlC,CAAP;AAA4C;;AAAA,iBAAO,IAAP;AAAY,SAA1N,CAAxE;AAAqS;;AAAA,UAAIe,CAAC,GAAC,IAAN;AAAW,UAAGU,CAAC,CAAChB,CAAC,CAAC,CAAD,CAAF,CAAD,KAAUM,CAAC,GAACN,CAAC,CAAC,CAAD,CAAb,GAAkBM,CAArB,EAAuB,OAAOF,CAAC,GAAC,CAAC,CAAH,EAAKF,CAAC,GAAC,IAAD,GAAMI,CAAC,CAACkG,IAAF,GAAStC,IAAT,CAAe,MAAI5D,CAAC,CAACmG,kBAAF,EAAnB,EAA4CvC,IAA5C,CAAkD1E,CAAC,IAAE;AAAC,YAAG,CAACA,CAAJ,EAAM,OAAOU,CAAC,GAAC,IAAD,GAAMI,CAAC,CAACoG,eAAF,GAAoBxC,IAApB,CAA0B7E,CAAC,IAAEA,CAAC,GAACC,CAAC,CAACiH,+BAAF,CAAkC;AAACI,UAAAA,QAAQ,EAACtH;AAAV,SAAlC,CAAD,GAAiD,IAA/E,CAAd;AAAoG,YAAIS,CAAC,GAAC,IAAN;AAAW,eAAOP,CAAC,CAAC0G,QAAF,IAAY1G,CAAC,CAAC0G,QAAF,CAAWC,MAAvB,KAAgCpG,CAAC,GAACP,CAAC,CAAC0G,QAAF,CAAWC,MAA7C,GAAqDpG,CAAC,GAACJ,CAAC,CAAC,IAAIL,CAAJ,CAAMG,CAAN,CAAD,EAAUM,CAAV,CAAxD,EAAqEF,CAAC,CAACE,CAAD,EAAGI,CAAH,EAAKE,CAAL,CAAD,CAAS8D,IAAT,CAAe7E,CAAC,IAAE;AAAC,cAAGA,CAAH,EAAK;AAAC,kBAAME,CAAC,GAAC4G,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAehH,CAAf,CAAX,CAAR;;AAAsC,iBAAI,MAAMA,CAAV,IAAc,CAAC,WAAD,EAAa,SAAb,EAAuB,UAAvB,CAAd,EAAiD,KAAK,CAAL,KAASE,CAAC,CAACF,CAAD,CAAV,IAAe,SAAOE,CAAC,CAACF,CAAD,CAAvB,KAA6BE,CAAC,CAACF,CAAD,CAAD,GAAK,IAAIiH,IAAJ,CAAS/G,CAAC,CAACF,CAAD,CAAV,CAAlC;;AAAkD,mBAAOC,CAAC,CAACiH,+BAAF,CAAkChH,CAAlC,CAAP;AAA4C;;AAAA,iBAAO,IAAP;AAAY,SAA1N,CAA5E;AAAyS,OAApd,CAAnB;AAA0e,YAAM,IAAIqH,KAAJ,CAAU,mBAAV,CAAN;AAAqC,KAAz9B,CAAP;AAAm+B,GAArgC,EAAsgC3D,CAAC,CAAC4D,UAAF,CAAa7C,IAAb,CAAkB;AAACD,IAAAA,IAAI,EAAC,SAAN;AAAgB+C,IAAAA,GAAG,EAAC,GAApB;AAAwBC,IAAAA,GAAG,EAAC;AAA5B,GAAlB,CAAtgC,EAA0jC9D,CAAC,CAAC6C,SAAF,CAAYkB,cAAZ,GAA2B,UAAS3H,CAAT,EAAWC,CAAX,EAAa;AAAC,WAAO2D,CAAC,CAAC+C,qBAAF,CAAwB3G,CAAxB,EAA0BC,CAA1B,EAA6B,CAACD,CAAD,EAAGC,CAAH,EAAKC,CAAL,KAAS;AAAC,UAAGoB,CAAC,CAACpB,CAAD,EAAG,CAAH,EAAK,CAAL,CAAD,EAASA,CAAC,CAAC,CAAD,CAAD,YAAeC,CAA3B,EAA6B;AAAC,cAAMH,CAAC,GAACyB,CAAC,CAACvB,CAAC,CAAC,CAAD,CAAF,CAAT;AAAgB,YAAID,CAAC,GAACuB,CAAC,CAACtB,CAAC,CAAC,CAAD,CAAF,EAAM,IAAN,CAAP;AAAmB,cAAMC,CAAC,GAAC0B,CAAC,CAACL,CAAC,CAACtB,CAAC,CAAC,CAAD,CAAF,EAAM,CAAC,CAAP,CAAF,CAAT;AAAsB,YAAG,SAAOD,CAAP,KAAWA,CAAC,GAAC,CAAC,GAAD,CAAb,GAAoB,CAAC,CAAD,KAAK6B,CAAC,CAAC7B,CAAD,CAA7B,EAAiC,MAAM,IAAIsH,KAAJ,CAAU,mBAAV,CAAN;AAAqC,eAAOrH,CAAC,CAAC,CAAD,CAAD,CAAK0H,cAAL,CAAoB5H,CAApB,EAAsBG,CAAtB,EAAwBF,CAAxB,CAAP;AAAkC;;AAAA,YAAM,IAAIsH,KAAJ,CAAU,mBAAV,CAAN;AAAqC,KAA3Q,CAAP;AAAqR,GAAx3C,EAAy3C3D,CAAC,CAAC4D,UAAF,CAAa7C,IAAb,CAAkB;AAACD,IAAAA,IAAI,EAAC,gBAAN;AAAuB+C,IAAAA,GAAG,EAAC,GAA3B;AAA+BC,IAAAA,GAAG,EAAC;AAAnC,GAAlB,CAAz3C,EAAo7C9D,CAAC,CAAC6C,SAAF,CAAYoB,aAAZ,GAA0B,UAAS7H,CAAT,EAAWC,CAAX,EAAa;AAAC,WAAO2D,CAAC,CAAC+C,qBAAF,CAAwB3G,CAAxB,EAA0BC,CAA1B,EAA6B,CAACA,CAAD,EAAGC,CAAH,EAAKC,CAAL,KAAS;AAAC,UAAGmB,CAAC,CAACnB,CAAD,EAAG,CAAH,EAAK,CAAL,CAAD,EAAS6B,CAAC,CAAC7B,CAAC,CAAC,CAAD,CAAF,CAAb,EAAoB;AAAC,YAAIF,CAAC,GAACuB,CAAC,CAACrB,CAAC,CAAC,CAAD,CAAF,EAAM,YAAN,CAAP;AAA2B,eAAO,SAAOF,CAAP,KAAWA,CAAC,GAAC,YAAb,GAA2BA,CAAC,GAACwB,CAAC,CAACxB,CAAD,CAAD,CAAK8E,WAAL,EAA7B,EAAgDtE,CAAC,CAACN,CAAC,CAAC,CAAD,CAAD,CAAK2H,UAAL,EAAD,EAAmB7H,CAAnB,EAAqBD,CAAC,CAAC+H,QAAvB,EAAgC/H,CAAC,CAACgI,WAAlC,EAA8ChI,CAAC,CAAC2F,gBAAhD,CAAxD;AAA0H;;AAAA,YAAM,IAAI4B,KAAJ,CAAU,mBAAV,CAAN;AAAqC,KAAtP,CAAP;AAAgQ,GAA5tD,EAA6tD3D,CAAC,CAAC4D,UAAF,CAAa7C,IAAb,CAAkB;AAACD,IAAAA,IAAI,EAAC,eAAN;AAAsB+C,IAAAA,GAAG,EAAC,GAA1B;AAA8BC,IAAAA,GAAG,EAAC;AAAlC,GAAlB,CAA7tD,EAAuxD9D,CAAC,CAAC6C,SAAF,CAAYwB,sBAAZ,GAAmC,UAAShI,CAAT,EAAWC,CAAX,EAAa;AAAC,WAAO0D,CAAC,CAAC+C,qBAAF,CAAwB1G,CAAxB,EAA0BC,CAA1B,EAA6B,CAACA,CAAD,EAAGC,CAAH,EAAKI,CAAL,KAAS;AAAC,UAAGe,CAAC,CAACf,CAAD,EAAG,CAAH,EAAK,CAAL,CAAD,EAAS,SAAOA,CAAC,CAAC,CAAD,CAApB,EAAwB,MAAM,IAAIgH,KAAJ,CAAU,oBAAV,CAAN;;AAAsC,UAAGhH,CAAC,CAAC,CAAD,CAAD,YAAeP,CAAlB,EAAoB;AAAC,cAAMA,CAAC,GAACyB,CAAC,CAAClB,CAAC,CAAC,CAAD,CAAF,CAAT;AAAA,cAAgBL,CAAC,GAACuB,CAAC,CAAClB,CAAC,CAAC,CAAD,CAAF,CAAnB;AAA0B,YAAIJ,CAAC,GAACqB,CAAC,CAACjB,CAAC,CAAC,CAAD,CAAF,EAAM,IAAN,CAAP;AAAmB,cAAME,CAAC,GAACoB,CAAC,CAACL,CAAC,CAACjB,CAAC,CAAC,CAAD,CAAF,EAAM,CAAC,CAAP,CAAF,CAAT;AAAsB,YAAG,SAAOJ,CAAP,KAAWA,CAAC,GAAC,CAAC,GAAD,CAAb,GAAoB,CAAC,CAAD,KAAK2B,CAAC,CAAC3B,CAAD,CAA7B,EAAiC,MAAM,IAAIoH,KAAJ,CAAU,mBAAV,CAAN;AAAqC,YAAI1G,CAAC,GAAC,IAAN;AAAW,eAAOZ,CAAC,CAAC2G,QAAF,IAAY3G,CAAC,CAAC2G,QAAF,CAAWC,MAAvB,KAAgChG,CAAC,GAACZ,CAAC,CAAC2G,QAAF,CAAWC,MAA7C,GAAqDhG,CAAC,GAACR,CAAC,CAACE,CAAC,CAAC,CAAD,CAAF,EAAMM,CAAN,CAAxD,EAAiEF,CAAC,CAACX,CAAD,EAAGE,CAAH,EAAKD,CAAC,CAAC0F,gBAAP,EAAwBxF,CAAxB,EAA0BM,CAA1B,EAA4BI,CAA5B,EAA8BZ,CAAC,CAAC8H,QAAhC,EAAyC9H,CAAC,CAAC+H,WAA3C,CAAzE;AAAiI;;AAAA,UAAG,CAAC,CAAD,KAAK/F,CAAC,CAAC1B,CAAC,CAAC,CAAD,CAAF,CAAT,EAAgB,MAAM,IAAIgH,KAAJ,CAAU,oBAAV,CAAN;AAAsC,YAAM9G,CAAC,GAACgB,CAAC,CAAClB,CAAC,CAAC,CAAD,CAAF,CAAT;AAAA,YAAgBM,CAAC,GAACY,CAAC,CAAClB,CAAC,CAAC,CAAD,CAAF,CAAnB;AAA0B,UAAIQ,CAAC,GAACS,CAAC,CAACjB,CAAC,CAAC,CAAD,CAAF,EAAM,IAAN,CAAP;AAAmB,YAAMU,CAAC,GAACY,CAAC,CAACL,CAAC,CAACjB,CAAC,CAAC,CAAD,CAAF,EAAM,CAAC,CAAP,CAAF,CAAT;AAAsB,UAAG,SAAOQ,CAAP,KAAWA,CAAC,GAAC,CAAC,GAAD,CAAb,GAAoB,CAAC,CAAD,KAAKe,CAAC,CAACf,CAAD,CAA7B,EAAiC,MAAM,IAAIwG,KAAJ,CAAU,mBAAV,CAAN;AAAqC,UAAGtH,CAAC,CAAC2G,QAAF,IAAY3G,CAAC,CAAC2G,QAAF,CAAWC,MAA1B,EAAiC,OAAOlG,CAAC,CAACF,CAAD,EAAGI,CAAH,EAAKZ,CAAC,CAAC0F,gBAAP,EAAwB5E,CAAxB,EAA0BE,CAA1B,EAA4BhB,CAAC,CAAC2G,QAAF,CAAWC,MAAvC,EAA8C5G,CAAC,CAAC8H,QAAhD,EAAyD9H,CAAC,CAAC+H,WAA3D,CAAR;AAAgF,YAAM,IAAIT,KAAJ,CAAU,oBAAV,CAAN;AAAsC,KAAruB,CAAP;AAA+uB,GAAvjF,EAAwjF3D,CAAC,CAAC4D,UAAF,CAAa7C,IAAb,CAAkB;AAACD,IAAAA,IAAI,EAAC,wBAAN;AAA+B+C,IAAAA,GAAG,EAAC,GAAnC;AAAuCC,IAAAA,GAAG,EAAC;AAA3C,GAAlB,CAAxjF,EAA2nF9D,CAAC,CAAC6C,SAAF,CAAYyB,gBAAZ,GAA6B,UAASlI,CAAT,EAAWC,CAAX,EAAa;AAAC,WAAO2D,CAAC,CAAC+C,qBAAF,CAAwB3G,CAAxB,EAA0BC,CAA1B,EAA6B,CAACD,CAAD,EAAGC,CAAH,EAAKC,CAAL,KAAS;AAAC,UAAGoB,CAAC,CAACpB,CAAD,EAAG,CAAH,EAAK,CAAL,CAAD,EAASA,CAAC,CAAC,CAAD,CAAD,YAAeC,CAA3B,EAA6B;AAAC,cAAMH,CAAC,GAACyB,CAAC,CAACvB,CAAC,CAAC,CAAD,CAAF,CAAT;AAAgB,YAAID,CAAC,GAACuB,CAAC,CAACtB,CAAC,CAAC,CAAD,CAAF,EAAM,IAAN,CAAP;AAAmB,cAAMC,CAAC,GAAC0B,CAAC,CAACL,CAAC,CAACtB,CAAC,CAAC,CAAD,CAAF,EAAM,CAAC,CAAP,CAAF,CAAT;AAAsB,YAAG,SAAOD,CAAP,KAAWA,CAAC,GAAC,CAAC,GAAD,CAAb,GAAoB,CAAC,CAAD,KAAK6B,CAAC,CAAC7B,CAAD,CAA7B,EAAiC,MAAM,IAAIsH,KAAJ,CAAU,mBAAV,CAAN;AAAqC,eAAOrH,CAAC,CAAC,CAAD,CAAD,CAAKiI,gBAAL,CAAsBnI,CAAtB,EAAwBG,CAAxB,EAA0BF,CAA1B,CAAP;AAAoC;;AAAA,YAAM,IAAIsH,KAAJ,CAAU,mBAAV,CAAN;AAAqC,KAA7Q,CAAP;AAAuR,GAA77F,EAA87F3D,CAAC,CAAC4D,UAAF,CAAa7C,IAAb,CAAkB;AAACD,IAAAA,IAAI,EAAC,kBAAN;AAAyB+C,IAAAA,GAAG,EAAC,GAA7B;AAAiCC,IAAAA,GAAG,EAAC;AAArC,GAAlB,CAA97F,EAA2/F9D,CAAC,CAAC6C,SAAF,CAAY2B,UAAZ,GAAuB,UAASpI,CAAT,EAAWE,CAAX,EAAa;AAAC,WAAO0D,CAAC,CAACyE,gBAAF,CAAmBrI,CAAnB,EAAqBE,CAArB,EAAwB,CAACA,CAAD,EAAGC,CAAH,EAAKE,CAAL,KAAS;AAACiB,MAAAA,CAAC,CAACjB,CAAD,EAAG,CAAH,EAAK,CAAL,CAAD;AAAS,UAAIE,CAAC,GAACF,CAAC,CAAC,CAAD,CAAP;AAAW,YAAMI,CAAC,GAAC;AAACwF,QAAAA,eAAe,EAAC;AAACE,UAAAA,YAAY,EAAC,EAAd;AAAiBC,UAAAA,aAAa,EAAC,EAA/B;AAAkCkC,UAAAA,aAAa,EAAC,EAAhD;AAAmDC,UAAAA,WAAW,EAAC,EAA/D;AAAkElC,UAAAA,MAAM,EAAC;AAAzE,SAAjB;AAA8FH,QAAAA,UAAU,EAAC;AAACC,UAAAA,YAAY,EAAC,EAAd;AAAiBG,UAAAA,QAAQ,EAAC;AAA1B;AAAzG,OAAR;AAAgJ,UAAGrE,CAAC,CAAC1B,CAAD,CAAJ,EAAQA,CAAC,GAACuG,IAAI,CAACC,KAAL,CAAWxG,CAAX,CAAF,EAAgB,KAAK,CAAL,KAASA,CAAC,CAAC0F,eAAX,IAA4BxF,CAAC,CAACwF,eAAF,GAAkB1F,CAAC,CAAC0F,eAApB,EAAoCxF,CAAC,CAACyF,UAAF,GAAa3F,CAAC,CAAC2F,UAAnD,EAA8D3F,CAAC,CAAC0F,eAAF,CAAkBN,gBAAlB,KAAqClF,CAAC,CAACwF,eAAF,CAAkBN,gBAAlB,GAAmCpF,CAAC,CAAC0F,eAAF,CAAkBN,gBAA1F,CAA1F,KAAwMlF,CAAC,CAACyF,UAAF,CAAaI,QAAb,GAAsB/F,CAAC,CAAC+F,QAAxB,EAAiC7F,CAAC,CAACyF,UAAF,CAAaC,YAAb,GAA0B5F,CAAC,CAAC4F,YAA7D,EAA0E1F,CAAC,CAACwF,eAAF,CAAkBE,YAAlB,GAA+B1F,CAAC,CAACyF,UAAF,CAAaC,YAAtH,EAAmI1F,CAAC,CAACwF,eAAF,CAAkBG,aAAlB,GAAgC7F,CAAC,CAACiI,iBAArK,EAAuL/H,CAAC,CAACwF,eAAF,CAAkBsC,WAAlB,GAA8BhI,CAAC,CAACkI,eAAvN,EAAuOhI,CAAC,CAACwF,eAAF,CAAkBqC,aAAlB,GAAgC/H,CAAC,CAACmI,iBAAzQ,EAA2RjI,CAAC,CAACwF,eAAF,CAAkBI,MAAlB,GAAyB9F,CAAC,CAAC8F,MAAtT,EAA6T9F,CAAC,CAACoF,gBAAF,KAAqBlF,CAAC,CAACwF,eAAF,CAAkBN,gBAAlB,GAAmCpF,CAAC,CAACoF,gBAA1D,CAArgB,CAAhB,CAAR,KAA8mB;AAAC,YAAG,EAAEtF,CAAC,CAAC,CAAD,CAAD,YAAeJ,CAAjB,CAAH,EAAuB,MAAM,IAAIsH,KAAJ,CAAU,mBAAV,CAAN;AAAqC;AAAChH,UAAAA,CAAC,GAACuG,IAAI,CAACC,KAAL,CAAW1G,CAAC,CAAC,CAAD,CAAD,CAAKsI,UAAL,EAAX,CAAF;AAAgC,gBAAM3I,CAAC,GAACuC,CAAC,CAAChC,CAAD,EAAG,iBAAH,CAAT;;AAA+B,cAAG,SAAOP,CAAV,EAAY;AAACS,YAAAA,CAAC,CAACwF,eAAF,CAAkBE,YAAlB,GAA+B5D,CAAC,CAACvC,CAAD,EAAG,cAAH,EAAkB,EAAlB,CAAhC,EAAsDS,CAAC,CAACyF,UAAF,CAAaC,YAAb,GAA0B1F,CAAC,CAACwF,eAAF,CAAkBE,YAAlG,EAA+G1F,CAAC,CAACwF,eAAF,CAAkBqC,aAAlB,GAAgC/F,CAAC,CAACvC,CAAD,EAAG,eAAH,EAAmB,EAAnB,CAAhJ,EAAuKS,CAAC,CAACwF,eAAF,CAAkBG,aAAlB,GAAgC7D,CAAC,CAACvC,CAAD,EAAG,eAAH,EAAmB,EAAnB,CAAxM,EAA+NS,CAAC,CAACwF,eAAF,CAAkBsC,WAAlB,GAA8BhG,CAAC,CAACvC,CAAD,EAAG,aAAH,EAAiB,EAAjB,CAA9P;AAAmR,kBAAMC,CAAC,GAACsC,CAAC,CAACvC,CAAD,EAAG,kBAAH,EAAsB,IAAtB,CAAT;AAAqCC,YAAAA,CAAC,KAAGQ,CAAC,CAACwF,eAAF,CAAkBN,gBAAlB,GAAmCN,CAAC,CAACpF,CAAD,CAAvC,CAAD;;AAA6C,iBAAI,MAAME,CAAV,IAAeoC,CAAC,CAACvC,CAAD,EAAG,QAAH,EAAY,EAAZ,CAAhB,EAAgC;AAAC,oBAAMA,CAAC,GAAC;AAAC0E,gBAAAA,IAAI,EAACnC,CAAC,CAACpC,CAAD,EAAG,MAAH,EAAU,EAAV,CAAP;AAAqByI,gBAAAA,KAAK,EAACrG,CAAC,CAACpC,CAAD,EAAG,OAAH,EAAW,EAAX,CAA5B;AAA2C8E,gBAAAA,IAAI,EAAC1C,CAAC,CAACpC,CAAD,EAAG,MAAH,EAAU,EAAV,CAAjD;AAA+D0I,gBAAAA,QAAQ,EAACtG,CAAC,CAACpC,CAAD,EAAG,UAAH,EAAc,CAAC,CAAf,CAAzE;AAA2F2I,gBAAAA,QAAQ,EAACvG,CAAC,CAACpC,CAAD,EAAG,UAAH,EAAc,CAAC,CAAf,CAArG;AAAuHmE,gBAAAA,MAAM,EAAC/B,CAAC,CAACpC,CAAD,EAAG,QAAH,EAAY,IAAZ,CAA/H;AAAiJ4I,gBAAAA,MAAM,EAAC/D,CAAC,CAACzC,CAAC,CAACpC,CAAD,EAAG,QAAH,CAAF;AAAzJ,eAAR;AAAkLM,cAAAA,CAAC,CAACwF,eAAF,CAAkBI,MAAlB,CAAyB1B,IAAzB,CAA8B3E,CAA9B;AAAiC;;AAAA,kBAAME,CAAC,GAACqC,CAAC,CAAChC,CAAD,EAAG,YAAH,EAAgB,IAAhB,CAAT;;AAA+B,gBAAGL,CAAH,EAAK;AAAC,oBAAMF,CAAC,GAAC,EAAR;;AAAW,mBAAI,MAAMC,CAAV,IAAeQ,CAAC,CAACwF,eAAF,CAAkBI,MAAjC,EAAwCrG,CAAC,CAACC,CAAC,CAACyE,IAAF,CAAOK,WAAP,EAAD,CAAD,GAAwB9E,CAAC,CAACyE,IAA1B;;AAA+B,mBAAI,MAAMzE,CAAV,IAAesC,CAAC,CAACrC,CAAD,EAAG,UAAH,EAAc,EAAd,CAAhB,EAAkC;AAAC,sBAAMA,CAAC,GAAC,EAAR;AAAA,sBAAWC,CAAC,GAACoC,CAAC,CAACtC,CAAD,EAAG,YAAH,EAAgB,EAAhB,CAAd;;AAAkC,qBAAI,MAAMA,CAAV,IAAeE,CAAf,EAAiBD,CAAC,CAACF,CAAC,CAACC,CAAC,CAAC8E,WAAF,EAAD,CAAF,CAAD,GAAsB5E,CAAC,CAACF,CAAD,CAAvB;;AAA2BQ,gBAAAA,CAAC,CAACyF,UAAF,CAAaI,QAAb,CAAsB3B,IAAtB,CAA2B;AAACqE,kBAAAA,UAAU,EAAC9I,CAAZ;AAAc+I,kBAAAA,QAAQ,EAACzD,CAAC,CAACjD,CAAC,CAACtC,CAAD,EAAG,UAAH,EAAc,IAAd,CAAF;AAAxB,iBAA3B;AAA4E;AAAC;AAAC,WAA55B,MAAg6B;AAACQ,YAAAA,CAAC,CAACwF,eAAF,CAAkBE,YAAlB,GAA+B5D,CAAC,CAAChC,CAAD,EAAG,cAAH,EAAkB,EAAlB,CAAhC,EAAsDE,CAAC,CAACyF,UAAF,CAAaC,YAAb,GAA0B1F,CAAC,CAACwF,eAAF,CAAkBE,YAAlG,EAA+G1F,CAAC,CAACwF,eAAF,CAAkBG,aAAlB,GAAgC7D,CAAC,CAAChC,CAAD,EAAG,mBAAH,EAAuB,EAAvB,CAAhJ,EAA2KE,CAAC,CAACwF,eAAF,CAAkBsC,WAAlB,GAA8BhG,CAAC,CAAChC,CAAD,EAAG,iBAAH,EAAqB,EAArB,CAA1M;AAAmO,kBAAMP,CAAC,GAACuC,CAAC,CAAChC,CAAD,EAAG,kBAAH,EAAsB,IAAtB,CAAT;AAAqCP,YAAAA,CAAC,KAAGS,CAAC,CAACwF,eAAF,CAAkBN,gBAAlB,GAAmCN,CAAC,CAACrF,CAAD,CAAvC,CAAD;;AAA6C,iBAAI,MAAME,CAAV,IAAeqC,CAAC,CAAChC,CAAD,EAAG,QAAH,EAAY,EAAZ,CAAhB,EAAgC;AAAC,oBAAMP,CAAC,GAAC;AAAC0E,gBAAAA,IAAI,EAACnC,CAAC,CAACrC,CAAD,EAAG,MAAH,EAAU,EAAV,CAAP;AAAqB0I,gBAAAA,KAAK,EAACrG,CAAC,CAACrC,CAAD,EAAG,OAAH,EAAW,EAAX,CAA5B;AAA2C+E,gBAAAA,IAAI,EAAC1C,CAAC,CAACrC,CAAD,EAAG,MAAH,EAAU,EAAV,CAAjD;AAA+D2I,gBAAAA,QAAQ,EAACtG,CAAC,CAACrC,CAAD,EAAG,UAAH,EAAc,CAAC,CAAf,CAAzE;AAA2F4I,gBAAAA,QAAQ,EAACvG,CAAC,CAACrC,CAAD,EAAG,UAAH,EAAc,CAAC,CAAf,CAArG;AAAuHoE,gBAAAA,MAAM,EAAC/B,CAAC,CAACrC,CAAD,EAAG,QAAH,EAAY,IAAZ,CAA/H;AAAiJ6I,gBAAAA,MAAM,EAAC/D,CAAC,CAACzC,CAAC,CAACrC,CAAD,EAAG,QAAH,CAAF;AAAzJ,eAAR;AAAkLO,cAAAA,CAAC,CAACwF,eAAF,CAAkBI,MAAlB,CAAyB1B,IAAzB,CAA8B3E,CAA9B;AAAiC;;AAAA,kBAAMC,CAAC,GAAC,EAAR;;AAAW,iBAAI,MAAMC,CAAV,IAAeO,CAAC,CAACwF,eAAF,CAAkBI,MAAjC,EAAwCpG,CAAC,CAACC,CAAC,CAACwE,IAAF,CAAOK,WAAP,EAAD,CAAD,GAAwB7E,CAAC,CAACwE,IAA1B;;AAA+B,iBAAI,MAAMxE,CAAV,IAAeqC,CAAC,CAAChC,CAAD,EAAG,UAAH,EAAc,EAAd,CAAhB,EAAkC;AAAC,oBAAMP,CAAC,GAAC,EAAR;AAAA,oBAAWG,CAAC,GAACoC,CAAC,CAACrC,CAAD,EAAG,YAAH,EAAgB,EAAhB,CAAd;;AAAkC,mBAAI,MAAMA,CAAV,IAAeC,CAAf,EAAiBH,CAAC,CAACC,CAAC,CAACC,CAAC,CAAC6E,WAAF,EAAD,CAAF,CAAD,GAAsB5E,CAAC,CAACD,CAAD,CAAvB;;AAA2BO,cAAAA,CAAC,CAACyF,UAAF,CAAaI,QAAb,CAAsB3B,IAAtB,CAA2B;AAACqE,gBAAAA,UAAU,EAAChJ,CAAZ;AAAciJ,gBAAAA,QAAQ,EAACzD,CAAC,CAACjD,CAAC,CAACrC,CAAD,EAAG,UAAH,EAAc,IAAd,CAAF;AAAxB,eAA3B;AAA4E;AAAC;AAAC;AAAC;AAAA,UAAG,CAAC,CAAD,KAAK8F,EAAE,CAACvF,CAAD,CAAV,EAAc,MAAM,IAAI8G,KAAJ,CAAU,mBAAV,CAAN;AAAqC,aAAOjE,CAAC,CAAC4F,MAAF,CAASzI,CAAT,EAAWT,CAAC,CAAC2F,gBAAb,CAAP;AAAsC,KAAtuF,CAAP;AAAgvF,GAAhxL,EAAixL/B,CAAC,CAAC4D,UAAF,CAAa7C,IAAb,CAAkB;AAACD,IAAAA,IAAI,EAAC,YAAN;AAAmB+C,IAAAA,GAAG,EAAC,GAAvB;AAA2BC,IAAAA,GAAG,EAAC;AAA/B,GAAlB,CAAjxL,EAAw0L9D,CAAC,CAAC6C,SAAF,CAAY0C,MAAZ,GAAmB,UAASnJ,CAAT,EAAWC,CAAX,EAAa;AAAC,WAAO2D,CAAC,CAAC+C,qBAAF,CAAwB3G,CAAxB,EAA0BC,CAA1B,EAA6B,CAACA,CAAD,EAAGC,CAAH,EAAKC,CAAL,KAAS;AAAC,UAAGmB,CAAC,CAACnB,CAAD,EAAG,CAAH,EAAK,CAAL,CAAD,EAAS2B,CAAC,CAAC3B,CAAC,CAAC,CAAD,CAAF,CAAD,IAASgC,CAAC,CAAChC,CAAC,CAAC,CAAD,CAAF,CAAtB,EAA6B;AAAC,cAAMF,CAAC,GAAC,EAAR;AAAW,YAAIC,CAAC,GAACC,CAAC,CAAC,CAAD,CAAP;AAAWD,QAAAA,CAAC,YAAYmB,CAAb,KAAiBnB,CAAC,GAACA,CAAC,CAACqE,OAAF,EAAnB;AAAgC,YAAIlE,CAAC,GAAC,IAAN;AAAW,YAAGF,CAAC,CAAC,CAAD,CAAD,YAAeiB,CAAlB,EAAoBf,CAAC,GAACuD,CAAC,CAACwF,2BAAF,CAA8BjJ,CAAC,CAAC,CAAD,CAA/B,CAAF,CAApB,KAA+D,IAAGA,CAAC,CAAC,CAAD,CAAD,YAAe+B,CAAlB,EAAoB7B,CAAC,GAAC;AAAA,4CAAIJ,CAAJ;AAAIA,YAAAA,CAAJ;AAAA;;AAAA,iBAAQE,CAAC,CAAC,CAAD,CAAD,CAAKkJ,EAAL,CAAQrJ,CAAR,EAAU;AAACsJ,YAAAA,SAAS,EAAC,CAAC,CAAZ;AAAcC,YAAAA,SAAS,EAACtJ;AAAxB,WAAV,CAAR;AAAA,SAAF,CAApB,KAAwE;AAAC,cAAG,EAAEE,CAAC,CAAC,CAAD,CAAD,YAAemC,CAAjB,CAAH,EAAuB,MAAM,IAAIiF,KAAJ,CAAU,mBAAV,CAAN;;AAAqClH,UAAAA,CAAC,GAAC,YAAQ;AAAC,gBAAG,UAAEiE,MAAF,KAAWnE,CAAC,CAAC,CAAD,CAAD,CAAKqJ,UAAnB,EAA8B,MAAM,IAAIjC,KAAJ,CAAU,oBAAV,CAAN;AAAsC,mBAAOpH,CAAC,CAAC,CAAD,CAAD,CAAKkJ,EAAL,CAAQ,YAAR,CAAP;AAAqB,WAApG;AAAqG;AAAA,eAAOnJ,CAAC,CAACuJ,MAAF,CAAU,CAACzJ,CAAD,EAAGG,CAAH,EAAKI,CAAL,KAASP,CAAC,CAAC6E,IAAF,CAAQ7E,CAAC,IAAE;AAACO,UAAAA,CAAC,GAAC,CAAF,IAAK,CAAC,CAAD,KAAKP,CAAV,IAAaC,CAAC,CAAC0E,IAAF,CAAOzE,CAAC,CAACK,CAAC,GAAC,CAAH,CAAR,CAAb;AAA4B,gBAAME,CAAC,GAACJ,CAAC,CAACF,CAAD,CAAT;AAAa,iBAAO2D,CAAC,CAACrD,CAAD,CAAD,GAAKA,CAAL,GAAOmB,CAAC,CAACnB,CAAD,CAAf;AAAmB,SAAxE,CAAnB,EAA+FiJ,OAAO,CAAC3F,OAAR,CAAgB,CAAC,CAAjB,CAA/F,EAAoHc,IAApH,CAA0H7E,CAAC,KAAG,CAAC,CAAD,KAAKA,CAAL,IAAQE,CAAC,CAACoE,MAAF,GAAS,CAAjB,IAAoBrE,CAAC,CAAC0E,IAAF,CAAOzE,CAAC,CAACA,CAAC,CAACoE,MAAF,GAAS,CAAV,CAAR,CAApB,EAA0CrE,CAA7C,CAA3H,CAAP;AAAoL;;AAAA,aAAO0B,CAAC,CAACxB,CAAC,CAAC,CAAD,CAAF,CAAD,GAAQA,CAAC,CAAC,CAAD,CAAD,CAAKgH,IAAL,GAAYtC,IAAZ,CAAkB5E,CAAC,IAAE;AAAC,cAAMC,CAAC,GAACiE,CAAC,CAAC+E,MAAF,CAAS/I,CAAC,CAAC,CAAD,CAAV,EAAcF,CAAC,CAAC0J,cAAF,EAAd,CAAR;AAAA,cAA0CtJ,CAAC,GAACH,CAAC,CAACuE,YAAF,EAA5C;;AAA6D,YAAGpE,CAAC,CAACiE,MAAF,GAAS,CAAZ,EAAc;AAAC,gBAAMrE,CAAC,GAAC,EAAR;;AAAW,eAAI,IAAIC,CAAC,GAAC,CAAV,EAAYA,CAAC,GAACG,CAAC,CAACiE,MAAhB,EAAuBpE,CAAC,EAAxB,EAA2B;AAAC,kBAAMC,CAAC,GAAC;AAACuE,cAAAA,IAAI,EAACrE,CAAC,CAACH,CAAD;AAAP,aAAR;AAAoBD,YAAAA,CAAC,CAAC0E,IAAF,CAAOf,CAAC,CAACgB,kBAAF,CAAqB5E,CAArB,EAAuBG,CAAvB,CAAP;AAAkC;;AAAA,iBAAO8D,CAAC,CAAChE,CAAD,CAAD,CAAK4E,IAAL,CAAW7E,CAAC,IAAE;AAAC,kBAAMC,CAAC,GAAC,EAAR;;AAAW,iBAAI,IAAIC,CAAC,GAAC,CAAV,EAAYA,CAAC,GAACG,CAAC,CAACiE,MAAhB,EAAuBpE,CAAC,EAAxB,EAA2BD,CAAC,CAACI,CAAC,CAACH,CAAD,CAAF,CAAD,GAAQF,CAAC,CAACE,CAAD,CAAT;;AAAa,mBAAOA,CAAC,CAAC4E,UAAF,GAAa7E,CAAb,EAAe,IAAImD,CAAJ,CAAM;AAACwG,cAAAA,gBAAgB,EAACzJ,CAAC,CAAC,CAAD,CAAnB;AAAuB0J,cAAAA,WAAW,EAAC3J;AAAnC,aAAN,CAAtB;AAAmE,WAArI,CAAP;AAA+I;;AAAA,eAAO0B,CAAC,CAAC,IAAIwB,CAAJ,CAAM;AAACwG,UAAAA,gBAAgB,EAACzJ,CAAC,CAAC,CAAD,CAAnB;AAAuB0J,UAAAA,WAAW,EAAC3J;AAAnC,SAAN,CAAD,CAAR;AAAuD,OAArY,CAAR,GAAgZ0D,CAAC,CAACkG,aAAF,CAAgB,0CAAhB,CAAvZ;AAAmd,KAAtjC,CAAP;AAAgkC,GAAz6N,EAA06NlG,CAAC,CAAC4D,UAAF,CAAa7C,IAAb,CAAkB;AAACD,IAAAA,IAAI,EAAC,QAAN;AAAe+C,IAAAA,GAAG,EAAC,GAAnB;AAAuBC,IAAAA,GAAG,EAAC;AAA3B,GAAlB,CAA16N,EAA69N9D,CAAC,CAAC6C,SAAF,CAAYsD,OAAZ,GAAoB,UAAS/J,CAAT,EAAWC,CAAX,EAAa;AAAC,WAAO2D,CAAC,CAAC+C,qBAAF,CAAwB3G,CAAxB,EAA0BC,CAA1B,EAA6B,CAACD,CAAD,EAAGC,CAAH,EAAKC,CAAL,KAAS;AAAC,UAAGoB,CAAC,CAACpB,CAAD,EAAG,CAAH,EAAK,CAAL,CAAD,EAASyB,CAAC,CAACzB,CAAC,CAAC,CAAD,CAAF,CAAb,EAAoB;AAAC,cAAMF,CAAC,GAAC,IAAI+B,CAAJ,CAAM7B,CAAC,CAAC,CAAD,CAAP,CAAR;AAAoB,eAAO0B,CAAC,CAAC,IAAIL,CAAJ,CAAM;AAACqI,UAAAA,gBAAgB,EAAC1J,CAAC,CAAC,CAAD,CAAnB;AAAuB8J,UAAAA,aAAa,EAAChK;AAArC,SAAN,CAAD,CAAR;AAAyD;;AAAA,aAAO4D,CAAC,CAACkG,aAAF,CAAgB,yCAAhB,CAAP;AAAkE,KAA3M,CAAP;AAAqN,GAAptO,EAAqtOlG,CAAC,CAAC4D,UAAF,CAAa7C,IAAb,CAAkB;AAACD,IAAAA,IAAI,EAAC,SAAN;AAAgB+C,IAAAA,GAAG,EAAC,GAApB;AAAwBC,IAAAA,GAAG,EAAC;AAA5B,GAAlB,CAArtO,EAAywO9D,CAAC,CAAC6C,SAAF,CAAYwD,GAAZ,GAAgB,UAASjK,CAAT,EAAWC,CAAX,EAAa;AAAC,WAAO2D,CAAC,CAAC+C,qBAAF,CAAwB3G,CAAxB,EAA0BC,CAA1B,EAA6B,CAACD,CAAD,EAAGC,CAAH,EAAKC,CAAL,MAAUoB,CAAC,CAACpB,CAAD,EAAG,CAAH,EAAK,CAAL,CAAD,EAASyB,CAAC,CAACzB,CAAC,CAAC,CAAD,CAAF,CAAD,GAAQ0B,CAAC,CAAC,IAAIyB,CAAJ,CAAM;AAACuG,MAAAA,gBAAgB,EAAC1J,CAAC,CAAC,CAAD,CAAnB;AAAuBgK,MAAAA,MAAM,EAAChK,CAAC,CAAC,CAAD;AAA/B,KAAN,CAAD,CAAT,GAAsD4B,CAAC,CAAC5B,CAAC,CAAC,CAAD,CAAF,CAAD,GAAQkC,CAAC,CAAClC,CAAC,CAAC,CAAD,CAAF,CAAD,IAASA,CAAC,CAAC,CAAD,CAAD,CAAKoE,MAAd,GAAqBpE,CAAC,CAAC,CAAD,CAAD,CAAKiK,KAAL,CAAW,CAAX,CAArB,GAAmCjK,CAAC,CAAC,CAAD,CAAD,CAAKiK,KAAL,CAAW,CAAX,EAAa/H,CAAC,CAAClC,CAAC,CAAC,CAAD,CAAF,CAAd,CAA3C,GAAiEiC,CAAC,CAACjC,CAAC,CAAC,CAAD,CAAF,CAAD,GAAQkC,CAAC,CAAClC,CAAC,CAAC,CAAD,CAAF,CAAD,IAASA,CAAC,CAAC,CAAD,CAAD,CAAKoE,MAAL,EAAT,GAAuBpE,CAAC,CAAC,CAAD,CAAD,CAAKiK,KAAL,CAAW,CAAX,CAAvB,GAAqCjK,CAAC,CAAC,CAAD,CAAD,CAAKiK,KAAL,CAAW,CAAX,EAAa/H,CAAC,CAAClC,CAAC,CAAC,CAAD,CAAF,CAAd,CAA7C,GAAmE0D,CAAC,CAACkG,aAAF,CAAgB,uCAAhB,CAA7M,CAA7B,CAAP;AAA6S,GAAplP,EAAqlPlG,CAAC,CAAC4D,UAAF,CAAa7C,IAAb,CAAkB;AAACD,IAAAA,IAAI,EAAC,KAAN;AAAY+C,IAAAA,GAAG,EAAC,GAAhB;AAAoBC,IAAAA,GAAG,EAAC;AAAxB,GAAlB,CAArlP,EAAqoP9D,CAAC,CAAC6C,SAAF,CAAY2D,KAAZ,GAAkB,UAASpK,CAAT,EAAWC,CAAX,EAAa;AAAC,WAAO2D,CAAC,CAAC+C,qBAAF,CAAwB3G,CAAxB,EAA0BC,CAA1B,EAA6B,CAACD,CAAD,EAAGC,CAAH,EAAKE,CAAL,MAAUmB,CAAC,CAACnB,CAAD,EAAG,CAAH,EAAK,CAAL,CAAD,EAASwB,CAAC,CAACxB,CAAC,CAAC,CAAD,CAAF,CAAD,GAAQA,CAAC,CAAC,CAAD,CAAD,CAAKiK,KAAL,CAAWpK,CAAC,CAACqK,WAAb,EAA0BxF,IAA1B,CAAgC7E,CAAC,IAAE;AAAC,UAAG,SAAOA,CAAV,EAAY;AAAC,cAAMC,CAAC,GAACC,CAAC,CAACoK,2BAAF,CAA8BtK,CAAC,CAACiJ,QAAhC,EAAyCjJ,CAAC,CAACgJ,UAA3C,EAAsD7I,CAAC,CAAC,CAAD,CAAvD,CAAR;AAAoEF,QAAAA,CAAC,CAACsK,kBAAF,GAAqBvK,CAArB,EAAuBA,CAAC,GAACC,CAAzB;AAA2B;;AAAA,aAAOD,CAAP;AAAS,KAAzJ,CAAR,GAAoK8B,CAAC,CAAC3B,CAAC,CAAC,CAAD,CAAF,CAAD,GAAQ,MAAIA,CAAC,CAAC,CAAD,CAAD,CAAKmE,MAAT,GAAgB1C,CAAC,CAAC,IAAD,CAAjB,GAAwBA,CAAC,CAACzB,CAAC,CAAC,CAAD,CAAD,CAAK,CAAL,CAAD,CAAjC,GAA2CgC,CAAC,CAAChC,CAAC,CAAC,CAAD,CAAF,CAAD,GAAQ,MAAIA,CAAC,CAAC,CAAD,CAAD,CAAKmE,MAAL,EAAJ,GAAkB1C,CAAC,CAAC,IAAD,CAAnB,GAA0BA,CAAC,CAACzB,CAAC,CAAC,CAAD,CAAD,CAAKqK,GAAL,CAAS,CAAT,CAAD,CAAnC,GAAiD,IAAnR,CAA7B,CAAP;AAA+T,GAAp+P,EAAq+P5G,CAAC,CAAC4D,UAAF,CAAa7C,IAAb,CAAkB;AAACD,IAAAA,IAAI,EAAC,OAAN;AAAc+C,IAAAA,GAAG,EAAC,GAAlB;AAAsBC,IAAAA,GAAG,EAAC;AAA1B,GAAlB,CAAr+P,EAAuhQ9D,CAAC,CAAC6C,SAAF,CAAYgE,WAAZ,GAAwB,UAASzK,CAAT,EAAWE,CAAX,EAAa;AAAC,WAAO0D,CAAC,CAAC+C,qBAAF,CAAwB3G,CAAxB,EAA0BE,CAA1B,EAA6B,CAACA,CAAD,EAAGC,CAAH,EAAKE,CAAL,KAAS;AAACiB,MAAAA,CAAC,CAACjB,CAAD,EAAG,CAAH,EAAK,CAAL,CAAD;AAAS,YAAME,CAAC,GAAC;AAACmK,QAAAA,OAAO,EAAC,CAAC,CAAV;AAAYC,QAAAA,OAAO,EAAC,CAAC,CAArB;AAAuBC,QAAAA,KAAK,EAAC,IAA7B;AAAkCC,QAAAA,cAAc,EAAC,CAAC;AAAlD,OAAR;AAA6D,UAAGxK,CAAC,CAACiE,MAAF,GAAS,CAAZ,EAAc,IAAGjE,CAAC,CAAC,CAAD,CAAD,YAAeJ,CAAlB,EAAoB;AAAC,YAAGI,CAAC,CAAC,CAAD,CAAD,CAAKyK,QAAL,CAAc,SAAd,MAA2BvK,CAAC,CAACmK,OAAF,GAAUtI,CAAC,CAAC/B,CAAC,CAAC,CAAD,CAAD,CAAK0K,KAAL,CAAW,SAAX,CAAD,CAAtC,GAA+D1K,CAAC,CAAC,CAAD,CAAD,CAAKyK,QAAL,CAAc,UAAd,MAA4BvK,CAAC,CAACsK,cAAF,GAAiBhJ,CAAC,CAACxB,CAAC,CAAC,CAAD,CAAD,CAAK0K,KAAL,CAAW,UAAX,CAAD,CAA9C,CAA/D,EAAuI1K,CAAC,CAAC,CAAD,CAAD,CAAKyK,QAAL,CAAc,SAAd,MAA2BvK,CAAC,CAACoK,OAAF,GAAUvI,CAAC,CAAC/B,CAAC,CAAC,CAAD,CAAD,CAAK0K,KAAL,CAAW,SAAX,CAAD,CAAtC,CAAvI,EAAsM1K,CAAC,CAAC,CAAD,CAAD,CAAKyK,QAAL,CAAc,OAAd,CAAzM,EAAgO;AAAC,gBAAM9K,CAAC,GAACwC,CAAC,CAACnC,CAAC,CAAC,CAAD,CAAD,CAAK0K,KAAL,CAAW,OAAX,CAAD,EAAqB,CAAC,CAAtB,CAAT;AAAkC/K,UAAAA,CAAC,CAACsE,MAAF,GAAS,CAAT,KAAa/D,CAAC,CAACqK,KAAF,GAAQ5K,CAArB;AAAwB;AAAC,OAAjT,MAAsT,IAAG,SAAOK,CAAC,CAAC,CAAD,CAAX,EAAe,MAAM,IAAIkH,KAAJ,CAAU,mBAAV,CAAN;;AAAqC,UAAGvF,CAAC,CAAC3B,CAAC,CAAC,CAAD,CAAF,CAAJ,EAAW;AAAC,YAAIJ,CAAC,GAACI,CAAC,CAAC,CAAD,CAAD,CAAK2K,MAAX;AAAkB,eAAO/K,CAAC,YAAYmE,CAAb,KAAiBnE,CAAC,GAACY,CAAC,CAACZ,CAAD,EAAGD,CAAC,CAAC2F,gBAAL,EAAsB,CAAC,GAAD,CAAtB,EAA4B,CAAC,CAA7B,EAA+B3F,CAAC,CAAC+H,QAAjC,EAA0C/H,CAAC,CAACgI,WAA5C,CAApB,GAA8E,SAAO/H,CAAP,IAAU,CAAC,CAAD,KAAK0B,CAAC,CAAC1B,CAAD,CAAhB,GAAoB,EAApB,GAAuBA,CAAC,CAACkH,IAAF,GAAStC,IAAT,CAAe,MAAI5E,CAAC,CAACgL,gBAAF,CAAmB5K,CAAC,CAAC,CAAD,CAAD,CAAK0K,KAAL,CAAW9K,CAAC,CAACmG,aAAb,CAAnB,EAA+C7F,CAAC,CAACmK,OAAjD,EAAyDnK,CAAC,CAACoK,OAA3D,EAAmEpK,CAAC,CAACqK,KAArE,EAA2ErK,CAAC,CAACsK,cAA7E,CAAnB,CAA5G;AAA8N;;AAAA,UAAG,SAAOxK,CAAC,CAAC,CAAD,CAAX,EAAe,OAAM,EAAN;AAAS,YAAM,IAAIkH,KAAJ,CAAU,mBAAV,CAAN;AAAqC,KAA9xB,CAAP;AAAwyB,GAAr2R,EAAs2R3D,CAAC,CAAC4D,UAAF,CAAa7C,IAAb,CAAkB;AAACD,IAAAA,IAAI,EAAC,aAAN;AAAoB+C,IAAAA,GAAG,EAAC,GAAxB;AAA4BC,IAAAA,GAAG,EAAC;AAAhC,GAAlB,CAAt2R,EAA85R9D,CAAC,CAAC6C,SAAF,CAAYyE,4BAAZ,GAAyC,UAASlL,CAAT,EAAWC,CAAX,EAAa;AAAC,WAAO2D,CAAC,CAAC+C,qBAAF,CAAwB3G,CAAxB,EAA0BC,CAA1B,EAA6B,CAACA,CAAD,EAAGC,CAAH,EAAKC,CAAL,KAAS;AAACmB,MAAAA,CAAC,CAACnB,CAAD,EAAG,CAAH,EAAK,CAAL,CAAD;AAAS,YAAME,CAAC,GAACF,CAAC,CAAC,CAAD,CAAT;AAAA,YAAaI,CAAC,GAACkB,CAAC,CAACtB,CAAC,CAAC,CAAD,CAAF,CAAhB;AAAuB,UAAIM,CAAC,GAACe,CAAC,CAACrB,CAAC,CAAC,CAAD,CAAF,EAAM,IAAN,CAAP;AAAmB,YAAMQ,CAAC,GAACkB,CAAC,CAACL,CAAC,CAACrB,CAAC,CAAC,CAAD,CAAF,EAAM,CAAC,CAAP,CAAF,CAAT;AAAsB,UAAG,SAAOM,CAAP,KAAWA,CAAC,GAAC,CAAC,GAAD,CAAb,GAAoB,CAAC,CAAD,KAAKqB,CAAC,CAACrB,CAAD,CAA7B,EAAiC,MAAM,IAAI8G,KAAJ,CAAU,mBAAV,CAAN;AAAqC,UAAG,SAAOpH,CAAC,CAAC,CAAD,CAAX,EAAe,OAAO,IAAP;AAAY,UAAG,CAAC6B,CAAC,CAAC7B,CAAC,CAAC,CAAD,CAAF,CAAL,EAAY,MAAM,IAAIoH,KAAJ,CAAU,mBAAV,CAAN;AAAqC,UAAIpG,CAAC,GAACd,CAAC,CAAC2K,MAAR;AAAe,aAAO7J,CAAC,YAAYiD,CAAb,KAAiBjD,CAAC,GAACN,CAAC,CAACM,CAAD,EAAGnB,CAAC,CAAC2F,gBAAL,EAAsB,CAAC,GAAD,CAAtB,EAA4B,CAAC,CAA7B,EAA+B3F,CAAC,CAAC+H,QAAjC,EAA0C/H,CAAC,CAACgI,WAA5C,CAApB,GAA8E,SAAO7G,CAAP,IAAU,CAAC,CAAD,KAAKQ,CAAC,CAACR,CAAD,CAAhB,GAAoB,IAApB,GAAyBA,CAAC,CAACgG,IAAF,GAAStC,IAAT,CAAe5E,CAAC,IAAE;AAAC,cAAMC,CAAC,GAACD,CAAC,CAACkL,oBAAF,GAAyBhC,MAAzB,CAAiCnJ,CAAC,IAAEA,CAAC,CAAC0E,IAAF,KAASnE,CAA7C,CAAR;AAAyD,YAAG,MAAIL,CAAC,CAACoE,MAAT,EAAgB,OAAO,IAAP;AAAY,YAAG,KAAK,CAAL,KAASpE,CAAC,CAAC,CAAD,CAAD,CAAKkL,mBAAd,IAAmC,SAAOlL,CAAC,CAAC,CAAD,CAAD,CAAKkL,mBAA/C,IAAoElL,CAAC,CAAC,CAAD,CAAD,CAAKkL,mBAAL,GAAyB,CAAC,CAAjG,EAAmG,OAAOrK,CAAC,CAACd,CAAD,EAAGC,CAAC,CAAC,CAAD,CAAJ,EAAQG,CAAC,CAAC0K,KAAF,CAAQ9K,CAAC,CAACmG,aAAV,CAAR,EAAiCnG,CAAC,CAAC0F,gBAAnC,EAAoDlF,CAApD,EAAsDE,CAAtD,EAAwDX,CAAC,CAAC+H,QAA1D,EAAmE/H,CAAC,CAACgI,WAArE,CAAR;AAA0F,YAAI7H,CAAC,GAACF,CAAC,CAACoL,UAAF,EAAN;AAAqB,eAAOlL,CAAC,IAAEA,CAAC,GAAC,QAAMA,CAAC,CAACmL,MAAF,CAASnL,CAAC,CAACmE,MAAF,GAAS,CAAlB,CAAN,GAA2BnE,CAAC,GAACD,CAAC,CAAC,CAAD,CAAD,CAAKqL,cAAL,CAAoBC,QAApB,EAA7B,GAA4DrL,CAAC,GAAC,GAAF,GAAMD,CAAC,CAAC,CAAD,CAAD,CAAKqL,cAAL,CAAoBC,QAApB,EAApE,EAAmGvK,CAAC,CAACd,CAAD,EAAGF,CAAC,CAAC0F,gBAAL,EAAsBlF,CAAtB,EAAwBE,CAAxB,EAA0BX,CAAC,CAAC+H,QAA5B,EAAqC/H,CAAC,CAACgI,WAAvC,CAAD,CAAqDnD,IAArD,CAA2D7E,CAAC,IAAEA,CAAC,CAACmH,IAAF,GAAStC,IAAT,CAAe,MAAI7E,CAAC,CAACmL,oBAAF,EAAnB,EAA8CtG,IAA9C,CAAoD1E,CAAC,IAAE;AAAC,cAAGA,CAAC,GAACA,CAAC,CAACgJ,MAAF,CAAUnJ,CAAC,IAAEA,CAAC,CAACyL,EAAF,KAAOvL,CAAC,CAAC,CAAD,CAAD,CAAKuL,EAAzB,CAAF,EAAgC,CAAC,CAAD,KAAKpL,CAAC,CAACyK,QAAF,CAAW5K,CAAC,CAAC,CAAD,CAAD,CAAKwL,QAAhB,CAAL,IAAgC,SAAOrL,CAAC,CAAC0K,KAAF,CAAQ7K,CAAC,CAAC,CAAD,CAAD,CAAKwL,QAAb,CAA1E,EAAiG,OAAOzL,CAAC,CAAC0L,oBAAF,CAAuBtL,CAAC,CAAC0K,KAAF,CAAQ9K,CAAC,CAACmG,aAAV,CAAvB,EAAgD,CAAClG,CAAC,CAAC,CAAD,CAAD,CAAKwL,QAAN,CAAhD,EAAiE7G,IAAjE,CAAuE5E,CAAC,IAAE;AAAC,gBAAGA,CAAH,EAAK;AAAC,oBAAMI,CAAC,GAAC8D,CAAC,CAAC+E,MAAF,CAAS/I,CAAC,CAAC,CAAD,CAAD,CAAKuL,QAAL,GAAc,OAAvB,EAA+B1L,CAAC,CAAC2J,cAAF,EAA/B,CAAR;AAA2D,qBAAOtJ,CAAC,CAACyE,UAAF,GAAa;AAAC2G,gBAAAA,EAAE,EAACxL,CAAC,CAAC+I,UAAF,CAAa9I,CAAC,CAAC,CAAD,CAAD,CAAKwL,QAAlB;AAAJ,eAAb,EAA8C1L,CAAC,CAACmJ,MAAF,CAAS9I,CAAT,CAArD;AAAiE;;AAAA,mBAAO,IAAIoC,CAAJ,CAAM;AAACmH,cAAAA,gBAAgB,EAAC5J;AAAlB,aAAN,CAAP;AAAmC,WAAhP,CAAP;AAA0P,gBAAMO,CAAC,GAAC4D,CAAC,CAAC+E,MAAF,CAAS/I,CAAC,CAAC,CAAD,CAAD,CAAKuL,QAAL,GAAc,OAAvB,EAA+B1L,CAAC,CAAC2J,cAAF,EAA/B,CAAR;AAA2D,iBAAOpJ,CAAC,CAACuE,UAAF,GAAa;AAAC2G,YAAAA,EAAE,EAACpL,CAAC,CAAC0K,KAAF,CAAQ7K,CAAC,CAAC,CAAD,CAAD,CAAKwL,QAAb;AAAJ,WAAb,EAAyC1L,CAAC,CAACmJ,MAAF,CAAS5I,CAAT,CAAhD;AAA4D,SAA1gB,CAA9D,CAArG,IAAmrB,IAA3rB;AAAgsB,OAA1/B,CAA9G;AAA2mC,KAA53C,CAAP;AAAs4C,GAA31U,EAA41UqD,CAAC,CAAC4D,UAAF,CAAa7C,IAAb,CAAkB;AAACD,IAAAA,IAAI,EAAC,8BAAN;AAAqC+C,IAAAA,GAAG,EAAC,GAAzC;AAA6CC,IAAAA,GAAG,EAAC;AAAjD,GAAlB,CAA51U,EAAq6U9D,CAAC,CAAC6C,SAAF,CAAYmF,uBAAZ,GAAoC,UAAS5L,CAAT,EAAWC,CAAX,EAAa;AAAC,WAAO2D,CAAC,CAAC+C,qBAAF,CAAwB3G,CAAxB,EAA0BC,CAA1B,EAA6B,CAACA,CAAD,EAAGC,CAAH,EAAKC,CAAL,KAAS;AAACmB,MAAAA,CAAC,CAACnB,CAAD,EAAG,CAAH,EAAK,CAAL,CAAD;AAAS,YAAME,CAAC,GAACF,CAAC,CAAC,CAAD,CAAT;AAAA,YAAaI,CAAC,GAACkB,CAAC,CAACD,CAAC,CAACrB,CAAC,CAAC,CAAD,CAAF,EAAM,EAAN,CAAF,CAAD,CAAc4E,WAAd,EAAf;AAAA,YAA2CtE,CAAC,GAACwB,CAAC,CAAC9B,CAAC,CAAC,CAAD,CAAF,CAAD,GAAQsB,CAAC,CAACtB,CAAC,CAAC,CAAD,CAAF,CAAT,GAAgB,IAA7D;AAAkE,UAAG,SAAOA,CAAC,CAAC,CAAD,CAAX,EAAe,OAAO,IAAP;AAAY,UAAG,CAAC6B,CAAC,CAAC7B,CAAC,CAAC,CAAD,CAAF,CAAL,EAAY,MAAM,IAAIoH,KAAJ,CAAU,mBAAV,CAAN;AAAqC,UAAI5G,CAAC,GAACN,CAAC,CAAC2K,MAAR;AAAe,aAAOrK,CAAC,YAAYyD,CAAb,KAAiBzD,CAAC,GAACE,CAAC,CAACF,CAAD,EAAGX,CAAC,CAAC2F,gBAAL,EAAsB,CAAC,GAAD,CAAtB,EAA4B,CAAC,CAA7B,EAA+B3F,CAAC,CAAC+H,QAAjC,EAA0C/H,CAAC,CAACgI,WAA5C,CAApB,GAA8E,SAAOrH,CAAP,IAAU,CAAC,CAAD,KAAKgB,CAAC,CAAChB,CAAD,CAAhB,GAAoB,IAApB,GAAyBA,CAAC,CAACwG,IAAF,GAAStC,IAAT,CAAe,MAAI;AAAC,cAAM5E,CAAC,GAACU,CAAC,CAAC0K,UAAF,EAAR;AAAuB,eAAOlK,CAAC,CAAClB,CAAD,EAAGD,CAAC,CAAC2F,gBAAL,CAAR;AAA+B,OAA1E,EAA6Ed,IAA7E,CAAmF7E,CAAC,IAAE;AAAC,YAAIC,CAAC,GAAC,IAAN;AAAA,YAAWC,CAAC,GAAC,IAAb;AAAA,YAAkBC,CAAC,GAAC,CAAC,CAArB;;AAAuB,YAAG,SAAOM,CAAP,IAAU,OAAKA,CAAf,IAAkB,KAAK,CAAL,KAASA,CAA9B,EAAgC;AAAC,eAAI,MAAMR,CAAV,IAAeD,CAAC,CAAC6L,SAAjB,EAA2B5L,CAAC,CAAC6L,YAAF,KAAiBrL,CAAjB,KAAqBP,CAAC,GAACD,CAAC,CAAC8L,UAAzB;;AAAqC,mBAAO7L,CAAP,KAAWC,CAAC,GAAC,CAAC,CAAd;AAAiB;;AAAA,cAAMU,CAAC,GAACb,CAAC,CAACgM,YAAF,CAAerC,cAAf,EAAR;AAAA,cAAwC5I,CAAC,GAACF,CAAC,CAAC2J,GAAF,CAAM,YAAN,EAAoB9F,IAA9D;AAAA,cAAmEzD,CAAC,GAACJ,CAAC,CAAC2J,GAAF,CAAM,cAAN,EAAsB9F,IAA3F;AAAA,cAAgGvD,CAAC,GAACN,CAAC,CAAC2J,GAAF,CAAM,cAAN,EAAsB9F,IAAxH;AAAA,cAA6HtD,CAAC,GAACP,CAAC,CAAC2J,GAAF,CAAM,gBAAN,EAAwB9F,IAAvJ;AAAA,cAA4JrD,CAAC,GAACR,CAAC,CAAC2J,GAAF,CAAM,qBAAN,EAA6B9F,IAA3L;AAAA,cAAgMpD,CAAC,GAACT,CAAC,CAAC2J,GAAF,CAAM,mBAAN,EAA2B9F,IAA7N;AAAA,cAAkOlD,CAAC,GAACX,CAAC,CAAC2J,GAAF,CAAM,iBAAN,EAAyB9F,IAA7P;AAAA,cAAkQjD,CAAC,GAACZ,CAAC,CAAC2J,GAAF,CAAM,kBAAN,EAA0B9F,IAA9R;AAAA,cAAmS/C,CAAC,GAACd,CAAC,CAAC2J,GAAF,CAAM,UAAN,EAAkB9F,IAAvT;;AAA4T,aAAI,MAAMnE,CAAV,IAAeI,CAAC,CAAC0F,MAAjB,EAAwB,IAAG,gBAAc9F,CAAC,CAAC0E,IAAnB,EAAwB;AAAChF,UAAAA,CAAC,GAACI,CAAC,CAAC0K,KAAF,CAAQxK,CAAC,CAACmE,IAAV,CAAF;AAAkB;AAAM;;AAAA,YAAI7C,CAAC,GAAC,IAAN;AAAA,YAAWC,CAAC,GAAC,IAAIa,CAAJ,CAAM,IAAIjB,CAAJ,CAAM;AAACgD,UAAAA,IAAI,EAAC,cAAN;AAAqBkE,UAAAA,KAAK,EAAC,cAA3B;AAA0C3D,UAAAA,IAAI,EAAC;AAA/C,SAAN,CAAN,EAAsEd,CAAC,CAAC+E,MAAF,CAAS,GAAT,EAAalJ,CAAC,CAACgM,YAAF,CAAerC,cAAf,EAAb,CAAtE,CAAb;AAAA,YAAkI3H,CAAC,GAAC,IAAIW,CAAJ,CAAM,IAAIjB,CAAJ,CAAM;AAACgD,UAAAA,IAAI,EAAC,MAAN;AAAakE,UAAAA,KAAK,EAAC,MAAnB;AAA0B3D,UAAAA,IAAI,EAAC;AAA/B,SAAN,CAAN,EAAsDd,CAAC,CAAC+E,MAAF,CAAS,IAAT,EAAclJ,CAAC,CAACgM,YAAF,CAAerC,cAAf,EAAd,CAAtD,CAApI;AAA0O,cAAM1H,CAAC,GAAC,UAAR;AAAA,cAAmBE,CAAC,GAAC,UAArB;AAAA,cAAgCD,CAAC,GAAC,EAAlC;;AAAqC,aAAI,MAAM7B,CAAV,IAAeL,CAAC,CAACiM,GAAjB,EAAqB/J,CAAC,CAAC7B,CAAD,CAAD,GAAKL,CAAC,CAACiM,GAAF,CAAM5L,CAAN,EAAS6L,QAAd;;AAAuB,cAAM5J,CAAC,GAAC,IAAIO,CAAJ,CAAM,IAAInB,CAAJ,CAAM;AAACgD,UAAAA,IAAI,EAAC,WAAN;AAAkBkE,UAAAA,KAAK,EAAC,WAAxB;AAAoC3D,UAAAA,IAAI,EAAC;AAAzC,SAAN,CAAN,EAAgE,IAAhE,EAAqE/C,CAArE,CAAR;AAAgF,YAAIE,CAAC,GAAC,EAAN;;AAAS,gBAAO7B,CAAP;AAAU,eAAI,SAAJ;AAAc;AAAC6B,cAAAA,CAAC,GAAE,KAAIrB,CAAE,KAAId,CAAE,WAAUgB,CAAE,KAAIhB,CAAE,YAAWuB,CAAE,UAA9C,EAAwDc,CAAC,CAAC6J,SAAF,GAAYhI,CAAC,CAAC+E,MAAF,CAAU,cAAanI,CAAE,KAAId,CAAE,WAAUoB,CAAE,SAAQC,CAAE,MAArD,EAA2DtB,CAAC,CAACgM,YAAF,CAAerC,cAAf,EAA3D,CAApE;AAAgK,oBAAMzJ,CAAC,GAACsD,CAAC,CAACP,CAAC,CAACmJ,SAAF,CAAYpM,CAAC,CAACgM,YAAF,CAAe3F,MAA3B,EAAkCpF,CAAlC,CAAD,CAAT;AAAgDf,cAAAA,CAAC,CAACwE,IAAF,GAAOzC,CAAP,EAAS/B,CAAC,CAAC0I,KAAF,GAAQ3G,CAAjB,EAAmBJ,CAAC,GAAC,IAAIc,CAAJ,CAAMzC,CAAN,EAAQiE,CAAC,CAAC+E,MAAF,CAAU,cAAajI,CAAE,KAAIhB,CAAE,WAAUc,CAAE,SAAQE,CAAE,MAArD,EAA2DjB,CAAC,CAACgM,YAAF,CAAerC,cAAf,EAA3D,CAAR,CAArB,EAA0H7H,CAAC,GAAC9B,CAAC,CAACqM,SAAF,IAAa,CAAb,GAAe,IAAIlJ,CAAJ,CAAMF,CAAC,CAACmJ,SAAF,CAAYpM,CAAC,CAACgM,YAAF,CAAe3F,MAA3B,EAAkCxF,CAAC,CAAC2J,GAAF,CAAM,cAAN,EAAsB9F,IAAxD,CAAN,CAAf,GAAoF,IAAI/B,CAAJ,CAAM,IAAIjB,CAAJ,CAAM;AAACgD,gBAAAA,IAAI,EAAC,cAAN;AAAqBkE,gBAAAA,KAAK,EAAC,cAA3B;AAA0C3D,gBAAAA,IAAI,EAAC;AAA/C,eAAN,CAAN,EAAsEd,CAAC,CAAC+E,MAAF,CAAS,GAAT,EAAalJ,CAAC,CAACgM,YAAF,CAAerC,cAAf,EAAb,CAAtE,CAAhN;AAAqU;AAAM;;AAAA,eAAI,cAAJ;AAAmB;AAACvH,cAAAA,CAAC,GAAE,KAAIrB,CAAE,KAAId,CAAE,WAAUgB,CAAE,KAAIhB,CAAE,YAAWuB,CAAE,YAA9C,EAA0Dc,CAAC,CAAC6J,SAAF,GAAYhI,CAAC,CAAC+E,MAAF,CAAU,cAAanI,CAAE,KAAId,CAAE,WAAUoB,CAAE,SAAQC,CAAE,MAArD,EAA2DtB,CAAC,CAACgM,YAAF,CAAerC,cAAf,EAA3D,CAAtE;AAAkK,oBAAMzJ,CAAC,GAACsD,CAAC,CAACP,CAAC,CAACmJ,SAAF,CAAYpM,CAAC,CAACgM,YAAF,CAAe3F,MAA3B,EAAkCpF,CAAlC,CAAD,CAAT;AAAgDf,cAAAA,CAAC,CAACwE,IAAF,GAAOzC,CAAP,EAAS/B,CAAC,CAAC0I,KAAF,GAAQ3G,CAAjB,EAAmBJ,CAAC,GAAC,IAAIc,CAAJ,CAAMzC,CAAN,EAAQiE,CAAC,CAAC+E,MAAF,CAAU,cAAajI,CAAE,KAAIhB,CAAE,WAAUc,CAAE,SAAQE,CAAE,MAArD,EAA2DjB,CAAC,CAACgM,YAAF,CAAerC,cAAf,EAA3D,CAAR,CAArB,EAA0H3H,CAAC,GAAC,IAAIW,CAAJ,CAAM,IAAIjB,CAAJ,CAAM;AAACgD,gBAAAA,IAAI,EAAC,MAAN;AAAakE,gBAAAA,KAAK,EAAC,MAAnB;AAA0B3D,gBAAAA,IAAI,EAAC;AAA/B,eAAN,CAAN,EAAsDd,CAAC,CAAC+E,MAAF,CAAU,cAAa1H,CAAE,+BAAzB,EAAwDxB,CAAC,CAACgM,YAAF,CAAerC,cAAf,EAAxD,CAAtD,CAA5H;AAA4Q;AAAM;;AAAA,eAAI,WAAJ;AAAgB;AAAC,kBAAIxJ,CAAC,GAAE,GAAEY,CAAE,OAAX;AAAA,kBAAkBV,CAAC,GAAE,GAAEY,CAAE,OAAzB;AAAgC,uBAAOf,CAAP,KAAWC,CAAC,IAAG,QAAOgB,CAAE,KAAb,EAAkBd,CAAC,IAAG,QAAOe,CAAE,KAA1C,GAAgDgB,CAAC,GAAC,OAAKjC,CAAL,GAAO,QAAP,GAAgBE,CAAhB,GAAkB,IAApE,EAAyE+B,CAAC,GAACC,CAAC,CAACD,CAAD,EAAG,IAAH,EAAQnC,CAAR,CAA5E,EAAuFE,CAAC,GAACkC,CAAC,CAAClC,CAAD,EAAG,IAAH,EAAQF,CAAR,CAA1F,EAAqG,SAAOC,CAAP,KAAWC,CAAC,GAACkC,CAAC,CAAClC,CAAD,EAAG,IAAH,EAAQD,CAAC,CAACsL,QAAF,EAAR,CAAH,EAAyBpJ,CAAC,GAACC,CAAC,CAACD,CAAD,EAAG,IAAH,EAAQlC,CAAC,CAACsL,QAAF,EAAR,CAAvC,CAArG,EAAmKlJ,CAAC,CAAC6J,SAAF,GAAYhI,CAAC,CAAC+E,MAAF,CAAS,eAAa/I,CAAb,GAAgB,SAAQkB,CAAE,SAAQC,CAAE,MAA7C,EAAmDtB,CAAC,CAACgM,YAAF,CAAerC,cAAf,EAAnD,CAA/K;AAAmQ,oBAAMpJ,CAAC,GAACiD,CAAC,CAACP,CAAC,CAACmJ,SAAF,CAAYpM,CAAC,CAACgM,YAAF,CAAe3F,MAA3B,EAAkCpF,CAAlC,CAAD,CAAT;AAAgDV,cAAAA,CAAC,CAACmE,IAAF,GAAOzC,CAAP,EAAS1B,CAAC,CAACqI,KAAF,GAAQ3G,CAAjB,EAAmBJ,CAAC,GAAC,IAAIc,CAAJ,CAAMpC,CAAN,EAAQ4D,CAAC,CAAC+E,MAAF,CAAS,eAAa/I,CAAb,GAAgB,SAAQc,CAAE,SAAQF,CAAE,MAA7C,EAAmDf,CAAC,CAACgM,YAAF,CAAerC,cAAf,EAAnD,CAAR,CAArB;AAAkH;AAAM;;AAAA,eAAI,WAAJ;AAAgBvH,YAAAA,CAAC,GAAE,GAAErB,CAAE,KAAId,CAAE,SAAQuB,CAAE,MAAvB,EAA6B,SAAOtB,CAAP,KAAWkC,CAAC,IAAG,QAAOjB,CAAE,KAAV,GAAejB,CAAC,CAACsL,QAAF,EAA7B,CAA7B,EAAwElJ,CAAC,CAAC6J,SAAF,GAAY9K,CAApF,EAAsFe,CAAC,GAAC,OAAKA,CAAL,GAAO,IAA/F,EAAoGP,CAAC,GAAC,IAAIkB,CAAJ,CAAME,CAAC,CAACmJ,SAAF,CAAYpM,CAAC,CAACgM,YAAF,CAAe3F,MAA3B,EAAkCpF,CAAlC,CAAN,EAA2CgB,CAA3C,EAA6CA,CAA7C,CAAtG;;AAAsJ,eAAI,SAAJ;AAAcG,YAAAA,CAAC,GAAE,IAAGnB,CAAE,KAAIhB,CAAE,SAAQuB,CAAE,OAAxB,EAA+B,SAAOtB,CAAP,KAAWkC,CAAC,IAAG,QAAOhB,CAAE,KAAV,GAAelB,CAAC,CAACsL,QAAF,EAA7B,CAA/B,EAA0ElJ,CAAC,CAAC6J,SAAF,GAAY7K,CAAtF,EAAwFc,CAAC,GAAC,OAAKA,CAAL,GAAO,IAAjG,EAAsGP,CAAC,GAAC,IAAIkB,CAAJ,CAAME,CAAC,CAACmJ,SAAF,CAAYpM,CAAC,CAACgM,YAAF,CAAe3F,MAA3B,EAAkCtF,CAAlC,CAAN,EAA2CkB,CAA3C,EAA6CA,CAA7C,CAAxG;AAAwJ;;AAAM,eAAI,WAAJ;AAAgBG,YAAAA,CAAC,GAAE,IAAGrB,CAAE,KAAId,CAAE,SAAQuB,CAAE,OAAxB,EAA+B,SAAOtB,CAAP,KAAWkC,CAAC,IAAG,QAAOjB,CAAE,KAAV,GAAejB,CAAC,CAACsL,QAAF,EAA7B,CAA/B,EAA0ElJ,CAAC,CAAC6J,SAAF,GAAY9K,CAAtF,EAAwFe,CAAC,GAAC,OAAKA,CAAL,GAAO,IAAjG,EAAsGP,CAAC,GAAC,IAAIkB,CAAJ,CAAME,CAAC,CAACmJ,SAAF,CAAYpM,CAAC,CAACgM,YAAF,CAAe3F,MAA3B,EAAkCpF,CAAlC,CAAN,EAA2CgB,CAA3C,EAA6CE,CAA7C,CAAxG;AAAwJ;;AAAM,eAAI,UAAJ;AAAeC,YAAAA,CAAC,GAAE,IAAGnB,CAAE,KAAIhB,CAAE,SAAQuB,CAAE,OAAxB,EAA+B,SAAOtB,CAAP,KAAWkC,CAAC,IAAG,QAAOhB,CAAE,KAAV,GAAelB,CAAC,CAACsL,QAAF,EAA7B,CAA/B,EAA0ElJ,CAAC,CAAC6J,SAAF,GAAY7K,CAAtF,EAAwFc,CAAC,GAAC,OAAKA,CAAL,GAAO,IAAjG,EAAsGP,CAAC,GAAC,IAAIkB,CAAJ,CAAME,CAAC,CAACmJ,SAAF,CAAYpM,CAAC,CAACgM,YAAF,CAAe3F,MAA3B,EAAkCtF,CAAlC,CAAN,EAA2CkB,CAA3C,EAA6CE,CAA7C,CAAxG;AAAwJ;;AAAM;AAAQ,kBAAM,IAAIoF,KAAJ,CAAU,mBAAV,CAAN;AAA7rE;;AAAkuEpH,QAAAA,CAAC,KAAGiC,CAAC,GAAC,QAAL,CAAD;AAAgB,eAAO,IAAIa,CAAJ,CAAM;AAAC2G,UAAAA,gBAAgB,EAAC5J,CAAC,CAACgM,YAApB;AAAiCM,UAAAA,aAAa,EAAC,CAAC,IAAInJ,CAAJ,CAAMF,CAAC,CAACmJ,SAAF,CAAYpM,CAAC,CAACgM,YAAF,CAAe3F,MAA3B,EAAkC1E,CAAlC,CAAN,CAAD,EAA6C,IAAIwB,CAAJ,CAAMF,CAAC,CAACmJ,SAAF,CAAYpM,CAAC,CAACgM,YAAF,CAAe3F,MAA3B,EAAkC5E,CAAlC,CAAN,CAA7C,EAAyFI,CAAzF,EAA2FG,CAA3F,EAA6FM,CAA7F,EAA+FR,CAA/F,CAA/C;AAAiJyK,UAAAA,WAAW,EAACnK,CAAC,GAAC+B,CAAC,CAAC+E,MAAF,CAAS9G,CAAT,EAAWpC,CAAC,CAACgM,YAAF,CAAerC,cAAf,EAAX,CAAD,GAA6C;AAA3M,SAAN,CAAP;AAA+N,OAA18G,CAA9G;AAA2jH,KAAxwH,CAAP;AAAkxH,GAAzuc,EAA0uc/F,CAAC,CAAC4D,UAAF,CAAa7C,IAAb,CAAkB;AAACD,IAAAA,IAAI,EAAC,yBAAN;AAAgC+C,IAAAA,GAAG,EAAC,GAApC;AAAwCC,IAAAA,GAAG,EAAC;AAA5C,GAAlB,CAA1uc,EAA8yc9D,CAAC,CAAC6C,SAAF,CAAY+F,OAAZ,GAAoB,UAASxM,CAAT,EAAWE,CAAX,EAAa;AAAC,WAAO0D,CAAC,CAAC+C,qBAAF,CAAwB3G,CAAxB,EAA0BE,CAA1B,EAA6B,CAACA,CAAD,EAAGC,CAAH,EAAKE,CAAL,MAAUiB,CAAC,CAACjB,CAAD,EAAG,CAAH,EAAK,CAAL,CAAD,EAASsB,CAAC,CAACtB,CAAC,CAAC,CAAD,CAAF,CAAD,GAAQA,CAAC,CAAC,CAAD,CAAD,CAAK8G,IAAL,GAAYtC,IAAZ,CAAkB3E,CAAC,IAAE;AAAC,YAAMC,CAAC,GAAC,EAAR;AAAA,YAAWI,CAAC,GAAC,EAAb;AAAgB,UAAIE,CAAC,GAAC,CAAC,CAAP;AAAA,UAASE,CAAC,GAAC,EAAX;AAAc,UAAGsB,CAAC,CAAC5B,CAAC,CAAC,CAAD,CAAF,CAAJ,EAAWM,CAAC,CAACgE,IAAF,CAAOtE,CAAC,CAAC,CAAD,CAAR,EAAX,KAA6B,IAAGA,CAAC,CAAC,CAAD,CAAD,YAAeJ,CAAlB,EAAoBU,CAAC,CAACgE,IAAF,CAAOtE,CAAC,CAAC,CAAD,CAAR,EAApB,KAAsC,IAAGyB,CAAC,CAACzB,CAAC,CAAC,CAAD,CAAF,CAAJ,EAAWM,CAAC,GAACN,CAAC,CAAC,CAAD,CAAH,CAAX,KAAsB;AAAC,YAAG,CAAC8B,CAAC,CAAC9B,CAAC,CAAC,CAAD,CAAF,CAAL,EAAY,OAAOuD,CAAC,CAACkG,aAAF,CAAgB,wBAAhB,CAAP;AAAiDnJ,QAAAA,CAAC,GAACN,CAAC,CAAC,CAAD,CAAD,CAAKkE,OAAL,EAAF;AAAiB;;AAAA,WAAI,MAAMvE,CAAV,IAAeW,CAAf,EAAiB,IAAGsB,CAAC,CAACjC,CAAD,CAAJ,EAAQ;AAAC,cAAMC,CAAC,GAACkE,CAAC,CAAC+E,MAAF,CAASzH,CAAC,CAACzB,CAAD,CAAV,EAAcE,CAAC,CAACyJ,cAAF,EAAd,CAAR;AAAA,cAA0CtJ,CAAC,GAAC,CAAC,CAAD,KAAKqD,CAAC,CAACzD,CAAD,CAAN,GAAUwB,CAAC,CAACzB,CAAD,CAAX,GAAe,eAA3D;AAA2EG,QAAAA,CAAC,CAACwE,IAAF,CAAO;AAACD,UAAAA,IAAI,EAACrE,CAAN;AAAQoM,UAAAA,UAAU,EAACxM;AAAnB,SAAP,GAA8B,oBAAkBI,CAAlB,KAAsBI,CAAC,GAAC,CAAC,CAAzB,CAA9B;AAA0D,OAA9I,MAAkJ;AAAC,YAAG,EAAET,CAAC,YAAYC,CAAf,CAAH,EAAqB,OAAO2D,CAAC,CAACkG,aAAF,CAAgB,wBAAhB,CAAP;AAAiD;AAAC,gBAAM7J,CAAC,GAACD,CAAC,CAAC8K,QAAF,CAAW,MAAX,IAAmB9K,CAAC,CAAC+K,KAAF,CAAQ,MAAR,CAAnB,GAAmC,eAA3C;AAAA,gBAA2D1K,CAAC,GAACL,CAAC,CAAC8K,QAAF,CAAW,YAAX,IAAyB9K,CAAC,CAAC+K,KAAF,CAAQ,YAAR,CAAzB,GAA+C,EAA5G;AAA+G,cAAG,oBAAkB9K,CAAlB,KAAsBQ,CAAC,GAAC,CAAC,CAAzB,GAA4B,CAACR,CAAhC,EAAkC,OAAO2D,CAAC,CAACkG,aAAF,CAAgB,wBAAhB,CAAP;AAAiD3J,UAAAA,CAAC,CAACwE,IAAF,CAAO;AAACD,YAAAA,IAAI,EAACzE,CAAN;AAAQwM,YAAAA,UAAU,EAACtI,CAAC,CAAC+E,MAAF,CAAS7I,CAAC,IAAEJ,CAAZ,EAAcC,CAAC,CAACyJ,cAAF,EAAd;AAAnB,WAAP;AAA8D;AAAC;;AAAA,UAAGhJ,CAAC,GAAC,EAAF,EAAKsB,CAAC,CAAC5B,CAAC,CAAC,CAAD,CAAF,CAAT,EAAgBM,CAAC,CAACgE,IAAF,CAAOtE,CAAC,CAAC,CAAD,CAAR,EAAhB,KAAkC,IAAGyB,CAAC,CAACzB,CAAC,CAAC,CAAD,CAAF,CAAJ,EAAWM,CAAC,GAACN,CAAC,CAAC,CAAD,CAAH,CAAX,KAAuB,IAAG8B,CAAC,CAAC9B,CAAC,CAAC,CAAD,CAAF,CAAJ,EAAWM,CAAC,GAACN,CAAC,CAAC,CAAD,CAAD,CAAKkE,OAAL,EAAF,CAAX,KAAgC;AAAC,YAAG,EAAElE,CAAC,CAAC,CAAD,CAAD,YAAeJ,CAAjB,CAAH,EAAuB,OAAO2D,CAAC,CAACkG,aAAF,CAAgB,wBAAhB,CAAP;AAAiDnJ,QAAAA,CAAC,CAACgE,IAAF,CAAOtE,CAAC,CAAC,CAAD,CAAR;AAAa;;AAAA,WAAI,MAAML,CAAV,IAAeW,CAAf,EAAiB;AAAC,YAAG,EAAEX,CAAC,YAAYC,CAAf,CAAH,EAAqB,OAAO2D,CAAC,CAACkG,aAAF,CAAgB,wBAAhB,CAAP;AAAiD;AAAC,gBAAM7J,CAAC,GAACD,CAAC,CAAC8K,QAAF,CAAW,MAAX,IAAmB9K,CAAC,CAAC+K,KAAF,CAAQ,MAAR,CAAnB,GAAmC,EAA3C;AAAA,gBAA8C5K,CAAC,GAACH,CAAC,CAAC8K,QAAF,CAAW,WAAX,IAAwB9K,CAAC,CAAC+K,KAAF,CAAQ,WAAR,CAAxB,GAA6C,EAA7F;AAAA,gBAAgG1K,CAAC,GAACL,CAAC,CAAC8K,QAAF,CAAW,YAAX,IAAyB9K,CAAC,CAAC+K,KAAF,CAAQ,YAAR,CAAzB,GAA+C,EAAjJ;AAAoJ,cAAG,CAAC9K,CAAD,IAAI,CAACE,CAAL,IAAQ,CAACE,CAAZ,EAAc,OAAOuD,CAAC,CAACkG,aAAF,CAAgB,wBAAhB,CAAP;AAAiDvJ,UAAAA,CAAC,CAACoE,IAAF,CAAO;AAACD,YAAAA,IAAI,EAACzE,CAAN;AAAQyM,YAAAA,SAAS,EAACvM,CAAC,CAAC4E,WAAF,EAAlB;AAAkC0H,YAAAA,UAAU,EAACtI,CAAC,CAAC+E,MAAF,CAAS7I,CAAT,EAAWH,CAAC,CAACyJ,cAAF,EAAX;AAA7C,WAAP;AAAqF;AAAC;;AAAA,UAAGlJ,CAAH,EAAK;AAAC,cAAMT,CAAC,GAAC,EAAR;;AAAW,aAAI,MAAMG,CAAV,IAAeD,CAAC,CAACmG,MAAjB,EAAwBrG,CAAC,CAACG,CAAC,CAACuE,IAAF,CAAOK,WAAP,EAAD,CAAD,GAAwB,CAAxB;;AAA0B,aAAI,MAAM7E,CAAV,IAAeC,CAAf,EAAiB,oBAAkBD,CAAC,CAACwE,IAApB,KAA2B1E,CAAC,CAACE,CAAC,CAACwE,IAAF,CAAOK,WAAP,EAAD,CAAD,GAAwB,CAAnD;;AAAsD,aAAI,MAAM7E,CAAV,IAAeK,CAAf,EAAiB,oBAAkBL,CAAC,CAACwE,IAApB,KAA2B1E,CAAC,CAACE,CAAC,CAACwE,IAAF,CAAOK,WAAP,EAAD,CAAD,GAAwB,CAAnD;;AAAsD,YAAI9E,CAAC,GAAC,CAAN;;AAAQ,aAAI,MAAMC,CAAV,IAAeC,CAAf,EAAiB,IAAG,oBAAkBD,CAAC,CAACwE,IAAvB,EAA4B;AAAC,iBAAK,MAAI1E,CAAC,CAAC,WAASC,CAAC,CAACuL,QAAF,EAAV,CAAV,GAAmCvL,CAAC;;AAAGD,UAAAA,CAAC,CAAC,WAASC,CAAC,CAACuL,QAAF,EAAV,CAAD,GAAyB,CAAzB,EAA2BtL,CAAC,CAACwE,IAAF,GAAO,WAASzE,CAAC,CAACuL,QAAF,EAA3C;AAAwD;AAAC;;AAAA,YAAM3K,CAAC,GAAC,EAAR;;AAAW,WAAI,MAAMZ,CAAV,IAAeE,CAAf,EAAiBU,CAAC,CAAC8D,IAAF,CAAOH,CAAC,CAACvE,CAAC,CAACwM,UAAH,EAAc7I,CAAd,EAAgB5D,CAAhB,CAAR;;AAA4B,WAAI,MAAMC,CAAV,IAAeM,CAAf,EAAiBM,CAAC,CAAC8D,IAAF,CAAOH,CAAC,CAACvE,CAAC,CAACwM,UAAH,EAAc7I,CAAd,EAAgB5D,CAAhB,CAAR;;AAA4B,aAAOa,CAAC,CAACyD,MAAF,GAAS,CAAT,GAAWL,CAAC,CAACpD,CAAD,CAAD,CAAKgE,IAAL,CAAW,MAAIjD,CAAC,CAACvB,CAAC,CAAC,CAAD,CAAD,CAAKmM,OAAL,CAAarM,CAAb,EAAeI,CAAf,CAAD,CAAhB,CAAX,GAAiDqB,CAAC,CAACvB,CAAC,CAAC,CAAD,CAAD,CAAKmM,OAAL,CAAarM,CAAb,EAAeI,CAAf,CAAD,CAAzD;AAA6E,KAAlxD,CAAR,GAA6xDqD,CAAC,CAACkG,aAAF,CAAgB,wBAAhB,CAAhzD,CAA7B,CAAP;AAAi4D,GAAjtgB,EAAktgBlG,CAAC,CAAC4D,UAAF,CAAa7C,IAAb,CAAkB;AAACD,IAAAA,IAAI,EAAC,SAAN;AAAgB+C,IAAAA,GAAG,EAAC,GAApB;AAAwBC,IAAAA,GAAG,EAAC;AAA5B,GAAlB,CAAltgB,EAAswgB9D,CAAC,CAAC6C,SAAF,CAAYkG,QAAZ,GAAqB,UAAS3M,CAAT,EAAWE,CAAX,EAAa;AAAC,WAAO0D,CAAC,CAAC+C,qBAAF,CAAwB3G,CAAxB,EAA0BE,CAA1B,EAA6B,CAACA,CAAD,EAAGC,CAAH,EAAKE,CAAL,KAASsB,CAAC,CAACtB,CAAC,CAAC,CAAD,CAAF,CAAD,IAASiB,CAAC,CAACjB,CAAD,EAAG,CAAH,EAAK,CAAL,CAAD,EAASA,CAAC,CAAC,CAAD,CAAD,CAAK8G,IAAL,GAAYtC,IAAZ,CAAkB3E,CAAC,IAAE;AAAC,YAAMC,CAAC,GAAC,EAAR;AAAW,UAAII,CAAC,GAAC,EAAN;AAAS,UAAG0B,CAAC,CAAC5B,CAAC,CAAC,CAAD,CAAF,CAAJ,EAAWE,CAAC,CAACoE,IAAF,CAAOtE,CAAC,CAAC,CAAD,CAAR,EAAX,KAA6B,IAAGA,CAAC,CAAC,CAAD,CAAD,YAAeJ,CAAlB,EAAoBM,CAAC,CAACoE,IAAF,CAAOtE,CAAC,CAAC,CAAD,CAAR,EAApB,KAAsC,IAAGyB,CAAC,CAACzB,CAAC,CAAC,CAAD,CAAF,CAAJ,EAAWE,CAAC,GAACF,CAAC,CAAC,CAAD,CAAH,CAAX,KAAsB;AAAC,YAAG,CAAC8B,CAAC,CAAC9B,CAAC,CAAC,CAAD,CAAF,CAAL,EAAY,OAAOuD,CAAC,CAACkG,aAAF,CAAgB,wBAAhB,CAAP;AAAiDvJ,QAAAA,CAAC,GAACF,CAAC,CAAC,CAAD,CAAD,CAAKkE,OAAL,EAAF;AAAiB;AAAA,UAAI9D,CAAC,GAAC,CAAC,CAAP;;AAAS,WAAI,MAAMT,CAAV,IAAeO,CAAf,EAAiB,IAAG0B,CAAC,CAACjC,CAAD,CAAJ,EAAQ;AAAC,cAAMC,CAAC,GAACkE,CAAC,CAAC+E,MAAF,CAASzH,CAAC,CAACzB,CAAD,CAAV,EAAcE,CAAC,CAACyJ,cAAF,EAAd,CAAR;AAAA,cAA0CtJ,CAAC,GAAC,CAAC,CAAD,KAAKqD,CAAC,CAACzD,CAAD,CAAN,GAAUwB,CAAC,CAACzB,CAAD,CAAX,GAAe,eAA3D;AAA2EG,QAAAA,CAAC,CAACwE,IAAF,CAAO;AAACD,UAAAA,IAAI,EAACrE,CAAN;AAAQoM,UAAAA,UAAU,EAACxM;AAAnB,SAAP,GAA8B,oBAAkBI,CAAlB,KAAsBI,CAAC,GAAC,CAAC,CAAzB,CAA9B;AAA0D,OAA9I,MAAkJ;AAAC,YAAG,EAAET,CAAC,YAAYC,CAAf,CAAH,EAAqB,OAAO2D,CAAC,CAACkG,aAAF,CAAgB,wBAAhB,CAAP;AAAiD;AAAC,gBAAM7J,CAAC,GAACD,CAAC,CAAC8K,QAAF,CAAW,MAAX,IAAmB9K,CAAC,CAAC+K,KAAF,CAAQ,MAAR,CAAnB,GAAmC,eAA3C;AAAA,gBAA2D1K,CAAC,GAACL,CAAC,CAAC8K,QAAF,CAAW,YAAX,IAAyB9K,CAAC,CAAC+K,KAAF,CAAQ,YAAR,CAAzB,GAA+C,EAA5G;AAA+G,cAAG,oBAAkB9K,CAAlB,KAAsBQ,CAAC,GAAC,CAAC,CAAzB,GAA4B,CAACR,CAAhC,EAAkC,OAAO2D,CAAC,CAACkG,aAAF,CAAgB,wBAAhB,CAAP;AAAiD3J,UAAAA,CAAC,CAACwE,IAAF,CAAO;AAACD,YAAAA,IAAI,EAACzE,CAAN;AAAQwM,YAAAA,UAAU,EAACtI,CAAC,CAAC+E,MAAF,CAAS7I,CAAC,IAAEJ,CAAZ,EAAcC,CAAC,CAACyJ,cAAF,EAAd;AAAnB,WAAP;AAA8D;AAAC;;AAAA,UAAGlJ,CAAH,EAAK;AAAC,cAAMT,CAAC,GAAC,EAAR;;AAAW,aAAI,MAAMG,CAAV,IAAeD,CAAC,CAACmG,MAAjB,EAAwBrG,CAAC,CAACG,CAAC,CAACuE,IAAF,CAAOK,WAAP,EAAD,CAAD,GAAwB,CAAxB;;AAA0B,aAAI,MAAM7E,CAAV,IAAeC,CAAf,EAAiB,oBAAkBD,CAAC,CAACwE,IAApB,KAA2B1E,CAAC,CAACE,CAAC,CAACwE,IAAF,CAAOK,WAAP,EAAD,CAAD,GAAwB,CAAnD;;AAAsD,YAAI9E,CAAC,GAAC,CAAN;;AAAQ,aAAI,MAAMC,CAAV,IAAeC,CAAf,EAAiB,IAAG,oBAAkBD,CAAC,CAACwE,IAAvB,EAA4B;AAAC,iBAAK,MAAI1E,CAAC,CAAC,WAASC,CAAC,CAACuL,QAAF,EAAV,CAAV,GAAmCvL,CAAC;;AAAGD,UAAAA,CAAC,CAAC,WAASC,CAAC,CAACuL,QAAF,EAAV,CAAD,GAAyB,CAAzB,EAA2BtL,CAAC,CAACwE,IAAF,GAAO,WAASzE,CAAC,CAACuL,QAAF,EAA3C;AAAwD;AAAC;;AAAA,YAAM7K,CAAC,GAAC,EAAR;;AAAW,WAAI,MAAMV,CAAV,IAAeE,CAAf,EAAiBQ,CAAC,CAACgE,IAAF,CAAOH,CAAC,CAACvE,CAAC,CAACwM,UAAH,EAAc7I,CAAd,EAAgB5D,CAAhB,CAAR;;AAA4B,aAAOW,CAAC,CAAC2D,MAAF,GAAS,CAAT,GAAWL,CAAC,CAACtD,CAAD,CAAD,CAAKkE,IAAL,CAAW,MAAIjD,CAAC,CAACvB,CAAC,CAAC,CAAD,CAAD,CAAKmM,OAAL,CAAarM,CAAb,EAAe,EAAf,CAAD,CAAhB,CAAX,GAAkDyB,CAAC,CAACvB,CAAC,CAAC,CAAD,CAAD,CAAKmM,OAAL,CAAarM,CAAb,EAAe,EAAf,CAAD,CAA1D;AAA+E,KAA9mC,CAAlB,IAAooCkE,CAAC,CAAC,UAAD,EAAYnE,CAAZ,EAAcC,CAAd,EAAgBE,CAAhB,CAA3qC,CAAP;AAAusC,GAAngjB;AAAqgjB;;AAAA,SAAOkG,EAAE,IAAIqG,iBAAb","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport e from\"../ArcadePortal.js\";import t from\"../Dictionary.js\";import n from\"../Feature.js\";import r from\"../featureSetCollection.js\";import{getPortal as i,lookupUser as a,convertToFeatureSet as s,constructFeatureSetFromPortalItem as l,constructFeatureSet as o,constructFeatureSetFromRelationship as f,constructFeatureSetFromUrl as u,constructAssociationMetaDataFeatureSetFromUrl as c}from\"../featureSetUtils.js\";import d from\"../FunctionWrapper.js\";import m from\"../ImmutableArray.js\";import{p,C as y,d as g,q as h,z as F,a as I,k as E,f as D,b as w,N as b,S as A,t as N,Y as x,M as S}from\"../../chunks/languageUtils.js\";import{SqlExpressionAdapted as $,StringToCodeAdapted as L,FieldRename as T,AdaptedFeatureSet as v,OriginalField as j}from\"../featureset/actions/Adapted.js\";import O from\"../featureset/actions/AttributeFilter.js\";import C from\"../featureset/actions/OrderBy.js\";import R from\"../featureset/actions/Top.js\";import M from\"../featureset/sources/Empty.js\";import P from\"../featureset/sources/FeatureLayerMemory.js\";import k from\"../featureset/support/OrderbyClause.js\";import{cloneField as G}from\"../featureset/support/shared.js\";import{isSingleField as B}from\"../featureset/support/sqlUtils.js\";import{calculateStat as V}from\"./fieldStats.js\";import{isPromiseLike as H,resolve as z,all as W}from\"../../core/promiseUtils.js\";import{WhereClause as U}from\"../../core/sql/WhereClause.js\";import _ from\"../../layers/FeatureLayer.js\";import q from\"../../layers/support/Field.js\";function J(e,t,n,r){if(1===r.length){if(I(r[0]))return V(e,r[0],-1);if(w(r[0]))return V(e,r[0].toArray(),-1)}return V(e,r,-1)}function K(e,t,n){const r=e.getVariables();if(r.length>0){const i=[];for(let e=0;e<r.length;e++){const a={name:r[e]};i.push(t.evaluateIdentifier(n,a))}return W(i).then((t=>{const n={};for(let e=0;e<r.length;e++)n[r[e]]=t[e];return e.parameters=n,e}))}return z(e)}function Y(e,t,n=null){for(const r in e)if(r.toLowerCase()===t.toLowerCase())return e[r];return n}function Z(e){if(null===e)return null;const t={type:Y(e,\"type\",\"\"),name:Y(e,\"name\",\"\")};if(\"range\"===t.type)t.range=Y(e,\"range\",[]);else{t.codedValues=[];for(const n of Y(e,\"codedValues\",[]))t.codedValues.push({name:Y(n,\"name\",\"\"),code:Y(n,\"code\",null)})}return t}function Q(e){if(null===e)return null;const t={},n=Y(e,\"wkt\",null);null!==n&&(t.wkt=n);const r=Y(e,\"wkid\",null);return null!==r&&(t.wkid=r),t}function X(e){if(null===e)return null;const t={hasZ:Y(e,\"hasz\",!1),hasM:Y(e,\"hasm\",!1)},n=Y(e,\"spatialreference\",null);n&&(t.spatialReference=Q(n));const r=Y(e,\"x\",null);if(null!==r)return t.x=r,t.y=Y(e,\"y\",null),t;const i=Y(e,\"rings\",null);if(null!==i)return t.rings=i,t;const a=Y(e,\"paths\",null);if(null!==a)return t.paths=a,t;const s=Y(e,\"points\",null);if(null!==s)return t.points=s,t;for(const l of[\"xmin\",\"xmax\",\"ymin\",\"ymax\",\"zmin\",\"zmax\",\"mmin\",\"mmax\"]){const n=Y(e,l,null);null!==n&&(t[l]=n)}return t}function ee(e,t){for(const n of t)if(n===e)return!0;return!1}function te(e){return!!e.layerDefinition&&(!!e.featureSet&&(!1!==ee(e.layerDefinition.geometryType,[\"\",\"esriGeometryPoint\",\"esriGeometryPolyline\",\"esriGeometryPolygon\",\"esriGeometryMultipoint\",\"esriGeometryEnvelope\"])&&(null!==e.layerDefinition.objectIdField&&\"\"!==e.layerDefinition.objectIdField&&(!1!==I(e.layerDefinition.fields)&&!1!==I(e.featureSet.features)))))}function ne(V){\"async\"===V.mode&&(V.functions.getuser=function(n,r){return V.standardFunctionAsync(n,r,((r,s,l)=>{p(l,1,2);let o=y(l[1],\"\"),f=!0===o;if(o=!0===o||!1===o?\"\":g(o),l[0]instanceof e){let e=null;return n.services&&n.services.portal&&(e=n.services.portal),e=i(l[0],e),a(e,o,f).then((e=>{if(e){const n=JSON.parse(JSON.stringify(e));for(const e of[\"lastLogin\",\"created\",\"modified\"])void 0!==n[e]&&null!==n[e]&&(n[e]=new Date(n[e]));return t.convertObjectToArcadeDictionary(n)}return null}))}let u=null;if(h(l[0])&&(u=l[0]),u)return f=!1,o?null:u.load().then((()=>u.getOwningSystemUrl())).then((r=>{if(!r)return o?null:u.getIdentityUser().then((e=>e?t.convertObjectToArcadeDictionary({username:e}):null));let s=null;return n.services&&n.services.portal&&(s=n.services.portal),s=i(new e(r),s),a(s,o,f).then((e=>{if(e){const n=JSON.parse(JSON.stringify(e));for(const e of[\"lastLogin\",\"created\",\"modified\"])void 0!==n[e]&&null!==n[e]&&(n[e]=new Date(n[e]));return t.convertObjectToArcadeDictionary(n)}return null}))}));throw new Error(\"Invalid Parameter\")}))},V.signatures.push({name:\"getuser\",min:\"1\",max:\"2\"}),V.functions.featuresetbyid=function(e,t){return V.standardFunctionAsync(e,t,((e,t,n)=>{if(p(n,2,4),n[0]instanceof r){const e=g(n[1]);let t=y(n[2],null);const r=F(y(n[3],!0));if(null===t&&(t=[\"*\"]),!1===I(t))throw new Error(\"Invalid Parameter\");return n[0].featureSetById(e,r,t)}throw new Error(\"Invalid Parameter\")}))},V.signatures.push({name:\"featuresetbyid\",min:\"2\",max:\"4\"}),V.functions.getfeatureset=function(e,t){return V.standardFunctionAsync(e,t,((t,n,r)=>{if(p(r,1,2),E(r[0])){let t=y(r[1],\"datasource\");return null===t&&(t=\"datasource\"),t=g(t).toLowerCase(),s(r[0].fullSchema(),t,e.lrucache,e.interceptor,e.spatialReference)}throw new Error(\"Invalid Parameter\")}))},V.signatures.push({name:\"getfeatureset\",min:\"1\",max:\"2\"}),V.functions.featuresetbyportalitem=function(t,n){return V.standardFunctionAsync(t,n,((n,r,a)=>{if(p(a,2,5),null===a[0])throw new Error(\"Portal is required\");if(a[0]instanceof e){const e=g(a[1]),n=g(a[2]);let r=y(a[3],null);const s=F(y(a[4],!0));if(null===r&&(r=[\"*\"]),!1===I(r))throw new Error(\"Invalid Parameter\");let o=null;return t.services&&t.services.portal&&(o=t.services.portal),o=i(a[0],o),l(e,n,t.spatialReference,r,s,o,t.lrucache,t.interceptor)}if(!1===D(a[0]))throw new Error(\"Portal is required\");const s=g(a[0]),o=g(a[1]);let f=y(a[2],null);const u=F(y(a[3],!0));if(null===f&&(f=[\"*\"]),!1===I(f))throw new Error(\"Invalid Parameter\");if(t.services&&t.services.portal)return l(s,o,t.spatialReference,f,u,t.services.portal,t.lrucache,t.interceptor);throw new Error(\"Portal is required\")}))},V.signatures.push({name:\"featuresetbyportalitem\",min:\"2\",max:\"5\"}),V.functions.featuresetbyname=function(e,t){return V.standardFunctionAsync(e,t,((e,t,n)=>{if(p(n,2,4),n[0]instanceof r){const e=g(n[1]);let t=y(n[2],null);const r=F(y(n[3],!0));if(null===t&&(t=[\"*\"]),!1===I(t))throw new Error(\"Invalid Parameter\");return n[0].featureSetByName(e,r,t)}throw new Error(\"Invalid Parameter\")}))},V.signatures.push({name:\"featuresetbyname\",min:\"2\",max:\"4\"}),V.functions.featureset=function(e,n){return V.standardFunction(e,n,((n,r,i)=>{p(i,1,1);let a=i[0];const s={layerDefinition:{geometryType:\"\",objectIdField:\"\",globalIdField:\"\",typeIdField:\"\",fields:[]},featureSet:{geometryType:\"\",features:[]}};if(D(a))a=JSON.parse(a),void 0!==a.layerDefinition?(s.layerDefinition=a.layerDefinition,s.featureSet=a.featureSet,a.layerDefinition.spatialReference&&(s.layerDefinition.spatialReference=a.layerDefinition.spatialReference)):(s.featureSet.features=a.features,s.featureSet.geometryType=a.geometryType,s.layerDefinition.geometryType=s.featureSet.geometryType,s.layerDefinition.objectIdField=a.objectIdFieldName,s.layerDefinition.typeIdField=a.typeIdFieldName,s.layerDefinition.globalIdField=a.globalIdFieldName,s.layerDefinition.fields=a.fields,a.spatialReference&&(s.layerDefinition.spatialReference=a.spatialReference));else{if(!(i[0]instanceof t))throw new Error(\"Invalid Parameter\");{a=JSON.parse(i[0].castToText());const e=Y(a,\"layerdefinition\");if(null!==e){s.layerDefinition.geometryType=Y(e,\"geometrytype\",\"\"),s.featureSet.geometryType=s.layerDefinition.geometryType,s.layerDefinition.globalIdField=Y(e,\"globalidfield\",\"\"),s.layerDefinition.objectIdField=Y(e,\"objectidfield\",\"\"),s.layerDefinition.typeIdField=Y(e,\"typeidfield\",\"\");const t=Y(e,\"spatialreference\",null);t&&(s.layerDefinition.spatialReference=Q(t));for(const r of Y(e,\"fields\",[])){const e={name:Y(r,\"name\",\"\"),alias:Y(r,\"alias\",\"\"),type:Y(r,\"type\",\"\"),nullable:Y(r,\"nullable\",!0),editable:Y(r,\"editable\",!0),length:Y(r,\"length\",null),domain:Z(Y(r,\"domain\"))};s.layerDefinition.fields.push(e)}const n=Y(a,\"featureset\",null);if(n){const e={};for(const t of s.layerDefinition.fields)e[t.name.toLowerCase()]=t.name;for(const t of Y(n,\"features\",[])){const n={},r=Y(t,\"attributes\",{});for(const t in r)n[e[t.toLowerCase()]]=r[t];s.featureSet.features.push({attributes:n,geometry:X(Y(t,\"geometry\",null))})}}}else{s.layerDefinition.geometryType=Y(a,\"geometrytype\",\"\"),s.featureSet.geometryType=s.layerDefinition.geometryType,s.layerDefinition.objectIdField=Y(a,\"objectidfieldname\",\"\"),s.layerDefinition.typeIdField=Y(a,\"typeidfieldname\",\"\");const e=Y(a,\"spatialreference\",null);e&&(s.layerDefinition.spatialReference=Q(e));for(const n of Y(a,\"fields\",[])){const e={name:Y(n,\"name\",\"\"),alias:Y(n,\"alias\",\"\"),type:Y(n,\"type\",\"\"),nullable:Y(n,\"nullable\",!0),editable:Y(n,\"editable\",!0),length:Y(n,\"length\",null),domain:Z(Y(n,\"domain\"))};s.layerDefinition.fields.push(e)}const t={};for(const n of s.layerDefinition.fields)t[n.name.toLowerCase()]=n.name;for(const n of Y(a,\"features\",[])){const e={},r=Y(n,\"attributes\",{});for(const n in r)e[t[n.toLowerCase()]]=r[n];s.featureSet.features.push({attributes:e,geometry:X(Y(n,\"geometry\",null))})}}}}if(!1===te(s))throw new Error(\"Invalid Parameter\");return P.create(s,e.spatialReference)}))},V.signatures.push({name:\"featureset\",min:\"1\",max:\"1\"}),V.functions.filter=function(e,t){return V.standardFunctionAsync(e,t,((t,n,r)=>{if(p(r,2,2),I(r[0])||w(r[0])){const t=[];let n=r[0];n instanceof m&&(n=n.toArray());let i=null;if(r[1]instanceof d)i=V.arcadeCustomFunctionHandler(r[1]);else if(r[1]instanceof b)i=(...t)=>r[1].fn(e,{preparsed:!0,arguments:t});else{if(!(r[1]instanceof A))throw new Error(\"Invalid Parameter\");i=(...e)=>{if(e.length!==r[1].paramCount)throw new Error(\"Invalid parameters\");return r[1].fn(...e)}}return n.reduce(((e,r,a)=>e.then((e=>{a>0&&!0===e&&t.push(n[a-1]);const s=i(r);return H(s)?s:z(s)}))),Promise.resolve(!1)).then((e=>(!0===e&&n.length>0&&t.push(n[n.length-1]),t)))}return h(r[0])?r[0].load().then((t=>{const n=U.create(r[1],t.getFieldsIndex()),i=n.getVariables();if(i.length>0){const t=[];for(let n=0;n<i.length;n++){const r={name:i[n]};t.push(V.evaluateIdentifier(e,r))}return W(t).then((e=>{const t={};for(let n=0;n<i.length;n++)t[i[n]]=e[n];return n.parameters=t,new O({parentfeatureset:r[0],whereclause:n})}))}return z(new O({parentfeatureset:r[0],whereclause:n}))})):V.failDefferred(\"Filter cannot accept this parameter type\")}))},V.signatures.push({name:\"filter\",min:\"2\",max:\"2\"}),V.functions.orderby=function(e,t){return V.standardFunctionAsync(e,t,((e,t,n)=>{if(p(n,2,2),h(n[0])){const e=new k(n[1]);return z(new C({parentfeatureset:n[0],orderbyclause:e}))}return V.failDefferred(\"Order cannot accept this parameter type\")}))},V.signatures.push({name:\"orderby\",min:\"2\",max:\"2\"}),V.functions.top=function(e,t){return V.standardFunctionAsync(e,t,((e,t,n)=>(p(n,2,2),h(n[0])?z(new R({parentfeatureset:n[0],topnum:n[1]})):I(n[0])?N(n[1])>=n[0].length?n[0].slice(0):n[0].slice(0,N(n[1])):w(n[0])?N(n[1])>=n[0].length()?n[0].slice(0):n[0].slice(0,N(n[1])):V.failDefferred(\"Top cannot accept this parameter type\"))))},V.signatures.push({name:\"top\",min:\"2\",max:\"2\"}),V.functions.first=function(e,t){return V.standardFunctionAsync(e,t,((e,t,r)=>(p(r,1,1),h(r[0])?r[0].first(e.abortSignal).then((e=>{if(null!==e){const t=n.createFromGraphicLikeObject(e.geometry,e.attributes,r[0]);t._underlyingGraphic=e,e=t}return e})):I(r[0])?0===r[0].length?z(null):z(r[0][0]):w(r[0])?0===r[0].length()?z(null):z(r[0].get(0)):null)))},V.signatures.push({name:\"first\",min:\"1\",max:\"1\"}),V.functions.attachments=function(e,n){return V.standardFunctionAsync(e,n,((n,r,i)=>{p(i,1,2);const a={minsize:-1,maxsize:-1,types:null,returnMetadata:!1};if(i.length>1)if(i[1]instanceof t){if(i[1].hasField(\"minsize\")&&(a.minsize=N(i[1].field(\"minsize\"))),i[1].hasField(\"metadata\")&&(a.returnMetadata=F(i[1].field(\"metadata\"))),i[1].hasField(\"maxsize\")&&(a.maxsize=N(i[1].field(\"maxsize\"))),i[1].hasField(\"types\")){const e=x(i[1].field(\"types\"),!1);e.length>0&&(a.types=e)}}else if(null!==i[1])throw new Error(\"Invalid Parameter\");if(E(i[0])){let t=i[0]._layer;return t instanceof _&&(t=o(t,e.spatialReference,[\"*\"],!0,e.lrucache,e.interceptor)),null===t||!1===h(t)?[]:t.load().then((()=>t.queryAttachments(i[0].field(t.objectIdField),a.minsize,a.maxsize,a.types,a.returnMetadata)))}if(null===i[0])return[];throw new Error(\"Invalid Parameter\")}))},V.signatures.push({name:\"attachments\",min:\"1\",max:\"2\"}),V.functions.featuresetbyrelationshipname=function(e,t){return V.standardFunctionAsync(e,t,((t,n,r)=>{p(r,2,4);const i=r[0],a=g(r[1]);let s=y(r[2],null);const l=F(y(r[3],!0));if(null===s&&(s=[\"*\"]),!1===I(s))throw new Error(\"Invalid Parameter\");if(null===r[0])return null;if(!E(r[0]))throw new Error(\"Invalid Parameter\");let c=i._layer;return c instanceof _&&(c=o(c,e.spatialReference,[\"*\"],!0,e.lrucache,e.interceptor)),null===c||!1===h(c)?null:c.load().then((t=>{const n=t.relationshipMetaData().filter((e=>e.name===a));if(0===n.length)return null;if(void 0!==n[0].relationshipTableId&&null!==n[0].relationshipTableId&&n[0].relationshipTableId>-1)return f(t,n[0],i.field(t.objectIdField),t.spatialReference,s,l,e.lrucache,e.interceptor);let r=t.serviceUrl();return r?(r=\"/\"===r.charAt(r.length-1)?r+n[0].relatedTableId.toString():r+\"/\"+n[0].relatedTableId.toString(),u(r,t.spatialReference,s,l,e.lrucache,e.interceptor).then((e=>e.load().then((()=>e.relationshipMetaData())).then((r=>{if(r=r.filter((e=>e.id===n[0].id)),!1===i.hasField(n[0].keyField)||null===i.field(n[0].keyField))return t.getFeatureByObjectId(i.field(t.objectIdField),[n[0].keyField]).then((t=>{if(t){const i=U.create(r[0].keyField+\"= @id\",e.getFieldsIndex());return i.parameters={id:t.attributes[n[0].keyField]},e.filter(i)}return new M({parentfeatureset:e})}));const a=U.create(r[0].keyField+\"= @id\",e.getFieldsIndex());return a.parameters={id:i.field(n[0].keyField)},e.filter(a)}))))):null}))}))},V.signatures.push({name:\"featuresetbyrelationshipname\",min:\"2\",max:\"4\"}),V.functions.featuresetbyassociation=function(e,t){return V.standardFunctionAsync(e,t,((t,n,r)=>{p(r,2,3);const i=r[0],a=g(y(r[1],\"\")).toLowerCase(),s=D(r[2])?g(r[2]):null;if(null===r[0])return null;if(!E(r[0]))throw new Error(\"Invalid Parameter\");let l=i._layer;return l instanceof _&&(l=o(l,e.spatialReference,[\"*\"],!0,e.lrucache,e.interceptor)),null===l||!1===h(l)?null:l.load().then((()=>{const t=l.serviceUrl();return c(t,e.spatialReference)})).then((e=>{let t=null,n=null,r=!1;if(null!==s&&\"\"!==s&&void 0!==s){for(const t of e.terminals)t.terminalName===s&&(n=t.terminalId);null===n&&(r=!0)}const o=e.associations.getFieldsIndex(),f=o.get(\"TOGLOBALID\").name,u=o.get(\"FROMGLOBALID\").name,c=o.get(\"TOTERMINALID\").name,d=o.get(\"FROMTERMINALID\").name,m=o.get(\"FROMNETWORKSOURCEID\").name,p=o.get(\"TONETWORKSOURCEID\").name,y=o.get(\"ASSOCIATIONTYPE\").name,g=o.get(\"ISCONTENTVISIBLE\").name,h=o.get(\"OBJECTID\").name;for(const a of l.fields)if(\"global-id\"===a.type){t=i.field(a.name);break}let F=null,I=new $(new q({name:\"percentalong\",alias:\"percentalong\",type:\"double\"}),U.create(\"0\",e.associations.getFieldsIndex())),E=new $(new q({name:\"side\",alias:\"side\",type:\"string\"}),U.create(\"''\",e.associations.getFieldsIndex()));const D=\"globalid\",w=\"globalId\",b={};for(const i in e.lkp)b[i]=e.lkp[i].sourceId;const A=new L(new q({name:\"classname\",alias:\"classname\",type:\"string\"}),null,b);let N=\"\";switch(a){case\"midspan\":{N=`((${f}='${t}') OR ( ${u}='${t}')) AND (${y} IN (5))`,A.codefield=U.create(`CASE WHEN (${f}='${t}') THEN ${m} ELSE ${p} END`,e.associations.getFieldsIndex());const n=G(v.findField(e.associations.fields,u));n.name=D,n.alias=D,F=new $(n,U.create(`CASE WHEN (${u}='${t}') THEN ${f} ELSE ${u} END`,e.associations.getFieldsIndex())),I=e.unVersion>=4?new j(v.findField(e.associations.fields,o.get(\"PERCENTALONG\").name)):new $(new q({name:\"percentalong\",alias:\"percentalong\",type:\"double\"}),U.create(\"0\",e.associations.getFieldsIndex()));break}case\"junctionedge\":{N=`((${f}='${t}') OR ( ${u}='${t}')) AND (${y} IN (4,6))`,A.codefield=U.create(`CASE WHEN (${f}='${t}') THEN ${m} ELSE ${p} END`,e.associations.getFieldsIndex());const n=G(v.findField(e.associations.fields,u));n.name=D,n.alias=D,F=new $(n,U.create(`CASE WHEN (${u}='${t}') THEN ${f} ELSE ${u} END`,e.associations.getFieldsIndex())),E=new $(new q({name:\"side\",alias:\"side\",type:\"string\"}),U.create(`CASE WHEN (${y}=4) THEN 'from' ELSE 'to' END`,e.associations.getFieldsIndex()));break}case\"connected\":{let r=`${f}='@T'`,i=`${u}='@T'`;null!==n&&(r+=` AND ${c}=@A`,i+=` AND ${d}=@A`),N=\"((\"+r+\") OR (\"+i+\"))\",N=S(N,\"@T\",t),r=S(r,\"@T\",t),null!==n&&(r=S(r,\"@A\",n.toString()),N=S(N,\"@A\",n.toString())),A.codefield=U.create(\"CASE WHEN \"+r+` THEN ${m} ELSE ${p} END`,e.associations.getFieldsIndex());const a=G(v.findField(e.associations.fields,u));a.name=D,a.alias=D,F=new $(a,U.create(\"CASE WHEN \"+r+` THEN ${u} ELSE ${f} END`,e.associations.getFieldsIndex()));break}case\"container\":N=`${f}='${t}' AND ${y} = 2`,null!==n&&(N+=` AND ${c} = `+n.toString()),A.codefield=m,N=\"( \"+N+\" )\",F=new T(v.findField(e.associations.fields,u),D,D);case\"content\":N=`(${u}='${t}' AND ${y} = 2)`,null!==n&&(N+=` AND ${d} = `+n.toString()),A.codefield=p,N=\"( \"+N+\" )\",F=new T(v.findField(e.associations.fields,f),D,D);break;case\"structure\":N=`(${f}='${t}' AND ${y} = 3)`,null!==n&&(N+=` AND ${c} = `+n.toString()),A.codefield=m,N=\"( \"+N+\" )\",F=new T(v.findField(e.associations.fields,u),D,w);break;case\"attached\":N=`(${u}='${t}' AND ${y} = 3)`,null!==n&&(N+=` AND ${d} = `+n.toString()),A.codefield=p,N=\"( \"+N+\" )\",F=new T(v.findField(e.associations.fields,f),D,w);break;default:throw new Error(\"Invalid Parameter\")}r&&(N=\"1 <> 1\");return new v({parentfeatureset:e.associations,adaptedFields:[new j(v.findField(e.associations.fields,h)),new j(v.findField(e.associations.fields,g)),F,E,A,I],extraFilter:N?U.create(N,e.associations.getFieldsIndex()):null})}))}))},V.signatures.push({name:\"featuresetbyassociation\",min:\"2\",max:\"6\"}),V.functions.groupby=function(e,n){return V.standardFunctionAsync(e,n,((n,r,i)=>(p(i,3,3),h(i[0])?i[0].load().then((n=>{const r=[],a=[];let s=!1,l=[];if(D(i[1]))l.push(i[1]);else if(i[1]instanceof t)l.push(i[1]);else if(I(i[1]))l=i[1];else{if(!w(i[1]))return V.failDefferred(\"Illegal Value: GroupBy\");l=i[1].toArray()}for(const e of l)if(D(e)){const t=U.create(g(e),n.getFieldsIndex()),i=!0===B(t)?g(e):\"%%%%FIELDNAME\";r.push({name:i,expression:t}),\"%%%%FIELDNAME\"===i&&(s=!0)}else{if(!(e instanceof t))return V.failDefferred(\"Illegal Value: GroupBy\");{const t=e.hasField(\"name\")?e.field(\"name\"):\"%%%%FIELDNAME\",i=e.hasField(\"expression\")?e.field(\"expression\"):\"\";if(\"%%%%FIELDNAME\"===t&&(s=!0),!t)return V.failDefferred(\"Illegal Value: GroupBy\");r.push({name:t,expression:U.create(i||t,n.getFieldsIndex())})}}if(l=[],D(i[2]))l.push(i[2]);else if(I(i[2]))l=i[2];else if(w(i[2]))l=i[2].toArray();else{if(!(i[2]instanceof t))return V.failDefferred(\"Illegal Value: GroupBy\");l.push(i[2])}for(const e of l){if(!(e instanceof t))return V.failDefferred(\"Illegal Value: GroupBy\");{const t=e.hasField(\"name\")?e.field(\"name\"):\"\",r=e.hasField(\"statistic\")?e.field(\"statistic\"):\"\",i=e.hasField(\"expression\")?e.field(\"expression\"):\"\";if(!t||!r||!i)return V.failDefferred(\"Illegal Value: GroupBy\");a.push({name:t,statistic:r.toLowerCase(),expression:U.create(i,n.getFieldsIndex())})}}if(s){const e={};for(const r of n.fields)e[r.name.toLowerCase()]=1;for(const n of r)\"%%%%FIELDNAME\"!==n.name&&(e[n.name.toLowerCase()]=1);for(const n of a)\"%%%%FIELDNAME\"!==n.name&&(e[n.name.toLowerCase()]=1);let t=0;for(const n of r)if(\"%%%%FIELDNAME\"===n.name){for(;1===e[\"field_\"+t.toString()];)t++;e[\"field_\"+t.toString()]=1,n.name=\"FIELD_\"+t.toString()}}const o=[];for(const t of r)o.push(K(t.expression,V,e));for(const t of a)o.push(K(t.expression,V,e));return o.length>0?W(o).then((()=>z(i[0].groupby(r,a)))):z(i[0].groupby(r,a))})):V.failDefferred(\"Illegal Value: GroupBy\"))))},V.signatures.push({name:\"groupby\",min:\"3\",max:\"3\"}),V.functions.distinct=function(e,n){return V.standardFunctionAsync(e,n,((n,r,i)=>h(i[0])?(p(i,2,2),i[0].load().then((n=>{const r=[];let a=[];if(D(i[1]))a.push(i[1]);else if(i[1]instanceof t)a.push(i[1]);else if(I(i[1]))a=i[1];else{if(!w(i[1]))return V.failDefferred(\"Illegal Value: GroupBy\");a=i[1].toArray()}let s=!1;for(const e of a)if(D(e)){const t=U.create(g(e),n.getFieldsIndex()),i=!0===B(t)?g(e):\"%%%%FIELDNAME\";r.push({name:i,expression:t}),\"%%%%FIELDNAME\"===i&&(s=!0)}else{if(!(e instanceof t))return V.failDefferred(\"Illegal Value: GroupBy\");{const t=e.hasField(\"name\")?e.field(\"name\"):\"%%%%FIELDNAME\",i=e.hasField(\"expression\")?e.field(\"expression\"):\"\";if(\"%%%%FIELDNAME\"===t&&(s=!0),!t)return V.failDefferred(\"Illegal Value: GroupBy\");r.push({name:t,expression:U.create(i||t,n.getFieldsIndex())})}}if(s){const e={};for(const r of n.fields)e[r.name.toLowerCase()]=1;for(const n of r)\"%%%%FIELDNAME\"!==n.name&&(e[n.name.toLowerCase()]=1);let t=0;for(const n of r)if(\"%%%%FIELDNAME\"===n.name){for(;1===e[\"field_\"+t.toString()];)t++;e[\"field_\"+t.toString()]=1,n.name=\"FIELD_\"+t.toString()}}const l=[];for(const t of r)l.push(K(t.expression,V,e));return l.length>0?W(l).then((()=>z(i[0].groupby(r,[])))):z(i[0].groupby(r,[]))}))):J(\"distinct\",n,r,i)))})}export{ne as registerFunctions};\n"]},"metadata":{},"sourceType":"module"}