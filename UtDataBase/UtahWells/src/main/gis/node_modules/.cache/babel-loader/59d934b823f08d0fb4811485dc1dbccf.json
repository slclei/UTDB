{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../chunks/tslib.es6.js\";\nimport t from \"../Graphic.js\";\nimport i from \"../Viewpoint.js\";\nimport s from \"../core/Collection.js\";\nimport n from \"../core/CollectionFlattener.js\";\nimport r from \"../core/Error.js\";\nimport a from \"../core/has.js\";\nimport { isIterable as o } from \"../core/iteratorUtils.js\";\nimport l from \"../core/Logger.js\";\nimport { isSome as p, unwrap as h, isNone as c } from \"../core/maybe.js\";\nimport { throwIfAborted as d } from \"../core/promiseUtils.js\";\nimport { watch as u, whenOnce as m, sync as g, syncAndInitial as f } from \"../core/reactiveUtils.js\";\nimport { createScreenPoint as w } from \"../core/screenUtils.js\";\nimport y from \"../core/Warning.js\";\nimport { initialize as v } from \"../core/workers/workers.js\";\nimport { property as _ } from \"../core/accessorSupport/decorators/property.js\";\nimport \"../core/arrayUtils.js\";\nimport \"../core/accessorSupport/ensureType.js\";\nimport { subclass as V } from \"../core/accessorSupport/decorators/subclass.js\";\nimport S from \"../geometry/Extent.js\";\nimport j from \"../geometry/Point.js\";\nimport { load as T, canProjectWithoutEngine as R, project as b, isLoaded as x } from \"../geometry/projection.js\";\nimport { equals as M } from \"../geometry/support/spatialReferenceUtils.js\";\nimport O from \"../layers/support/TileInfo.js\";\nimport { BreakpointsOwner as k } from \"./BreakpointsOwner.js\";\nimport { DOMContainer as z } from \"./DOMContainer.js\";\nimport { PopupView as L } from \"./PopupView.js\";\nimport P from \"./View.js\";\nimport C from \"./ViewAnimation.js\";\nimport E from \"./2d/AnimationManager.js\";\nimport G from \"./2d/FrameTask.js\";\nimport { layerView2DImporter as N } from \"./2d/layerViewModuleImportUtils.js\";\nimport D from \"./2d/MapViewConstraints.js\";\nimport q from \"./2d/PaddedViewState.js\";\nimport \"./2d/tiling/PagedTileQueue.js\";\nimport U from \"./2d/tiling/TileInfoView.js\";\nimport \"./2d/tiling/TileKey.js\";\nimport \"./2d/tiling/TileQueue.js\";\nimport \"./2d/tiling/TileStrategy.js\";\nimport { centerAt as A, setExtent as I, rotateTo as F, scaleTo as W, copy as B, create as H, extentToScale as $, resize as J, angleBetween as Q } from \"./2d/viewpointUtils.js\";\nimport Z from \"./2d/input/MapViewInputManager.js\";\nimport K from \"./2d/layers/features/support/TileStore.js\";\nimport X from \"./2d/support/HighlightOptions.js\";\nimport { Timeline as Y } from \"./2d/support/Timeline.js\";\nimport ee from \"./support/createScreenshotPlan.js\";\nimport { getMaximumResolutionScale as te, getFormatAndQuality as ie } from \"./support/screenshotUtils.js\";\nimport { isSupportedScreenPointEvent as se, createScreenPointFromSupportedEvent as ne } from \"./support/screenUtils.js\";\nimport { check as re } from \"./support/WebGLRequirements.js\";\nimport ae from \"./ui/2d/DefaultUI2D.js\";\nimport oe from \"../webmap/background/ColorBackground.js\";\nconst le = l.getLogger(\"esri.views.MapView\");\nlet pe, he, ce, de, ue, me;\n\nasync function ge() {\n  const [, {\n    GraphicsView2D: e,\n    GraphicContainer: t,\n    LabelManager: i,\n    MapViewNavigation: s,\n    MagnifierView2D: n,\n    Stage: r\n  }] = await Promise.all([import(\"./2d/webglDeps.js\"), import(\"./2d/mapViewDeps.js\")]);\n  he = e, ce = t, de = i, ue = s, me = n, pe = r;\n}\n\nconst fe = 160;\n\nfunction we(e) {\n  return e && \"esri.Viewpoint\" === e.declaredClass;\n}\n\nlet ye = class extends k(z(L(P))) {\n  constructor(e) {\n    super(e), this._magnifierView = null, this._stage = null, this._resolveWhenReady = [], this.rootLayerViews = new n({\n      getCollections: () => {\n        var e, t;\n        return [null == (e = this.basemapView) ? void 0 : e.baseLayerViews, this.layerViews, null == (t = this.basemapView) ? void 0 : t.referenceLayerViews];\n      },\n      getChildrenFunction: () => null\n    }), this.featuresTilingScheme = null, this.fullOpacity = 1, this.graphicsView = null, this.labelManager = null, this.mapViewNavigation = null, this.renderingOptions = {\n      samplingMode: \"dynamic\",\n      edgeLabelsVisible: !0,\n      labelsAnimationTime: 125,\n      labelCollisionsEnabled: !0\n    }, this.rendering = !1, this.supersampleScreenshotsEnabled = !1, this.supportsGround = !1, this._stationaryTimer = null, this.frameTask = new G(this), this._pePromise = null, this.floors = new s(), this.highlightOptions = new X(), this.inputManager = new Z({\n      view: this\n    }), this.map = null, this.resizeAlign = \"center\", this.spatialReferenceLocked = !1, this.timeline = new Y(), this.type = \"2d\", this.ui = new ae(), this.constraints = new D(), this.padding = {\n      top: 0,\n      right: 0,\n      bottom: 0,\n      left: 0\n    }, this.handles.add([u(() => this.viewpoint, () => {\n      this._lastStationaryEventTimestamp = performance.now(), this._flipStationary(fe);\n    }, g), this.on(\"resize\", e => this._resizeHandler(e)), u(() => {\n      var e;\n      return null == (e = this.animationManager) ? void 0 : e.animation;\n    }, e => {\n      this.animation = e;\n    })]), v();\n  }\n\n  destroy() {\n    this._set(\"preconditionsReady\", !1), this._gotoTask = this.frameTask = null, this.rootLayerViews.destroy(), this.inputManager.destroy(), this._set(\"inputManager\", null);\n  }\n\n  get graphicsTileStore() {\n    return new K(this.featuresTilingScheme);\n  }\n\n  get initialExtentRequired() {\n    var e;\n    const {\n      scale: t,\n      constraints: i,\n      center: s,\n      viewpoint: n,\n      extent: r\n    } = this;\n    let a = this.zoom;\n    return !(this.map && \"initialViewProperties\" in this.map && null != (e = this.map.initialViewProperties) && e.viewpoint) && !r && (null != i && i.effectiveLODs || (a = -1), (!s || 0 === t && -1 === a) && (!n || !p(n.targetGeometry) || \"extent\" !== n.targetGeometry.type && !n.scale));\n  }\n\n  get resourceManager() {\n    return this._stage.resourceManager;\n  }\n\n  get textureManager() {\n    return this._stage.painter.textureManager;\n  }\n\n  get _defaultsFromMapSettings() {\n    return {\n      required: {\n        tileInfo: !0,\n        heightModelInfo: !1,\n        extent: !1\n      },\n      requiresExtentInSpatialReference: this.spatialReferenceLocked\n    };\n  }\n\n  get _projectionEngineLoaded() {\n    return !!x() || (this._pePromise || (this._pePromise = T().finally(() => {\n      this._pePromise = null;\n    })), !1);\n  }\n\n  get typeSpecificPreconditionsReady() {\n    const e = this._getDefaultViewpoint();\n\n    if (!e) return !1;\n    const t = this.spatialReference,\n          i = h(e.targetGeometry);\n    return !!R(i.spatialReference, t) || this._projectionEngineLoaded;\n  }\n\n  set animation(e) {\n    const t = this._get(\"animation\");\n\n    if (e === t) return;\n    if (t && t.stop(), !e || e.isFulfilled()) return void this._set(\"animation\", null);\n    this._set(\"animation\", e), this.frameTask.animationInProgress = !0;\n\n    const i = () => {\n      e === this._get(\"animation\") && (this._set(\"animation\", null), this.frameTask.requestFrame()), this.frameTask.animationInProgress = !1;\n    };\n\n    e.when(i, i);\n  }\n\n  get background() {\n    return this.get(\"map.initialViewProperties.background\") || null;\n  }\n\n  set background(e) {\n    void 0 === e ? this._clearOverride(\"background\") : this._override(\"background\", e);\n  }\n\n  get center() {\n    if (!this.ready) return this._get(\"center\");\n    const {\n      center: e,\n      spatialReference: t\n    } = this.state.paddedViewState;\n    return new j({\n      x: e[0],\n      y: e[1],\n      spatialReference: t\n    });\n  }\n\n  set center(e) {\n    if (null == e) return;\n    if (!this.ready) return this._set(\"center\", e), void this.notifyChange(\"initialExtentRequired\");\n    let t;\n\n    try {\n      t = this._project(e, this.spatialReference);\n    } catch (s) {\n      return void le.error(new r(\"mapview:invalid-center\", \"could not project the value in the view's spatial reference\", {\n        input: e,\n        error: s\n      }));\n    }\n\n    const i = this.viewpoint;\n    A(i, i, t), this.viewpoint = i;\n  }\n\n  set constraints(e) {\n    const t = this._get(\"constraints\");\n\n    t && (this.handles.remove(\"map-view-constraints\"), t.destroy()), this._set(\"constraints\", e), e && (e.view = this, this.ready && (this.state.viewpoint = e.fit(this.state.paddedViewState.viewpoint)), this.handles.add(u(() => e.version, () => {\n      this.ready && this.state && (this.state.viewpoint = e.fit(this.state.paddedViewState.viewpoint));\n    }, g), \"map-view-constraints\"));\n  }\n\n  get extent() {\n    return this.ready ? this.state.paddedViewState.extent.clone() : this._get(\"extent\");\n  }\n\n  set extent(e) {\n    if (null == e) return;\n    if (!e.width || !e.height) return void le.error(new r(\"mapview:invalid-extent\", \"invalid extent size\"));\n    if (!this.ready) return this._set(\"extent\", e), this._set(\"center\", null), this._set(\"viewpoint\", null), this._set(\"scale\", 0), this._set(\"zoom\", -1), void this.notifyChange(\"initialExtentRequired\");\n    let t;\n\n    try {\n      t = this._project(e, this.spatialReference);\n    } catch (s) {\n      return void le.error(new r(\"mapview:invalid-extent\", \"could not project the value in the view's spatial reference\", {\n        error: s\n      }));\n    }\n\n    const i = this.viewpoint;\n    I(i, i, t, this.size, {\n      constraints: this.constraints\n    }), this.viewpoint = i;\n  }\n\n  get padding() {\n    return this.ready ? this.state.padding : this._get(\"padding\");\n  }\n\n  set padding(e) {\n    this.ready ? (this.state.padding = e, this._set(\"padding\", this.state.padding)) : this._set(\"padding\", e);\n  }\n\n  get resolution() {\n    return this.state ? this.state.resolution : 0;\n  }\n\n  get rotation() {\n    return this.ready ? this.state.rotation : this._get(\"rotation\");\n  }\n\n  set rotation(e) {\n    if (isNaN(e)) return;\n    if (!this.ready) return void this._set(\"rotation\", e);\n    const t = this.viewpoint;\n    F(t, t, e), this.viewpoint = t;\n  }\n\n  get scale() {\n    return this.ready ? this.state.scale : this._get(\"scale\");\n  }\n\n  set scale(e) {\n    if (!e || isNaN(e)) return;\n\n    if (!this.ready) {\n      this._set(\"scale\", e), this._set(\"zoom\", -1);\n\n      const t = this._get(\"extent\");\n\n      return t && (this._set(\"extent\", null), this._set(\"center\", t.center)), void this.notifyChange(\"initialExtentRequired\");\n    }\n\n    const t = this.viewpoint;\n    W(t, t, e), this.viewpoint = t;\n  }\n\n  get stationary() {\n    return !(this.animation || this.navigating || this.resizing || this._stationaryTimer);\n  }\n\n  get updating() {\n    return !this.destroyed && (!this.layerViewManager || !this.labelManager || !this.graphicsView || !0 === this.layerViewManager.updating || !0 === this.labelManager.updating || !0 === this.graphicsView.updating || this.allLayerViews.some(e => !e.destroyed && !(\"layerViews\" in e) && !0 === e.updating));\n  }\n\n  get viewpoint() {\n    if (!this.ready) return this._get(\"viewpoint\");\n    const e = this.state.paddedViewState;\n    return e && e.viewpoint.clone();\n  }\n\n  set viewpoint(e) {\n    if (null == e) return;\n    if (!this.ready) return this._set(\"viewpoint\", e), this._set(\"extent\", null), this._set(\"center\", null), this._set(\"zoom\", -1), this._set(\"scale\", 0), void this.notifyChange(\"initialExtentRequired\");\n    let t, s;\n\n    try {\n      t = this._project(e, this.spatialReference), !e.scale || isNaN(e.scale) ? s = new r(\"mapview:invalid-viewpoint\", `invalid scale value of ${e.scale}`) : c(e.targetGeometry) && (s = new r(\"mapview:invalid-viewpoint\", \"geometry not defined\"));\n    } catch (a) {\n      s = new r(\"mapview:invalid-viewpoint\", \"could not project the value in the view's spatial reference\", {\n        error: a\n      });\n    }\n\n    if (s) return void le.error(s);\n    this._scaleBeforeChangingSpatialReference = null;\n    const n = new i({\n      targetGeometry: new j(),\n      scale: 0,\n      rotation: 0\n    });\n    B(n, t), this.constraints.constrain(n, this.state.paddedViewState.viewpoint), this.state.viewpoint = n, this.frameTask.requestFrame(), this._set(\"viewpoint\", n);\n  }\n\n  get zoom() {\n    return this.ready ? this.constraints.scaleToZoom(this.scale) : this._get(\"zoom\");\n  }\n\n  set zoom(e) {\n    if (null == e) return;\n\n    if (!this.ready) {\n      this._set(\"zoom\", e), this._set(\"scale\", 0);\n\n      const t = this._get(\"extent\");\n\n      return t && (this._set(\"extent\", null), this._set(\"center\", t.center)), void this.notifyChange(\"initialExtentRequired\");\n    }\n\n    if (!this.constraints.effectiveLODs) return void this._set(\"zoom\", -1);\n    const t = this.viewpoint;\n    W(t, t, this.constraints.zoomToScale(e)), this.viewpoint = t, this._set(\"zoom\", this.constraints.scaleToZoom(this.scale));\n  }\n\n  get navigating() {\n    return !(!this.mapViewNavigation || !this.mapViewNavigation.interacting);\n  }\n\n  goTo(e, t) {\n    if (e) return this.animation && (this.animation = null), this._createAnimation(), m(() => this.ready, t).then(() => {\n      const i = {\n        animate: !0,\n        ...t\n      },\n            s = H(e, this);\n      return this.animation.update(s), this._gotoTask = {}, i.animate ? this._gotoAnimated(s, i) : this._gotoImmediate(s, i);\n    });\n    le.error(\"#goTo()\", \"target cannot be null or undefined\");\n  }\n\n  async hitTest(e, t) {\n    const i = se(e) ? ne(this, e) : e;\n    if (!this.ready || isNaN(i.x) || isNaN(i.y)) return {\n      screenPoint: i,\n      results: []\n    };\n    let s = new Set(),\n        n = !1,\n        r = null,\n        a = null;\n    null != t && t.include ? Se(t.include, Ve(this, e => s.add(e), e => {\n      r || (r = new Set()), r.add(e);\n    }, e => s.add(e), () => n = !0)) : (n = !0, s = new Set(this.allLayerViews)), null != t && t.exclude && Se(t.exclude, Ve(this, e => s.delete(e), e => {\n      a || (a = new Set()), a.add(e);\n    }));\n    const o = this.allLayerViews.filter(e => !e.suspended && s.has(e)).reverse(),\n          l = this.toMap(i);\n    let h = (await Promise.all([n ? this.graphicsView.hitTest(l) : null, ...o.map(e => e.hitTest(l, i))])).filter(p).flat();\n    return r && (h = h.filter(e => r.has(_e(e)))), a && (h = h.filter(e => !a.has(_e(e)))), {\n      screenPoint: i,\n      results: h.map(e => ({\n        mapPoint: l,\n        graphic: e\n      }))\n    };\n  }\n\n  takeScreenshot(e) {\n    e = e || {};\n    const t = this.supersampleScreenshotsEnabled ? Math.min(4, te(this.size, Math.min(4096, this._stage.context.parameters.maxTextureSize))) : 1;\n    let i;\n    e.layers ? (i = [], e.layers.forEach(e => {\n      const t = this.allLayerViews.find(t => t.layer.id === e.id);\n      t && \"container\" in t && t.container && i.push(t.container);\n    })) : i = this._stage.children;\n    const {\n      format: s,\n      quality: n\n    } = ie(e.format, e.quality),\n          r = ee(e, t, this.size, this.padding, s, n, i, e.rotation);\n    return this._stage.takeScreenshot(r);\n  }\n\n  toMap(e) {\n    if (!this.ready) return null;\n    const t = se(e) ? ne(this, e) : e,\n          i = [0, 0],\n          [s, n] = this.state.toMap(i, [t.x, t.y]),\n          r = this.spatialReference;\n    return new j({\n      x: s,\n      y: n,\n      spatialReference: r\n    });\n  }\n\n  toScreen(e) {\n    if (!this.ready) return null;\n\n    const t = this._project(e, this.spatialReference),\n          i = [t.x, t.y];\n\n    return this.state.toScreen(i, i), w(i[0], i[1]);\n  }\n\n  on(e, t, i, s) {\n    const n = this.inputManager && this.viewEvents.on(e, t, i, s);\n    return n || super.on(e, t);\n  }\n\n  hasEventListener(e) {\n    return super.hasEventListener(e) || this.viewEvents.hasHandler(e);\n  }\n\n  whenLayerView(e) {\n    return super.whenLayerView(e);\n  }\n\n  graphicChanged(e) {\n    if (this.graphicsView) {\n      this.graphicsView.graphicUpdateHandler(e);\n    }\n  }\n\n  whenReady() {\n    return new Promise(e => {\n      this.ready ? e(this) : this._resolveWhenReady.push(e);\n    });\n  }\n\n  forceDOMReadyCycle() {\n    this.forceReadyCycle();\n  }\n\n  getDefaultSpatialReference() {\n    var e, t, i;\n    return this.map && \"initialViewProperties\" in this.map && (null == (e = this.map) || null == (t = e.initialViewProperties) ? void 0 : t.spatialReference) || (null == (i = this.defaultsFromMap) ? void 0 : i.spatialReference) || null;\n  }\n\n  hasLayerViewModule(e) {\n    return N.hasLayerViewModule(e);\n  }\n\n  importLayerView(e) {\n    return N.importLayerView(e);\n  }\n\n  pixelSizeAt() {\n    return this.ready ? this.state.resolution : (le.error(\"#pixelSizeAt()\", \"Map view cannot be used before it is ready\"), null);\n  }\n\n  popupHitTest(e) {\n    return this.hitTest(e).then(t => ({ ...t,\n      mapPoint: this.toMap(e)\n    }));\n  }\n\n  requestUpdate() {\n    this.ready && this.frameTask.requestUpdate();\n  }\n\n  validate() {\n    let e = re(this.type);\n    return a(\"safari\") && a(\"safari\") < 9 && (e = new r(\"mapview:browser-not-supported\", \"This browser is not supported by MapView (Safari < 9)\", {\n      type: \"safari\",\n      requiredVersion: 9,\n      detectedVersion: a(\"safari\")\n    })), p(e) ? (le.warn(\"#validate()\", e.message), Promise.reject(e)) : ge();\n  }\n\n  _createAnimation() {\n    return this.animation && !this.animation.done || (this.animation = new C()), this.animation;\n  }\n\n  _cancellableGoTo(e, t, i) {\n    const s = () => e === this._gotoTask,\n          n = i.then(() => {\n      s() && (this.animation = null);\n    }).catch(e => {\n      throw s() && (this.animation = null, t.done || (t.stop(), this.frameTask.animationInProgress = !1)), e;\n    }),\n          r = new Promise(e => e(n));\n\n    return t.when().catch(() => {\n      s() && r.cancel && r.cancel();\n    }), r;\n  }\n\n  _gotoImmediate(e, t) {\n    const i = this._gotoTask,\n          s = this.animation,\n          n = e.then(e => {\n      if (d(t), i !== this._gotoTask) throw new r(\"view:goto-interrupted\", \"Goto was interrupted\");\n      this.viewpoint = s.target = e, s.finish();\n    });\n    return this._cancellableGoTo(i, s, n);\n  }\n\n  _flipStationary(e) {\n    return null !== this._stationaryTimer || (this._stationaryTimer = setTimeout(() => {\n      this._stationaryTimer = null;\n\n      const e = performance.now() - this._lastStationaryEventTimestamp;\n\n      e < fe && (this._stationaryTimer = this._flipStationary(e));\n    }, e)), this._stationaryTimer;\n  }\n\n  _getDefaultViewpoint() {\n    var e, t, s, n;\n    const {\n      constraints: r,\n      initialExtent: a,\n      map: o\n    } = this;\n    if (!r) return null;\n    const l = o && \"initialViewProperties\" in o && o.initialViewProperties,\n          c = {\n      zoom: this._get(\"zoom\"),\n      scale: this._get(\"scale\"),\n      center: this._get(\"center\"),\n      extent: this._get(\"extent\"),\n      rotation: this._get(\"rotation\"),\n      viewpoint: this._get(\"viewpoint\"),\n      spatialReference: this._userSpatialReference\n    };\n    r.effectiveLODs ? -1 !== c.zoom && (c.scale = r.zoomToScale(c.zoom)) : c.zoom = -1;\n    let d = null,\n        u = null,\n        m = 0;\n    const g = c.viewpoint && c.viewpoint.rotation,\n          f = c.viewpoint && c.viewpoint.targetGeometry;\n    p(f) && (\"extent\" === f.type ? d = f : \"point\" === f.type && (u = f, m = c.viewpoint.scale));\n\n    const w = c.extent || d || (null == (e = h(null == l || null == (t = l.viewpoint) ? void 0 : t.targetGeometry)) ? void 0 : e.extent) || a,\n          y = c.center || u || (null == w ? void 0 : w.center),\n          v = c.scale || m || (null == l || null == (s = l.viewpoint) ? void 0 : s.scale) || w && $(w, this.size),\n          _ = c.rotation || g || (null == l || null == (n = l.viewpoint) ? void 0 : n.rotation) || 0;\n\n    return y && v ? new i({\n      targetGeometry: y,\n      scale: v,\n      rotation: _\n    }) : null;\n  }\n\n  _gotoAnimated(e, t) {\n    const i = this._gotoTask,\n          s = this.animation,\n          n = e.then(e => {\n      if (d(t), i !== this._gotoTask) throw new r(\"view:goto-interrupted\", \"Goto was interrupted\");\n      return s.update(e), this.animationManager.animate(s, this.viewpoint, t), s.when().then(() => {}, () => {});\n    });\n    return this._cancellableGoTo(i, s, n);\n  }\n\n  _project(e, t) {\n    var i;\n    const s = e && e.targetGeometry || e;\n    if (!t) return e;\n    if (!s) return null;\n    if (t.imageCoordinateSystem || null != (i = s.spatialReference) && i.imageCoordinateSystem) return e;\n    if (M(t, s.spatialReference)) return e;\n    const n = b(s, t);\n    if (!n) throw new r(\"mapview:projection-not-possible\", \"projecting input geometry to target spatial reference returned a null value\", {\n      geometry: s,\n      spatialReference: t\n    });\n    return we(e) ? (e.targetGeometry = n, e) : n;\n  }\n\n  _resizeHandler(e) {\n    if (!this.ready) return;\n    const t = this.state;\n    let i = this.state.paddedViewState.viewpoint;\n    const s = this.state.paddedViewState.size.concat();\n    t.size = [e.width, e.height], J(i, i, s, this.state.paddedViewState.size, this.resizeAlign), i = this.constraints.constrain(i, null), this.state.viewpoint = i;\n  }\n\n  _startup() {\n    var e;\n    this.timeline.begin(\"MapView Startup\");\n\n    const t = this._getDefaultViewpoint(),\n          i = t.targetGeometry;\n\n    try {\n      this._project(t, this.spatialReference);\n    } catch (p) {\n      var s;\n      le.warn(new y(\"mapview:startup-projection-error\", \"projection of initial viewpoint to the view's spatial reference, defaulting to the initial viewpoint.\", {\n        center: i.toJSON(),\n        spatialReference: this.spatialReference,\n        error: p\n      })), t.targetGeometry = (null == (s = this.defaultsFromMap.extent) ? void 0 : s.center) || new j({\n        x: 0,\n        y: 0,\n        spatialReference: this.spatialReference\n      });\n    }\n\n    null == (e = this.constraints) || e.fit(t), this._set(\"state\", new q({\n      padding: this._get(\"padding\"),\n      size: this.size,\n      viewpoint: t\n    })), this.graphics.owner = this;\n    const n = new pe(this.surface, {\n      canvas: this.renderCanvas,\n      supersampleScreenshots: this.supersampleScreenshotsEnabled,\n      contextOptions: {\n        disabledExtensions: this.deactivatedWebGLExtensions,\n        debugWebGLExtensions: this.debugWebGLExtensions\n      },\n      renderingOptions: this.renderingOptions,\n      timeline: this.timeline\n    });\n    this._stage = n, this._magnifierView = new me(), this._magnifierView.magnifier = this.magnifier;\n    const r = new de({\n      view: this\n    });\n\n    this._set(\"labelManager\", r);\n\n    const a = new E({\n      view: this\n    });\n\n    this._set(\"animationManager\", a);\n\n    const o = new ue({\n      view: this,\n      animationManager: a\n    });\n    this._set(\"mapViewNavigation\", o), this._setupSpatialReferenceDependentProperties(), this.handles.add([this.rootLayerViews.on(\"change\", () => this._updateStageChildren()), n.on(\"post-render\", () => this._set(\"rendering\", n.renderRequested)), n.on(\"will-render\", () => this._set(\"rendering\", n.renderRequested)), n.on(\"webgl-error\", e => this.fatalError = e.error), u(() => this.stationary, e => n.stationary = e, f), u(() => this.background, e => {\n      n.background = e, this._magnifierView.background = e;\n    }, f), u(() => this.magnifier, e => this._magnifierView.magnifier = e, f), u(() => this.renderingOptions, e => n.renderingOptions = e, f), u(() => this.highlightOptions, e => n.highlightOptions = e, f), u(() => this.state.id, () => n.state = this.state, f)], \"map-view\"), this._updateStageChildren();\n    const l = this._resolveWhenReady;\n    this._resolveWhenReady = [], l.forEach(e => e(this)), this.timeline.end(\"MapView Startup\"), this.frameTask && this.frameTask.start(), this._set(\"ready\", !0);\n  }\n\n  _teardown() {\n    this._destroySpatialReferenceDependentProperties(), this.handles.remove(\"map-view\"), this.mapViewNavigation.destroy(), this._set(\"mapViewNavigation\", null), this.animationManager.destroy(), this._set(\"animationManager\", null), this.layerViewManager.clear(), this.labelManager.destroy(), this._magnifierView.destroy(), this._stage.destroy(), this._stage = null, this._set(\"graphicsView\", null), this._magnifierView = null, this._set(\"labelManager\", null), this._set(\"mapViewNavigation\", null), this.graphics.owner = null, this.frameTask && this.frameTask.stop(), this._stationaryTimer && (clearTimeout(this._stationaryTimer), this._stationaryTimer = null), this._set(\"ready\", !1);\n    const {\n      center: [e, t],\n      spatialReference: i,\n      rotation: s,\n      scale: n\n    } = this.state.paddedViewState,\n          r = new j({\n      x: e,\n      y: t,\n      spatialReference: i\n    });\n    this._set(\"viewpoint\", null), this._set(\"extent\", null), this._set(\"center\", r), this._set(\"zoom\", -1), this._set(\"rotation\", s), this._set(\"scale\", n), this._set(\"spatialReference\", i), this._set(\"state\", null), this.animation = null;\n  }\n\n  _updateStageChildren() {\n    this._stage.removeAllChildren(), this.rootLayerViews.forEach(e => {\n      this._stage.addChild(e.container);\n    });\n    const e = this.graphicsView;\n    this._stage.addChild(e.container), this._stage.addChild(this._magnifierView);\n  }\n\n  _setupSpatialReferenceDependentProperties() {\n    const e = new U(O.create({\n      spatialReference: this.spatialReference,\n      size: 512,\n      numLODs: 36\n    }));\n\n    this._set(\"featuresTilingScheme\", e);\n\n    const t = new he({\n      view: this,\n      graphics: this.graphics,\n      requestUpdateCallback: () => this.requestUpdate(),\n      container: new ce(e)\n    });\n    this.frameTask.graphicsView = t, this._set(\"graphicsView\", t);\n  }\n\n  _destroySpatialReferenceDependentProperties() {\n    const e = this.graphicsView;\n    this._set(\"graphicsView\", null), this.frameTask.graphicsView = null, e.destroy(), this._set(\"featuresTilingScheme\", null);\n  }\n\n  _spatialReferenceChanged(e) {\n    if (!this.ready) return;\n    this.frameTask.stop();\n\n    for (const i of this.allLayerViews) i.processDetach();\n\n    this._destroySpatialReferenceDependentProperties();\n\n    const t = this.state.paddedViewState.clone();\n    if (c(this._scaleBeforeChangingSpatialReference)) this._scaleBeforeChangingSpatialReference = t.scale;else {\n      const e = t.viewpoint.clone();\n      e.scale = this._scaleBeforeChangingSpatialReference, t.viewpoint = e;\n    }\n    const s = t.clone(),\n          [n, r] = t.center;\n    let o = null;\n\n    try {\n      o = this._project(new j({\n        x: n,\n        y: r,\n        spatialReference: t.spatialReference\n      }), e);\n    } catch (p) {\n      x() || le.warn(new y(\"mapview:spatial-reference-change\", \"could not project the view's center to the new spatial reference\", {\n        center: o.toJSON(),\n        spatialReference: e,\n        error: p\n      }));\n    }\n\n    o || (o = new j({\n      x: 0,\n      y: 0,\n      spatialReference: e\n    }));\n    const l = A(new i({\n      targetGeometry: new j(),\n      scale: 0,\n      rotation: 0\n    }), t.viewpoint, o);\n    s.viewpoint = l;\n\n    try {\n      const i = 20,\n            n = [t.size[0] / 2, t.size[1] / 2],\n            r = [n[0] + i, n[1]],\n            o = t.toMap([0, 0], r),\n            {\n        x: p,\n        y: h\n      } = this._project(new j({\n        x: o[0],\n        y: o[1],\n        spatialReference: t.spatialReference\n      }), e);\n\n      o[0] = p, o[1] = h, s.toScreen(o, o);\n      const c = Q(n, o, r),\n            d = Math.hypot(o[0] - n[0], o[1] - n[1]) / i;\n      !Number.isFinite(d) || Math.abs(d) > 4 ? (l.rotation = 0, l.targetGeometry = new j({\n        x: 0,\n        y: 0,\n        spatialReference: e\n      })) : (l.scale *= d, l.scale > a(\"mapview-srswitch-adjust-rotation-scale-threshold\") ? l.rotation = 0 : l.rotation += Number.isFinite(c) ? c : 0);\n    } catch {}\n\n    this._get(\"constraints\").constrain(l, null), this._get(\"state\").viewpoint = l, this._stage.state = this.state, this._setupSpatialReferenceDependentProperties();\n\n    for (const i of this.allLayerViews) i.processAttach();\n\n    this.frameTask.requestFrame(), this.frameTask.start(), this._updateStageChildren();\n  }\n\n};\ne([_({\n  readOnly: !0\n})], ye.prototype, \"animationManager\", void 0), e([_({\n  constructOnly: !0\n})], ye.prototype, \"deactivatedWebGLExtensions\", void 0), e([_({\n  constructOnly: !0\n})], ye.prototype, \"debugWebGLExtensions\", void 0), e([_({\n  readOnly: !0\n})], ye.prototype, \"featuresTilingScheme\", void 0), e([_({\n  readOnly: !0\n})], ye.prototype, \"fullOpacity\", void 0), e([_({\n  readOnly: !0\n})], ye.prototype, \"graphicsTileStore\", null), e([_()], ye.prototype, \"graphicsView\", void 0), e([_({\n  readOnly: !0\n})], ye.prototype, \"state\", void 0), e([_()], ye.prototype, \"initialExtentRequired\", null), e([_()], ye.prototype, \"labelManager\", void 0), e([_({\n  readOnly: !0\n})], ye.prototype, \"resourceManager\", null), e([_({\n  readOnly: !0\n})], ye.prototype, \"textureManager\", null), e([_({\n  readOnly: !0\n})], ye.prototype, \"mapViewNavigation\", void 0), e([_({\n  constructOnly: !0\n})], ye.prototype, \"renderCanvas\", void 0), e([_()], ye.prototype, \"renderingOptions\", void 0), e([_({\n  readOnly: !0\n})], ye.prototype, \"rendering\", void 0), e([_({\n  constructOnly: !0\n})], ye.prototype, \"supersampleScreenshotsEnabled\", void 0), e([_({\n  readOnly: !0\n})], ye.prototype, \"supportsGround\", void 0), e([_()], ye.prototype, \"_stationaryTimer\", void 0), e([_()], ye.prototype, \"_defaultsFromMapSettings\", null), e([_()], ye.prototype, \"_pePromise\", void 0), e([_({\n  readOnly: !0\n})], ye.prototype, \"typeSpecificPreconditionsReady\", null), e([_()], ye.prototype, \"animation\", null), e([_({\n  type: oe\n})], ye.prototype, \"background\", null), e([_({\n  value: null,\n  type: j,\n  dependsOn: [\"state.id\", \"ready\"]\n})], ye.prototype, \"center\", null), e([_({\n  type: D\n})], ye.prototype, \"constraints\", null), e([_({\n  value: null,\n  type: S,\n  dependsOn: [\"state.id\", \"ready\"]\n})], ye.prototype, \"extent\", null), e([_()], ye.prototype, \"floors\", void 0), e([_({\n  type: X\n})], ye.prototype, \"highlightOptions\", void 0), e([_({\n  readOnly: !0\n})], ye.prototype, \"inputManager\", void 0), e([_()], ye.prototype, \"map\", void 0), e([_({\n  value: {\n    top: 0,\n    right: 0,\n    bottom: 0,\n    left: 0\n  },\n  cast: e => ({\n    top: 0,\n    right: 0,\n    bottom: 0,\n    left: 0,\n    ...e\n  })\n})], ye.prototype, \"padding\", null), e([_()], ye.prototype, \"resizeAlign\", void 0), e([_({\n  readOnly: !0,\n  dependsOn: [\"state.id\"]\n})], ye.prototype, \"resolution\", null), e([_({\n  value: 0,\n  type: Number,\n  dependsOn: [\"state.id\", \"ready\"]\n})], ye.prototype, \"rotation\", null), e([_({\n  value: 0,\n  type: Number,\n  dependsOn: [\"state.id\", \"ready\"]\n})], ye.prototype, \"scale\", null), e([_({\n  constructOnly: !0\n})], ye.prototype, \"spatialReferenceLocked\", void 0), e([_()], ye.prototype, \"stationary\", null), e([_({\n  type: Y,\n  readOnly: !0\n})], ye.prototype, \"timeline\", void 0), e([_({\n  readOnly: !0\n})], ye.prototype, \"type\", void 0), e([_({\n  readOnly: !0\n})], ye.prototype, \"updating\", null), e([_({\n  value: null,\n  type: i,\n  dependsOn: [\"state.id\", \"ready\"]\n})], ye.prototype, \"viewpoint\", null), e([_({\n  value: -1,\n  dependsOn: [\"state.id\"]\n})], ye.prototype, \"zoom\", null), e([_({\n  type: Boolean\n})], ye.prototype, \"navigating\", null), e([_({\n  type: ae\n})], ye.prototype, \"ui\", void 0), ye = e([V(\"esri.views.MapView\")], ye);\nconst ve = ye;\n\nfunction _e(e) {\n  const t = e.getObjectId();\n  var i, s, n, r;\n  return t ? `${null != (i = null != (s = null == (n = e.layer) ? void 0 : n.uid) ? s : null == (r = e.sourceLayer) ? void 0 : r.uid) ? i : \"MapView\"}/${t}` : `\"MapView/${e.uid}`;\n}\n\nfunction Ve(e, i, s, n, r) {\n  return a => {\n    if (a instanceof t) {\n      if (a.layer === e) null == r || r();else {\n        const t = e.allLayerViews.find(e => e.layer === a.layer);\n        t && (null == n || n(t));\n      }\n      s(_e(a));\n    } else {\n      const t = e.allLayerViews.find(e => e.layer === a);\n      t && i(t);\n    }\n  };\n}\n\nfunction Se(e, t) {\n  if (e) if (o(e)) {\n    for (const i of e) if (o(i)) for (const e of i) t(e);else t(i);\n  } else t(e);\n}\n\nexport { ve as default };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/views/MapView.js"],"names":["_","e","t","i","s","n","r","a","isIterable","o","l","isSome","p","unwrap","h","isNone","c","throwIfAborted","d","watch","u","whenOnce","m","sync","g","syncAndInitial","f","createScreenPoint","w","y","initialize","v","property","subclass","V","S","j","load","T","canProjectWithoutEngine","R","project","b","isLoaded","x","equals","M","O","BreakpointsOwner","k","DOMContainer","z","PopupView","L","P","C","E","G","layerView2DImporter","N","D","q","U","centerAt","A","setExtent","I","rotateTo","F","scaleTo","W","copy","B","create","H","extentToScale","$","resize","J","angleBetween","Q","Z","K","X","Timeline","Y","ee","getMaximumResolutionScale","te","getFormatAndQuality","ie","isSupportedScreenPointEvent","se","createScreenPointFromSupportedEvent","ne","check","re","ae","oe","le","getLogger","pe","he","ce","de","ue","me","ge","GraphicsView2D","GraphicContainer","LabelManager","MapViewNavigation","MagnifierView2D","Stage","Promise","all","fe","we","declaredClass","ye","constructor","_magnifierView","_stage","_resolveWhenReady","rootLayerViews","getCollections","basemapView","baseLayerViews","layerViews","referenceLayerViews","getChildrenFunction","featuresTilingScheme","fullOpacity","graphicsView","labelManager","mapViewNavigation","renderingOptions","samplingMode","edgeLabelsVisible","labelsAnimationTime","labelCollisionsEnabled","rendering","supersampleScreenshotsEnabled","supportsGround","_stationaryTimer","frameTask","_pePromise","floors","highlightOptions","inputManager","view","map","resizeAlign","spatialReferenceLocked","timeline","type","ui","constraints","padding","top","right","bottom","left","handles","add","viewpoint","_lastStationaryEventTimestamp","performance","now","_flipStationary","on","_resizeHandler","animationManager","animation","destroy","_set","_gotoTask","graphicsTileStore","initialExtentRequired","scale","center","extent","zoom","initialViewProperties","effectiveLODs","targetGeometry","resourceManager","textureManager","painter","_defaultsFromMapSettings","required","tileInfo","heightModelInfo","requiresExtentInSpatialReference","_projectionEngineLoaded","finally","typeSpecificPreconditionsReady","_getDefaultViewpoint","spatialReference","_get","stop","isFulfilled","animationInProgress","requestFrame","when","background","get","_clearOverride","_override","ready","state","paddedViewState","notifyChange","_project","error","input","remove","fit","version","clone","width","height","size","resolution","rotation","isNaN","stationary","navigating","resizing","updating","destroyed","layerViewManager","allLayerViews","some","_scaleBeforeChangingSpatialReference","constrain","scaleToZoom","zoomToScale","interacting","goTo","_createAnimation","then","animate","update","_gotoAnimated","_gotoImmediate","hitTest","screenPoint","results","Set","include","Se","Ve","exclude","delete","filter","suspended","has","reverse","toMap","flat","_e","mapPoint","graphic","takeScreenshot","Math","min","context","parameters","maxTextureSize","layers","forEach","find","layer","id","container","push","children","format","quality","toScreen","viewEvents","hasEventListener","hasHandler","whenLayerView","graphicChanged","graphicUpdateHandler","whenReady","forceDOMReadyCycle","forceReadyCycle","getDefaultSpatialReference","defaultsFromMap","hasLayerViewModule","importLayerView","pixelSizeAt","popupHitTest","requestUpdate","validate","requiredVersion","detectedVersion","warn","message","reject","done","_cancellableGoTo","catch","cancel","target","finish","setTimeout","initialExtent","_userSpatialReference","imageCoordinateSystem","geometry","concat","_startup","begin","toJSON","graphics","owner","surface","canvas","renderCanvas","supersampleScreenshots","contextOptions","disabledExtensions","deactivatedWebGLExtensions","debugWebGLExtensions","magnifier","_setupSpatialReferenceDependentProperties","_updateStageChildren","renderRequested","fatalError","end","start","_teardown","_destroySpatialReferenceDependentProperties","clear","clearTimeout","removeAllChildren","addChild","numLODs","requestUpdateCallback","_spatialReferenceChanged","processDetach","hypot","Number","isFinite","abs","processAttach","readOnly","prototype","constructOnly","value","dependsOn","cast","Boolean","ve","getObjectId","uid","sourceLayer","default"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../chunks/tslib.es6.js\";import t from\"../Graphic.js\";import i from\"../Viewpoint.js\";import s from\"../core/Collection.js\";import n from\"../core/CollectionFlattener.js\";import r from\"../core/Error.js\";import a from\"../core/has.js\";import{isIterable as o}from\"../core/iteratorUtils.js\";import l from\"../core/Logger.js\";import{isSome as p,unwrap as h,isNone as c}from\"../core/maybe.js\";import{throwIfAborted as d}from\"../core/promiseUtils.js\";import{watch as u,whenOnce as m,sync as g,syncAndInitial as f}from\"../core/reactiveUtils.js\";import{createScreenPoint as w}from\"../core/screenUtils.js\";import y from\"../core/Warning.js\";import{initialize as v}from\"../core/workers/workers.js\";import{property as _}from\"../core/accessorSupport/decorators/property.js\";import\"../core/arrayUtils.js\";import\"../core/accessorSupport/ensureType.js\";import{subclass as V}from\"../core/accessorSupport/decorators/subclass.js\";import S from\"../geometry/Extent.js\";import j from\"../geometry/Point.js\";import{load as T,canProjectWithoutEngine as R,project as b,isLoaded as x}from\"../geometry/projection.js\";import{equals as M}from\"../geometry/support/spatialReferenceUtils.js\";import O from\"../layers/support/TileInfo.js\";import{BreakpointsOwner as k}from\"./BreakpointsOwner.js\";import{DOMContainer as z}from\"./DOMContainer.js\";import{PopupView as L}from\"./PopupView.js\";import P from\"./View.js\";import C from\"./ViewAnimation.js\";import E from\"./2d/AnimationManager.js\";import G from\"./2d/FrameTask.js\";import{layerView2DImporter as N}from\"./2d/layerViewModuleImportUtils.js\";import D from\"./2d/MapViewConstraints.js\";import q from\"./2d/PaddedViewState.js\";import\"./2d/tiling/PagedTileQueue.js\";import U from\"./2d/tiling/TileInfoView.js\";import\"./2d/tiling/TileKey.js\";import\"./2d/tiling/TileQueue.js\";import\"./2d/tiling/TileStrategy.js\";import{centerAt as A,setExtent as I,rotateTo as F,scaleTo as W,copy as B,create as H,extentToScale as $,resize as J,angleBetween as Q}from\"./2d/viewpointUtils.js\";import Z from\"./2d/input/MapViewInputManager.js\";import K from\"./2d/layers/features/support/TileStore.js\";import X from\"./2d/support/HighlightOptions.js\";import{Timeline as Y}from\"./2d/support/Timeline.js\";import ee from\"./support/createScreenshotPlan.js\";import{getMaximumResolutionScale as te,getFormatAndQuality as ie}from\"./support/screenshotUtils.js\";import{isSupportedScreenPointEvent as se,createScreenPointFromSupportedEvent as ne}from\"./support/screenUtils.js\";import{check as re}from\"./support/WebGLRequirements.js\";import ae from\"./ui/2d/DefaultUI2D.js\";import oe from\"../webmap/background/ColorBackground.js\";const le=l.getLogger(\"esri.views.MapView\");let pe,he,ce,de,ue,me;async function ge(){const[,{GraphicsView2D:e,GraphicContainer:t,LabelManager:i,MapViewNavigation:s,MagnifierView2D:n,Stage:r}]=await Promise.all([import(\"./2d/webglDeps.js\"),import(\"./2d/mapViewDeps.js\")]);he=e,ce=t,de=i,ue=s,me=n,pe=r}const fe=160;function we(e){return e&&\"esri.Viewpoint\"===e.declaredClass}let ye=class extends(k(z(L(P)))){constructor(e){super(e),this._magnifierView=null,this._stage=null,this._resolveWhenReady=[],this.rootLayerViews=new n({getCollections:()=>{var e,t;return[null==(e=this.basemapView)?void 0:e.baseLayerViews,this.layerViews,null==(t=this.basemapView)?void 0:t.referenceLayerViews]},getChildrenFunction:()=>null}),this.featuresTilingScheme=null,this.fullOpacity=1,this.graphicsView=null,this.labelManager=null,this.mapViewNavigation=null,this.renderingOptions={samplingMode:\"dynamic\",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0},this.rendering=!1,this.supersampleScreenshotsEnabled=!1,this.supportsGround=!1,this._stationaryTimer=null,this.frameTask=new G(this),this._pePromise=null,this.floors=new s,this.highlightOptions=new X,this.inputManager=new Z({view:this}),this.map=null,this.resizeAlign=\"center\",this.spatialReferenceLocked=!1,this.timeline=new Y,this.type=\"2d\",this.ui=new ae,this.constraints=new D,this.padding={top:0,right:0,bottom:0,left:0},this.handles.add([u((()=>this.viewpoint),(()=>{this._lastStationaryEventTimestamp=performance.now(),this._flipStationary(fe)}),g),this.on(\"resize\",(e=>this._resizeHandler(e))),u((()=>{var e;return null==(e=this.animationManager)?void 0:e.animation}),(e=>{this.animation=e}))]),v()}destroy(){this._set(\"preconditionsReady\",!1),this._gotoTask=this.frameTask=null,this.rootLayerViews.destroy(),this.inputManager.destroy(),this._set(\"inputManager\",null)}get graphicsTileStore(){return new K(this.featuresTilingScheme)}get initialExtentRequired(){var e;const{scale:t,constraints:i,center:s,viewpoint:n,extent:r}=this;let a=this.zoom;return!(this.map&&\"initialViewProperties\"in this.map&&null!=(e=this.map.initialViewProperties)&&e.viewpoint)&&(!r&&(null!=i&&i.effectiveLODs||(a=-1),(!s||0===t&&-1===a)&&(!n||!p(n.targetGeometry)||\"extent\"!==n.targetGeometry.type&&!n.scale)))}get resourceManager(){return this._stage.resourceManager}get textureManager(){return this._stage.painter.textureManager}get _defaultsFromMapSettings(){return{required:{tileInfo:!0,heightModelInfo:!1,extent:!1},requiresExtentInSpatialReference:this.spatialReferenceLocked}}get _projectionEngineLoaded(){return!!x()||(this._pePromise||(this._pePromise=T().finally((()=>{this._pePromise=null}))),!1)}get typeSpecificPreconditionsReady(){const e=this._getDefaultViewpoint();if(!e)return!1;const t=this.spatialReference,i=h(e.targetGeometry);return!!R(i.spatialReference,t)||this._projectionEngineLoaded}set animation(e){const t=this._get(\"animation\");if(e===t)return;if(t&&t.stop(),!e||e.isFulfilled())return void this._set(\"animation\",null);this._set(\"animation\",e),this.frameTask.animationInProgress=!0;const i=()=>{e===this._get(\"animation\")&&(this._set(\"animation\",null),this.frameTask.requestFrame()),this.frameTask.animationInProgress=!1};e.when(i,i)}get background(){return this.get(\"map.initialViewProperties.background\")||null}set background(e){void 0===e?this._clearOverride(\"background\"):this._override(\"background\",e)}get center(){if(!this.ready)return this._get(\"center\");const{center:e,spatialReference:t}=this.state.paddedViewState;return new j({x:e[0],y:e[1],spatialReference:t})}set center(e){if(null==e)return;if(!this.ready)return this._set(\"center\",e),void this.notifyChange(\"initialExtentRequired\");let t;try{t=this._project(e,this.spatialReference)}catch(s){return void le.error(new r(\"mapview:invalid-center\",\"could not project the value in the view's spatial reference\",{input:e,error:s}))}const i=this.viewpoint;A(i,i,t),this.viewpoint=i}set constraints(e){const t=this._get(\"constraints\");t&&(this.handles.remove(\"map-view-constraints\"),t.destroy()),this._set(\"constraints\",e),e&&(e.view=this,this.ready&&(this.state.viewpoint=e.fit(this.state.paddedViewState.viewpoint)),this.handles.add(u((()=>e.version),(()=>{this.ready&&this.state&&(this.state.viewpoint=e.fit(this.state.paddedViewState.viewpoint))}),g),\"map-view-constraints\"))}get extent(){return this.ready?this.state.paddedViewState.extent.clone():this._get(\"extent\")}set extent(e){if(null==e)return;if(!e.width||!e.height)return void le.error(new r(\"mapview:invalid-extent\",\"invalid extent size\"));if(!this.ready)return this._set(\"extent\",e),this._set(\"center\",null),this._set(\"viewpoint\",null),this._set(\"scale\",0),this._set(\"zoom\",-1),void this.notifyChange(\"initialExtentRequired\");let t;try{t=this._project(e,this.spatialReference)}catch(s){return void le.error(new r(\"mapview:invalid-extent\",\"could not project the value in the view's spatial reference\",{error:s}))}const i=this.viewpoint;I(i,i,t,this.size,{constraints:this.constraints}),this.viewpoint=i}get padding(){return this.ready?this.state.padding:this._get(\"padding\")}set padding(e){this.ready?(this.state.padding=e,this._set(\"padding\",this.state.padding)):this._set(\"padding\",e)}get resolution(){return this.state?this.state.resolution:0}get rotation(){return this.ready?this.state.rotation:this._get(\"rotation\")}set rotation(e){if(isNaN(e))return;if(!this.ready)return void this._set(\"rotation\",e);const t=this.viewpoint;F(t,t,e),this.viewpoint=t}get scale(){return this.ready?this.state.scale:this._get(\"scale\")}set scale(e){if(!e||isNaN(e))return;if(!this.ready){this._set(\"scale\",e),this._set(\"zoom\",-1);const t=this._get(\"extent\");return t&&(this._set(\"extent\",null),this._set(\"center\",t.center)),void this.notifyChange(\"initialExtentRequired\")}const t=this.viewpoint;W(t,t,e),this.viewpoint=t}get stationary(){return!(this.animation||this.navigating||this.resizing||this._stationaryTimer)}get updating(){return!this.destroyed&&(!this.layerViewManager||!this.labelManager||!this.graphicsView||!0===this.layerViewManager.updating||!0===this.labelManager.updating||!0===this.graphicsView.updating||this.allLayerViews.some((e=>!e.destroyed&&!(\"layerViews\"in e)&&!0===e.updating)))}get viewpoint(){if(!this.ready)return this._get(\"viewpoint\");const e=this.state.paddedViewState;return e&&e.viewpoint.clone()}set viewpoint(e){if(null==e)return;if(!this.ready)return this._set(\"viewpoint\",e),this._set(\"extent\",null),this._set(\"center\",null),this._set(\"zoom\",-1),this._set(\"scale\",0),void this.notifyChange(\"initialExtentRequired\");let t,s;try{t=this._project(e,this.spatialReference),!e.scale||isNaN(e.scale)?s=new r(\"mapview:invalid-viewpoint\",`invalid scale value of ${e.scale}`):c(e.targetGeometry)&&(s=new r(\"mapview:invalid-viewpoint\",\"geometry not defined\"))}catch(a){s=new r(\"mapview:invalid-viewpoint\",\"could not project the value in the view's spatial reference\",{error:a})}if(s)return void le.error(s);this._scaleBeforeChangingSpatialReference=null;const n=new i({targetGeometry:new j,scale:0,rotation:0});B(n,t),this.constraints.constrain(n,this.state.paddedViewState.viewpoint),this.state.viewpoint=n,this.frameTask.requestFrame(),this._set(\"viewpoint\",n)}get zoom(){return this.ready?this.constraints.scaleToZoom(this.scale):this._get(\"zoom\")}set zoom(e){if(null==e)return;if(!this.ready){this._set(\"zoom\",e),this._set(\"scale\",0);const t=this._get(\"extent\");return t&&(this._set(\"extent\",null),this._set(\"center\",t.center)),void this.notifyChange(\"initialExtentRequired\")}if(!this.constraints.effectiveLODs)return void this._set(\"zoom\",-1);const t=this.viewpoint;W(t,t,this.constraints.zoomToScale(e)),this.viewpoint=t,this._set(\"zoom\",this.constraints.scaleToZoom(this.scale))}get navigating(){return!(!this.mapViewNavigation||!this.mapViewNavigation.interacting)}goTo(e,t){if(e)return this.animation&&(this.animation=null),this._createAnimation(),m((()=>this.ready),t).then((()=>{const i={animate:!0,...t},s=H(e,this);return this.animation.update(s),this._gotoTask={},i.animate?this._gotoAnimated(s,i):this._gotoImmediate(s,i)}));le.error(\"#goTo()\",\"target cannot be null or undefined\")}async hitTest(e,t){const i=se(e)?ne(this,e):e;if(!this.ready||isNaN(i.x)||isNaN(i.y))return{screenPoint:i,results:[]};let s=new Set,n=!1,r=null,a=null;null!=t&&t.include?Se(t.include,Ve(this,(e=>s.add(e)),(e=>{r||(r=new Set),r.add(e)}),(e=>s.add(e)),(()=>n=!0))):(n=!0,s=new Set(this.allLayerViews)),null!=t&&t.exclude&&Se(t.exclude,Ve(this,(e=>s.delete(e)),(e=>{a||(a=new Set),a.add(e)})));const o=this.allLayerViews.filter((e=>!e.suspended&&s.has(e))).reverse(),l=this.toMap(i);let h=(await Promise.all([n?this.graphicsView.hitTest(l):null,...o.map((e=>e.hitTest(l,i)))])).filter(p).flat();return r&&(h=h.filter((e=>r.has(_e(e))))),a&&(h=h.filter((e=>!a.has(_e(e))))),{screenPoint:i,results:h.map((e=>({mapPoint:l,graphic:e})))}}takeScreenshot(e){e=e||{};const t=this.supersampleScreenshotsEnabled?Math.min(4,te(this.size,Math.min(4096,this._stage.context.parameters.maxTextureSize))):1;let i;e.layers?(i=[],e.layers.forEach((e=>{const t=this.allLayerViews.find((t=>t.layer.id===e.id));t&&\"container\"in t&&t.container&&i.push(t.container)}))):i=this._stage.children;const{format:s,quality:n}=ie(e.format,e.quality),r=ee(e,t,this.size,this.padding,s,n,i,e.rotation);return this._stage.takeScreenshot(r)}toMap(e){if(!this.ready)return null;const t=se(e)?ne(this,e):e,i=[0,0],[s,n]=this.state.toMap(i,[t.x,t.y]),r=this.spatialReference;return new j({x:s,y:n,spatialReference:r})}toScreen(e){if(!this.ready)return null;const t=this._project(e,this.spatialReference),i=[t.x,t.y];return this.state.toScreen(i,i),w(i[0],i[1])}on(e,t,i,s){const n=this.inputManager&&this.viewEvents.on(e,t,i,s);return n||super.on(e,t)}hasEventListener(e){return super.hasEventListener(e)||this.viewEvents.hasHandler(e)}whenLayerView(e){return super.whenLayerView(e)}graphicChanged(e){if(this.graphicsView){this.graphicsView.graphicUpdateHandler(e)}}whenReady(){return new Promise((e=>{this.ready?e(this):this._resolveWhenReady.push(e)}))}forceDOMReadyCycle(){this.forceReadyCycle()}getDefaultSpatialReference(){var e,t,i;return this.map&&\"initialViewProperties\"in this.map&&(null==(e=this.map)||null==(t=e.initialViewProperties)?void 0:t.spatialReference)||(null==(i=this.defaultsFromMap)?void 0:i.spatialReference)||null}hasLayerViewModule(e){return N.hasLayerViewModule(e)}importLayerView(e){return N.importLayerView(e)}pixelSizeAt(){return this.ready?this.state.resolution:(le.error(\"#pixelSizeAt()\",\"Map view cannot be used before it is ready\"),null)}popupHitTest(e){return this.hitTest(e).then((t=>({...t,mapPoint:this.toMap(e)})))}requestUpdate(){this.ready&&this.frameTask.requestUpdate()}validate(){let e=re(this.type);return a(\"safari\")&&a(\"safari\")<9&&(e=new r(\"mapview:browser-not-supported\",\"This browser is not supported by MapView (Safari < 9)\",{type:\"safari\",requiredVersion:9,detectedVersion:a(\"safari\")})),p(e)?(le.warn(\"#validate()\",e.message),Promise.reject(e)):ge()}_createAnimation(){return this.animation&&!this.animation.done||(this.animation=new C),this.animation}_cancellableGoTo(e,t,i){const s=()=>e===this._gotoTask,n=i.then((()=>{s()&&(this.animation=null)})).catch((e=>{throw s()&&(this.animation=null,t.done||(t.stop(),this.frameTask.animationInProgress=!1)),e})),r=new Promise((e=>e(n)));return t.when().catch((()=>{s()&&r.cancel&&r.cancel()})),r}_gotoImmediate(e,t){const i=this._gotoTask,s=this.animation,n=e.then((e=>{if(d(t),i!==this._gotoTask)throw new r(\"view:goto-interrupted\",\"Goto was interrupted\");this.viewpoint=s.target=e,s.finish()}));return this._cancellableGoTo(i,s,n)}_flipStationary(e){return null!==this._stationaryTimer||(this._stationaryTimer=setTimeout((()=>{this._stationaryTimer=null;const e=performance.now()-this._lastStationaryEventTimestamp;e<fe&&(this._stationaryTimer=this._flipStationary(e))}),e)),this._stationaryTimer}_getDefaultViewpoint(){var e,t,s,n;const{constraints:r,initialExtent:a,map:o}=this;if(!r)return null;const l=o&&\"initialViewProperties\"in o&&o.initialViewProperties,c={zoom:this._get(\"zoom\"),scale:this._get(\"scale\"),center:this._get(\"center\"),extent:this._get(\"extent\"),rotation:this._get(\"rotation\"),viewpoint:this._get(\"viewpoint\"),spatialReference:this._userSpatialReference};r.effectiveLODs?-1!==c.zoom&&(c.scale=r.zoomToScale(c.zoom)):c.zoom=-1;let d=null,u=null,m=0;const g=c.viewpoint&&c.viewpoint.rotation,f=c.viewpoint&&c.viewpoint.targetGeometry;p(f)&&(\"extent\"===f.type?d=f:\"point\"===f.type&&(u=f,m=c.viewpoint.scale));const w=c.extent||d||(null==(e=h(null==l||null==(t=l.viewpoint)?void 0:t.targetGeometry))?void 0:e.extent)||a,y=c.center||u||(null==w?void 0:w.center),v=c.scale||m||(null==l||null==(s=l.viewpoint)?void 0:s.scale)||w&&$(w,this.size),_=c.rotation||g||(null==l||null==(n=l.viewpoint)?void 0:n.rotation)||0;return y&&v?new i({targetGeometry:y,scale:v,rotation:_}):null}_gotoAnimated(e,t){const i=this._gotoTask,s=this.animation,n=e.then((e=>{if(d(t),i!==this._gotoTask)throw new r(\"view:goto-interrupted\",\"Goto was interrupted\");return s.update(e),this.animationManager.animate(s,this.viewpoint,t),s.when().then((()=>{}),(()=>{}))}));return this._cancellableGoTo(i,s,n)}_project(e,t){var i;const s=e&&e.targetGeometry||e;if(!t)return e;if(!s)return null;if(t.imageCoordinateSystem||null!=(i=s.spatialReference)&&i.imageCoordinateSystem)return e;if(M(t,s.spatialReference))return e;const n=b(s,t);if(!n)throw new r(\"mapview:projection-not-possible\",\"projecting input geometry to target spatial reference returned a null value\",{geometry:s,spatialReference:t});return we(e)?(e.targetGeometry=n,e):n}_resizeHandler(e){if(!this.ready)return;const t=this.state;let i=this.state.paddedViewState.viewpoint;const s=this.state.paddedViewState.size.concat();t.size=[e.width,e.height],J(i,i,s,this.state.paddedViewState.size,this.resizeAlign),i=this.constraints.constrain(i,null),this.state.viewpoint=i}_startup(){var e;this.timeline.begin(\"MapView Startup\");const t=this._getDefaultViewpoint(),i=t.targetGeometry;try{this._project(t,this.spatialReference)}catch(p){var s;le.warn(new y(\"mapview:startup-projection-error\",\"projection of initial viewpoint to the view's spatial reference, defaulting to the initial viewpoint.\",{center:i.toJSON(),spatialReference:this.spatialReference,error:p})),t.targetGeometry=(null==(s=this.defaultsFromMap.extent)?void 0:s.center)||new j({x:0,y:0,spatialReference:this.spatialReference})}null==(e=this.constraints)||e.fit(t),this._set(\"state\",new q({padding:this._get(\"padding\"),size:this.size,viewpoint:t})),this.graphics.owner=this;const n=new pe(this.surface,{canvas:this.renderCanvas,supersampleScreenshots:this.supersampleScreenshotsEnabled,contextOptions:{disabledExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions},renderingOptions:this.renderingOptions,timeline:this.timeline});this._stage=n,this._magnifierView=new me,this._magnifierView.magnifier=this.magnifier;const r=new de({view:this});this._set(\"labelManager\",r);const a=new E({view:this});this._set(\"animationManager\",a);const o=new ue({view:this,animationManager:a});this._set(\"mapViewNavigation\",o),this._setupSpatialReferenceDependentProperties(),this.handles.add([this.rootLayerViews.on(\"change\",(()=>this._updateStageChildren())),n.on(\"post-render\",(()=>this._set(\"rendering\",n.renderRequested))),n.on(\"will-render\",(()=>this._set(\"rendering\",n.renderRequested))),n.on(\"webgl-error\",(e=>this.fatalError=e.error)),u((()=>this.stationary),(e=>n.stationary=e),f),u((()=>this.background),(e=>{n.background=e,this._magnifierView.background=e}),f),u((()=>this.magnifier),(e=>this._magnifierView.magnifier=e),f),u((()=>this.renderingOptions),(e=>n.renderingOptions=e),f),u((()=>this.highlightOptions),(e=>n.highlightOptions=e),f),u((()=>this.state.id),(()=>n.state=this.state),f)],\"map-view\"),this._updateStageChildren();const l=this._resolveWhenReady;this._resolveWhenReady=[],l.forEach((e=>e(this))),this.timeline.end(\"MapView Startup\"),this.frameTask&&this.frameTask.start(),this._set(\"ready\",!0)}_teardown(){this._destroySpatialReferenceDependentProperties(),this.handles.remove(\"map-view\"),this.mapViewNavigation.destroy(),this._set(\"mapViewNavigation\",null),this.animationManager.destroy(),this._set(\"animationManager\",null),this.layerViewManager.clear(),this.labelManager.destroy(),this._magnifierView.destroy(),this._stage.destroy(),this._stage=null,this._set(\"graphicsView\",null),this._magnifierView=null,this._set(\"labelManager\",null),this._set(\"mapViewNavigation\",null),this.graphics.owner=null,this.frameTask&&this.frameTask.stop(),this._stationaryTimer&&(clearTimeout(this._stationaryTimer),this._stationaryTimer=null),this._set(\"ready\",!1);const{center:[e,t],spatialReference:i,rotation:s,scale:n}=this.state.paddedViewState,r=new j({x:e,y:t,spatialReference:i});this._set(\"viewpoint\",null),this._set(\"extent\",null),this._set(\"center\",r),this._set(\"zoom\",-1),this._set(\"rotation\",s),this._set(\"scale\",n),this._set(\"spatialReference\",i),this._set(\"state\",null),this.animation=null}_updateStageChildren(){this._stage.removeAllChildren(),this.rootLayerViews.forEach((e=>{this._stage.addChild(e.container)}));const e=this.graphicsView;this._stage.addChild(e.container),this._stage.addChild(this._magnifierView)}_setupSpatialReferenceDependentProperties(){const e=new U(O.create({spatialReference:this.spatialReference,size:512,numLODs:36}));this._set(\"featuresTilingScheme\",e);const t=new he({view:this,graphics:this.graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new ce(e)});this.frameTask.graphicsView=t,this._set(\"graphicsView\",t)}_destroySpatialReferenceDependentProperties(){const e=this.graphicsView;this._set(\"graphicsView\",null),this.frameTask.graphicsView=null,e.destroy(),this._set(\"featuresTilingScheme\",null)}_spatialReferenceChanged(e){if(!this.ready)return;this.frameTask.stop();for(const i of this.allLayerViews)i.processDetach();this._destroySpatialReferenceDependentProperties();const t=this.state.paddedViewState.clone();if(c(this._scaleBeforeChangingSpatialReference))this._scaleBeforeChangingSpatialReference=t.scale;else{const e=t.viewpoint.clone();e.scale=this._scaleBeforeChangingSpatialReference,t.viewpoint=e}const s=t.clone(),[n,r]=t.center;let o=null;try{o=this._project(new j({x:n,y:r,spatialReference:t.spatialReference}),e)}catch(p){x()||le.warn(new y(\"mapview:spatial-reference-change\",\"could not project the view's center to the new spatial reference\",{center:o.toJSON(),spatialReference:e,error:p}))}o||(o=new j({x:0,y:0,spatialReference:e}));const l=A(new i({targetGeometry:new j,scale:0,rotation:0}),t.viewpoint,o);s.viewpoint=l;try{const i=20,n=[t.size[0]/2,t.size[1]/2],r=[n[0]+i,n[1]],o=t.toMap([0,0],r),{x:p,y:h}=this._project(new j({x:o[0],y:o[1],spatialReference:t.spatialReference}),e);o[0]=p,o[1]=h,s.toScreen(o,o);const c=Q(n,o,r),d=Math.hypot(o[0]-n[0],o[1]-n[1])/i;!Number.isFinite(d)||Math.abs(d)>4?(l.rotation=0,l.targetGeometry=new j({x:0,y:0,spatialReference:e})):(l.scale*=d,l.scale>a(\"mapview-srswitch-adjust-rotation-scale-threshold\")?l.rotation=0:l.rotation+=Number.isFinite(c)?c:0)}catch{}this._get(\"constraints\").constrain(l,null),this._get(\"state\").viewpoint=l,this._stage.state=this.state,this._setupSpatialReferenceDependentProperties();for(const i of this.allLayerViews)i.processAttach();this.frameTask.requestFrame(),this.frameTask.start(),this._updateStageChildren()}};e([_({readOnly:!0})],ye.prototype,\"animationManager\",void 0),e([_({constructOnly:!0})],ye.prototype,\"deactivatedWebGLExtensions\",void 0),e([_({constructOnly:!0})],ye.prototype,\"debugWebGLExtensions\",void 0),e([_({readOnly:!0})],ye.prototype,\"featuresTilingScheme\",void 0),e([_({readOnly:!0})],ye.prototype,\"fullOpacity\",void 0),e([_({readOnly:!0})],ye.prototype,\"graphicsTileStore\",null),e([_()],ye.prototype,\"graphicsView\",void 0),e([_({readOnly:!0})],ye.prototype,\"state\",void 0),e([_()],ye.prototype,\"initialExtentRequired\",null),e([_()],ye.prototype,\"labelManager\",void 0),e([_({readOnly:!0})],ye.prototype,\"resourceManager\",null),e([_({readOnly:!0})],ye.prototype,\"textureManager\",null),e([_({readOnly:!0})],ye.prototype,\"mapViewNavigation\",void 0),e([_({constructOnly:!0})],ye.prototype,\"renderCanvas\",void 0),e([_()],ye.prototype,\"renderingOptions\",void 0),e([_({readOnly:!0})],ye.prototype,\"rendering\",void 0),e([_({constructOnly:!0})],ye.prototype,\"supersampleScreenshotsEnabled\",void 0),e([_({readOnly:!0})],ye.prototype,\"supportsGround\",void 0),e([_()],ye.prototype,\"_stationaryTimer\",void 0),e([_()],ye.prototype,\"_defaultsFromMapSettings\",null),e([_()],ye.prototype,\"_pePromise\",void 0),e([_({readOnly:!0})],ye.prototype,\"typeSpecificPreconditionsReady\",null),e([_()],ye.prototype,\"animation\",null),e([_({type:oe})],ye.prototype,\"background\",null),e([_({value:null,type:j,dependsOn:[\"state.id\",\"ready\"]})],ye.prototype,\"center\",null),e([_({type:D})],ye.prototype,\"constraints\",null),e([_({value:null,type:S,dependsOn:[\"state.id\",\"ready\"]})],ye.prototype,\"extent\",null),e([_()],ye.prototype,\"floors\",void 0),e([_({type:X})],ye.prototype,\"highlightOptions\",void 0),e([_({readOnly:!0})],ye.prototype,\"inputManager\",void 0),e([_()],ye.prototype,\"map\",void 0),e([_({value:{top:0,right:0,bottom:0,left:0},cast:e=>({top:0,right:0,bottom:0,left:0,...e})})],ye.prototype,\"padding\",null),e([_()],ye.prototype,\"resizeAlign\",void 0),e([_({readOnly:!0,dependsOn:[\"state.id\"]})],ye.prototype,\"resolution\",null),e([_({value:0,type:Number,dependsOn:[\"state.id\",\"ready\"]})],ye.prototype,\"rotation\",null),e([_({value:0,type:Number,dependsOn:[\"state.id\",\"ready\"]})],ye.prototype,\"scale\",null),e([_({constructOnly:!0})],ye.prototype,\"spatialReferenceLocked\",void 0),e([_()],ye.prototype,\"stationary\",null),e([_({type:Y,readOnly:!0})],ye.prototype,\"timeline\",void 0),e([_({readOnly:!0})],ye.prototype,\"type\",void 0),e([_({readOnly:!0})],ye.prototype,\"updating\",null),e([_({value:null,type:i,dependsOn:[\"state.id\",\"ready\"]})],ye.prototype,\"viewpoint\",null),e([_({value:-1,dependsOn:[\"state.id\"]})],ye.prototype,\"zoom\",null),e([_({type:Boolean})],ye.prototype,\"navigating\",null),e([_({type:ae})],ye.prototype,\"ui\",void 0),ye=e([V(\"esri.views.MapView\")],ye);const ve=ye;function _e(e){const t=e.getObjectId();var i,s,n,r;return t?`${null!=(i=null!=(s=null==(n=e.layer)?void 0:n.uid)?s:null==(r=e.sourceLayer)?void 0:r.uid)?i:\"MapView\"}/${t}`:`\"MapView/${e.uid}`}function Ve(e,i,s,n,r){return a=>{if(a instanceof t){if(a.layer===e)null==r||r();else{const t=e.allLayerViews.find((e=>e.layer===a.layer));t&&(null==n||n(t))}s(_e(a))}else{const t=e.allLayerViews.find((e=>e.layer===a));t&&i(t)}}}function Se(e,t){if(e)if(o(e))for(const i of e)if(o(i))for(const e of i)t(e);else t(i);else t(e)}export{ve as default};\n"]},"metadata":{},"sourceType":"module"}