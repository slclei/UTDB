{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport { TEXTURE_BINDING_BITMAP as e } from \"../definitions.js\";\nimport t from \"../VertexStream.js\";\nimport i from \"./WGLBrush.js\";\nimport { TextureSamplingMode as s, BlendFactor as n, CompareFunction as a } from \"../../../../webgl/enums.js\";\n\nconst r = {\n  nearest: {\n    defines: [],\n    samplingMode: s.NEAREST,\n    mips: !1\n  },\n  bilinear: {\n    defines: [],\n    samplingMode: s.LINEAR,\n    mips: !1\n  },\n  bicubic: {\n    defines: [\"bicubic\"],\n    samplingMode: s.LINEAR,\n    mips: !1\n  },\n  trilinear: {\n    defines: [],\n    samplingMode: s.LINEAR_MIPMAP_LINEAR,\n    mips: !0\n  }\n},\n      o = (e, t, i) => {\n  if (\"dynamic\" === i.samplingMode) {\n    const {\n      state: i\n    } = e,\n          s = t.resolution / t.pixelRatio / i.resolution,\n          n = Math.round(e.pixelRatio) !== e.pixelRatio,\n          a = s > 1.05 || s < .95;\n    return i.rotation || a || n || t.isSourceScaled || t.rotation ? r.bilinear : r.nearest;\n  }\n\n  return r[i.samplingMode];\n};\n\nclass d extends i {\n  constructor() {\n    super(...arguments), this._desc = {\n      vsPath: \"raster/bitmap\",\n      fsPath: \"raster/bitmap\",\n      attributes: new Map([[\"a_position\", 0], [\"a_texcoord\", 1]])\n    };\n  }\n\n  dispose() {\n    this._quad && this._quad.dispose();\n  }\n\n  prepareState(_ref, t) {\n    let {\n      context: e\n    } = _ref;\n    e.setBlendingEnabled(!0), \"additive\" === t.blendFunction ? e.setBlendFunctionSeparate(n.ONE, n.ONE, n.ONE, n.ONE) : e.setBlendFunctionSeparate(n.ONE, n.ONE_MINUS_SRC_ALPHA, n.ONE, n.ONE_MINUS_SRC_ALPHA), e.setColorMask(!0, !0, !0, !0), e.setStencilWriteMask(0), e.setStencilTestEnabled(!0), e.setStencilFunction(a.EQUAL, t.stencilRef, 255);\n  }\n\n  draw(i, s) {\n    const {\n      context: n,\n      renderingOptions: a,\n      painter: r\n    } = i;\n    if (!s.source) return;\n    i.timeline.begin(this.name), this._quad || (this._quad = new t(n, [0, 0, 1, 0, 0, 1, 1, 1]));\n    const d = o(i, s, a),\n          m = r.materialManager.getProgram(i, this._desc, d.defines),\n          {\n      coordScale: c,\n      computedOpacity: l,\n      transforms: p\n    } = s;\n    s.setSamplingProfile(d), s.bind(i.context, e), n.useProgram(m), m.setUniformMatrix3fv(\"u_dvsMat3\", p.dvs), m.setUniform1i(\"u_texture\", e), m.setUniform2fv(\"u_coordScale\", c), m.setUniform1f(\"u_opacity\", l), this._quad.draw(), i.timeline.end(this.name);\n  }\n\n}\n\nexport { d as default };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/views/2d/engine/webgl/brushes/BrushBitmap.js"],"names":["TEXTURE_BINDING_BITMAP","e","t","i","TextureSamplingMode","s","BlendFactor","n","CompareFunction","a","r","nearest","defines","samplingMode","NEAREST","mips","bilinear","LINEAR","bicubic","trilinear","LINEAR_MIPMAP_LINEAR","o","state","resolution","pixelRatio","Math","round","rotation","isSourceScaled","d","constructor","arguments","_desc","vsPath","fsPath","attributes","Map","dispose","_quad","prepareState","context","setBlendingEnabled","blendFunction","setBlendFunctionSeparate","ONE","ONE_MINUS_SRC_ALPHA","setColorMask","setStencilWriteMask","setStencilTestEnabled","setStencilFunction","EQUAL","stencilRef","draw","renderingOptions","painter","source","timeline","begin","name","m","materialManager","getProgram","coordScale","c","computedOpacity","l","transforms","p","setSamplingProfile","bind","useProgram","setUniformMatrix3fv","dvs","setUniform1i","setUniform2fv","setUniform1f","end","default"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{TEXTURE_BINDING_BITMAP as e}from\"../definitions.js\";import t from\"../VertexStream.js\";import i from\"./WGLBrush.js\";import{TextureSamplingMode as s,BlendFactor as n,CompareFunction as a}from\"../../../../webgl/enums.js\";const r={nearest:{defines:[],samplingMode:s.NEAREST,mips:!1},bilinear:{defines:[],samplingMode:s.LINEAR,mips:!1},bicubic:{defines:[\"bicubic\"],samplingMode:s.LINEAR,mips:!1},trilinear:{defines:[],samplingMode:s.LINEAR_MIPMAP_LINEAR,mips:!0}},o=(e,t,i)=>{if(\"dynamic\"===i.samplingMode){const{state:i}=e,s=t.resolution/t.pixelRatio/i.resolution,n=Math.round(e.pixelRatio)!==e.pixelRatio,a=s>1.05||s<.95;return i.rotation||a||n||t.isSourceScaled||t.rotation?r.bilinear:r.nearest}return r[i.samplingMode]};class d extends i{constructor(){super(...arguments),this._desc={vsPath:\"raster/bitmap\",fsPath:\"raster/bitmap\",attributes:new Map([[\"a_position\",0],[\"a_texcoord\",1]])}}dispose(){this._quad&&this._quad.dispose()}prepareState({context:e},t){e.setBlendingEnabled(!0),\"additive\"===t.blendFunction?e.setBlendFunctionSeparate(n.ONE,n.ONE,n.ONE,n.ONE):e.setBlendFunctionSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA),e.setColorMask(!0,!0,!0,!0),e.setStencilWriteMask(0),e.setStencilTestEnabled(!0),e.setStencilFunction(a.EQUAL,t.stencilRef,255)}draw(i,s){const{context:n,renderingOptions:a,painter:r}=i;if(!s.source)return;i.timeline.begin(this.name),this._quad||(this._quad=new t(n,[0,0,1,0,0,1,1,1]));const d=o(i,s,a),m=r.materialManager.getProgram(i,this._desc,d.defines),{coordScale:c,computedOpacity:l,transforms:p}=s;s.setSamplingProfile(d),s.bind(i.context,e),n.useProgram(m),m.setUniformMatrix3fv(\"u_dvsMat3\",p.dvs),m.setUniform1i(\"u_texture\",e),m.setUniform2fv(\"u_coordScale\",c),m.setUniform1f(\"u_opacity\",l),this._quad.draw(),i.timeline.end(this.name)}}export{d as default};\n"]},"metadata":{},"sourceType":"module"}