{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport e from \"../../core/Error.js\";\nimport { isNone as t } from \"../../core/maybe.js\";\nimport { urlToObject as n } from \"../../core/urlUtils.js\";\nimport r from \"../../geometry/Extent.js\";\nimport i from \"../../geometry/SpatialReference.js\";\nimport { isAxesOrderReversedForWkid as s } from \"../ogc/crsUtils.js\";\nconst a = {\n  84: 4326,\n  83: 4269,\n  27: 4267\n};\n\nfunction o(t) {\n  if (!t) return null;\n  const n = {\n    idCounter: -1\n  };\n\n  if (\"string\" == typeof t) {\n    t = new DOMParser().parseFromString(t, \"text/xml\");\n  }\n\n  const i = t.documentElement;\n\n  if (\"ServiceExceptionReport\" === i.nodeName) {\n    const t = Array.prototype.slice.call(i.childNodes).map(e => e.textContent).join(\"\\r\\n\");\n    throw new e(\"wmslayer:wms-capabilities-xml-is-not-valid\", \"The server returned errors when the WMS capabilities were requested.\", t);\n  }\n\n  const s = d(\"Capability\", i),\n        a = d(\"Service\", i),\n        o = d(\"Request\", s);\n  if (!s || !a || !o) return null;\n  const l = d(\"Layer\", s);\n  if (!l) return null;\n  const m = \"WMS_Capabilities\" === i.nodeName || \"WMT_MS_Capabilities\" === i.nodeName ? i.getAttribute(\"version\") : \"1.3.0\",\n        f = h(\"Title\", a, \"\") || h(\"Name\", a, \"\"),\n        p = h(\"AccessConstraints\", a, \"\"),\n        x = h(\"Abstract\", a, \"\"),\n        b = parseInt(h(\"MaxWidth\", a, \"5000\"), 10),\n        E = parseInt(h(\"MaxHeight\", a, \"5000\"), 10),\n        S = g(o, \"GetMap\"),\n        w = N(o, \"GetMap\"),\n        I = y(l, m, n);\n  let F,\n      M = 0;\n  if (Array.prototype.slice.call(s.childNodes).forEach(e => {\n    \"Layer\" === e.nodeName && (0 === M ? F = e : 1 === M ? (I.name && (I.name = \"\", I.sublayers.push(y(F, m, n))), I.sublayers.push(y(e, m, n))) : I.sublayers.push(y(e, m, n)), M++);\n  }), !I) return null;\n  let O, C;\n  const T = I.fullExtents;\n\n  if (O = I.sublayers, O || (O = []), 0 === O.length && O.push(I), C = I.extent, !C) {\n    const e = new r(O[0].extent);\n    I.extent = e.toJSON(), C = I.extent;\n  }\n\n  const R = I.spatialReferences.length > 0 ? I.spatialReferences : u(I),\n        v = N(o, \"GetFeatureInfo\");\n  let V;\n\n  if (v) {\n    const e = g(o, \"GetFeatureInfo\");\n    e.indexOf(\"text/html\") > -1 ? V = \"text/html\" : e.indexOf(\"text/plain\") > -1 && (V = \"text/plain\");\n  }\n\n  if (!V) {\n    const e = function (t) {\n      t && (t.queryable = !1, t.sublayers && t.sublayers.forEach(t => {\n        e(t);\n      }));\n    };\n\n    e(I);\n  }\n\n  const U = c(O),\n        _ = I.minScale || 0,\n        q = I.maxScale || 0,\n        B = I.dimensions,\n        D = U.reduce((e, t) => e.concat(t.dimensions), []),\n        j = B.concat(D).filter(L);\n\n  let k = null;\n\n  if (j.length > 0) {\n    let e = Number.POSITIVE_INFINITY,\n        t = Number.NEGATIVE_INFINITY;\n    j.forEach(n => {\n      const {\n        extent: r\n      } = n;\n      A(r) ? r.forEach(n => {\n        e = Math.min(e, n.getTime()), t = Math.max(t, n.getTime());\n      }) : r.forEach(n => {\n        e = Math.min(e, n.min.getTime()), t = Math.max(t, n.max.getTime());\n      });\n    }), k = {\n      startTimeField: null,\n      endTimeField: null,\n      trackIdField: null,\n      timeExtent: [e, t]\n    };\n  }\n\n  return {\n    copyright: p,\n    description: x,\n    dimensions: B,\n    extent: C,\n    fullExtents: T,\n    featureInfoFormat: V,\n    featureInfoUrl: v,\n    mapUrl: w,\n    maxWidth: b,\n    maxHeight: E,\n    maxScale: q,\n    minScale: _,\n    layers: U,\n    spatialReferences: R,\n    supportedImageFormatTypes: S,\n    timeInfo: k,\n    title: f,\n    version: m\n  };\n}\n\nfunction l(e) {\n  return e.length ? e.filter(e => e.popupEnabled && e.name && e.queryable).map(e => e.name).join(\",\") : \"\";\n}\n\nfunction u(e) {\n  if (e.spatialReferences.length > 0) return e.spatialReferences;\n  if (e.sublayers) for (const t of e.sublayers) {\n    const e = u(t);\n    if (e.length > 0) return e;\n  }\n  return [];\n}\n\nfunction c(e) {\n  let t = [];\n  return e.forEach(e => {\n    t.push(e), e.sublayers && e.sublayers.length && (t = t.concat(c(e.sublayers)), delete e.sublayers);\n  }), t;\n}\n\nfunction m(e, t, n) {\n  var r;\n  return null != (r = t.getAttribute(e)) ? r : n;\n}\n\nfunction f(e, t, n, r) {\n  const i = d(e, n);\n  return i ? m(t, i, r) : r;\n}\n\nfunction d(e, t) {\n  for (let n = 0; n < t.childNodes.length; n++) {\n    const r = t.childNodes[n];\n    if (E(r) && r.nodeName === e) return r;\n  }\n\n  return null;\n}\n\nfunction p(e, t) {\n  const n = [];\n\n  for (let r = 0; r < t.childNodes.length; r++) {\n    const i = t.childNodes[r];\n    E(i) && i.nodeName === e && n.push(i);\n  }\n\n  return n;\n}\n\nfunction h(e, t, n) {\n  const r = d(e, t);\n  return r ? r.textContent : n;\n}\n\nfunction x(e, t, n) {\n  if (!e) return null;\n  const s = parseFloat(e.getAttribute(\"minx\")),\n        a = parseFloat(e.getAttribute(\"miny\")),\n        o = parseFloat(e.getAttribute(\"maxx\")),\n        l = parseFloat(e.getAttribute(\"maxy\"));\n  let u, c, m, f;\n  n ? (u = isNaN(a) ? -Number.MAX_VALUE : a, c = isNaN(s) ? -Number.MAX_VALUE : s, m = isNaN(l) ? Number.MAX_VALUE : l, f = isNaN(o) ? Number.MAX_VALUE : o) : (u = isNaN(s) ? -Number.MAX_VALUE : s, c = isNaN(a) ? -Number.MAX_VALUE : a, m = isNaN(o) ? Number.MAX_VALUE : o, f = isNaN(l) ? Number.MAX_VALUE : l);\n  const d = new i({\n    wkid: t\n  });\n  return new r({\n    xmin: u,\n    ymin: c,\n    xmax: m,\n    ymax: f,\n    spatialReference: d\n  });\n}\n\nfunction N(e, t) {\n  const n = d(t, e);\n\n  if (n) {\n    const e = d(\"DCPType\", n);\n\n    if (e) {\n      const t = d(\"HTTP\", e);\n\n      if (t) {\n        const e = d(\"Get\", t);\n\n        if (e) {\n          let t = f(\"OnlineResource\", \"xlink:href\", e, null);\n          if (t) return t.indexOf(\"&\") === t.length - 1 && (t = t.substring(0, t.length - 1)), F(t, [\"service\", \"request\"]);\n        }\n      }\n    }\n  }\n\n  return null;\n}\n\nfunction g(e, t) {\n  const n = p(\"Operation\", e);\n\n  if (0 === n.length) {\n    return p(\"Format\", d(t, e)).map(e => e.textContent);\n  }\n\n  const r = [];\n  return n.forEach(e => {\n    if (e.getAttribute(\"name\") === t) {\n      p(\"Format\", e).forEach(e => {\n        r.push(e.textContent);\n      });\n    }\n  }), r;\n}\n\nfunction b(e, t, n) {\n  const r = d(t, e);\n  if (!r) return n;\n  const {\n    textContent: i\n  } = r;\n  if (null == i || \"\" === i) return n;\n  const s = Number(i);\n  return isNaN(s) ? n : s;\n}\n\nfunction y(e, t, n) {\n  var o;\n  if (!e) return null;\n  const l = {\n    id: n.idCounter++,\n    fullExtents: [],\n    parentLayerId: null,\n    queryable: \"1\" === e.getAttribute(\"queryable\"),\n    spatialReferences: [],\n    sublayers: null\n  },\n        u = d(\"LatLonBoundingBox\", e),\n        c = d(\"EX_GeographicBoundingBox\", e);\n  let f = null;\n  u && (f = x(u, 4326)), c && (f = new r(0, 0, 0, 0, new i({\n    wkid: 4326\n  })), f.xmin = parseFloat(h(\"westBoundLongitude\", c, \"0\")), f.ymin = parseFloat(h(\"southBoundLatitude\", c, \"0\")), f.xmax = parseFloat(h(\"eastBoundLongitude\", c, \"0\")), f.ymax = parseFloat(h(\"northBoundLatitude\", c, \"0\"))), u || c || (f = new r(-180, -90, 180, 90, new i({\n    wkid: 4326\n  }))), l.minScale = b(e, \"MaxScaleDenominator\", 0), l.maxScale = b(e, \"MinScaleDenominator\", 0);\n  const N = [\"1.0.0\", \"1.1.0\", \"1.1.1\"].indexOf(t) > -1 ? \"SRS\" : \"CRS\";\n  return Array.prototype.slice.call(e.childNodes).forEach(e => {\n    if (\"Name\" === e.nodeName) l.name = e.textContent || \"\";else if (\"Title\" === e.nodeName) l.title = e.textContent || \"\";else if (\"Abstract\" === e.nodeName) l.description = e.textContent || \"\";else if (\"BoundingBox\" === e.nodeName) {\n      const n = e.getAttribute(N);\n\n      if (n && 0 === n.indexOf(\"EPSG:\")) {\n        const r = parseInt(n.substring(5), 10);\n        0 === r || isNaN(r) || f || (f = \"1.3.0\" === t ? x(e, r, s(r)) : x(e, r));\n      }\n\n      const r = n && n.indexOf(\":\");\n\n      if (r && r > -1) {\n        let i = parseInt(n.substring(r + 1, n.length), 10);\n        0 === i || isNaN(i) || (i = a[i] ? a[i] : i);\n        const o = \"1.3.0\" === t ? x(e, i, s(i)) : x(e, i);\n        l.fullExtents.push(o);\n      }\n    } else if (e.nodeName === N) {\n      e.textContent.split(\" \").forEach(e => {\n        const t = e.includes(\":\") ? parseInt(e.split(\":\")[1], 10) : parseInt(e, 10);\n\n        if (0 !== t && !isNaN(t)) {\n          const e = a[t] ? a[t] : t;\n          l.spatialReferences.includes(e) || l.spatialReferences.push(e);\n        }\n      });\n    } else if (\"Style\" !== e.nodeName || l.legendURL) {\n      if (\"Layer\" === e.nodeName) {\n        const r = y(e, t, n);\n        r && (r.parentLayerId = l.id, l.sublayers || (l.sublayers = []), l.sublayers.push(r));\n      }\n    } else {\n      const t = d(\"LegendURL\", e);\n\n      if (t) {\n        const e = d(\"OnlineResource\", t);\n        e && (l.legendURL = e.getAttribute(\"xlink:href\"));\n      }\n    }\n  }), l.extent = null == (o = f) ? void 0 : o.toJSON(), l.dimensions = p(\"Dimension\", e).filter(e => e.getAttribute(\"name\") && e.getAttribute(\"units\") && e.textContent).map(e => {\n    const t = e.getAttribute(\"name\"),\n          n = e.getAttribute(\"units\"),\n          r = e.textContent,\n          i = e.getAttribute(\"unitSymbol\"),\n          s = e.getAttribute(\"default\"),\n          a = \"0\" !== m(\"default\", e, \"0\"),\n          o = \"0\" !== m(\"nearestValue\", e, \"0\"),\n          l = \"0\" !== m(\"current\", e, \"0\");\n\n    if (L({\n      name: t,\n      units: n\n    })) {\n      return {\n        name: \"time\",\n        units: \"ISO8601\",\n        extent: C(r),\n        default: C(s),\n        multipleValues: a,\n        nearestValue: o,\n        current: l\n      };\n    }\n\n    if (w({\n      name: t,\n      units: n\n    })) {\n      return {\n        name: \"elevation\",\n        units: n,\n        extent: M(r),\n        unitSymbol: i,\n        default: M(s),\n        multipleValues: a,\n        nearestValue: o\n      };\n    }\n\n    return {\n      name: t,\n      units: n,\n      extent: O(r),\n      unitSymbol: i,\n      default: O(s),\n      multipleValues: a,\n      nearestValue: o\n    };\n  }), l;\n}\n\nfunction A(e) {\n  return Array.isArray(e) && e.length > 0 && e[0] instanceof Date;\n}\n\nfunction E(e) {\n  return e.nodeType === Node.ELEMENT_NODE;\n}\n\nfunction S(e) {\n  return void 0 !== e.min && void 0 !== e.max;\n}\n\nfunction w(e) {\n  return /^elevation$/i.test(e.name) && /^(epsg|crs):\\d+$/i.test(e.units);\n}\n\nfunction I(e) {\n  return !L(e) && !w(e);\n}\n\nfunction L(e) {\n  return /^time$/i.test(e.name) && /^iso8601$/i.test(e.units);\n}\n\nfunction F(e, t) {\n  const r = [],\n        i = n(e);\n\n  for (const n in i.query) i.query.hasOwnProperty(n) && -1 === t.indexOf(n.toLowerCase()) && r.push(n + \"=\" + i.query[n]);\n\n  return i.path + (r.length ? \"?\" + r.join(\"&\") : \"\");\n}\n\nfunction M(e) {\n  if (!e) return null;\n  const t = -1 !== e.indexOf(\"/\"),\n        n = e.split(\",\");\n  return t ? n.map(e => {\n    const t = e.split(\"/\");\n    if (t.length < 2) return null;\n    return {\n      min: parseFloat(t[0]),\n      max: parseFloat(t[1]),\n      resolution: t.length >= 3 && \"0\" !== t[2] ? parseFloat(t[2]) : void 0\n    };\n  }).filter(e => e) : n.map(e => parseFloat(e));\n}\n\nfunction O(e) {\n  if (!e) return null;\n  const t = -1 !== e.indexOf(\"/\"),\n        n = e.split(\",\");\n  return t ? n.map(e => {\n    const t = e.split(\"/\");\n    if (t.length < 2) return null;\n    return {\n      min: t[0],\n      max: t[1],\n      resolution: t.length >= 3 && \"0\" !== t[2] ? t[2] : void 0\n    };\n  }).filter(e => e) : n;\n}\n\nfunction C(e) {\n  if (!e) return null;\n  const t = -1 !== e.indexOf(\"/\"),\n        n = e.split(\",\");\n  return t ? n.map(e => {\n    const t = e.split(\"/\");\n    if (t.length < 2) return null;\n    return {\n      min: new Date(t[0]),\n      max: new Date(t[1]),\n      resolution: t.length >= 3 && \"0\" !== t[2] ? T(t[2]) : void 0\n    };\n  }).filter(e => e) : n.map(e => new Date(e));\n}\n\nfunction T(e) {\n  const t = /(?:p(\\d+y|\\d+(?:.|,)\\d+y)?(\\d+m|\\d+(?:.|,)\\d+m)?(\\d+d|\\d+(?:.|,)\\d+d)?)?(?:t(\\d+h|\\d+(?:.|,)\\d+h)?(\\d+m|\\d+(?:.|,)\\d+m)?(\\d+s|\\d+(?:.|,)\\d+s)?)?/i,\n        n = e.match(t);\n  if (!n) return null;\n  return {\n    years: R(n[1]),\n    months: R(n[2]),\n    days: R(n[3]),\n    hours: R(n[4]),\n    minutes: R(n[5]),\n    seconds: R(n[6])\n  };\n}\n\nfunction R(e) {\n  if (!e) return 0;\n  const t = /(?:\\d+(?:.|,)\\d+|\\d+)/,\n        n = e.match(t);\n  if (!n) return 0;\n  const r = n[0].replace(\",\", \".\");\n  return Number(r);\n}\n\nfunction v(e) {\n  return e.toISOString().replace(/\\.[0-9]{3}/, \"\");\n}\n\nconst V = new Set([102100, 3857, 102113, 900913]),\n      U = new Set([3395, 54004]);\n\nfunction _(e, n) {\n  let r = e.wkid;\n  return t(n) ? r : (!n.includes(r) && e.latestWkid && (r = e.latestWkid), V.has(r) ? n.find(e => V.has(e)) || n.find(e => U.has(e)) || 102100 : r);\n}\n\nexport { T as fromISODuration, l as getPopupLayers, S as isDimensionInterval, w as isElevationDimension, I as isGenericDimension, L as isTimeDimension, _ as normalizeWKID, o as parseCapabilities, v as toISOString };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/layers/support/wmsUtils.js"],"names":["e","isNone","t","urlToObject","n","r","i","isAxesOrderReversedForWkid","s","a","o","idCounter","DOMParser","parseFromString","documentElement","nodeName","Array","prototype","slice","call","childNodes","map","textContent","join","d","l","m","getAttribute","f","h","p","x","b","parseInt","E","S","g","w","N","I","y","F","M","forEach","name","sublayers","push","O","C","T","fullExtents","length","extent","toJSON","R","spatialReferences","u","v","V","indexOf","queryable","U","c","_","minScale","q","maxScale","B","dimensions","D","reduce","concat","j","filter","L","k","Number","POSITIVE_INFINITY","NEGATIVE_INFINITY","A","Math","min","getTime","max","startTimeField","endTimeField","trackIdField","timeExtent","copyright","description","featureInfoFormat","featureInfoUrl","mapUrl","maxWidth","maxHeight","layers","supportedImageFormatTypes","timeInfo","title","version","popupEnabled","parseFloat","isNaN","MAX_VALUE","wkid","xmin","ymin","xmax","ymax","spatialReference","substring","id","parentLayerId","split","includes","legendURL","units","default","multipleValues","nearestValue","current","unitSymbol","isArray","Date","nodeType","Node","ELEMENT_NODE","test","query","hasOwnProperty","toLowerCase","path","resolution","match","years","months","days","hours","minutes","seconds","replace","toISOString","Set","latestWkid","has","find","fromISODuration","getPopupLayers","isDimensionInterval","isElevationDimension","isGenericDimension","isTimeDimension","normalizeWKID","parseCapabilities"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport e from\"../../core/Error.js\";import{isNone as t}from\"../../core/maybe.js\";import{urlToObject as n}from\"../../core/urlUtils.js\";import r from\"../../geometry/Extent.js\";import i from\"../../geometry/SpatialReference.js\";import{isAxesOrderReversedForWkid as s}from\"../ogc/crsUtils.js\";const a={84:4326,83:4269,27:4267};function o(t){if(!t)return null;const n={idCounter:-1};if(\"string\"==typeof t){t=(new DOMParser).parseFromString(t,\"text/xml\")}const i=t.documentElement;if(\"ServiceExceptionReport\"===i.nodeName){const t=Array.prototype.slice.call(i.childNodes).map((e=>e.textContent)).join(\"\\r\\n\");throw new e(\"wmslayer:wms-capabilities-xml-is-not-valid\",\"The server returned errors when the WMS capabilities were requested.\",t)}const s=d(\"Capability\",i),a=d(\"Service\",i),o=d(\"Request\",s);if(!s||!a||!o)return null;const l=d(\"Layer\",s);if(!l)return null;const m=\"WMS_Capabilities\"===i.nodeName||\"WMT_MS_Capabilities\"===i.nodeName?i.getAttribute(\"version\"):\"1.3.0\",f=h(\"Title\",a,\"\")||h(\"Name\",a,\"\"),p=h(\"AccessConstraints\",a,\"\"),x=h(\"Abstract\",a,\"\"),b=parseInt(h(\"MaxWidth\",a,\"5000\"),10),E=parseInt(h(\"MaxHeight\",a,\"5000\"),10),S=g(o,\"GetMap\"),w=N(o,\"GetMap\"),I=y(l,m,n);let F,M=0;if(Array.prototype.slice.call(s.childNodes).forEach((e=>{\"Layer\"===e.nodeName&&(0===M?F=e:1===M?(I.name&&(I.name=\"\",I.sublayers.push(y(F,m,n))),I.sublayers.push(y(e,m,n))):I.sublayers.push(y(e,m,n)),M++)})),!I)return null;let O,C;const T=I.fullExtents;if(O=I.sublayers,O||(O=[]),0===O.length&&O.push(I),C=I.extent,!C){const e=new r(O[0].extent);I.extent=e.toJSON(),C=I.extent}const R=I.spatialReferences.length>0?I.spatialReferences:u(I),v=N(o,\"GetFeatureInfo\");let V;if(v){const e=g(o,\"GetFeatureInfo\");e.indexOf(\"text/html\")>-1?V=\"text/html\":e.indexOf(\"text/plain\")>-1&&(V=\"text/plain\")}if(!V){const e=function(t){t&&(t.queryable=!1,t.sublayers&&t.sublayers.forEach((t=>{e(t)})))};e(I)}const U=c(O),_=I.minScale||0,q=I.maxScale||0,B=I.dimensions,D=U.reduce(((e,t)=>e.concat(t.dimensions)),[]),j=B.concat(D).filter(L);let k=null;if(j.length>0){let e=Number.POSITIVE_INFINITY,t=Number.NEGATIVE_INFINITY;j.forEach((n=>{const{extent:r}=n;A(r)?r.forEach((n=>{e=Math.min(e,n.getTime()),t=Math.max(t,n.getTime())})):r.forEach((n=>{e=Math.min(e,n.min.getTime()),t=Math.max(t,n.max.getTime())}))})),k={startTimeField:null,endTimeField:null,trackIdField:null,timeExtent:[e,t]}}return{copyright:p,description:x,dimensions:B,extent:C,fullExtents:T,featureInfoFormat:V,featureInfoUrl:v,mapUrl:w,maxWidth:b,maxHeight:E,maxScale:q,minScale:_,layers:U,spatialReferences:R,supportedImageFormatTypes:S,timeInfo:k,title:f,version:m}}function l(e){return e.length?e.filter((e=>e.popupEnabled&&e.name&&e.queryable)).map((e=>e.name)).join(\",\"):\"\"}function u(e){if(e.spatialReferences.length>0)return e.spatialReferences;if(e.sublayers)for(const t of e.sublayers){const e=u(t);if(e.length>0)return e}return[]}function c(e){let t=[];return e.forEach((e=>{t.push(e),e.sublayers&&e.sublayers.length&&(t=t.concat(c(e.sublayers)),delete e.sublayers)})),t}function m(e,t,n){var r;return null!=(r=t.getAttribute(e))?r:n}function f(e,t,n,r){const i=d(e,n);return i?m(t,i,r):r}function d(e,t){for(let n=0;n<t.childNodes.length;n++){const r=t.childNodes[n];if(E(r)&&r.nodeName===e)return r}return null}function p(e,t){const n=[];for(let r=0;r<t.childNodes.length;r++){const i=t.childNodes[r];E(i)&&i.nodeName===e&&n.push(i)}return n}function h(e,t,n){const r=d(e,t);return r?r.textContent:n}function x(e,t,n){if(!e)return null;const s=parseFloat(e.getAttribute(\"minx\")),a=parseFloat(e.getAttribute(\"miny\")),o=parseFloat(e.getAttribute(\"maxx\")),l=parseFloat(e.getAttribute(\"maxy\"));let u,c,m,f;n?(u=isNaN(a)?-Number.MAX_VALUE:a,c=isNaN(s)?-Number.MAX_VALUE:s,m=isNaN(l)?Number.MAX_VALUE:l,f=isNaN(o)?Number.MAX_VALUE:o):(u=isNaN(s)?-Number.MAX_VALUE:s,c=isNaN(a)?-Number.MAX_VALUE:a,m=isNaN(o)?Number.MAX_VALUE:o,f=isNaN(l)?Number.MAX_VALUE:l);const d=new i({wkid:t});return new r({xmin:u,ymin:c,xmax:m,ymax:f,spatialReference:d})}function N(e,t){const n=d(t,e);if(n){const e=d(\"DCPType\",n);if(e){const t=d(\"HTTP\",e);if(t){const e=d(\"Get\",t);if(e){let t=f(\"OnlineResource\",\"xlink:href\",e,null);if(t)return t.indexOf(\"&\")===t.length-1&&(t=t.substring(0,t.length-1)),F(t,[\"service\",\"request\"])}}}}return null}function g(e,t){const n=p(\"Operation\",e);if(0===n.length){return p(\"Format\",d(t,e)).map((e=>e.textContent))}const r=[];return n.forEach((e=>{if(e.getAttribute(\"name\")===t){p(\"Format\",e).forEach((e=>{r.push(e.textContent)}))}})),r}function b(e,t,n){const r=d(t,e);if(!r)return n;const{textContent:i}=r;if(null==i||\"\"===i)return n;const s=Number(i);return isNaN(s)?n:s}function y(e,t,n){var o;if(!e)return null;const l={id:n.idCounter++,fullExtents:[],parentLayerId:null,queryable:\"1\"===e.getAttribute(\"queryable\"),spatialReferences:[],sublayers:null},u=d(\"LatLonBoundingBox\",e),c=d(\"EX_GeographicBoundingBox\",e);let f=null;u&&(f=x(u,4326)),c&&(f=new r(0,0,0,0,new i({wkid:4326})),f.xmin=parseFloat(h(\"westBoundLongitude\",c,\"0\")),f.ymin=parseFloat(h(\"southBoundLatitude\",c,\"0\")),f.xmax=parseFloat(h(\"eastBoundLongitude\",c,\"0\")),f.ymax=parseFloat(h(\"northBoundLatitude\",c,\"0\"))),u||c||(f=new r(-180,-90,180,90,new i({wkid:4326}))),l.minScale=b(e,\"MaxScaleDenominator\",0),l.maxScale=b(e,\"MinScaleDenominator\",0);const N=[\"1.0.0\",\"1.1.0\",\"1.1.1\"].indexOf(t)>-1?\"SRS\":\"CRS\";return Array.prototype.slice.call(e.childNodes).forEach((e=>{if(\"Name\"===e.nodeName)l.name=e.textContent||\"\";else if(\"Title\"===e.nodeName)l.title=e.textContent||\"\";else if(\"Abstract\"===e.nodeName)l.description=e.textContent||\"\";else if(\"BoundingBox\"===e.nodeName){const n=e.getAttribute(N);if(n&&0===n.indexOf(\"EPSG:\")){const r=parseInt(n.substring(5),10);0===r||isNaN(r)||f||(f=\"1.3.0\"===t?x(e,r,s(r)):x(e,r))}const r=n&&n.indexOf(\":\");if(r&&r>-1){let i=parseInt(n.substring(r+1,n.length),10);0===i||isNaN(i)||(i=a[i]?a[i]:i);const o=\"1.3.0\"===t?x(e,i,s(i)):x(e,i);l.fullExtents.push(o)}}else if(e.nodeName===N){e.textContent.split(\" \").forEach((e=>{const t=e.includes(\":\")?parseInt(e.split(\":\")[1],10):parseInt(e,10);if(0!==t&&!isNaN(t)){const e=a[t]?a[t]:t;l.spatialReferences.includes(e)||l.spatialReferences.push(e)}}))}else if(\"Style\"!==e.nodeName||l.legendURL){if(\"Layer\"===e.nodeName){const r=y(e,t,n);r&&(r.parentLayerId=l.id,l.sublayers||(l.sublayers=[]),l.sublayers.push(r))}}else{const t=d(\"LegendURL\",e);if(t){const e=d(\"OnlineResource\",t);e&&(l.legendURL=e.getAttribute(\"xlink:href\"))}}})),l.extent=null==(o=f)?void 0:o.toJSON(),l.dimensions=p(\"Dimension\",e).filter((e=>e.getAttribute(\"name\")&&e.getAttribute(\"units\")&&e.textContent)).map((e=>{const t=e.getAttribute(\"name\"),n=e.getAttribute(\"units\"),r=e.textContent,i=e.getAttribute(\"unitSymbol\"),s=e.getAttribute(\"default\"),a=\"0\"!==m(\"default\",e,\"0\"),o=\"0\"!==m(\"nearestValue\",e,\"0\"),l=\"0\"!==m(\"current\",e,\"0\");if(L({name:t,units:n})){return{name:\"time\",units:\"ISO8601\",extent:C(r),default:C(s),multipleValues:a,nearestValue:o,current:l}}if(w({name:t,units:n})){return{name:\"elevation\",units:n,extent:M(r),unitSymbol:i,default:M(s),multipleValues:a,nearestValue:o}}return{name:t,units:n,extent:O(r),unitSymbol:i,default:O(s),multipleValues:a,nearestValue:o}})),l}function A(e){return Array.isArray(e)&&e.length>0&&e[0]instanceof Date}function E(e){return e.nodeType===Node.ELEMENT_NODE}function S(e){return void 0!==e.min&&void 0!==e.max}function w(e){return/^elevation$/i.test(e.name)&&/^(epsg|crs):\\d+$/i.test(e.units)}function I(e){return!L(e)&&!w(e)}function L(e){return/^time$/i.test(e.name)&&/^iso8601$/i.test(e.units)}function F(e,t){const r=[],i=n(e);for(const n in i.query)i.query.hasOwnProperty(n)&&-1===t.indexOf(n.toLowerCase())&&r.push(n+\"=\"+i.query[n]);return i.path+(r.length?\"?\"+r.join(\"&\"):\"\")}function M(e){if(!e)return null;const t=-1!==e.indexOf(\"/\"),n=e.split(\",\");return t?n.map((e=>{const t=e.split(\"/\");if(t.length<2)return null;return{min:parseFloat(t[0]),max:parseFloat(t[1]),resolution:t.length>=3&&\"0\"!==t[2]?parseFloat(t[2]):void 0}})).filter((e=>e)):n.map((e=>parseFloat(e)))}function O(e){if(!e)return null;const t=-1!==e.indexOf(\"/\"),n=e.split(\",\");return t?n.map((e=>{const t=e.split(\"/\");if(t.length<2)return null;return{min:t[0],max:t[1],resolution:t.length>=3&&\"0\"!==t[2]?t[2]:void 0}})).filter((e=>e)):n}function C(e){if(!e)return null;const t=-1!==e.indexOf(\"/\"),n=e.split(\",\");return t?n.map((e=>{const t=e.split(\"/\");if(t.length<2)return null;return{min:new Date(t[0]),max:new Date(t[1]),resolution:t.length>=3&&\"0\"!==t[2]?T(t[2]):void 0}})).filter((e=>e)):n.map((e=>new Date(e)))}function T(e){const t=/(?:p(\\d+y|\\d+(?:.|,)\\d+y)?(\\d+m|\\d+(?:.|,)\\d+m)?(\\d+d|\\d+(?:.|,)\\d+d)?)?(?:t(\\d+h|\\d+(?:.|,)\\d+h)?(\\d+m|\\d+(?:.|,)\\d+m)?(\\d+s|\\d+(?:.|,)\\d+s)?)?/i,n=e.match(t);if(!n)return null;return{years:R(n[1]),months:R(n[2]),days:R(n[3]),hours:R(n[4]),minutes:R(n[5]),seconds:R(n[6])}}function R(e){if(!e)return 0;const t=/(?:\\d+(?:.|,)\\d+|\\d+)/,n=e.match(t);if(!n)return 0;const r=n[0].replace(\",\",\".\");return Number(r)}function v(e){return e.toISOString().replace(/\\.[0-9]{3}/,\"\")}const V=new Set([102100,3857,102113,900913]),U=new Set([3395,54004]);function _(e,n){let r=e.wkid;return t(n)?r:(!n.includes(r)&&e.latestWkid&&(r=e.latestWkid),V.has(r)?n.find((e=>V.has(e)))||n.find((e=>U.has(e)))||102100:r)}export{T as fromISODuration,l as getPopupLayers,S as isDimensionInterval,w as isElevationDimension,I as isGenericDimension,L as isTimeDimension,_ as normalizeWKID,o as parseCapabilities,v as toISOString};\n"]},"metadata":{},"sourceType":"module"}