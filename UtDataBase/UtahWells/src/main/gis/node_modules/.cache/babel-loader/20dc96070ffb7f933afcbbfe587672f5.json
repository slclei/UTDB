{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../chunks/tslib.es6.js\";\nimport \"../../geometry.js\";\nimport { unwrap as t } from \"../../core/maybe.js\";\nimport { property as r } from \"../../core/accessorSupport/decorators/property.js\";\nimport \"../../core/arrayUtils.js\";\nimport \"../../core/has.js\";\nimport \"../../core/accessorSupport/ensureType.js\";\nimport { reader as o } from \"../../core/accessorSupport/decorators/reader.js\";\nimport { subclass as s } from \"../../core/accessorSupport/decorators/subclass.js\";\nimport a from \"./DirectionsFeature.js\";\nimport n from \"./FeatureSet.js\";\nimport p from \"../../geometry/Extent.js\";\nimport i from \"../../geometry/SpatialReference.js\";\nimport m from \"../../geometry/Polyline.js\";\nimport l from \"../../geometry/Point.js\";\nlet u = class extends n {\n  constructor(e) {\n    super(e), this.extent = null, this.features = null, this.geometryType = \"polyline\", this.routeId = null, this.routeName = null, this.totalDriveTime = null, this.totalLength = null, this.totalTime = null;\n  }\n\n  readFeatures(e, t) {\n    var r;\n    if (!e) return [];\n    const o = null != (r = t.summary.envelope.spatialReference) ? r : t.spatialReference,\n          s = o && i.fromJSON(o);\n    return e.map(e => {\n      var t, r;\n\n      const o = this._decompressGeometry(e.compressedGeometry),\n            n = new m({ ...o,\n        spatialReference: s\n      }),\n            p = null != (t = null == (r = e.events) ? void 0 : r.map(e => {\n        const {\n          arriveTimeUTC: t,\n          ETA: r,\n          point: {\n            x: o,\n            y: n,\n            z: p\n          },\n          strings: i\n        } = e;\n        return new a({\n          geometry: new l({\n            x: o,\n            y: n,\n            z: p,\n            hasZ: void 0 !== p,\n            spatialReference: s\n          }),\n          attributes: {\n            ETA: r,\n            arriveTimeUTC: t\n          },\n          strings: i\n        });\n      })) ? t : [];\n\n      return new a({\n        attributes: e.attributes,\n        events: p,\n        geometry: n,\n        strings: e.strings\n      });\n    });\n  }\n\n  get mergedGeometry() {\n    if (!this.features) return null;\n    const e = this.features.map(_ref => {\n      let {\n        geometry: e\n      } = _ref;\n      return t(e);\n    }),\n          r = this.get(\"extent.spatialReference\");\n    return this._mergePolylinesToSinglePath(e, r);\n  }\n\n  get strings() {\n    return this.features.map(_ref2 => {\n      let {\n        strings: e\n      } = _ref2;\n      return e;\n    });\n  }\n\n  _decompressGeometry(e) {\n    let t = 0,\n        r = 0,\n        o = 0,\n        s = 0;\n    const a = [];\n    let n,\n        p,\n        i,\n        m,\n        l,\n        u,\n        c,\n        y,\n        h = 0,\n        f = 0,\n        d = 0;\n\n    if (l = e.match(/((\\+|\\-)[^\\+\\-\\|]+|\\|)/g), l || (l = []), 0 === parseInt(l[h], 32)) {\n      h = 2;\n      const e = parseInt(l[h], 32);\n      h++, u = parseInt(l[h], 32), h++, 1 & e && (f = l.indexOf(\"|\") + 1, c = parseInt(l[f], 32), f++), 2 & e && (d = l.indexOf(\"|\", f) + 1, y = parseInt(l[d], 32), d++);\n    } else u = parseInt(l[h], 32), h++;\n\n    for (; h < l.length && \"|\" !== l[h];) {\n      n = parseInt(l[h], 32) + t, h++, t = n, p = parseInt(l[h], 32) + r, h++, r = p;\n      const e = [n / u, p / u];\n      f && (m = parseInt(l[f], 32) + o, f++, o = m, e.push(m / c)), d && (i = parseInt(l[d], 32) + s, d++, s = i, e.push(i / y)), a.push(e);\n    }\n\n    return {\n      paths: [a],\n      hasZ: f > 0,\n      hasM: d > 0\n    };\n  }\n\n  _mergePolylinesToSinglePath(e, t) {\n    if (0 === e.length) return new m({\n      spatialReference: t\n    });\n    const r = [];\n\n    for (const n of e) for (const e of n.paths) r.push(...e);\n\n    const o = [];\n    r.forEach((e, t) => {\n      0 !== t && e[0] === r[t - 1][0] && e[1] === r[t - 1][1] || o.push(e);\n    });\n    const {\n      hasM: s,\n      hasZ: a\n    } = e[0];\n    return new m({\n      hasM: s,\n      hasZ: a,\n      paths: [o],\n      spatialReference: t\n    });\n  }\n\n};\ne([r({\n  type: p,\n  json: {\n    read: {\n      source: \"summary.envelope\"\n    }\n  }\n})], u.prototype, \"extent\", void 0), e([r()], u.prototype, \"features\", void 0), e([o(\"features\")], u.prototype, \"readFeatures\", null), e([r()], u.prototype, \"geometryType\", void 0), e([r({\n  readOnly: !0\n})], u.prototype, \"mergedGeometry\", null), e([r()], u.prototype, \"routeId\", void 0), e([r()], u.prototype, \"routeName\", void 0), e([r({\n  value: null,\n  readOnly: !0\n})], u.prototype, \"strings\", null), e([r({\n  json: {\n    read: {\n      source: \"summary.totalDriveTime\"\n    }\n  }\n})], u.prototype, \"totalDriveTime\", void 0), e([r({\n  json: {\n    read: {\n      source: \"summary.totalLength\"\n    }\n  }\n})], u.prototype, \"totalLength\", void 0), e([r({\n  json: {\n    read: {\n      source: \"summary.totalTime\"\n    }\n  }\n})], u.prototype, \"totalTime\", void 0), u = e([s(\"esri.rest.support.DirectionsFeatureSet\")], u);\nconst c = u;\nexport { c as default };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/rest/support/DirectionsFeatureSet.js"],"names":["_","e","unwrap","t","property","r","reader","o","subclass","s","a","n","p","i","m","l","u","constructor","extent","features","geometryType","routeId","routeName","totalDriveTime","totalLength","totalTime","readFeatures","summary","envelope","spatialReference","fromJSON","map","_decompressGeometry","compressedGeometry","events","arriveTimeUTC","ETA","point","x","y","z","strings","geometry","hasZ","attributes","mergedGeometry","get","_mergePolylinesToSinglePath","c","h","f","d","match","parseInt","indexOf","length","push","paths","hasM","forEach","type","json","read","source","prototype","readOnly","value","default"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import\"../../geometry.js\";import{unwrap as t}from\"../../core/maybe.js\";import{property as r}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import{reader as o}from\"../../core/accessorSupport/decorators/reader.js\";import{subclass as s}from\"../../core/accessorSupport/decorators/subclass.js\";import a from\"./DirectionsFeature.js\";import n from\"./FeatureSet.js\";import p from\"../../geometry/Extent.js\";import i from\"../../geometry/SpatialReference.js\";import m from\"../../geometry/Polyline.js\";import l from\"../../geometry/Point.js\";let u=class extends n{constructor(e){super(e),this.extent=null,this.features=null,this.geometryType=\"polyline\",this.routeId=null,this.routeName=null,this.totalDriveTime=null,this.totalLength=null,this.totalTime=null}readFeatures(e,t){var r;if(!e)return[];const o=null!=(r=t.summary.envelope.spatialReference)?r:t.spatialReference,s=o&&i.fromJSON(o);return e.map((e=>{var t,r;const o=this._decompressGeometry(e.compressedGeometry),n=new m({...o,spatialReference:s}),p=null!=(t=null==(r=e.events)?void 0:r.map((e=>{const{arriveTimeUTC:t,ETA:r,point:{x:o,y:n,z:p},strings:i}=e;return new a({geometry:new l({x:o,y:n,z:p,hasZ:void 0!==p,spatialReference:s}),attributes:{ETA:r,arriveTimeUTC:t},strings:i})})))?t:[];return new a({attributes:e.attributes,events:p,geometry:n,strings:e.strings})}))}get mergedGeometry(){if(!this.features)return null;const e=this.features.map((({geometry:e})=>t(e))),r=this.get(\"extent.spatialReference\");return this._mergePolylinesToSinglePath(e,r)}get strings(){return this.features.map((({strings:e})=>e))}_decompressGeometry(e){let t=0,r=0,o=0,s=0;const a=[];let n,p,i,m,l,u,c,y,h=0,f=0,d=0;if(l=e.match(/((\\+|\\-)[^\\+\\-\\|]+|\\|)/g),l||(l=[]),0===parseInt(l[h],32)){h=2;const e=parseInt(l[h],32);h++,u=parseInt(l[h],32),h++,1&e&&(f=l.indexOf(\"|\")+1,c=parseInt(l[f],32),f++),2&e&&(d=l.indexOf(\"|\",f)+1,y=parseInt(l[d],32),d++)}else u=parseInt(l[h],32),h++;for(;h<l.length&&\"|\"!==l[h];){n=parseInt(l[h],32)+t,h++,t=n,p=parseInt(l[h],32)+r,h++,r=p;const e=[n/u,p/u];f&&(m=parseInt(l[f],32)+o,f++,o=m,e.push(m/c)),d&&(i=parseInt(l[d],32)+s,d++,s=i,e.push(i/y)),a.push(e)}return{paths:[a],hasZ:f>0,hasM:d>0}}_mergePolylinesToSinglePath(e,t){if(0===e.length)return new m({spatialReference:t});const r=[];for(const n of e)for(const e of n.paths)r.push(...e);const o=[];r.forEach(((e,t)=>{0!==t&&e[0]===r[t-1][0]&&e[1]===r[t-1][1]||o.push(e)}));const{hasM:s,hasZ:a}=e[0];return new m({hasM:s,hasZ:a,paths:[o],spatialReference:t})}};e([r({type:p,json:{read:{source:\"summary.envelope\"}}})],u.prototype,\"extent\",void 0),e([r()],u.prototype,\"features\",void 0),e([o(\"features\")],u.prototype,\"readFeatures\",null),e([r()],u.prototype,\"geometryType\",void 0),e([r({readOnly:!0})],u.prototype,\"mergedGeometry\",null),e([r()],u.prototype,\"routeId\",void 0),e([r()],u.prototype,\"routeName\",void 0),e([r({value:null,readOnly:!0})],u.prototype,\"strings\",null),e([r({json:{read:{source:\"summary.totalDriveTime\"}}})],u.prototype,\"totalDriveTime\",void 0),e([r({json:{read:{source:\"summary.totalLength\"}}})],u.prototype,\"totalLength\",void 0),e([r({json:{read:{source:\"summary.totalTime\"}}})],u.prototype,\"totalTime\",void 0),u=e([s(\"esri.rest.support.DirectionsFeatureSet\")],u);const c=u;export{c as default};\n"]},"metadata":{},"sourceType":"module"}