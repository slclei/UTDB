{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../../chunks/tslib.es6.js\";\nimport t from \"../../../../core/Logger.js\";\nimport { isSome as r } from \"../../../../core/maybe.js\";\nimport { f as o } from \"../../../../chunks/vec3f64.js\";\nimport { ShaderOutput as i } from \"../core/shaderLibrary/ShaderOutputOptions.js\";\nimport { bindSliceUniforms as s } from \"../core/shaderLibrary/Slice.glsl.js\";\nimport { bindCustomOrigin as a } from \"../core/shaderLibrary/attributes/InstancedDoublePrecision.glsl.js\";\nimport { NormalAttributeType as n } from \"../core/shaderLibrary/attributes/NormalAttribute.glsl.js\";\nimport { TextureCoordinateAttributeType as l } from \"../core/shaderLibrary/attributes/TextureCoordinateAttribute.glsl.js\";\nimport { bindVerticalOffsetUniforms as p } from \"../core/shaderLibrary/attributes/VerticalOffset.glsl.js\";\nimport { bindOutputHighlight as c } from \"../core/shaderLibrary/output/OutputHighlight.glsl.js\";\nimport { bindMultipassTerrainTexture as u } from \"../core/shaderLibrary/shading/MultipassTerrainTest.glsl.js\";\nimport { NormalsDoubleSidedMode as h } from \"../core/shaderLibrary/shading/Normals.glsl.js\";\nimport { PBRMode as d, bindPBRUniforms as m } from \"../core/shaderLibrary/shading/PhysicallyBasedRenderingParameters.glsl.js\";\nimport { bindReadShadowMapViewCustomOrigin as f } from \"../core/shaderLibrary/shading/ReadShadowMap.glsl.js\";\nimport { bindVisualVariablesUniformsForSymbols as g } from \"../core/shaderLibrary/shading/VisualVariables.glsl.js\";\nimport { doublePrecisionRequiresObfuscation as v } from \"../core/shaderLibrary/util/DoublePrecision.glsl.js\";\nimport { bindProjectionMatrix as b, bindViewCustomOrigin as y, bindCameraPosition as T } from \"../core/shaderLibrary/util/View.glsl.js\";\nimport { ReloadableShaderModule as x } from \"../core/shaderTechnique/ReloadableShaderModule.js\";\nimport { ShaderTechnique as M } from \"../core/shaderTechnique/ShaderTechnique.js\";\nimport { parameter as P, ShaderTechniqueConfiguration as C } from \"../core/shaderTechnique/ShaderTechniqueConfiguration.js\";\nimport { AlphaDiscardMode as S, CullFaceOptions as O, TransparencyPassType as D, DepthTestFunction as j } from \"../lib/basicInterfaces.js\";\nimport { Default3D as A } from \"../lib/DefaultVertexAttributeLocations.js\";\nimport { blendingDefault as w, oitBlending as E, oitDepthTest as N, getOITPolygonOffset as U } from \"../lib/OrderIndependentTransparency.js\";\nimport { Program as L } from \"../lib/Program.js\";\nimport { stencilWriteMaskOn as z, stencilToolMaskBaseParams as F, stencilBaseAllZerosParams as R } from \"../lib/StencilUtils.js\";\nimport { colorMixModes as H, bindScreenSizePerspective as B } from \"../materials/internal/MaterialUtil.js\";\nimport { D as k } from \"../../../../chunks/DefaultMaterial.glsl.js\";\nimport { CompareFunction as q } from \"../../../webgl/enums.js\";\nimport { makePipelineState as I, cullingParams as V, defaultDepthWriteParams as _, defaultColorWriteParams as G } from \"../../../webgl/renderState.js\";\nconst W = t.getLogger(\"esri.views.3d.webgl-engine.shaders.DefaultTechnique\");\n\nclass Q extends M {\n  initializeProgram(e) {\n    const t = Q.shader.get(),\n          r = this.configuration,\n          o = t.build({\n      oitEnabled: r.transparencyPassType === D.Color,\n      output: r.output,\n      viewingMode: e.viewingMode,\n      receiveShadows: r.receiveShadows,\n      slicePlaneEnabled: r.slicePlaneEnabled,\n      sliceHighlightDisabled: r.sliceHighlightDisabled,\n      sliceEnabledForVertexPrograms: !1,\n      symbolColor: r.symbolColors,\n      vvSize: r.vvSize,\n      vvColor: r.vvColor,\n      vvInstancingEnabled: !0,\n      instanced: r.instanced,\n      instancedColor: r.instancedColor,\n      instancedDoublePrecision: r.instancedDoublePrecision,\n      pbrMode: r.usePBR ? r.isSchematic ? d.Schematic : d.Normal : d.Disabled,\n      hasMetalnessAndRoughnessTexture: r.hasMetalnessAndRoughnessTexture,\n      hasEmissionTexture: r.hasEmissionTexture,\n      hasOcclusionTexture: r.hasOcclusionTexture,\n      hasNormalTexture: r.hasNormalTexture,\n      hasColorTexture: r.hasColorTexture,\n      hasModelTransformation: r.hasModelTransformation,\n      receiveAmbientOcclusion: r.receiveAmbientOcclusion,\n      useCustomDTRExponentForWater: !1,\n      normalType: r.normalsTypeDerivate ? n.ScreenDerivative : n.Attribute,\n      doubleSidedMode: r.doubleSidedMode,\n      vertexTangents: r.vertexTangents,\n      attributeTextureCoordinates: r.hasMetalnessAndRoughnessTexture || r.hasEmissionTexture || r.hasOcclusionTexture || r.hasNormalTexture || r.hasColorTexture ? l.Default : l.None,\n      textureAlphaPremultiplied: r.textureAlphaPremultiplied,\n      attributeColor: r.vertexColors,\n      screenSizePerspectiveEnabled: r.screenSizePerspective,\n      verticalOffsetEnabled: r.verticalOffset,\n      offsetBackfaces: r.offsetBackfaces,\n      doublePrecisionRequiresObfuscation: v(e.rctx),\n      alphaDiscardMode: r.alphaDiscardMode,\n      supportsTextureAtlas: !1,\n      multipassTerrainEnabled: r.multipassTerrainEnabled,\n      cullAboveGround: r.cullAboveGround\n    });\n    return new L(e.rctx, o, A);\n  }\n\n  bindPass(e, t) {\n    var o, s;\n    b(this.program, t.camera.projectionMatrix);\n    const a = this.configuration.output;\n    this.configuration.hasModelTransformation && (r(e.modelTransformation) ? this.program.setUniformMatrix4fv(\"model\", e.modelTransformation) : W.warnOnce(\"hasModelTransformation true, but no modelTransformation found.\")), (this.configuration.output === i.Depth || t.multipassTerrainEnabled || a === i.Shadow) && this.program.setUniform2fv(\"nearFar\", t.camera.nearFar), t.multipassTerrainEnabled && (this.program.setUniform2fv(\"inverseViewport\", t.inverseViewport), u(this.program, t)), a === i.Alpha && (this.program.setUniform1f(\"opacity\", e.opacity), this.program.setUniform1f(\"layerOpacity\", e.layerOpacity), this.program.setUniform4fv(\"externalColor\", e.externalColor), this.program.setUniform1i(\"colorMixMode\", H[e.colorMixMode])), a === i.Color ? (t.lighting.setUniforms(this.program, !1, t.hasFillLights), this.program.setUniform3fv(\"ambient\", e.ambient), this.program.setUniform3fv(\"diffuse\", e.diffuse), this.program.setUniform4fv(\"externalColor\", e.externalColor), this.program.setUniform1i(\"colorMixMode\", H[e.colorMixMode]), this.program.setUniform1f(\"opacity\", e.opacity), this.program.setUniform1f(\"layerOpacity\", e.layerOpacity), this.configuration.usePBR && m(this.program, e, this.configuration.isSchematic)) : a === i.Highlight && c(this.program, t), g(this.program, e), p(this.program, e, t), B(e.screenSizePerspective, this.program, \"screenSizePerspectiveAlignment\"), e.textureAlphaMode !== S.Mask && e.textureAlphaMode !== S.MaskBlend || this.program.setUniform1f(\"textureAlphaCutoff\", e.textureAlphaCutoff), null == (o = t.shadowMap) || o.bind(this.program), null == (s = t.ssaoHelper) || s.bind(this.program, t.camera);\n  }\n\n  bindDraw(e) {\n    const t = this.configuration.instancedDoublePrecision ? o(e.camera.viewInverseTransposeMatrix[3], e.camera.viewInverseTransposeMatrix[7], e.camera.viewInverseTransposeMatrix[11]) : e.origin;\n    y(this.program, t, e.camera.viewMatrix), this.program.rebindTextures(), (this.configuration.output === i.Color || this.configuration.output === i.Alpha || this.configuration.output === i.Depth && this.configuration.screenSizePerspective || this.configuration.output === i.Normal && this.configuration.screenSizePerspective || this.configuration.output === i.Highlight && this.configuration.screenSizePerspective) && T(this.program, t, e.camera.viewInverseTransposeMatrix), this.configuration.output === i.Normal && this.program.setUniformMatrix4fv(\"viewNormal\", e.camera.viewInverseTransposeMatrix), this.configuration.instancedDoublePrecision && a(this.program, t), s(this.program, this.configuration, e.slicePlane, {\n      origin: t\n    }), this.configuration.output === i.Color && f(this.program, e, t);\n  }\n\n  _convertDepthTestFunction(e) {\n    return e === j.Lequal ? q.LEQUAL : q.LESS;\n  }\n\n  _setPipeline(e, t) {\n    const r = this.configuration,\n          o = e === D.NONE,\n          s = e === D.FrontFace;\n    return I({\n      blending: r.output !== i.Color && r.output !== i.Alpha || !r.transparent ? null : o ? w : E(e),\n      culling: J(r) && V(r.cullFace),\n      depthTest: {\n        func: N(e, this._convertDepthTestFunction(r.customDepthTest))\n      },\n      depthWrite: o || s ? r.writeDepth && _ : null,\n      colorWrite: G,\n      stencilWrite: r.sceneHasOcludees ? z : null,\n      stencilTest: r.sceneHasOcludees ? t ? F : R : null,\n      polygonOffset: o || s ? null : U(r.enableOffset)\n    });\n  }\n\n  initializePipeline() {\n    return this._occludeePipelineState = this._setPipeline(this.configuration.transparencyPassType, !0), this._setPipeline(this.configuration.transparencyPassType, !1);\n  }\n\n  getPipelineState(e, t) {\n    return t ? this._occludeePipelineState : super.getPipelineState(e, t);\n  }\n\n}\n\nfunction J(e) {\n  return e.cullFace ? e.cullFace !== O.None : !e.slicePlaneEnabled && !e.transparent && !e.doubleSidedMode;\n}\n\nQ.shader = new x(k, () => import(\"./DefaultMaterial.glsl.js\"));\n\nclass K extends C {\n  constructor() {\n    super(...arguments), this.output = i.Color, this.alphaDiscardMode = S.Opaque, this.doubleSidedMode = h.None, this.isSchematic = !1, this.vertexColors = !1, this.offsetBackfaces = !1, this.symbolColors = !1, this.vvSize = !1, this.vvColor = !1, this.verticalOffset = !1, this.receiveShadows = !1, this.slicePlaneEnabled = !1, this.sliceHighlightDisabled = !1, this.receiveAmbientOcclusion = !1, this.screenSizePerspective = !1, this.textureAlphaPremultiplied = !1, this.hasColorTexture = !1, this.usePBR = !1, this.hasMetalnessAndRoughnessTexture = !1, this.hasEmissionTexture = !1, this.hasOcclusionTexture = !1, this.hasNormalTexture = !1, this.instanced = !1, this.instancedColor = !1, this.instancedDoublePrecision = !1, this.vertexTangents = !1, this.normalsTypeDerivate = !1, this.writeDepth = !0, this.sceneHasOcludees = !1, this.transparent = !1, this.enableOffset = !0, this.cullFace = O.None, this.transparencyPassType = D.NONE, this.multipassTerrainEnabled = !1, this.cullAboveGround = !1, this.hasModelTransformation = !1, this.customDepthTest = j.Less;\n  }\n\n}\n\ne([P({\n  count: i.COUNT\n})], K.prototype, \"output\", void 0), e([P({\n  count: S.COUNT\n})], K.prototype, \"alphaDiscardMode\", void 0), e([P({\n  count: h.COUNT\n})], K.prototype, \"doubleSidedMode\", void 0), e([P()], K.prototype, \"isSchematic\", void 0), e([P()], K.prototype, \"vertexColors\", void 0), e([P()], K.prototype, \"offsetBackfaces\", void 0), e([P()], K.prototype, \"symbolColors\", void 0), e([P()], K.prototype, \"vvSize\", void 0), e([P()], K.prototype, \"vvColor\", void 0), e([P()], K.prototype, \"verticalOffset\", void 0), e([P()], K.prototype, \"receiveShadows\", void 0), e([P()], K.prototype, \"slicePlaneEnabled\", void 0), e([P()], K.prototype, \"sliceHighlightDisabled\", void 0), e([P()], K.prototype, \"receiveAmbientOcclusion\", void 0), e([P()], K.prototype, \"screenSizePerspective\", void 0), e([P()], K.prototype, \"textureAlphaPremultiplied\", void 0), e([P()], K.prototype, \"hasColorTexture\", void 0), e([P()], K.prototype, \"usePBR\", void 0), e([P()], K.prototype, \"hasMetalnessAndRoughnessTexture\", void 0), e([P()], K.prototype, \"hasEmissionTexture\", void 0), e([P()], K.prototype, \"hasOcclusionTexture\", void 0), e([P()], K.prototype, \"hasNormalTexture\", void 0), e([P()], K.prototype, \"instanced\", void 0), e([P()], K.prototype, \"instancedColor\", void 0), e([P()], K.prototype, \"instancedDoublePrecision\", void 0), e([P()], K.prototype, \"vertexTangents\", void 0), e([P()], K.prototype, \"normalsTypeDerivate\", void 0), e([P()], K.prototype, \"writeDepth\", void 0), e([P()], K.prototype, \"sceneHasOcludees\", void 0), e([P()], K.prototype, \"transparent\", void 0), e([P()], K.prototype, \"enableOffset\", void 0), e([P({\n  count: O.COUNT\n})], K.prototype, \"cullFace\", void 0), e([P({\n  count: D.COUNT\n})], K.prototype, \"transparencyPassType\", void 0), e([P()], K.prototype, \"multipassTerrainEnabled\", void 0), e([P()], K.prototype, \"cullAboveGround\", void 0), e([P()], K.prototype, \"hasModelTransformation\", void 0), e([P({\n  count: j.COUNT\n})], K.prototype, \"customDepthTest\", void 0);\nexport { Q as DefaultMaterialTechnique, K as DefaultMaterialTechniqueConfiguration };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/views/3d/webgl-engine/shaders/DefaultMaterialTechnique.js"],"names":["_","e","t","isSome","r","f","o","ShaderOutput","i","bindSliceUniforms","s","bindCustomOrigin","a","NormalAttributeType","n","TextureCoordinateAttributeType","l","bindVerticalOffsetUniforms","p","bindOutputHighlight","c","bindMultipassTerrainTexture","u","NormalsDoubleSidedMode","h","PBRMode","d","bindPBRUniforms","m","bindReadShadowMapViewCustomOrigin","bindVisualVariablesUniformsForSymbols","g","doublePrecisionRequiresObfuscation","v","bindProjectionMatrix","b","bindViewCustomOrigin","y","bindCameraPosition","T","ReloadableShaderModule","x","ShaderTechnique","M","parameter","P","ShaderTechniqueConfiguration","C","AlphaDiscardMode","S","CullFaceOptions","O","TransparencyPassType","D","DepthTestFunction","j","Default3D","A","blendingDefault","w","oitBlending","E","oitDepthTest","N","getOITPolygonOffset","U","Program","L","stencilWriteMaskOn","z","stencilToolMaskBaseParams","F","stencilBaseAllZerosParams","R","colorMixModes","H","bindScreenSizePerspective","B","k","CompareFunction","q","makePipelineState","I","cullingParams","V","defaultDepthWriteParams","defaultColorWriteParams","G","W","getLogger","Q","initializeProgram","shader","get","configuration","build","oitEnabled","transparencyPassType","Color","output","viewingMode","receiveShadows","slicePlaneEnabled","sliceHighlightDisabled","sliceEnabledForVertexPrograms","symbolColor","symbolColors","vvSize","vvColor","vvInstancingEnabled","instanced","instancedColor","instancedDoublePrecision","pbrMode","usePBR","isSchematic","Schematic","Normal","Disabled","hasMetalnessAndRoughnessTexture","hasEmissionTexture","hasOcclusionTexture","hasNormalTexture","hasColorTexture","hasModelTransformation","receiveAmbientOcclusion","useCustomDTRExponentForWater","normalType","normalsTypeDerivate","ScreenDerivative","Attribute","doubleSidedMode","vertexTangents","attributeTextureCoordinates","Default","None","textureAlphaPremultiplied","attributeColor","vertexColors","screenSizePerspectiveEnabled","screenSizePerspective","verticalOffsetEnabled","verticalOffset","offsetBackfaces","rctx","alphaDiscardMode","supportsTextureAtlas","multipassTerrainEnabled","cullAboveGround","bindPass","program","camera","projectionMatrix","modelTransformation","setUniformMatrix4fv","warnOnce","Depth","Shadow","setUniform2fv","nearFar","inverseViewport","Alpha","setUniform1f","opacity","layerOpacity","setUniform4fv","externalColor","setUniform1i","colorMixMode","lighting","setUniforms","hasFillLights","setUniform3fv","ambient","diffuse","Highlight","textureAlphaMode","Mask","MaskBlend","textureAlphaCutoff","shadowMap","bind","ssaoHelper","bindDraw","viewInverseTransposeMatrix","origin","viewMatrix","rebindTextures","slicePlane","_convertDepthTestFunction","Lequal","LEQUAL","LESS","_setPipeline","NONE","FrontFace","blending","transparent","culling","J","cullFace","depthTest","func","customDepthTest","depthWrite","writeDepth","colorWrite","stencilWrite","sceneHasOcludees","stencilTest","polygonOffset","enableOffset","initializePipeline","_occludeePipelineState","getPipelineState","K","constructor","arguments","Opaque","Less","count","COUNT","prototype","DefaultMaterialTechnique","DefaultMaterialTechniqueConfiguration"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import t from\"../../../../core/Logger.js\";import{isSome as r}from\"../../../../core/maybe.js\";import{f as o}from\"../../../../chunks/vec3f64.js\";import{ShaderOutput as i}from\"../core/shaderLibrary/ShaderOutputOptions.js\";import{bindSliceUniforms as s}from\"../core/shaderLibrary/Slice.glsl.js\";import{bindCustomOrigin as a}from\"../core/shaderLibrary/attributes/InstancedDoublePrecision.glsl.js\";import{NormalAttributeType as n}from\"../core/shaderLibrary/attributes/NormalAttribute.glsl.js\";import{TextureCoordinateAttributeType as l}from\"../core/shaderLibrary/attributes/TextureCoordinateAttribute.glsl.js\";import{bindVerticalOffsetUniforms as p}from\"../core/shaderLibrary/attributes/VerticalOffset.glsl.js\";import{bindOutputHighlight as c}from\"../core/shaderLibrary/output/OutputHighlight.glsl.js\";import{bindMultipassTerrainTexture as u}from\"../core/shaderLibrary/shading/MultipassTerrainTest.glsl.js\";import{NormalsDoubleSidedMode as h}from\"../core/shaderLibrary/shading/Normals.glsl.js\";import{PBRMode as d,bindPBRUniforms as m}from\"../core/shaderLibrary/shading/PhysicallyBasedRenderingParameters.glsl.js\";import{bindReadShadowMapViewCustomOrigin as f}from\"../core/shaderLibrary/shading/ReadShadowMap.glsl.js\";import{bindVisualVariablesUniformsForSymbols as g}from\"../core/shaderLibrary/shading/VisualVariables.glsl.js\";import{doublePrecisionRequiresObfuscation as v}from\"../core/shaderLibrary/util/DoublePrecision.glsl.js\";import{bindProjectionMatrix as b,bindViewCustomOrigin as y,bindCameraPosition as T}from\"../core/shaderLibrary/util/View.glsl.js\";import{ReloadableShaderModule as x}from\"../core/shaderTechnique/ReloadableShaderModule.js\";import{ShaderTechnique as M}from\"../core/shaderTechnique/ShaderTechnique.js\";import{parameter as P,ShaderTechniqueConfiguration as C}from\"../core/shaderTechnique/ShaderTechniqueConfiguration.js\";import{AlphaDiscardMode as S,CullFaceOptions as O,TransparencyPassType as D,DepthTestFunction as j}from\"../lib/basicInterfaces.js\";import{Default3D as A}from\"../lib/DefaultVertexAttributeLocations.js\";import{blendingDefault as w,oitBlending as E,oitDepthTest as N,getOITPolygonOffset as U}from\"../lib/OrderIndependentTransparency.js\";import{Program as L}from\"../lib/Program.js\";import{stencilWriteMaskOn as z,stencilToolMaskBaseParams as F,stencilBaseAllZerosParams as R}from\"../lib/StencilUtils.js\";import{colorMixModes as H,bindScreenSizePerspective as B}from\"../materials/internal/MaterialUtil.js\";import{D as k}from\"../../../../chunks/DefaultMaterial.glsl.js\";import{CompareFunction as q}from\"../../../webgl/enums.js\";import{makePipelineState as I,cullingParams as V,defaultDepthWriteParams as _,defaultColorWriteParams as G}from\"../../../webgl/renderState.js\";const W=t.getLogger(\"esri.views.3d.webgl-engine.shaders.DefaultTechnique\");class Q extends M{initializeProgram(e){const t=Q.shader.get(),r=this.configuration,o=t.build({oitEnabled:r.transparencyPassType===D.Color,output:r.output,viewingMode:e.viewingMode,receiveShadows:r.receiveShadows,slicePlaneEnabled:r.slicePlaneEnabled,sliceHighlightDisabled:r.sliceHighlightDisabled,sliceEnabledForVertexPrograms:!1,symbolColor:r.symbolColors,vvSize:r.vvSize,vvColor:r.vvColor,vvInstancingEnabled:!0,instanced:r.instanced,instancedColor:r.instancedColor,instancedDoublePrecision:r.instancedDoublePrecision,pbrMode:r.usePBR?r.isSchematic?d.Schematic:d.Normal:d.Disabled,hasMetalnessAndRoughnessTexture:r.hasMetalnessAndRoughnessTexture,hasEmissionTexture:r.hasEmissionTexture,hasOcclusionTexture:r.hasOcclusionTexture,hasNormalTexture:r.hasNormalTexture,hasColorTexture:r.hasColorTexture,hasModelTransformation:r.hasModelTransformation,receiveAmbientOcclusion:r.receiveAmbientOcclusion,useCustomDTRExponentForWater:!1,normalType:r.normalsTypeDerivate?n.ScreenDerivative:n.Attribute,doubleSidedMode:r.doubleSidedMode,vertexTangents:r.vertexTangents,attributeTextureCoordinates:r.hasMetalnessAndRoughnessTexture||r.hasEmissionTexture||r.hasOcclusionTexture||r.hasNormalTexture||r.hasColorTexture?l.Default:l.None,textureAlphaPremultiplied:r.textureAlphaPremultiplied,attributeColor:r.vertexColors,screenSizePerspectiveEnabled:r.screenSizePerspective,verticalOffsetEnabled:r.verticalOffset,offsetBackfaces:r.offsetBackfaces,doublePrecisionRequiresObfuscation:v(e.rctx),alphaDiscardMode:r.alphaDiscardMode,supportsTextureAtlas:!1,multipassTerrainEnabled:r.multipassTerrainEnabled,cullAboveGround:r.cullAboveGround});return new L(e.rctx,o,A)}bindPass(e,t){var o,s;b(this.program,t.camera.projectionMatrix);const a=this.configuration.output;this.configuration.hasModelTransformation&&(r(e.modelTransformation)?this.program.setUniformMatrix4fv(\"model\",e.modelTransformation):W.warnOnce(\"hasModelTransformation true, but no modelTransformation found.\")),(this.configuration.output===i.Depth||t.multipassTerrainEnabled||a===i.Shadow)&&this.program.setUniform2fv(\"nearFar\",t.camera.nearFar),t.multipassTerrainEnabled&&(this.program.setUniform2fv(\"inverseViewport\",t.inverseViewport),u(this.program,t)),a===i.Alpha&&(this.program.setUniform1f(\"opacity\",e.opacity),this.program.setUniform1f(\"layerOpacity\",e.layerOpacity),this.program.setUniform4fv(\"externalColor\",e.externalColor),this.program.setUniform1i(\"colorMixMode\",H[e.colorMixMode])),a===i.Color?(t.lighting.setUniforms(this.program,!1,t.hasFillLights),this.program.setUniform3fv(\"ambient\",e.ambient),this.program.setUniform3fv(\"diffuse\",e.diffuse),this.program.setUniform4fv(\"externalColor\",e.externalColor),this.program.setUniform1i(\"colorMixMode\",H[e.colorMixMode]),this.program.setUniform1f(\"opacity\",e.opacity),this.program.setUniform1f(\"layerOpacity\",e.layerOpacity),this.configuration.usePBR&&m(this.program,e,this.configuration.isSchematic)):a===i.Highlight&&c(this.program,t),g(this.program,e),p(this.program,e,t),B(e.screenSizePerspective,this.program,\"screenSizePerspectiveAlignment\"),e.textureAlphaMode!==S.Mask&&e.textureAlphaMode!==S.MaskBlend||this.program.setUniform1f(\"textureAlphaCutoff\",e.textureAlphaCutoff),null==(o=t.shadowMap)||o.bind(this.program),null==(s=t.ssaoHelper)||s.bind(this.program,t.camera)}bindDraw(e){const t=this.configuration.instancedDoublePrecision?o(e.camera.viewInverseTransposeMatrix[3],e.camera.viewInverseTransposeMatrix[7],e.camera.viewInverseTransposeMatrix[11]):e.origin;y(this.program,t,e.camera.viewMatrix),this.program.rebindTextures(),(this.configuration.output===i.Color||this.configuration.output===i.Alpha||this.configuration.output===i.Depth&&this.configuration.screenSizePerspective||this.configuration.output===i.Normal&&this.configuration.screenSizePerspective||this.configuration.output===i.Highlight&&this.configuration.screenSizePerspective)&&T(this.program,t,e.camera.viewInverseTransposeMatrix),this.configuration.output===i.Normal&&this.program.setUniformMatrix4fv(\"viewNormal\",e.camera.viewInverseTransposeMatrix),this.configuration.instancedDoublePrecision&&a(this.program,t),s(this.program,this.configuration,e.slicePlane,{origin:t}),this.configuration.output===i.Color&&f(this.program,e,t)}_convertDepthTestFunction(e){return e===j.Lequal?q.LEQUAL:q.LESS}_setPipeline(e,t){const r=this.configuration,o=e===D.NONE,s=e===D.FrontFace;return I({blending:r.output!==i.Color&&r.output!==i.Alpha||!r.transparent?null:o?w:E(e),culling:J(r)&&V(r.cullFace),depthTest:{func:N(e,this._convertDepthTestFunction(r.customDepthTest))},depthWrite:o||s?r.writeDepth&&_:null,colorWrite:G,stencilWrite:r.sceneHasOcludees?z:null,stencilTest:r.sceneHasOcludees?t?F:R:null,polygonOffset:o||s?null:U(r.enableOffset)})}initializePipeline(){return this._occludeePipelineState=this._setPipeline(this.configuration.transparencyPassType,!0),this._setPipeline(this.configuration.transparencyPassType,!1)}getPipelineState(e,t){return t?this._occludeePipelineState:super.getPipelineState(e,t)}}function J(e){return e.cullFace?e.cullFace!==O.None:!e.slicePlaneEnabled&&(!e.transparent&&!e.doubleSidedMode)}Q.shader=new x(k,(()=>import(\"./DefaultMaterial.glsl.js\")));class K extends C{constructor(){super(...arguments),this.output=i.Color,this.alphaDiscardMode=S.Opaque,this.doubleSidedMode=h.None,this.isSchematic=!1,this.vertexColors=!1,this.offsetBackfaces=!1,this.symbolColors=!1,this.vvSize=!1,this.vvColor=!1,this.verticalOffset=!1,this.receiveShadows=!1,this.slicePlaneEnabled=!1,this.sliceHighlightDisabled=!1,this.receiveAmbientOcclusion=!1,this.screenSizePerspective=!1,this.textureAlphaPremultiplied=!1,this.hasColorTexture=!1,this.usePBR=!1,this.hasMetalnessAndRoughnessTexture=!1,this.hasEmissionTexture=!1,this.hasOcclusionTexture=!1,this.hasNormalTexture=!1,this.instanced=!1,this.instancedColor=!1,this.instancedDoublePrecision=!1,this.vertexTangents=!1,this.normalsTypeDerivate=!1,this.writeDepth=!0,this.sceneHasOcludees=!1,this.transparent=!1,this.enableOffset=!0,this.cullFace=O.None,this.transparencyPassType=D.NONE,this.multipassTerrainEnabled=!1,this.cullAboveGround=!1,this.hasModelTransformation=!1,this.customDepthTest=j.Less}}e([P({count:i.COUNT})],K.prototype,\"output\",void 0),e([P({count:S.COUNT})],K.prototype,\"alphaDiscardMode\",void 0),e([P({count:h.COUNT})],K.prototype,\"doubleSidedMode\",void 0),e([P()],K.prototype,\"isSchematic\",void 0),e([P()],K.prototype,\"vertexColors\",void 0),e([P()],K.prototype,\"offsetBackfaces\",void 0),e([P()],K.prototype,\"symbolColors\",void 0),e([P()],K.prototype,\"vvSize\",void 0),e([P()],K.prototype,\"vvColor\",void 0),e([P()],K.prototype,\"verticalOffset\",void 0),e([P()],K.prototype,\"receiveShadows\",void 0),e([P()],K.prototype,\"slicePlaneEnabled\",void 0),e([P()],K.prototype,\"sliceHighlightDisabled\",void 0),e([P()],K.prototype,\"receiveAmbientOcclusion\",void 0),e([P()],K.prototype,\"screenSizePerspective\",void 0),e([P()],K.prototype,\"textureAlphaPremultiplied\",void 0),e([P()],K.prototype,\"hasColorTexture\",void 0),e([P()],K.prototype,\"usePBR\",void 0),e([P()],K.prototype,\"hasMetalnessAndRoughnessTexture\",void 0),e([P()],K.prototype,\"hasEmissionTexture\",void 0),e([P()],K.prototype,\"hasOcclusionTexture\",void 0),e([P()],K.prototype,\"hasNormalTexture\",void 0),e([P()],K.prototype,\"instanced\",void 0),e([P()],K.prototype,\"instancedColor\",void 0),e([P()],K.prototype,\"instancedDoublePrecision\",void 0),e([P()],K.prototype,\"vertexTangents\",void 0),e([P()],K.prototype,\"normalsTypeDerivate\",void 0),e([P()],K.prototype,\"writeDepth\",void 0),e([P()],K.prototype,\"sceneHasOcludees\",void 0),e([P()],K.prototype,\"transparent\",void 0),e([P()],K.prototype,\"enableOffset\",void 0),e([P({count:O.COUNT})],K.prototype,\"cullFace\",void 0),e([P({count:D.COUNT})],K.prototype,\"transparencyPassType\",void 0),e([P()],K.prototype,\"multipassTerrainEnabled\",void 0),e([P()],K.prototype,\"cullAboveGround\",void 0),e([P()],K.prototype,\"hasModelTransformation\",void 0),e([P({count:j.COUNT})],K.prototype,\"customDepthTest\",void 0);export{Q as DefaultMaterialTechnique,K as DefaultMaterialTechniqueConfiguration};\n"]},"metadata":{},"sourceType":"module"}