{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport t from \"../../../core/Logger.js\";\nimport { isSome as r, isNone as e } from \"../../../core/maybe.js\";\nimport { f as o } from \"../../../chunks/mat3.js\";\nimport { c as i } from \"../../../chunks/mat3f64.js\";\nimport { d as n } from \"../../../chunks/mat4.js\";\nimport { c as s } from \"../../../chunks/mat4f64.js\";\nimport { s as a, f as c, b as f, t as l, m as p } from \"../../../chunks/vec3.js\";\nimport { c as m, Z as g } from \"../../../chunks/vec3f64.js\";\nimport { projectPointToVector as u, computeTranslationToOriginAndRotation as h } from \"../../projection.js\";\nimport { getSphericalPCPF as v } from \"../../projectionEllipsoid.js\";\nimport { create as j, compose as d, axis as x, angleRad as A } from \"../axisAngleDegrees.js\";\nimport { isGeographicMesh as b } from \"./geographicUtils.js\";\nimport { projectToPCPF as k, projectNormalToPCPF as y, projectTangentToPCPF as w, projectFromPCPF as R, projectNormalFromPCPF as F, projectTangentFromPCPF as L } from \"./projection.js\";\nconst $ = t.getLogger(\"esri.geometry.support.meshUtils.rotate\");\n\nfunction z(t, e, o) {\n  if (!t.vertexAttributes || !t.vertexAttributes.position || 0 === e[3]) return;\n  const i = t.spatialReference;\n\n  if (r(t.transform)) {\n    var n;\n    null != (null == o ? void 0 : o.geographic) && o.geographic !== t.transform.geographic && $.warn(`Specifying the 'geographic' parameter (${o.geographic}) different from the Mesh transform setting (${t.transform.geographic}) is not supported`);\n    const r = null != (n = null == o ? void 0 : o.origin) ? n : t.transform.getOriginPoint(i);\n    C(t.transform, e, r);\n  } else {\n    var s;\n    const r = null != (s = null == o ? void 0 : o.origin) ? s : t.origin;\n    b(t.spatialReference, o) ? I(t, e, r) : U(t, e, r);\n  }\n}\n\nfunction C(t, r, e) {\n  const o = a(E, e.x, e.y, e.z),\n        i = c(E, o, t.origin);\n  t.applyLocalInverse(i, M), t.rotation = d(t.rotation, r, j()), t.applyLocalInverse(i, i), c(i, i, M), t.translation = f(m(), t.translation, i);\n}\n\nfunction I(t, e, i) {\n  const n = t.spatialReference,\n        s = v(n),\n        a = Z;\n  u(i, a, s) || u(t.origin, a, s);\n  const c = t.vertexAttributes.position,\n        f = t.vertexAttributes.normal,\n        p = t.vertexAttributes.tangent,\n        m = new Float64Array(c.length),\n        g = r(f) ? new Float32Array(f.length) : null,\n        j = r(p) ? new Float32Array(p.length) : null;\n  h(s, a, P, s), o(S, P);\n  const d = O;\n  l(x(O), x(e), S), d[3] = e[3], k(c, n, m), r(f) && y(f, c, m, n, g), r(p) && w(p, c, m, n, j), D(m, d, 3, a), R(m, c, n), r(f) && (D(g, d, 3), F(g, c, m, n, f)), r(p) && (D(j, d, 4), L(j, c, m, n, p)), t.vertexAttributesChanged();\n}\n\nfunction U(t, r, e) {\n  const o = Z;\n\n  if (!u(e, o, t.spatialReference)) {\n    const r = t.origin;\n    o[0] = r.x, o[1] = r.y, o[2] = r.z, $.error(`Failed to project specified origin (wkid:${e.spatialReference.wkid}) to mesh spatial reference (wkid:${t.spatialReference.wkid}).`);\n  }\n\n  D(t.vertexAttributes.position, r, 3, o), D(t.vertexAttributes.normal, r, 3), D(t.vertexAttributes.tangent, r, 4), t.vertexAttributesChanged();\n}\n\nfunction D(t, r, o) {\n  let i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : g;\n\n  if (!e(t)) {\n    n(P, A(r), x(r));\n\n    for (let r = 0; r < t.length; r += o) {\n      for (let e = 0; e < 3; e++) E[e] = t[r + e] - i[e];\n\n      p(E, E, P);\n\n      for (let e = 0; e < 3; e++) t[r + e] = E[e] + i[e];\n    }\n  }\n}\n\nconst E = m(),\n      M = m(),\n      O = j(),\n      P = s(),\n      S = i(),\n      Z = m();\nexport { z as rotate };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/geometry/support/meshUtils/rotate.js"],"names":["t","isSome","r","isNone","e","f","o","c","i","d","n","s","a","b","l","m","p","Z","g","projectPointToVector","u","computeTranslationToOriginAndRotation","h","getSphericalPCPF","v","create","j","compose","axis","x","angleRad","A","isGeographicMesh","projectToPCPF","k","projectNormalToPCPF","y","projectTangentToPCPF","w","projectFromPCPF","R","projectNormalFromPCPF","F","projectTangentFromPCPF","L","$","getLogger","z","vertexAttributes","position","spatialReference","transform","geographic","warn","origin","getOriginPoint","C","I","U","E","applyLocalInverse","M","rotation","translation","normal","tangent","Float64Array","length","Float32Array","P","S","O","D","vertexAttributesChanged","error","wkid","rotate"],"mappings":"AAAA;AACA;AACA;AACA;AACA,OAAOA,CAAP,MAAa,yBAAb;AAAuC,SAAOC,MAAM,IAAIC,CAAjB,EAAmBC,MAAM,IAAIC,CAA7B,QAAmC,wBAAnC;AAA4D,SAAOC,CAAC,IAAIC,CAAZ,QAAkB,yBAAlB;AAA4C,SAAOC,CAAC,IAAIC,CAAZ,QAAkB,4BAAlB;AAA+C,SAAOC,CAAC,IAAIC,CAAZ,QAAkB,yBAAlB;AAA4C,SAAOH,CAAC,IAAII,CAAZ,QAAkB,4BAAlB;AAA+C,SAAOA,CAAC,IAAIC,CAAZ,EAAcP,CAAC,IAAIE,CAAnB,EAAqBM,CAAC,IAAIR,CAA1B,EAA4BL,CAAC,IAAIc,CAAjC,EAAmCC,CAAC,IAAIC,CAAxC,QAA8C,yBAA9C;AAAwE,SAAOT,CAAC,IAAIQ,CAAZ,EAAcE,CAAC,IAAIC,CAAnB,QAAyB,4BAAzB;AAAsD,SAAOC,oBAAoB,IAAIC,CAA/B,EAAiCC,qCAAqC,IAAIC,CAA1E,QAAgF,qBAAhF;AAAsG,SAAOC,gBAAgB,IAAIC,CAA3B,QAAiC,8BAAjC;AAAgE,SAAOC,MAAM,IAAIC,CAAjB,EAAmBC,OAAO,IAAIlB,CAA9B,EAAgCmB,IAAI,IAAIC,CAAxC,EAA0CC,QAAQ,IAAIC,CAAtD,QAA4D,wBAA5D;AAAqF,SAAOC,gBAAgB,IAAInB,CAA3B,QAAiC,sBAAjC;AAAwD,SAAOoB,aAAa,IAAIC,CAAxB,EAA0BC,mBAAmB,IAAIC,CAAjD,EAAmDC,oBAAoB,IAAIC,CAA3E,EAA6EC,eAAe,IAAIC,CAAhG,EAAkGC,qBAAqB,IAAIC,CAA3H,EAA6HC,sBAAsB,IAAIC,CAAvJ,QAA6J,iBAA7J;AAA+K,MAAMC,CAAC,GAAC7C,CAAC,CAAC8C,SAAF,CAAY,wCAAZ,CAAR;;AAA8D,SAASC,CAAT,CAAW/C,CAAX,EAAaI,CAAb,EAAeE,CAAf,EAAiB;AAAC,MAAG,CAACN,CAAC,CAACgD,gBAAH,IAAqB,CAAChD,CAAC,CAACgD,gBAAF,CAAmBC,QAAzC,IAAmD,MAAI7C,CAAC,CAAC,CAAD,CAA3D,EAA+D;AAAO,QAAMI,CAAC,GAACR,CAAC,CAACkD,gBAAV;;AAA2B,MAAGhD,CAAC,CAACF,CAAC,CAACmD,SAAH,CAAJ,EAAkB;AAAC,QAAIzC,CAAJ;AAAM,aAAO,QAAMJ,CAAN,GAAQ,KAAK,CAAb,GAAeA,CAAC,CAAC8C,UAAxB,KAAqC9C,CAAC,CAAC8C,UAAF,KAAepD,CAAC,CAACmD,SAAF,CAAYC,UAAhE,IAA4EP,CAAC,CAACQ,IAAF,CAAQ,0CAAyC/C,CAAC,CAAC8C,UAAW,gDAA+CpD,CAAC,CAACmD,SAAF,CAAYC,UAAW,oBAApI,CAA5E;AAAqO,UAAMlD,CAAC,GAAC,SAAOQ,CAAC,GAAC,QAAMJ,CAAN,GAAQ,KAAK,CAAb,GAAeA,CAAC,CAACgD,MAA1B,IAAkC5C,CAAlC,GAAoCV,CAAC,CAACmD,SAAF,CAAYI,cAAZ,CAA2B/C,CAA3B,CAA5C;AAA0EgD,IAAAA,CAAC,CAACxD,CAAC,CAACmD,SAAH,EAAa/C,CAAb,EAAeF,CAAf,CAAD;AAAmB,GAA3V,MAA+V;AAAC,QAAIS,CAAJ;AAAM,UAAMT,CAAC,GAAC,SAAOS,CAAC,GAAC,QAAML,CAAN,GAAQ,KAAK,CAAb,GAAeA,CAAC,CAACgD,MAA1B,IAAkC3C,CAAlC,GAAoCX,CAAC,CAACsD,MAA9C;AAAqDzC,IAAAA,CAAC,CAACb,CAAC,CAACkD,gBAAH,EAAoB5C,CAApB,CAAD,GAAwBmD,CAAC,CAACzD,CAAD,EAAGI,CAAH,EAAKF,CAAL,CAAzB,GAAiCwD,CAAC,CAAC1D,CAAD,EAAGI,CAAH,EAAKF,CAAL,CAAlC;AAA0C;AAAC;;AAAA,SAASsD,CAAT,CAAWxD,CAAX,EAAaE,CAAb,EAAeE,CAAf,EAAiB;AAAC,QAAME,CAAC,GAACM,CAAC,CAAC+C,CAAD,EAAGvD,CAAC,CAACyB,CAAL,EAAOzB,CAAC,CAACgC,CAAT,EAAWhC,CAAC,CAAC2C,CAAb,CAAT;AAAA,QAAyBvC,CAAC,GAACD,CAAC,CAACoD,CAAD,EAAGrD,CAAH,EAAKN,CAAC,CAACsD,MAAP,CAA5B;AAA2CtD,EAAAA,CAAC,CAAC4D,iBAAF,CAAoBpD,CAApB,EAAsBqD,CAAtB,GAAyB7D,CAAC,CAAC8D,QAAF,GAAWrD,CAAC,CAACT,CAAC,CAAC8D,QAAH,EAAY5D,CAAZ,EAAcwB,CAAC,EAAf,CAArC,EAAwD1B,CAAC,CAAC4D,iBAAF,CAAoBpD,CAApB,EAAsBA,CAAtB,CAAxD,EAAiFD,CAAC,CAACC,CAAD,EAAGA,CAAH,EAAKqD,CAAL,CAAlF,EAA0F7D,CAAC,CAAC+D,WAAF,GAAc1D,CAAC,CAACU,CAAC,EAAF,EAAKf,CAAC,CAAC+D,WAAP,EAAmBvD,CAAnB,CAAzG;AAA+H;;AAAA,SAASiD,CAAT,CAAWzD,CAAX,EAAaI,CAAb,EAAeI,CAAf,EAAiB;AAAC,QAAME,CAAC,GAACV,CAAC,CAACkD,gBAAV;AAAA,QAA2BvC,CAAC,GAACa,CAAC,CAACd,CAAD,CAA9B;AAAA,QAAkCE,CAAC,GAACK,CAApC;AAAsCG,EAAAA,CAAC,CAACZ,CAAD,EAAGI,CAAH,EAAKD,CAAL,CAAD,IAAUS,CAAC,CAACpB,CAAC,CAACsD,MAAH,EAAU1C,CAAV,EAAYD,CAAZ,CAAX;AAA0B,QAAMJ,CAAC,GAACP,CAAC,CAACgD,gBAAF,CAAmBC,QAA3B;AAAA,QAAoC5C,CAAC,GAACL,CAAC,CAACgD,gBAAF,CAAmBgB,MAAzD;AAAA,QAAgEhD,CAAC,GAAChB,CAAC,CAACgD,gBAAF,CAAmBiB,OAArF;AAAA,QAA6FlD,CAAC,GAAC,IAAImD,YAAJ,CAAiB3D,CAAC,CAAC4D,MAAnB,CAA/F;AAAA,QAA0HjD,CAAC,GAAChB,CAAC,CAACG,CAAD,CAAD,GAAK,IAAI+D,YAAJ,CAAiB/D,CAAC,CAAC8D,MAAnB,CAAL,GAAgC,IAA5J;AAAA,QAAiKzC,CAAC,GAACxB,CAAC,CAACc,CAAD,CAAD,GAAK,IAAIoD,YAAJ,CAAiBpD,CAAC,CAACmD,MAAnB,CAAL,GAAgC,IAAnM;AAAwM7C,EAAAA,CAAC,CAACX,CAAD,EAAGC,CAAH,EAAKyD,CAAL,EAAO1D,CAAP,CAAD,EAAWL,CAAC,CAACgE,CAAD,EAAGD,CAAH,CAAZ;AAAkB,QAAM5D,CAAC,GAAC8D,CAAR;AAAUzD,EAAAA,CAAC,CAACe,CAAC,CAAC0C,CAAD,CAAF,EAAM1C,CAAC,CAACzB,CAAD,CAAP,EAAWkE,CAAX,CAAD,EAAe7D,CAAC,CAAC,CAAD,CAAD,GAAKL,CAAC,CAAC,CAAD,CAArB,EAAyB8B,CAAC,CAAC3B,CAAD,EAAGG,CAAH,EAAKK,CAAL,CAA1B,EAAkCb,CAAC,CAACG,CAAD,CAAD,IAAM+B,CAAC,CAAC/B,CAAD,EAAGE,CAAH,EAAKQ,CAAL,EAAOL,CAAP,EAASQ,CAAT,CAAzC,EAAqDhB,CAAC,CAACc,CAAD,CAAD,IAAMsB,CAAC,CAACtB,CAAD,EAAGT,CAAH,EAAKQ,CAAL,EAAOL,CAAP,EAASgB,CAAT,CAA5D,EAAwE8C,CAAC,CAACzD,CAAD,EAAGN,CAAH,EAAK,CAAL,EAAOG,CAAP,CAAzE,EAAmF4B,CAAC,CAACzB,CAAD,EAAGR,CAAH,EAAKG,CAAL,CAApF,EAA4FR,CAAC,CAACG,CAAD,CAAD,KAAOmE,CAAC,CAACtD,CAAD,EAAGT,CAAH,EAAK,CAAL,CAAD,EAASiC,CAAC,CAACxB,CAAD,EAAGX,CAAH,EAAKQ,CAAL,EAAOL,CAAP,EAASL,CAAT,CAAjB,CAA5F,EAA0HH,CAAC,CAACc,CAAD,CAAD,KAAOwD,CAAC,CAAC9C,CAAD,EAAGjB,CAAH,EAAK,CAAL,CAAD,EAASmC,CAAC,CAAClB,CAAD,EAAGnB,CAAH,EAAKQ,CAAL,EAAOL,CAAP,EAASM,CAAT,CAAjB,CAA1H,EAAwJhB,CAAC,CAACyE,uBAAF,EAAxJ;AAAoL;;AAAA,SAASf,CAAT,CAAW1D,CAAX,EAAaE,CAAb,EAAeE,CAAf,EAAiB;AAAC,QAAME,CAAC,GAACW,CAAR;;AAAU,MAAG,CAACG,CAAC,CAAChB,CAAD,EAAGE,CAAH,EAAKN,CAAC,CAACkD,gBAAP,CAAL,EAA8B;AAAC,UAAMhD,CAAC,GAACF,CAAC,CAACsD,MAAV;AAAiBhD,IAAAA,CAAC,CAAC,CAAD,CAAD,GAAKJ,CAAC,CAAC2B,CAAP,EAASvB,CAAC,CAAC,CAAD,CAAD,GAAKJ,CAAC,CAACkC,CAAhB,EAAkB9B,CAAC,CAAC,CAAD,CAAD,GAAKJ,CAAC,CAAC6C,CAAzB,EAA2BF,CAAC,CAAC6B,KAAF,CAAS,4CAA2CtE,CAAC,CAAC8C,gBAAF,CAAmByB,IAAK,qCAAoC3E,CAAC,CAACkD,gBAAF,CAAmByB,IAAK,IAAxI,CAA3B;AAAwK;;AAAAH,EAAAA,CAAC,CAACxE,CAAC,CAACgD,gBAAF,CAAmBC,QAApB,EAA6B/C,CAA7B,EAA+B,CAA/B,EAAiCI,CAAjC,CAAD,EAAqCkE,CAAC,CAACxE,CAAC,CAACgD,gBAAF,CAAmBgB,MAApB,EAA2B9D,CAA3B,EAA6B,CAA7B,CAAtC,EAAsEsE,CAAC,CAACxE,CAAC,CAACgD,gBAAF,CAAmBiB,OAApB,EAA4B/D,CAA5B,EAA8B,CAA9B,CAAvE,EAAwGF,CAAC,CAACyE,uBAAF,EAAxG;AAAoI;;AAAA,SAASD,CAAT,CAAWxE,CAAX,EAAaE,CAAb,EAAeI,CAAf,EAAqB;AAAA,MAAJE,CAAI,uEAAFU,CAAE;;AAAC,MAAG,CAACd,CAAC,CAACJ,CAAD,CAAL,EAAS;AAACU,IAAAA,CAAC,CAAC2D,CAAD,EAAGtC,CAAC,CAAC7B,CAAD,CAAJ,EAAQ2B,CAAC,CAAC3B,CAAD,CAAT,CAAD;;AAAe,SAAI,IAAIA,CAAC,GAAC,CAAV,EAAYA,CAAC,GAACF,CAAC,CAACmE,MAAhB,EAAuBjE,CAAC,IAAEI,CAA1B,EAA4B;AAAC,WAAI,IAAIF,CAAC,GAAC,CAAV,EAAYA,CAAC,GAAC,CAAd,EAAgBA,CAAC,EAAjB,EAAoBuD,CAAC,CAACvD,CAAD,CAAD,GAAKJ,CAAC,CAACE,CAAC,GAACE,CAAH,CAAD,GAAOI,CAAC,CAACJ,CAAD,CAAb;;AAAiBY,MAAAA,CAAC,CAAC2C,CAAD,EAAGA,CAAH,EAAKU,CAAL,CAAD;;AAAS,WAAI,IAAIjE,CAAC,GAAC,CAAV,EAAYA,CAAC,GAAC,CAAd,EAAgBA,CAAC,EAAjB,EAAoBJ,CAAC,CAACE,CAAC,GAACE,CAAH,CAAD,GAAOuD,CAAC,CAACvD,CAAD,CAAD,GAAKI,CAAC,CAACJ,CAAD,CAAb;AAAiB;AAAC;AAAC;;AAAA,MAAMuD,CAAC,GAAC5C,CAAC,EAAT;AAAA,MAAY8C,CAAC,GAAC9C,CAAC,EAAf;AAAA,MAAkBwD,CAAC,GAAC7C,CAAC,EAArB;AAAA,MAAwB2C,CAAC,GAAC1D,CAAC,EAA3B;AAAA,MAA8B2D,CAAC,GAAC9D,CAAC,EAAjC;AAAA,MAAoCS,CAAC,GAACF,CAAC,EAAvC;AAA0C,SAAOgC,CAAC,IAAI6B,MAAZ","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport t from\"../../../core/Logger.js\";import{isSome as r,isNone as e}from\"../../../core/maybe.js\";import{f as o}from\"../../../chunks/mat3.js\";import{c as i}from\"../../../chunks/mat3f64.js\";import{d as n}from\"../../../chunks/mat4.js\";import{c as s}from\"../../../chunks/mat4f64.js\";import{s as a,f as c,b as f,t as l,m as p}from\"../../../chunks/vec3.js\";import{c as m,Z as g}from\"../../../chunks/vec3f64.js\";import{projectPointToVector as u,computeTranslationToOriginAndRotation as h}from\"../../projection.js\";import{getSphericalPCPF as v}from\"../../projectionEllipsoid.js\";import{create as j,compose as d,axis as x,angleRad as A}from\"../axisAngleDegrees.js\";import{isGeographicMesh as b}from\"./geographicUtils.js\";import{projectToPCPF as k,projectNormalToPCPF as y,projectTangentToPCPF as w,projectFromPCPF as R,projectNormalFromPCPF as F,projectTangentFromPCPF as L}from\"./projection.js\";const $=t.getLogger(\"esri.geometry.support.meshUtils.rotate\");function z(t,e,o){if(!t.vertexAttributes||!t.vertexAttributes.position||0===e[3])return;const i=t.spatialReference;if(r(t.transform)){var n;null!=(null==o?void 0:o.geographic)&&o.geographic!==t.transform.geographic&&$.warn(`Specifying the 'geographic' parameter (${o.geographic}) different from the Mesh transform setting (${t.transform.geographic}) is not supported`);const r=null!=(n=null==o?void 0:o.origin)?n:t.transform.getOriginPoint(i);C(t.transform,e,r)}else{var s;const r=null!=(s=null==o?void 0:o.origin)?s:t.origin;b(t.spatialReference,o)?I(t,e,r):U(t,e,r)}}function C(t,r,e){const o=a(E,e.x,e.y,e.z),i=c(E,o,t.origin);t.applyLocalInverse(i,M),t.rotation=d(t.rotation,r,j()),t.applyLocalInverse(i,i),c(i,i,M),t.translation=f(m(),t.translation,i)}function I(t,e,i){const n=t.spatialReference,s=v(n),a=Z;u(i,a,s)||u(t.origin,a,s);const c=t.vertexAttributes.position,f=t.vertexAttributes.normal,p=t.vertexAttributes.tangent,m=new Float64Array(c.length),g=r(f)?new Float32Array(f.length):null,j=r(p)?new Float32Array(p.length):null;h(s,a,P,s),o(S,P);const d=O;l(x(O),x(e),S),d[3]=e[3],k(c,n,m),r(f)&&y(f,c,m,n,g),r(p)&&w(p,c,m,n,j),D(m,d,3,a),R(m,c,n),r(f)&&(D(g,d,3),F(g,c,m,n,f)),r(p)&&(D(j,d,4),L(j,c,m,n,p)),t.vertexAttributesChanged()}function U(t,r,e){const o=Z;if(!u(e,o,t.spatialReference)){const r=t.origin;o[0]=r.x,o[1]=r.y,o[2]=r.z,$.error(`Failed to project specified origin (wkid:${e.spatialReference.wkid}) to mesh spatial reference (wkid:${t.spatialReference.wkid}).`)}D(t.vertexAttributes.position,r,3,o),D(t.vertexAttributes.normal,r,3),D(t.vertexAttributes.tangent,r,4),t.vertexAttributesChanged()}function D(t,r,o,i=g){if(!e(t)){n(P,A(r),x(r));for(let r=0;r<t.length;r+=o){for(let e=0;e<3;e++)E[e]=t[r+e]-i[e];p(E,E,P);for(let e=0;e<3;e++)t[r+e]=E[e]+i[e]}}}const E=m(),M=m(),O=j(),P=s(),S=i(),Z=m();export{z as rotate};\n"]},"metadata":{},"sourceType":"module"}