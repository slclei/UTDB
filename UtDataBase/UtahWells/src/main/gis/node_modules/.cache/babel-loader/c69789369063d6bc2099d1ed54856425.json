{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport { id as e } from \"../kernel.js\";\nimport t from \"../request.js\";\nimport r from \"./featureSetCollection.js\";\nimport n from \"./featureset/actions/AttributeFilter.js\";\nimport a from \"./featureset/actions/GroupBy.js\";\nimport s from \"./featureset/actions/OrderBy.js\";\nimport i from \"./featureset/actions/SpatialFilter.js\";\nimport l from \"./featureset/actions/Top.js\";\nimport o from \"./featureset/sources/FeatureLayerDynamic.js\";\nimport u from \"./featureset/sources/FeatureLayerMemory.js\";\nimport c from \"./featureset/sources/FeatureLayerRelated.js\";\nimport d from \"./featureset/support/cache.js\";\nimport m from \"./featureset/support/FeatureSet.js\";\nimport { extractServiceUrl as f } from \"./featureset/support/shared.js\";\nimport { resolve as h, reject as p, create as y } from \"../core/promiseUtils.js\";\nimport { WhereClause as L } from \"../core/sql/WhereClause.js\";\nimport _ from \"../layers/FeatureLayer.js\";\nimport I from \"../portal/Portal.js\";\nimport S from \"../portal/PortalItem.js\";\n\nfunction N() {\n  null === d.applicationCache && (d.applicationCache = new d());\n}\n\nfunction F(e, t) {\n  if (d.applicationCache) {\n    const r = d.applicationCache.getLayerInfo(e);\n    if (r) return r.then(r => h(new _({\n      url: e,\n      outFields: t,\n      sourceJSON: r\n    })));\n    const n = new _({\n      url: e,\n      outFields: t\n    });\n    let a = y((e, t) => {\n      n.load().then(() => {\n        e(n.sourceJSON);\n      }, e => {\n        t(e);\n      });\n    });\n    return d.applicationCache && (d.applicationCache.setLayerInfo(e, a), a = a.catch(t => {\n      throw d.applicationCache.clearLayerInfo(e), t;\n    })), a.then(() => h(n));\n  }\n\n  return h(new _({\n    url: e,\n    outFields: t\n  }));\n}\n\nfunction T(e, t, r, n, a) {\n  let s = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : null;\n  return F(e, [\"*\"]).then(e => h(g(e, t, r, n, a, s)));\n}\n\nfunction g(e) {\n  let t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n  let r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n  let n = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : !0;\n  let a = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : null;\n  let s = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : null;\n  return !0 === e._hasMemorySource() ? new u({\n    layer: e,\n    spatialReference: t,\n    outFields: r,\n    includeGeometry: n,\n    lrucache: a,\n    interceptor: s\n  }) : new o({\n    layer: e,\n    spatialReference: t,\n    outFields: r,\n    includeGeometry: n,\n    lrucache: a,\n    interceptor: s\n  });\n}\n\nfunction A(e) {\n  if (null !== d.applicationCache) {\n    const t = d.applicationCache.getLayerInfo(e);\n    if (null !== t) return t;\n  }\n\n  let r = t(e, {\n    responseType: \"json\",\n    query: {\n      f: \"json\"\n    }\n  }).then(e => {\n    if (e.data) {\n      const t = e.data;\n      return h(t);\n    }\n\n    return h(null);\n  });\n  return null !== d.applicationCache && (d.applicationCache.setLayerInfo(e, r), r = r.catch(t => {\n    throw d.applicationCache.clearLayerInfo(e), t;\n  })), r;\n}\n\nfunction C(e, r) {\n  const n = \"QUERYDATAELEMTS:\" + r.toString() + \":\" + e;\n\n  if (null !== d.applicationCache) {\n    const e = d.applicationCache.getLayerInfo(n);\n    if (null !== e) return e;\n  }\n\n  let a = t(e + \"/queryDataElements\", {\n    method: \"post\",\n    responseType: \"json\",\n    query: {\n      layers: JSON.stringify([r.toString()]),\n      f: \"json\"\n    }\n  }).then(e => {\n    if (e.data) {\n      const t = e.data;\n      if (t.layerDataElements && t.layerDataElements[0]) return t.layerDataElements[0];\n    }\n\n    throw new Error(\"Not Found\");\n  });\n  return null !== d.applicationCache && (d.applicationCache.setLayerInfo(n, a), a = a.catch(e => {\n    throw d.applicationCache.clearLayerInfo(n), e;\n  })), a;\n}\n\nfunction k(e) {\n  if (null !== d.applicationCache) {\n    const t = d.applicationCache.getLayerInfo(e);\n    if (null !== t) return t;\n  }\n\n  let r = t(e, {\n    responseType: \"json\",\n    query: {\n      f: \"json\"\n    }\n  }).then(e => {\n    if (e.data) {\n      const t = e.data;\n      return t.layers || (t.layers = []), t.tables || (t.tables = []), h(t);\n    }\n\n    return h({\n      layers: [],\n      tables: []\n    });\n  });\n  return null !== d.applicationCache && (d.applicationCache.setLayerInfo(e, r), r = r.catch(t => {\n    throw d.applicationCache.clearLayerInfo(e), t;\n  })), r;\n}\n\nfunction j(e, t) {\n  const r = {\n    metadata: null,\n    networkId: -1,\n    unVersion: 3,\n    terminals: [],\n    queryelem: null,\n    layerNameLkp: {},\n    lkp: null\n  };\n  return k(e).then(n => {\n    if (r.metadata = n, n.controllerDatasetLayers && void 0 !== n.controllerDatasetLayers.utilityNetworkLayerId && null !== n.controllerDatasetLayers.utilityNetworkLayerId) {\n      if (n.layers) for (const e of n.layers) r.layerNameLkp[e.id] = e.name;\n      if (n.tables) for (const e of n.tables) r.layerNameLkp[e.id] = e.name;\n      const a = n.controllerDatasetLayers.utilityNetworkLayerId;\n      return r.networkId = a, C(e, a).then(n => {\n        if (n) {\n          r.queryelem = n, r.queryelem && r.queryelem.dataElement && void 0 !== r.queryelem.dataElement.schemaGeneration && (r.unVersion = r.queryelem.dataElement.schemaGeneration), r.lkp = {}, r.queryelem.dataElement.domainNetworks || (r.queryelem.dataElement.domainNetworks = []);\n\n          for (const e of r.queryelem.dataElement.domainNetworks) {\n            for (const t of e.edgeSources ? e.edgeSources : []) {\n              const e = {\n                layerId: t.layerId,\n                sourceId: t.sourceId,\n                className: r.layerNameLkp[t.layerId] ? r.layerNameLkp[t.layerId] : null\n              };\n              e.className && (r.lkp[e.className] = e);\n            }\n\n            for (const t of e.junctionSources ? e.junctionSources : []) {\n              const e = {\n                layerId: t.layerId,\n                sourceId: t.sourceId,\n                className: r.layerNameLkp[t.layerId] ? r.layerNameLkp[t.layerId] : null\n              };\n              e.className && (r.lkp[e.className] = e);\n            }\n          }\n\n          if (r.queryelem.dataElement.terminalConfigurations) for (const e of r.queryelem.dataElement.terminalConfigurations) for (const t of e.terminals) r.terminals.push({\n            terminalId: t.terminalId,\n            terminalName: t.terminalName\n          });\n          return A(e + \"/\" + a).then(n => {\n            if (n.systemLayers && void 0 !== n.systemLayers.associationsTableId && null !== n.systemLayers.associationsTableId) {\n              const a = [];\n              return r.unVersion >= 4 && (a.push(\"STATUS\"), a.push(\"PERCENTALONG\")), T(e + \"/\" + n.systemLayers.associationsTableId.toString(), t, [\"OBJECTID\", \"FROMNETWORKSOURCEID\", \"TONETWORKSOURCEID\", \"FROMGLOBALID\", \"TOGLOBALID\", \"TOTERMINALID\", \"FROMTERMINALID\", \"ASSOCIATIONTYPE\", \"ISCONTENTVISIBLE\", \"GLOBALID\", ...a], !1, null, null).then(e => e.load()).then(e => r.unVersion >= 4 ? (e = e.filter(L.create(\"STATUS NOT IN (1, 2, 3, 4, 5, 6, 7, 9, 10, 11, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37, 38, 39, 41, 42, 43, 44, 45, 46, 47, 49, 50, 51, 52, 53, 54, 55, 57, 58, 59, 60, 61, 62,63)\", e.getFieldsIndex()))).load() : e).then(e => ({\n                lkp: r.lkp,\n                associations: e,\n                unVersion: r.unVersion,\n                terminals: r.terminals\n              }));\n            }\n\n            return {\n              associations: null,\n              unVersion: r.unVersion,\n              lkp: null,\n              terminals: []\n            };\n          });\n        }\n\n        return {\n          associations: null,\n          unVersion: r.unVersion,\n          lkp: null,\n          terminals: []\n        };\n      });\n    }\n\n    return {\n      associations: null,\n      unVersion: r.unVersion,\n      lkp: null,\n      terminals: []\n    };\n  });\n}\n\nfunction w(e, t, r) {\n  let n = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n  let a = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : null;\n  let s = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : !0;\n  let i = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : null;\n  let l = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : null;\n  let o = e.serviceUrl();\n  return o ? (o = \"/\" === o.charAt(o.length - 1) ? o + t.relatedTableId.toString() : o + \"/\" + t.relatedTableId.toString(), T(o, n, a, s, i, l).then(o => new c({\n    layer: e,\n    relatedLayer: o,\n    relationship: t,\n    objectId: r,\n    spatialReference: n,\n    outFields: a,\n    includeGeometry: s,\n    lrucache: i,\n    interceptor: l\n  }))) : null;\n}\n\nn.registerAction(), a.registerAction(), s.registerAction(), i.registerAction(), l.registerAction();\n\nclass O extends r {\n  constructor(e) {\n    let t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n    let r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    let n = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n    super(), this._map = e, this._overridespref = t, this.lrucache = r, this.interceptor = n, this._instantLayers = [];\n  }\n\n  _makeAndAddFeatureSet(e) {\n    let t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !0;\n    let r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    const n = g(e, this._overridespref, null === r ? [\"*\"] : r, t, this.lrucache, this.interceptor);\n    return this._instantLayers.push({\n      featureset: n,\n      opitem: e,\n      includeGeometry: t,\n      outFields: JSON.stringify(r)\n    }), n;\n  }\n\n  featureSetByName(e) {\n    let t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !0;\n    let r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    if (void 0 !== this._map.loaded && void 0 !== this._map.load && !1 === this._map.loaded) return this._map.load().then(() => {\n      try {\n        return this.featureSetByName(e, t, r);\n      } catch (n) {\n        return p(n);\n      }\n    });\n    null === r && (r = [\"*\"]), r = (r = r.slice(0)).sort();\n    const n = JSON.stringify(r);\n\n    for (let s = 0; s < this._instantLayers.length; s++) {\n      const r = this._instantLayers[s];\n      if (r.opitem.title === e && r.includeGeometry === t && r.outFields === n) return this.resolvePromise(this._instantLayers[s].featureset);\n    }\n\n    const a = this._map.allLayers.find(t => t instanceof _ && t.title === e);\n\n    if (a) return this.resolvePromise(this._makeAndAddFeatureSet(a, t, r));\n\n    if (this._map.tables) {\n      const n = this._map.tables.find(t => !!(t.title && t.title === e || t.title && t.title === e));\n\n      if (n) {\n        if (n instanceof _) return this.resolvePromise(this._makeAndAddFeatureSet(n, t, r));\n        if (n._materializedTable) ;else {\n          const e = n.outFields ? n : { ...n,\n            outFields: [\"*\"]\n          };\n          n._materializedTable = new _(e);\n        }\n        return n._materializedTable.load().then(() => this.resolvePromise(this._makeAndAddFeatureSet(n._materializedTable, t, r)));\n      }\n    }\n\n    return this.resolvePromise(null);\n  }\n\n  featureSetById(e) {\n    let t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !0;\n    let r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [\"*\"];\n    if (void 0 !== this._map.loaded && void 0 !== this._map.load && !1 === this._map.loaded) return this._map.load().then(() => {\n      try {\n        return this.featureSetById(e, t, r);\n      } catch (n) {\n        return p(n);\n      }\n    });\n    null === r && (r = [\"*\"]), r = (r = r.slice(0)).sort();\n    const n = JSON.stringify(r);\n\n    for (let s = 0; s < this._instantLayers.length; s++) {\n      const r = this._instantLayers[s];\n      if (r.opitem.id === e && r.includeGeometry === t && r.outFields === n) return this.resolvePromise(this._instantLayers[s].featureset);\n    }\n\n    const a = this._map.allLayers.find(t => t instanceof _ && t.id === e);\n\n    if (a) return this.resolvePromise(this._makeAndAddFeatureSet(a, t, r));\n\n    if (this._map.tables) {\n      const n = this._map.tables.find(t => t.id === e);\n\n      if (n) {\n        if (n instanceof _) return this.resolvePromise(this._makeAndAddFeatureSet(n, t, r));\n        if (n._materializedTable) ;else {\n          const e = { ...n,\n            outFields: [\"*\"]\n          };\n          n._materializedTable = new _(e);\n        }\n        return n._materializedTable.load().then(() => this.resolvePromise(this._makeAndAddFeatureSet(n._materializedTable, t, r)));\n      }\n    }\n\n    return this.resolvePromise(null);\n  }\n\n}\n\nclass v extends r {\n  constructor(e) {\n    let t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n    let r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    let n = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n    super(), this._url = e, this._overridespref = t, this.lrucache = r, this.interceptor = n, this.metadata = null, this._instantLayers = [];\n  }\n\n  get url() {\n    return this._url;\n  }\n\n  _makeAndAddFeatureSet(e) {\n    let t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !0;\n    let r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    const n = g(e, this._overridespref, null === r ? [\"*\"] : r, t, this.lrucache);\n    return this._instantLayers.push({\n      featureset: n,\n      opitem: e,\n      includeGeometry: t,\n      outFields: JSON.stringify(r)\n    }), n;\n  }\n\n  _loadMetaData() {\n    return k(this._url).then(e => (this.metadata = e, e));\n  }\n\n  load() {\n    return this._loadMetaData();\n  }\n\n  clone() {\n    return new v(this._url, this._overridespref, this.lrucache, this.interceptor);\n  }\n\n  featureSetByName(e) {\n    let t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !0;\n    let r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    null === r && (r = [\"*\"]), r = (r = r.slice(0)).sort();\n    const n = JSON.stringify(r);\n\n    for (let a = 0; a < this._instantLayers.length; a++) {\n      const r = this._instantLayers[a];\n      if (r.opitem.title === e && r.includeGeometry === t && r.outFields === n) return this.resolvePromise(this._instantLayers[a].featureset);\n    }\n\n    return this._loadMetaData().then(n => {\n      let a = null;\n\n      for (const t of n.layers ? n.layers : []) t.name === e && (a = t);\n\n      if (!a) for (const t of n.tables ? n.tables : []) t.name === e && (a = t);\n      return a ? F(this._url + \"/\" + a.id, [\"*\"]).then(e => this._makeAndAddFeatureSet(e, t, r)) : this.resolvePromise(null);\n    });\n  }\n\n  featureSetById(e) {\n    let t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !0;\n    let r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [\"*\"];\n    null === r && (r = [\"*\"]), r = (r = r.slice(0)).sort();\n    const n = JSON.stringify(r);\n    e = null != e ? e.toString() : \"\";\n\n    for (let a = 0; a < this._instantLayers.length; a++) {\n      const r = this._instantLayers[a];\n      if (r.opitem.id === e && r.includeGeometry === t && r.outFields === n) return this.resolvePromise(this._instantLayers[a].featureset);\n    }\n\n    return this._loadMetaData().then(n => {\n      let a = null;\n\n      for (const t of n.layers ? n.layers : []) null !== t.id && void 0 !== t.id && t.id.toString() === e && (a = t);\n\n      if (!a) for (const t of n.tables ? n.tables : []) null !== t.id && void 0 !== t.id && t.id.toString() === e && (a = t);\n      return a ? F(this._url + \"/\" + a.id, [\"*\"]).then(e => this._makeAndAddFeatureSet(e, t, r)) : this.resolvePromise(null);\n    });\n  }\n\n}\n\nfunction E(e, t) {\n  let r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n  let n = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n  return new O(e, t, r, n);\n}\n\nfunction b(e, t) {\n  let r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n  let n = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n  return new v(e, t, r, n);\n}\n\nfunction D(e, t) {\n  if (null === e) return t;\n  return new I({\n    url: e.field(\"url\")\n  });\n}\n\nfunction q(r, n, a) {\n  return e.findCredential(r.restUrl) ? \"loaded\" === r.loadStatus && \"\" === n && r.user && r.user.sourceJSON && !1 === a ? h(r.user.sourceJSON) : \"\" === n ? t(r.restUrl + \"/community/self\", {\n    responseType: \"json\",\n    query: {\n      f: \"json\",\n      ...(!1 === a ? {} : {\n        returnUserLicenseTypeExtensions: !0\n      })\n    }\n  }).then(e => {\n    if (e.data) {\n      const t = e.data;\n      if (t && t.username) return h(t);\n    }\n\n    return h(null);\n  }) : t(r.restUrl + \"/community/users/\" + n, {\n    responseType: \"json\",\n    query: {\n      f: \"json\"\n    }\n  }).then(e => {\n    if (e.data) {\n      const t = e.data;\n      return t.error ? null : h(t);\n    }\n\n    return h(null);\n  }) : h(null);\n}\n\nfunction P(e, t, r, n, a) {\n  if (null === e) return null;\n\n  if (e instanceof _) {\n    switch (t) {\n      case \"datasource\":\n        return g(e, a, e.outFields, !0, r, n).getDataSourceFeatureSet();\n\n      case \"parent\":\n      case \"root\":\n        return g(e, a, e.outFields, !0, r, n);\n    }\n\n    return null;\n  }\n\n  if (e instanceof m) switch (t) {\n    case \"datasource\":\n      return e.getDataSourceFeatureSet();\n\n    case \"parent\":\n      return e;\n\n    case \"root\":\n      return e.getRootFeatureSet();\n  }\n  return null;\n}\n\nfunction G(e, t, r, n, a, s, i) {\n  let l = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : null;\n\n  if (d.applicationCache) {\n    const o = d.applicationCache.getLayerInfo(e + \":\" + s.url);\n    if (o) return o.then(e => {\n      try {\n        const s = new _({\n          url: f(e.url) + \"/\" + t,\n          outFields: [\"*\"]\n        });\n        return h(g(s, r, n, a, i, l));\n      } catch (s) {\n        return p(s);\n      }\n    }, e => p(e));\n  }\n\n  return y((o, u) => {\n    const c = new S({\n      id: e,\n      portal: s\n    }).load();\n    d.applicationCache && d.applicationCache.setLayerInfo(e + \":\" + s.url, c), c.then(e => {\n      try {\n        const s = new _({\n          url: f(e.url) + \"/\" + t,\n          outFields: [\"*\"]\n        });\n        o(g(s, r, n, a, i, l));\n      } catch (s) {\n        u(s);\n      }\n    }, t => {\n      d.applicationCache && d.applicationCache.clearLayerInfo(e + \":\" + s.url), u(t);\n    });\n  });\n}\n\nexport { j as constructAssociationMetaDataFeatureSetFromUrl, g as constructFeatureSet, G as constructFeatureSetFromPortalItem, w as constructFeatureSetFromRelationship, T as constructFeatureSetFromUrl, P as convertToFeatureSet, E as createFeatureSetCollectionFromMap, b as createFeatureSetCollectionFromService, D as getPortal, N as initialiseMetaDataCache, q as lookupUser };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/arcade/featureSetUtils.js"],"names":["id","e","t","r","n","a","s","i","l","o","u","c","d","m","extractServiceUrl","f","resolve","h","reject","p","create","y","WhereClause","L","_","I","S","N","applicationCache","F","getLayerInfo","then","url","outFields","sourceJSON","load","setLayerInfo","catch","clearLayerInfo","T","g","_hasMemorySource","layer","spatialReference","includeGeometry","lrucache","interceptor","A","responseType","query","data","C","toString","method","layers","JSON","stringify","layerDataElements","Error","k","tables","j","metadata","networkId","unVersion","terminals","queryelem","layerNameLkp","lkp","controllerDatasetLayers","utilityNetworkLayerId","name","dataElement","schemaGeneration","domainNetworks","edgeSources","layerId","sourceId","className","junctionSources","terminalConfigurations","push","terminalId","terminalName","systemLayers","associationsTableId","filter","getFieldsIndex","associations","w","serviceUrl","charAt","length","relatedTableId","relatedLayer","relationship","objectId","registerAction","O","constructor","_map","_overridespref","_instantLayers","_makeAndAddFeatureSet","featureset","opitem","featureSetByName","loaded","slice","sort","title","resolvePromise","allLayers","find","_materializedTable","featureSetById","v","_url","_loadMetaData","clone","E","b","D","field","q","findCredential","restUrl","loadStatus","user","returnUserLicenseTypeExtensions","username","error","P","getDataSourceFeatureSet","getRootFeatureSet","G","portal","constructAssociationMetaDataFeatureSetFromUrl","constructFeatureSet","constructFeatureSetFromPortalItem","constructFeatureSetFromRelationship","constructFeatureSetFromUrl","convertToFeatureSet","createFeatureSetCollectionFromMap","createFeatureSetCollectionFromService","getPortal","initialiseMetaDataCache","lookupUser"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{id as e}from\"../kernel.js\";import t from\"../request.js\";import r from\"./featureSetCollection.js\";import n from\"./featureset/actions/AttributeFilter.js\";import a from\"./featureset/actions/GroupBy.js\";import s from\"./featureset/actions/OrderBy.js\";import i from\"./featureset/actions/SpatialFilter.js\";import l from\"./featureset/actions/Top.js\";import o from\"./featureset/sources/FeatureLayerDynamic.js\";import u from\"./featureset/sources/FeatureLayerMemory.js\";import c from\"./featureset/sources/FeatureLayerRelated.js\";import d from\"./featureset/support/cache.js\";import m from\"./featureset/support/FeatureSet.js\";import{extractServiceUrl as f}from\"./featureset/support/shared.js\";import{resolve as h,reject as p,create as y}from\"../core/promiseUtils.js\";import{WhereClause as L}from\"../core/sql/WhereClause.js\";import _ from\"../layers/FeatureLayer.js\";import I from\"../portal/Portal.js\";import S from\"../portal/PortalItem.js\";function N(){null===d.applicationCache&&(d.applicationCache=new d)}function F(e,t){if(d.applicationCache){const r=d.applicationCache.getLayerInfo(e);if(r)return r.then((r=>h(new _({url:e,outFields:t,sourceJSON:r}))));const n=new _({url:e,outFields:t});let a=y(((e,t)=>{n.load().then((()=>{e(n.sourceJSON)}),(e=>{t(e)}))}));return d.applicationCache&&(d.applicationCache.setLayerInfo(e,a),a=a.catch((t=>{throw d.applicationCache.clearLayerInfo(e),t}))),a.then((()=>h(n)))}return h(new _({url:e,outFields:t}))}function T(e,t,r,n,a,s=null){return F(e,[\"*\"]).then((e=>h(g(e,t,r,n,a,s))))}function g(e,t=null,r=null,n=!0,a=null,s=null){return!0===e._hasMemorySource()?new u({layer:e,spatialReference:t,outFields:r,includeGeometry:n,lrucache:a,interceptor:s}):new o({layer:e,spatialReference:t,outFields:r,includeGeometry:n,lrucache:a,interceptor:s})}function A(e){if(null!==d.applicationCache){const t=d.applicationCache.getLayerInfo(e);if(null!==t)return t}let r=t(e,{responseType:\"json\",query:{f:\"json\"}}).then((e=>{if(e.data){const t=e.data;return h(t)}return h(null)}));return null!==d.applicationCache&&(d.applicationCache.setLayerInfo(e,r),r=r.catch((t=>{throw d.applicationCache.clearLayerInfo(e),t}))),r}function C(e,r){const n=\"QUERYDATAELEMTS:\"+r.toString()+\":\"+e;if(null!==d.applicationCache){const e=d.applicationCache.getLayerInfo(n);if(null!==e)return e}let a=t(e+\"/queryDataElements\",{method:\"post\",responseType:\"json\",query:{layers:JSON.stringify([r.toString()]),f:\"json\"}}).then((e=>{if(e.data){const t=e.data;if(t.layerDataElements&&t.layerDataElements[0])return t.layerDataElements[0]}throw new Error(\"Not Found\")}));return null!==d.applicationCache&&(d.applicationCache.setLayerInfo(n,a),a=a.catch((e=>{throw d.applicationCache.clearLayerInfo(n),e}))),a}function k(e){if(null!==d.applicationCache){const t=d.applicationCache.getLayerInfo(e);if(null!==t)return t}let r=t(e,{responseType:\"json\",query:{f:\"json\"}}).then((e=>{if(e.data){const t=e.data;return t.layers||(t.layers=[]),t.tables||(t.tables=[]),h(t)}return h({layers:[],tables:[]})}));return null!==d.applicationCache&&(d.applicationCache.setLayerInfo(e,r),r=r.catch((t=>{throw d.applicationCache.clearLayerInfo(e),t}))),r}function j(e,t){const r={metadata:null,networkId:-1,unVersion:3,terminals:[],queryelem:null,layerNameLkp:{},lkp:null};return k(e).then((n=>{if(r.metadata=n,n.controllerDatasetLayers&&void 0!==n.controllerDatasetLayers.utilityNetworkLayerId&&null!==n.controllerDatasetLayers.utilityNetworkLayerId){if(n.layers)for(const e of n.layers)r.layerNameLkp[e.id]=e.name;if(n.tables)for(const e of n.tables)r.layerNameLkp[e.id]=e.name;const a=n.controllerDatasetLayers.utilityNetworkLayerId;return r.networkId=a,C(e,a).then((n=>{if(n){r.queryelem=n,r.queryelem&&r.queryelem.dataElement&&void 0!==r.queryelem.dataElement.schemaGeneration&&(r.unVersion=r.queryelem.dataElement.schemaGeneration),r.lkp={},r.queryelem.dataElement.domainNetworks||(r.queryelem.dataElement.domainNetworks=[]);for(const e of r.queryelem.dataElement.domainNetworks){for(const t of e.edgeSources?e.edgeSources:[]){const e={layerId:t.layerId,sourceId:t.sourceId,className:r.layerNameLkp[t.layerId]?r.layerNameLkp[t.layerId]:null};e.className&&(r.lkp[e.className]=e)}for(const t of e.junctionSources?e.junctionSources:[]){const e={layerId:t.layerId,sourceId:t.sourceId,className:r.layerNameLkp[t.layerId]?r.layerNameLkp[t.layerId]:null};e.className&&(r.lkp[e.className]=e)}}if(r.queryelem.dataElement.terminalConfigurations)for(const e of r.queryelem.dataElement.terminalConfigurations)for(const t of e.terminals)r.terminals.push({terminalId:t.terminalId,terminalName:t.terminalName});return A(e+\"/\"+a).then((n=>{if(n.systemLayers&&void 0!==n.systemLayers.associationsTableId&&null!==n.systemLayers.associationsTableId){const a=[];return r.unVersion>=4&&(a.push(\"STATUS\"),a.push(\"PERCENTALONG\")),T(e+\"/\"+n.systemLayers.associationsTableId.toString(),t,[\"OBJECTID\",\"FROMNETWORKSOURCEID\",\"TONETWORKSOURCEID\",\"FROMGLOBALID\",\"TOGLOBALID\",\"TOTERMINALID\",\"FROMTERMINALID\",\"ASSOCIATIONTYPE\",\"ISCONTENTVISIBLE\",\"GLOBALID\",...a],!1,null,null).then((e=>e.load())).then((e=>r.unVersion>=4?(e=e.filter(L.create(\"STATUS NOT IN (1, 2, 3, 4, 5, 6, 7, 9, 10, 11, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37, 38, 39, 41, 42, 43, 44, 45, 46, 47, 49, 50, 51, 52, 53, 54, 55, 57, 58, 59, 60, 61, 62,63)\",e.getFieldsIndex()))).load():e)).then((e=>({lkp:r.lkp,associations:e,unVersion:r.unVersion,terminals:r.terminals})))}return{associations:null,unVersion:r.unVersion,lkp:null,terminals:[]}}))}return{associations:null,unVersion:r.unVersion,lkp:null,terminals:[]}}))}return{associations:null,unVersion:r.unVersion,lkp:null,terminals:[]}}))}function w(e,t,r,n=null,a=null,s=!0,i=null,l=null){let o=e.serviceUrl();return o?(o=\"/\"===o.charAt(o.length-1)?o+t.relatedTableId.toString():o+\"/\"+t.relatedTableId.toString(),T(o,n,a,s,i,l).then((o=>new c({layer:e,relatedLayer:o,relationship:t,objectId:r,spatialReference:n,outFields:a,includeGeometry:s,lrucache:i,interceptor:l})))):null}n.registerAction(),a.registerAction(),s.registerAction(),i.registerAction(),l.registerAction();class O extends r{constructor(e,t=null,r=null,n=null){super(),this._map=e,this._overridespref=t,this.lrucache=r,this.interceptor=n,this._instantLayers=[]}_makeAndAddFeatureSet(e,t=!0,r=null){const n=g(e,this._overridespref,null===r?[\"*\"]:r,t,this.lrucache,this.interceptor);return this._instantLayers.push({featureset:n,opitem:e,includeGeometry:t,outFields:JSON.stringify(r)}),n}featureSetByName(e,t=!0,r=null){if(void 0!==this._map.loaded&&void 0!==this._map.load&&!1===this._map.loaded)return this._map.load().then((()=>{try{return this.featureSetByName(e,t,r)}catch(n){return p(n)}}));null===r&&(r=[\"*\"]),r=(r=r.slice(0)).sort();const n=JSON.stringify(r);for(let s=0;s<this._instantLayers.length;s++){const r=this._instantLayers[s];if(r.opitem.title===e&&r.includeGeometry===t&&r.outFields===n)return this.resolvePromise(this._instantLayers[s].featureset)}const a=this._map.allLayers.find((t=>t instanceof _&&t.title===e));if(a)return this.resolvePromise(this._makeAndAddFeatureSet(a,t,r));if(this._map.tables){const n=this._map.tables.find((t=>!!(t.title&&t.title===e||t.title&&t.title===e)));if(n){if(n instanceof _)return this.resolvePromise(this._makeAndAddFeatureSet(n,t,r));if(n._materializedTable);else{const e=n.outFields?n:{...n,outFields:[\"*\"]};n._materializedTable=new _(e)}return n._materializedTable.load().then((()=>this.resolvePromise(this._makeAndAddFeatureSet(n._materializedTable,t,r))))}}return this.resolvePromise(null)}featureSetById(e,t=!0,r=[\"*\"]){if(void 0!==this._map.loaded&&void 0!==this._map.load&&!1===this._map.loaded)return this._map.load().then((()=>{try{return this.featureSetById(e,t,r)}catch(n){return p(n)}}));null===r&&(r=[\"*\"]),r=(r=r.slice(0)).sort();const n=JSON.stringify(r);for(let s=0;s<this._instantLayers.length;s++){const r=this._instantLayers[s];if(r.opitem.id===e&&r.includeGeometry===t&&r.outFields===n)return this.resolvePromise(this._instantLayers[s].featureset)}const a=this._map.allLayers.find((t=>t instanceof _&&t.id===e));if(a)return this.resolvePromise(this._makeAndAddFeatureSet(a,t,r));if(this._map.tables){const n=this._map.tables.find((t=>t.id===e));if(n){if(n instanceof _)return this.resolvePromise(this._makeAndAddFeatureSet(n,t,r));if(n._materializedTable);else{const e={...n,outFields:[\"*\"]};n._materializedTable=new _(e)}return n._materializedTable.load().then((()=>this.resolvePromise(this._makeAndAddFeatureSet(n._materializedTable,t,r))))}}return this.resolvePromise(null)}}class v extends r{constructor(e,t=null,r=null,n=null){super(),this._url=e,this._overridespref=t,this.lrucache=r,this.interceptor=n,this.metadata=null,this._instantLayers=[]}get url(){return this._url}_makeAndAddFeatureSet(e,t=!0,r=null){const n=g(e,this._overridespref,null===r?[\"*\"]:r,t,this.lrucache);return this._instantLayers.push({featureset:n,opitem:e,includeGeometry:t,outFields:JSON.stringify(r)}),n}_loadMetaData(){return k(this._url).then((e=>(this.metadata=e,e)))}load(){return this._loadMetaData()}clone(){return new v(this._url,this._overridespref,this.lrucache,this.interceptor)}featureSetByName(e,t=!0,r=null){null===r&&(r=[\"*\"]),r=(r=r.slice(0)).sort();const n=JSON.stringify(r);for(let a=0;a<this._instantLayers.length;a++){const r=this._instantLayers[a];if(r.opitem.title===e&&r.includeGeometry===t&&r.outFields===n)return this.resolvePromise(this._instantLayers[a].featureset)}return this._loadMetaData().then((n=>{let a=null;for(const t of n.layers?n.layers:[])t.name===e&&(a=t);if(!a)for(const t of n.tables?n.tables:[])t.name===e&&(a=t);return a?F(this._url+\"/\"+a.id,[\"*\"]).then((e=>this._makeAndAddFeatureSet(e,t,r))):this.resolvePromise(null)}))}featureSetById(e,t=!0,r=[\"*\"]){null===r&&(r=[\"*\"]),r=(r=r.slice(0)).sort();const n=JSON.stringify(r);e=null!=e?e.toString():\"\";for(let a=0;a<this._instantLayers.length;a++){const r=this._instantLayers[a];if(r.opitem.id===e&&r.includeGeometry===t&&r.outFields===n)return this.resolvePromise(this._instantLayers[a].featureset)}return this._loadMetaData().then((n=>{let a=null;for(const t of n.layers?n.layers:[])null!==t.id&&void 0!==t.id&&t.id.toString()===e&&(a=t);if(!a)for(const t of n.tables?n.tables:[])null!==t.id&&void 0!==t.id&&t.id.toString()===e&&(a=t);return a?F(this._url+\"/\"+a.id,[\"*\"]).then((e=>this._makeAndAddFeatureSet(e,t,r))):this.resolvePromise(null)}))}}function E(e,t,r=null,n=null){return new O(e,t,r,n)}function b(e,t,r=null,n=null){return new v(e,t,r,n)}function D(e,t){if(null===e)return t;return new I({url:e.field(\"url\")})}function q(r,n,a){return e.findCredential(r.restUrl)?\"loaded\"===r.loadStatus&&\"\"===n&&r.user&&r.user.sourceJSON&&!1===a?h(r.user.sourceJSON):\"\"===n?t(r.restUrl+\"/community/self\",{responseType:\"json\",query:{f:\"json\",...!1===a?{}:{returnUserLicenseTypeExtensions:!0}}}).then((e=>{if(e.data){const t=e.data;if(t&&t.username)return h(t)}return h(null)})):t(r.restUrl+\"/community/users/\"+n,{responseType:\"json\",query:{f:\"json\"}}).then((e=>{if(e.data){const t=e.data;return t.error?null:h(t)}return h(null)})):h(null)}function P(e,t,r,n,a){if(null===e)return null;if(e instanceof _){switch(t){case\"datasource\":return g(e,a,e.outFields,!0,r,n).getDataSourceFeatureSet();case\"parent\":case\"root\":return g(e,a,e.outFields,!0,r,n)}return null}if(e instanceof m)switch(t){case\"datasource\":return e.getDataSourceFeatureSet();case\"parent\":return e;case\"root\":return e.getRootFeatureSet()}return null}function G(e,t,r,n,a,s,i,l=null){if(d.applicationCache){const o=d.applicationCache.getLayerInfo(e+\":\"+s.url);if(o)return o.then((e=>{try{const s=new _({url:f(e.url)+\"/\"+t,outFields:[\"*\"]});return h(g(s,r,n,a,i,l))}catch(s){return p(s)}}),(e=>p(e)))}return y(((o,u)=>{const c=new S({id:e,portal:s}).load();d.applicationCache&&d.applicationCache.setLayerInfo(e+\":\"+s.url,c),c.then((e=>{try{const s=new _({url:f(e.url)+\"/\"+t,outFields:[\"*\"]});o(g(s,r,n,a,i,l))}catch(s){u(s)}}),(t=>{d.applicationCache&&d.applicationCache.clearLayerInfo(e+\":\"+s.url),u(t)}))}))}export{j as constructAssociationMetaDataFeatureSetFromUrl,g as constructFeatureSet,G as constructFeatureSetFromPortalItem,w as constructFeatureSetFromRelationship,T as constructFeatureSetFromUrl,P as convertToFeatureSet,E as createFeatureSetCollectionFromMap,b as createFeatureSetCollectionFromService,D as getPortal,N as initialiseMetaDataCache,q as lookupUser};\n"]},"metadata":{},"sourceType":"module"}