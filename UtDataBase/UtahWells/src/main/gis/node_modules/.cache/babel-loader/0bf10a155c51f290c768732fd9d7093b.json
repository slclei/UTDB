{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport { bidiText as t } from \"../../core/BidiText.js\";\nimport e from \"../../core/Logger.js\";\nimport { isNone as s, isSome as i } from \"../../core/maybe.js\";\nimport r from \"../../core/ObjectPool.js\";\nimport { pt2px as n } from \"../../core/screenUtils.js\";\nimport { create as o, fromValues as a } from \"../../geometry/support/aaBoundingRect.js\";\nimport { getBoundsXY as h } from \"../../geometry/support/boundsUtils.js\";\nimport { polygonCentroid as l } from \"../../geometry/support/centroid.js\";\nimport { isPoint as c, isPolygon as m, isPolyline as f, isExtent as u, isMultipoint as _ } from \"../../geometry/support/jsonUtils.js\";\nimport { SimpleGeometryCursor as d } from \"./CIMEffects.js\";\nimport { getEffectOperator as p, getPlacementOperator as y } from \"./CIMOperators.js\";\nimport { Placement as g } from \"./CIMPlacements.js\";\nimport x from \"./CIMResourceManager.js\";\nimport { LineCapStyle as P, LineJoinStyle as w } from \"./enums.js\";\nimport M from \"./Rect.js\";\nimport { TextRasterizer as b } from \"./TextRasterizer.js\";\nimport { HAlign as S, VAlign as k } from \"../../views/2d/engine/webgl/alignmentUtils.js\";\nimport { GLYPH_SIZE as C, MAGIC_LABEL_LINE_HEIGHT as R } from \"../../views/2d/engine/webgl/definitions.js\";\nimport { shapeGlyphs as T } from \"../../views/2d/engine/webgl/mesh/templates/shapingUtils.js\";\nconst I = Math.PI / 180,\n      v = 10,\n      L = e.getLogger(\"esri.symbols.cim.CIMSymbolDrawHelper\");\n\nclass z {\n  constructor(t) {\n    this._t = t;\n  }\n\n  static createIdentity() {\n    return new z([1, 0, 0, 0, 1, 0]);\n  }\n\n  clone() {\n    const t = this._t;\n    return new z(t.slice());\n  }\n\n  transform(t) {\n    const e = this._t;\n    return [e[0] * t[0] + e[1] * t[1] + e[2], e[3] * t[0] + e[4] * t[1] + e[5]];\n  }\n\n  static createScale(t, e) {\n    return new z([t, 0, 0, 0, e, 0]);\n  }\n\n  scale(t, e) {\n    const s = this._t;\n    return s[0] *= t, s[1] *= t, s[2] *= t, s[3] *= e, s[4] *= e, s[5] *= e, this;\n  }\n\n  scaleRatio() {\n    return Math.sqrt(this._t[0] * this._t[0] + this._t[1] * this._t[1]);\n  }\n\n  static createTranslate(t, e) {\n    return new z([0, 0, t, 0, 0, e]);\n  }\n\n  translate(t, e) {\n    const s = this._t;\n    return s[2] += t, s[5] += e, this;\n  }\n\n  static createRotate(t) {\n    const e = Math.cos(t),\n          s = Math.sin(t);\n    return new z([e, -s, 0, s, e, 0]);\n  }\n\n  rotate(t) {\n    return z.multiply(this, z.createRotate(t), this);\n  }\n\n  static multiply(t, e, s) {\n    const i = t._t,\n          r = e._t,\n          n = i[0] * r[0] + i[3] * r[1],\n          o = i[1] * r[0] + i[4] * r[1],\n          a = i[2] * r[0] + i[5] * r[1] + r[2],\n          h = i[0] * r[3] + i[3] * r[4],\n          l = i[1] * r[3] + i[4] * r[4],\n          c = i[2] * r[3] + i[5] * r[4] + r[5],\n          m = s._t;\n    return m[0] = n, m[1] = o, m[2] = a, m[3] = h, m[4] = l, m[5] = c, s;\n  }\n\n  invert() {\n    const t = this._t;\n    let e = t[0] * t[4] - t[1] * t[3];\n    if (0 === e) return new z([0, 0, 0, 0, 0, 0]);\n    e = 1 / e;\n    const s = (t[1] * t[5] - t[2] * t[4]) * e,\n          i = (t[2] * t[3] - t[0] * t[5]) * e,\n          r = t[4] * e,\n          n = -t[1] * e,\n          o = -t[3] * e,\n          a = t[0] * e;\n    return new z([r, n, s, o, a, i]);\n  }\n\n}\n\nclass U {\n  constructor(t, e) {\n    this._transfos = [], this._sizeTransfos = [], this._geomUnitsPerPoint = 1, this._placementPool = new r(g, null, null, 100), this._earlyReturn = !1, this._mapRotation = 0, this._resourceManager = t || new x(), this._transfos.push(e || z.createIdentity()), this._sizeTransfos.push(e ? e.scaleRatio() : 1);\n  }\n\n  setTransform(t, e) {\n    this._transfos = [t || z.createIdentity()], this._sizeTransfos = [e || (t ? t.scaleRatio() : 1)];\n  }\n\n  setGeomUnitsPerPoint(t) {\n    this._geomUnitsPerPoint = t;\n  }\n\n  transformPt(t) {\n    return this._transfos[this._transfos.length - 1].transform(t);\n  }\n\n  transformSize(t) {\n    return t * this._sizeTransfos[this._sizeTransfos.length - 1];\n  }\n\n  reverseTransformPt(t) {\n    return this._transfos[this._transfos.length - 1].invert().transform(t);\n  }\n\n  reverseTransformSize(t) {\n    return t / this._sizeTransfos[this._sizeTransfos.length - 1];\n  }\n\n  geomUnitsPerPoint() {\n    return this.isEmbedded() ? 1 : this._geomUnitsPerPoint;\n  }\n\n  isEmbedded() {\n    return this._transfos.length > 1;\n  }\n\n  back() {\n    return this._transfos[this._transfos.length - 1];\n  }\n\n  push(t, e) {\n    const s = e ? t.scaleRatio() : 1;\n    z.multiply(t, this.back(), t), this._transfos.push(t), this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length - 1] * s);\n  }\n\n  pop() {\n    this._transfos.splice(-1, 1), this._sizeTransfos.splice(-1, 1);\n  }\n\n  drawSymbol(t, e) {\n    if (t) switch (t.type) {\n      case \"CIMPointSymbol\":\n      case \"CIMLineSymbol\":\n      case \"CIMPolygonSymbol\":\n        this.drawMultiLayerSymbol(t, e);\n        break;\n\n      case \"CIMTextSymbol\":\n        this.drawTextSymbol(t, e);\n    }\n  }\n\n  drawMultiLayerSymbol(t, e) {\n    if (!t) return;\n    const s = t.symbolLayers;\n    if (!s) return;\n    const i = t.effects;\n\n    if (i && i.length > 0) {\n      const t = this.executeEffects(i, e);\n\n      if (t) {\n        let e = t.next();\n\n        for (; e;) this.drawSymbolLayers(s, e), e = t.next();\n      }\n    } else this.drawSymbolLayers(s, e);\n  }\n\n  executeEffects(t, e) {\n    const s = this._resourceManager.geometryEngine;\n    let i = new d(e);\n\n    for (const r of t) {\n      const t = p(r);\n      t && (i = t.execute(i, r, this.geomUnitsPerPoint(), s));\n    }\n\n    return i;\n  }\n\n  drawSymbolLayers(t, e) {\n    let s = t.length;\n\n    for (; s--;) {\n      const i = t[s];\n      if (!i || !1 === i.enable) continue;\n      const r = i.effects;\n\n      if (r && r.length > 0) {\n        const t = this.executeEffects(r, e);\n\n        if (t) {\n          let e = null;\n\n          for (; (e = t.next()) && (this.drawSymbolLayer(i, e), !this._earlyReturn););\n        }\n      } else this.drawSymbolLayer(i, e);\n\n      if (this._earlyReturn) return;\n    }\n  }\n\n  drawSymbolLayer(t, e) {\n    switch (t.type) {\n      case \"CIMSolidFill\":\n        this.drawSolidFill(e, t.color);\n        break;\n\n      case \"CIMHatchFill\":\n        this.drawHatchFill(e, t);\n        break;\n\n      case \"CIMPictureFill\":\n        this.drawPictureFill(e, t);\n        break;\n\n      case \"CIMGradientFill\":\n        this.drawGradientFill(e, t);\n        break;\n\n      case \"CIMSolidStroke\":\n        this.drawSolidStroke(e, t.color, t.width, t.capStyle, t.joinStyle, t.miterLimit);\n        break;\n\n      case \"CIMPictureStroke\":\n        this.drawPictureStroke(e, t);\n        break;\n\n      case \"CIMGradientStroke\":\n        this.drawGradientStroke(e, t);\n        break;\n\n      case \"CIMCharacterMarker\":\n      case \"CIMPictureMarker\":\n      case \"CIMVectorMarker\":\n        this.drawMarkerLayer(t, e);\n    }\n  }\n\n  drawHatchFill(t, e) {\n    const s = this._buildHatchPolyline(e, t, this.geomUnitsPerPoint());\n\n    s && (this.pushClipPath(t), this.drawMultiLayerSymbol(e.lineSymbol, s), this.popClipPath());\n  }\n\n  drawPictureFill(t, e) {}\n\n  drawGradientFill(t, e) {}\n\n  drawPictureStroke(t, e) {}\n\n  drawGradientStroke(t, e) {}\n\n  drawMarkerLayer(t, e) {\n    const s = t.markerPlacement;\n\n    if (s) {\n      const i = y(s);\n\n      if (i) {\n        const r = \"CIMMarkerPlacementInsidePolygon\" === s.type;\n        r && this.pushClipPath(e);\n        const n = i.execute(e, s, this.geomUnitsPerPoint(), this._resourceManager.geometryEngine);\n\n        if (n) {\n          let e = null;\n\n          for (; (e = n.next()) && (this.drawMarker(t, e), !this._earlyReturn););\n        }\n\n        r && this.popClipPath();\n      }\n    } else {\n      const s = this._placementPool.acquire();\n\n      if (c(e)) s.tx = e.x, s.ty = e.y, this.drawMarker(t, s);else if (m(e)) [s.tx, s.ty] = l(e), this.drawMarker(t, s);else for (const i of e.points) if (s.tx = i[0], s.ty = i[1], this.drawMarker(t, s), this._earlyReturn) break;\n\n      this._placementPool.release(s);\n    }\n  }\n\n  drawMarker(t, e) {\n    switch (t.type) {\n      case \"CIMCharacterMarker\":\n      case \"CIMPictureMarker\":\n        this.drawPictureMarker(t, e);\n        break;\n\n      case \"CIMVectorMarker\":\n        this.drawVectorMarker(t, e);\n    }\n  }\n\n  drawPictureMarker(t, e) {\n    var i, r, n, o, a;\n    if (!t) return;\n\n    const h = this._resourceManager.getResource(t.url),\n          l = null != (i = t.size) ? i : 10;\n\n    if (s(h) || l <= 0) return;\n    const c = h.width,\n          m = h.height;\n    if (!c || !m) return;\n\n    const f = c / m,\n          u = null != (r = t.scaleX) ? r : 1,\n          _ = z.createIdentity(),\n          d = t.anchorPoint;\n\n    if (d) {\n      let e = d.x,\n          s = d.y;\n      \"Absolute\" !== t.anchorPointUnits && (e *= l * f * u, s *= l), _.translate(-e, -s);\n    }\n\n    let p = null != (n = t.rotation) ? n : 0;\n    t.rotateClockwise && (p = -p), this._mapRotation && (p += this._mapRotation), p && _.rotate(p * I);\n    let y = null != (o = t.offsetX) ? o : 0,\n        g = null != (a = t.offsetY) ? a : 0;\n\n    if (y || g) {\n      if (this._mapRotation) {\n        const t = I * this._mapRotation,\n              e = Math.cos(t),\n              s = Math.sin(t),\n              i = y * s + g * e;\n        y = y * e - g * s, g = i;\n      }\n\n      _.translate(y, g);\n    }\n\n    const x = this.geomUnitsPerPoint();\n    1 !== x && _.scale(x, x);\n    const P = e.getAngle();\n    P && _.rotate(P), _.translate(e.tx, e.ty), this.push(_, !1), this.drawImage(t.url, l, t.scaleX), this.pop();\n  }\n\n  drawVectorMarker(t, e) {\n    var s, i, r, n;\n    if (!t) return;\n    const o = t.markerGraphics;\n    if (!o) return;\n    const a = null != (s = t.size) ? s : 10,\n          h = t.frame,\n          l = h ? h.ymax - h.ymin : 0,\n          c = a && l ? a / l : 1,\n          m = z.createIdentity();\n    h && m.translate(.5 * -(h.xmax + h.xmin), .5 * -(h.ymax + h.ymin));\n    const f = t.anchorPoint;\n\n    if (f) {\n      let e = f.x,\n          s = f.y;\n      \"Absolute\" !== t.anchorPointUnits ? h && (e *= h.xmax - h.xmin, s *= h.ymax - h.ymin) : (e /= c, s /= c), m.translate(-e, -s);\n    }\n\n    1 !== c && m.scale(c, c);\n    let u = null != (i = t.rotation) ? i : 0;\n    t.rotateClockwise && (u = -u), this._mapRotation && (u += this._mapRotation), u && m.rotate(u * I);\n\n    let _ = null != (r = t.offsetX) ? r : 0,\n        d = null != (n = t.offsetY) ? n : 0;\n\n    if (_ || d) {\n      if (this._mapRotation) {\n        const t = I * this._mapRotation,\n              e = Math.cos(t),\n              s = Math.sin(t),\n              i = _ * s + d * e;\n        _ = _ * e - d * s, d = i;\n      }\n\n      m.translate(_, d);\n    }\n\n    const p = this.geomUnitsPerPoint();\n    1 !== p && m.scale(p, p);\n    const y = e.getAngle();\n    y && m.rotate(y), m.translate(e.tx, e.ty), this.push(m, t.scaleSymbolsProportionally);\n\n    for (const g of o) if (g && g.symbol && g.geometry || L.error(\"Invalid marker graphic\", g), this.drawSymbol(g.symbol, g.geometry), this._earlyReturn) break;\n\n    this.pop();\n  }\n\n  drawTextSymbol(t, e) {\n    var s, i, r, n;\n    if (!t) return;\n    if (!c(e)) return;\n    if ((null != (s = t.height) ? s : 10) <= 0) return;\n    const o = z.createIdentity();\n    let a = null != (i = t.angle) ? i : 0;\n    a = -a, a && o.rotate(a * I);\n    const h = null != (r = t.offsetX) ? r : 0,\n          l = null != (n = t.offsetY) ? n : 0;\n    (h || l) && o.translate(h, l);\n    const m = this.geomUnitsPerPoint();\n    1 !== m && o.scale(m, m), o.translate(e.x, e.y), this.push(o, !1), this.drawText(t), this.pop();\n  }\n\n  _buildHatchPolyline(t, e, s) {\n    let i = (void 0 !== t.separation ? t.separation : 4) * s,\n        r = void 0 !== t.rotation ? t.rotation : 0;\n    if (0 === i) return null;\n    i < 0 && (i = -i);\n    let n = 0;\n    const a = .5 * i;\n\n    for (; n > a;) n -= i;\n\n    for (; n < -a;) n += i;\n\n    const l = o();\n    h(l, e), l[0] -= a, l[1] -= a, l[2] += a, l[3] += a;\n    const c = [[l[0], l[1]], [l[0], l[3]], [l[2], l[3]], [l[2], l[1]]];\n\n    for (; r > 180;) r -= 180;\n\n    for (; r < 0;) r += 180;\n\n    const m = Math.cos(r * I),\n          f = Math.sin(r * I),\n          u = -i * f,\n          _ = i * m;\n\n    let d, p, y, g;\n    n = (void 0 !== t.offsetX ? t.offsetX * s : 0) * f - (void 0 !== t.offsetY ? t.offsetY * s : 0) * m, d = y = Number.MAX_VALUE, p = g = -Number.MAX_VALUE;\n\n    for (const o of c) {\n      const t = o[0],\n            e = o[1],\n            s = m * t + f * e,\n            i = -f * t + m * e;\n      d = Math.min(d, s), y = Math.min(y, i), p = Math.max(p, s), g = Math.max(g, i);\n    }\n\n    y = Math.floor(y / i) * i;\n    let x = m * d - f * y - u * n / i,\n        P = f * d + m * y - _ * n / i,\n        w = m * p - f * y - u * n / i,\n        M = f * p + m * y - _ * n / i;\n    const b = 1 + Math.round((g - y) / i),\n          S = [];\n\n    for (let o = 0; o < b; o++) x += u, P += _, w += u, M += _, S.push([[x, P], [w, M]]);\n\n    return {\n      paths: S\n    };\n  }\n\n}\n\nclass F extends U {\n  constructor(t, e) {\n    super(t, e), this.reset();\n  }\n\n  reset() {\n    this._xmin = this._ymin = 1 / 0, this._xmax = this._ymax = -1 / 0, this._clipCount = 0;\n  }\n\n  envelope() {\n    return new M(this._xmin, this._ymin, this._xmax - this._xmin, this._ymax - this._ymin);\n  }\n\n  bounds() {\n    return a(this._xmin, this._ymin, this._xmax, this._ymax);\n  }\n\n  drawSolidFill(t) {\n    if (t && !(this._clipCount > 0)) if (m(t)) this._processPath(t.rings, 0);else if (f(t)) this._processPath(t.paths, 0);else if (u(t)) {\n      const e = G(t);\n      e && this._processPath(e.rings, 0);\n    } else console.error(\"drawSolidFill Unexpected geometry type!\");\n  }\n\n  drawSolidStroke(t, e, s) {\n    if (!t || this._clipCount > 0) return;\n    const i = .5 * this.transformSize(s);\n    if (m(t)) this._processPath(t.rings, i);else if (f(t)) this._processPath(t.paths, i);else if (u(t)) {\n      const e = G(t);\n      e && this._processPath(e.rings, i);\n    } else console.error(\"drawSolidStroke unexpected geometry type!\");\n  }\n\n  pushClipPath(t) {\n    this.drawSolidFill(t), ++this._clipCount;\n  }\n\n  popClipPath() {\n    --this._clipCount;\n  }\n\n  drawImage(t, e, s) {\n    let r = s * e,\n        n = e;\n\n    const o = this._resourceManager.getResource(t);\n\n    !e && i(o) && (r = s * o.width, n = o.height), this._merge(this.transformPt([-r / 2, -n / 2]), 0), this._merge(this.transformPt([-r / 2, n / 2]), 0), this._merge(this.transformPt([r / 2, -n / 2]), 0), this._merge(this.transformPt([r / 2, n / 2]), 0);\n  }\n\n  drawText(t) {\n    this._textRasterizer || (this._textRasterizer = new b());\n  }\n\n  _processPath(t, e) {\n    if (t) for (const s of t) {\n      const t = s ? s.length : 0;\n\n      if (t > 1) {\n        this._merge(this.transformPt(s[0]), e);\n\n        for (let i = 1; i < t; ++i) this._merge(this.transformPt(s[i]), e);\n      }\n    }\n  }\n\n  _merge(t, e) {\n    t[0] - e < this._xmin && (this._xmin = t[0] - e), t[0] + e > this._xmax && (this._xmax = t[0] + e), t[1] - e < this._ymin && (this._ymin = t[1] - e), t[1] + e > this._ymax && (this._ymax = t[1] + e);\n  }\n\n}\n\nclass j extends U {\n  constructor() {\n    super(...arguments), this._searchPoint = [0, 0], this._searchDistPoint = 0;\n  }\n\n  hitTest(t, e, s, i, r, o) {\n    const a = o * n(1);\n    this.setTransform(), this.setGeomUnitsPerPoint(a), this._searchPoint = [(t[0] + t[2]) / 2, (t[1] + t[3]) / 2], this._searchDistPoint = (t[2] - t[0]) / 2 / a, this._textInfo = i;\n    const h = e && (\"CIMPointSymbol\" === e.type && \"Map\" !== e.angleAlignment || \"CIMTextSymbol\" === e.type);\n    return this._mapRotation = h ? r : 0, this._earlyReturn = !1, this.drawSymbol(e, s), this._earlyReturn;\n  }\n\n  drawSolidFill(t, e) {\n    this._hitTestFill(t);\n  }\n\n  drawHatchFill(t, e) {\n    this._hitTestFill(t);\n  }\n\n  drawPictureFill(t, e) {\n    this._hitTestFill(t);\n  }\n\n  drawGradientFill(t, e) {\n    this._hitTestFill(t);\n  }\n\n  drawSolidStroke(t, e, s, i, r, n) {\n    this._hitTestStroke(t, s);\n  }\n\n  drawPictureStroke(t, e) {\n    this._hitTestStroke(t, e.width);\n  }\n\n  drawGradientStroke(t, e) {\n    this._hitTestStroke(t, e.width);\n  }\n\n  pushClipPath(t) {}\n\n  popClipPath() {}\n\n  drawImage(t, e, i) {\n    const r = this._resourceManager.getResource(t);\n\n    if (s(r) || 0 === r.height || 0 === e) return;\n    const n = e * this.geomUnitsPerPoint(),\n          o = n * i * (r.width / r.height),\n          a = this.reverseTransformPt(this._searchPoint),\n          h = this._searchDistPoint;\n    Math.abs(a[0]) < o / 2 + h && Math.abs(a[1]) < n / 2 + h && (this._earlyReturn = !0);\n  }\n\n  drawText(e) {\n    var s, i;\n    const r = this._textInfo;\n    if (!r) return;\n    const n = r.get(e);\n    if (!n) return;\n    const {\n      text: o,\n      mosaicItem: a\n    } = n;\n    if (!a || 0 === a.glyphMosaicItems.length) return;\n    const h = null != (s = e.height) ? s : v,\n          l = H(e.lineGapType, null != (i = e.lineGap) ? i : 0, h),\n          c = t(o)[1],\n          m = a.glyphMosaicItems,\n          f = T(m, c, {\n      scale: h / C,\n      angle: 0,\n      xOffset: 0,\n      yOffset: 0,\n      hAlign: E(e.horizontalAlignment),\n      vAlign: B(e.verticalAlignment),\n      maxLineWidth: 512,\n      lineHeight: R * Math.max(.25, Math.min(l || 1, 4)),\n      decoration: e.font.decoration || \"none\",\n      isCIM: !0\n    }),\n          u = this.reverseTransformPt(this._searchPoint),\n          _ = u[0],\n          d = u[1];\n\n    for (const t of f.glyphs) if (_ > t.xTopLeft && _ < t.xBottomRight && d > -t.yBottomRight && d < -t.yTopLeft) {\n      this._earlyReturn = !0;\n      break;\n    }\n  }\n\n  _hitTestFill(t) {\n    let e = null;\n\n    if (u(t)) {\n      const s = t;\n      e = [[[s.xmin, s.ymin], [s.xmin, s.ymax], [s.xmax, s.ymax], [s.xmax, s.ymin], [s.xmin, s.ymin]]];\n    } else if (m(t)) e = t.rings;else {\n      if (!f(t)) return;\n      e = t.paths;\n    }\n\n    const s = this.reverseTransformPt(this._searchPoint);\n    this._pointInPolygon(s, e) && (this._earlyReturn = !0);\n    const i = this.reverseTransformSize(this._searchDistPoint) * this.geomUnitsPerPoint();\n    this._nearLine(s, e, i) && (this._earlyReturn = !0);\n  }\n\n  _hitTestStroke(t, e) {\n    let s = null;\n\n    if (u(t)) {\n      const e = t;\n      s = [[[e.xmin, e.ymin], [e.xmin, e.ymax], [e.xmax, e.ymax], [e.xmax, e.ymin], [e.xmin, e.ymin]]];\n    } else if (m(t)) s = t.rings;else {\n      if (!f(t)) return;\n      s = t.paths;\n    }\n\n    const i = this.reverseTransformPt(this._searchPoint),\n          r = e * this.geomUnitsPerPoint(),\n          n = this.reverseTransformSize(this._searchDistPoint) * this.geomUnitsPerPoint();\n    this._nearLine(i, s, r / 2 + n) && (this._earlyReturn = !0);\n  }\n\n  _pointInPolygon(t, e) {\n    let s = 0;\n\n    for (const i of e) {\n      const e = i.length;\n\n      for (let r = 1; r < e; ++r) {\n        const e = i[r - 1],\n              n = i[r];\n        if (e[1] > t[1] == n[1] > t[1]) continue;\n        (n[0] - e[0]) * (t[1] - e[1]) - (n[1] - e[1]) * (t[0] - e[0]) > 0 ? s++ : s--;\n      }\n    }\n\n    return 0 !== s;\n  }\n\n  _nearLine(t, e, s) {\n    for (const i of e) {\n      const e = i.length;\n\n      for (let r = 1; r < e; ++r) {\n        const e = i[r - 1],\n              n = i[r];\n        let o = (n[0] - e[0]) * (n[0] - e[0]) + (n[1] - e[1]) * (n[1] - e[1]);\n        if (0 === o) continue;\n        o = Math.sqrt(o);\n        const a = ((n[0] - e[0]) * (t[1] - e[1]) - (n[1] - e[1]) * (t[0] - e[0])) / o;\n\n        if (Math.abs(a) < s) {\n          const i = ((n[0] - e[0]) * (t[0] - e[0]) + (n[1] - e[1]) * (t[1] - e[1])) / o;\n          if (i > -s && i < o + s) return !0;\n        }\n      }\n    }\n\n    return !1;\n  }\n\n}\n\nclass A extends U {\n  constructor(t, e, s) {\n    super(e, s), this._ctx = t;\n  }\n\n  drawSolidFill(t, e) {\n    if (!t) return;\n    if (m(t)) this._buildPath(t.rings, !0);else if (f(t)) this._buildPath(t.paths, !0);else if (u(t)) this._buildPath(G(t).rings, !0);else {\n      if (!_(t)) return;\n      console.log(\"CanvasDrawHelper.drawSolidFill - No implementation!\");\n    }\n    const s = this._ctx;\n    s.fillStyle = \"string\" == typeof e ? e : \"rgba(\" + Math.round(e[0]) + \",\" + Math.round(e[1]) + \",\" + Math.round(e[2]) + \",\" + e[3] / 255 + \")\", s.fill(\"evenodd\");\n  }\n\n  drawSolidStroke(t, e, s, i, r, n) {\n    if (!t || !e || 0 === s) return;\n    if (m(t)) this._buildPath(t.rings, !0);else if (f(t)) this._buildPath(t.paths, !1);else {\n      if (!u(t)) return void console.log(\"CanvasDrawHelper.drawSolidStroke isn't implemented!\");\n\n      this._buildPath(G(t).rings, !0);\n    }\n    const o = this._ctx;\n    o.strokeStyle = \"string\" == typeof e ? e : \"rgba(\" + Math.round(e[0]) + \",\" + Math.round(e[1]) + \",\" + Math.round(e[2]) + \",\" + e[3] / 255 + \")\", o.lineWidth = this.transformSize(s) + .5, this._setCapStyle(i), this._setJoinStyle(r), o.miterLimit = n, o.stroke();\n  }\n\n  pushClipPath(t) {\n    if (this._ctx.save(), m(t)) this._buildPath(t.rings, !0);else if (f(t)) this._buildPath(t.paths, !0);else {\n      if (!u(t)) return;\n\n      this._buildPath(G(t).rings, !0);\n    }\n\n    this._ctx.clip(\"evenodd\");\n  }\n\n  popClipPath() {\n    this._ctx.restore();\n  }\n\n  drawImage(t, e, i) {\n    const r = this._resourceManager.getResource(t);\n\n    if (s(r)) return;\n    const n = this._ctx,\n          o = n.canvas.width,\n          a = n.canvas.height;\n    let h = e * i * (r.width / r.height),\n        l = i * e;\n    e || (h = i * r.width, l = i * r.height), this._ctx.drawImage(r, 0, 0, r.width, r.height, 0, 0, Math.min(this.transformSize(h), o), Math.min(this.transformSize(l), a));\n  }\n\n  drawText(t) {\n    this._textRasterizer || (this._textRasterizer = new b());\n  }\n\n  _buildPath(t, e) {\n    const s = this._ctx;\n    if (s.beginPath(), t) for (const i of t) {\n      const t = i ? i.length : 0;\n\n      if (t > 1) {\n        let r = this.transformPt(i[0]);\n        s.moveTo(r[0], r[1]);\n\n        for (let e = 1; e < t; ++e) r = this.transformPt(i[e]), s.lineTo(r[0], r[1]);\n\n        e && s.closePath();\n      }\n    }\n  }\n\n  _setCapStyle(t) {\n    switch (t) {\n      case P.Butt:\n        this._ctx.lineCap = \"butt\";\n        break;\n\n      case P.Round:\n        this._ctx.lineCap = \"round\";\n        break;\n\n      case P.Square:\n        this._ctx.lineCap = \"square\";\n    }\n  }\n\n  _setJoinStyle(t) {\n    switch (t) {\n      case w.Bevel:\n        this._ctx.lineJoin = \"bevel\";\n        break;\n\n      case w.Round:\n        this._ctx.lineJoin = \"round\";\n        break;\n\n      case w.Miter:\n        this._ctx.lineJoin = \"miter\";\n    }\n  }\n\n}\n\nconst G = t => t ? {\n  spatialReference: t.spatialReference,\n  rings: [[[t.xmin, t.ymin], [t.xmin, t.ymax], [t.xmax, t.ymax], [t.xmax, t.ymin], [t.xmin, t.ymin]]]\n} : null,\n      E = t => {\n  switch (t) {\n    case \"Left\":\n      return S.Left;\n\n    case \"Right\":\n      return S.Right;\n\n    case \"Center\":\n    case \"Justify\":\n      return S.Center;\n  }\n},\n      B = t => {\n  switch (t) {\n    case \"Top\":\n      return k.Top;\n\n    case \"Center\":\n      return k.Center;\n\n    case \"Bottom\":\n      return k.Bottom;\n\n    case \"Baseline\":\n      return k.Baseline;\n  }\n},\n      H = (t, e, s) => {\n  switch (t) {\n    case \"ExtraLeading\":\n      return 1 + e / s;\n\n    case \"Multiple\":\n      return e;\n\n    case \"Exact\":\n      return e / s;\n  }\n};\n\nexport { U as CIMSymbolDrawHelper, I as C_DEG_TO_RAD, A as CanvasDrawHelper, F as EnvDrawHelper, j as HittestDrawHelper, z as Transformation, E as horizontalAlignment2HAlign, H as lineGapType2LineHeight, B as verticalAlignment2VAlign };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/symbols/cim/CIMSymbolDrawHelper.js"],"names":["bidiText","t","e","isNone","s","isSome","i","r","pt2px","n","create","o","fromValues","a","getBoundsXY","h","polygonCentroid","l","isPoint","c","isPolygon","m","isPolyline","f","isExtent","u","isMultipoint","_","SimpleGeometryCursor","d","getEffectOperator","p","getPlacementOperator","y","Placement","g","x","LineCapStyle","P","LineJoinStyle","w","M","TextRasterizer","b","HAlign","S","VAlign","k","GLYPH_SIZE","C","MAGIC_LABEL_LINE_HEIGHT","R","shapeGlyphs","T","I","Math","PI","v","L","getLogger","z","constructor","_t","createIdentity","clone","slice","transform","createScale","scale","scaleRatio","sqrt","createTranslate","translate","createRotate","cos","sin","rotate","multiply","invert","U","_transfos","_sizeTransfos","_geomUnitsPerPoint","_placementPool","_earlyReturn","_mapRotation","_resourceManager","push","setTransform","setGeomUnitsPerPoint","transformPt","length","transformSize","reverseTransformPt","reverseTransformSize","geomUnitsPerPoint","isEmbedded","back","pop","splice","drawSymbol","type","drawMultiLayerSymbol","drawTextSymbol","symbolLayers","effects","executeEffects","next","drawSymbolLayers","geometryEngine","execute","enable","drawSymbolLayer","drawSolidFill","color","drawHatchFill","drawPictureFill","drawGradientFill","drawSolidStroke","width","capStyle","joinStyle","miterLimit","drawPictureStroke","drawGradientStroke","drawMarkerLayer","_buildHatchPolyline","pushClipPath","lineSymbol","popClipPath","markerPlacement","drawMarker","acquire","tx","ty","points","release","drawPictureMarker","drawVectorMarker","getResource","url","size","height","scaleX","anchorPoint","anchorPointUnits","rotation","rotateClockwise","offsetX","offsetY","getAngle","drawImage","markerGraphics","frame","ymax","ymin","xmax","xmin","scaleSymbolsProportionally","symbol","geometry","error","angle","drawText","separation","Number","MAX_VALUE","min","max","floor","round","paths","F","reset","_xmin","_ymin","_xmax","_ymax","_clipCount","envelope","bounds","_processPath","rings","G","console","_merge","_textRasterizer","j","arguments","_searchPoint","_searchDistPoint","hitTest","_textInfo","angleAlignment","_hitTestFill","_hitTestStroke","abs","get","text","mosaicItem","glyphMosaicItems","H","lineGapType","lineGap","xOffset","yOffset","hAlign","E","horizontalAlignment","vAlign","B","verticalAlignment","maxLineWidth","lineHeight","decoration","font","isCIM","glyphs","xTopLeft","xBottomRight","yBottomRight","yTopLeft","_pointInPolygon","_nearLine","A","_ctx","_buildPath","log","fillStyle","fill","strokeStyle","lineWidth","_setCapStyle","_setJoinStyle","stroke","save","clip","restore","canvas","beginPath","moveTo","lineTo","closePath","Butt","lineCap","Round","Square","Bevel","lineJoin","Miter","spatialReference","Left","Right","Center","Top","Bottom","Baseline","CIMSymbolDrawHelper","C_DEG_TO_RAD","CanvasDrawHelper","EnvDrawHelper","HittestDrawHelper","Transformation","horizontalAlignment2HAlign","lineGapType2LineHeight","verticalAlignment2VAlign"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{bidiText as t}from\"../../core/BidiText.js\";import e from\"../../core/Logger.js\";import{isNone as s,isSome as i}from\"../../core/maybe.js\";import r from\"../../core/ObjectPool.js\";import{pt2px as n}from\"../../core/screenUtils.js\";import{create as o,fromValues as a}from\"../../geometry/support/aaBoundingRect.js\";import{getBoundsXY as h}from\"../../geometry/support/boundsUtils.js\";import{polygonCentroid as l}from\"../../geometry/support/centroid.js\";import{isPoint as c,isPolygon as m,isPolyline as f,isExtent as u,isMultipoint as _}from\"../../geometry/support/jsonUtils.js\";import{SimpleGeometryCursor as d}from\"./CIMEffects.js\";import{getEffectOperator as p,getPlacementOperator as y}from\"./CIMOperators.js\";import{Placement as g}from\"./CIMPlacements.js\";import x from\"./CIMResourceManager.js\";import{LineCapStyle as P,LineJoinStyle as w}from\"./enums.js\";import M from\"./Rect.js\";import{TextRasterizer as b}from\"./TextRasterizer.js\";import{HAlign as S,VAlign as k}from\"../../views/2d/engine/webgl/alignmentUtils.js\";import{GLYPH_SIZE as C,MAGIC_LABEL_LINE_HEIGHT as R}from\"../../views/2d/engine/webgl/definitions.js\";import{shapeGlyphs as T}from\"../../views/2d/engine/webgl/mesh/templates/shapingUtils.js\";const I=Math.PI/180,v=10,L=e.getLogger(\"esri.symbols.cim.CIMSymbolDrawHelper\");class z{constructor(t){this._t=t}static createIdentity(){return new z([1,0,0,0,1,0])}clone(){const t=this._t;return new z(t.slice())}transform(t){const e=this._t;return[e[0]*t[0]+e[1]*t[1]+e[2],e[3]*t[0]+e[4]*t[1]+e[5]]}static createScale(t,e){return new z([t,0,0,0,e,0])}scale(t,e){const s=this._t;return s[0]*=t,s[1]*=t,s[2]*=t,s[3]*=e,s[4]*=e,s[5]*=e,this}scaleRatio(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])}static createTranslate(t,e){return new z([0,0,t,0,0,e])}translate(t,e){const s=this._t;return s[2]+=t,s[5]+=e,this}static createRotate(t){const e=Math.cos(t),s=Math.sin(t);return new z([e,-s,0,s,e,0])}rotate(t){return z.multiply(this,z.createRotate(t),this)}static multiply(t,e,s){const i=t._t,r=e._t,n=i[0]*r[0]+i[3]*r[1],o=i[1]*r[0]+i[4]*r[1],a=i[2]*r[0]+i[5]*r[1]+r[2],h=i[0]*r[3]+i[3]*r[4],l=i[1]*r[3]+i[4]*r[4],c=i[2]*r[3]+i[5]*r[4]+r[5],m=s._t;return m[0]=n,m[1]=o,m[2]=a,m[3]=h,m[4]=l,m[5]=c,s}invert(){const t=this._t;let e=t[0]*t[4]-t[1]*t[3];if(0===e)return new z([0,0,0,0,0,0]);e=1/e;const s=(t[1]*t[5]-t[2]*t[4])*e,i=(t[2]*t[3]-t[0]*t[5])*e,r=t[4]*e,n=-t[1]*e,o=-t[3]*e,a=t[0]*e;return new z([r,n,s,o,a,i])}}class U{constructor(t,e){this._transfos=[],this._sizeTransfos=[],this._geomUnitsPerPoint=1,this._placementPool=new r(g,null,null,100),this._earlyReturn=!1,this._mapRotation=0,this._resourceManager=t||new x,this._transfos.push(e||z.createIdentity()),this._sizeTransfos.push(e?e.scaleRatio():1)}setTransform(t,e){this._transfos=[t||z.createIdentity()],this._sizeTransfos=[e||(t?t.scaleRatio():1)]}setGeomUnitsPerPoint(t){this._geomUnitsPerPoint=t}transformPt(t){return this._transfos[this._transfos.length-1].transform(t)}transformSize(t){return t*this._sizeTransfos[this._sizeTransfos.length-1]}reverseTransformPt(t){return this._transfos[this._transfos.length-1].invert().transform(t)}reverseTransformSize(t){return t/this._sizeTransfos[this._sizeTransfos.length-1]}geomUnitsPerPoint(){return this.isEmbedded()?1:this._geomUnitsPerPoint}isEmbedded(){return this._transfos.length>1}back(){return this._transfos[this._transfos.length-1]}push(t,e){const s=e?t.scaleRatio():1;z.multiply(t,this.back(),t),this._transfos.push(t),this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-1]*s)}pop(){this._transfos.splice(-1,1),this._sizeTransfos.splice(-1,1)}drawSymbol(t,e){if(t)switch(t.type){case\"CIMPointSymbol\":case\"CIMLineSymbol\":case\"CIMPolygonSymbol\":this.drawMultiLayerSymbol(t,e);break;case\"CIMTextSymbol\":this.drawTextSymbol(t,e)}}drawMultiLayerSymbol(t,e){if(!t)return;const s=t.symbolLayers;if(!s)return;const i=t.effects;if(i&&i.length>0){const t=this.executeEffects(i,e);if(t){let e=t.next();for(;e;)this.drawSymbolLayers(s,e),e=t.next()}}else this.drawSymbolLayers(s,e)}executeEffects(t,e){const s=this._resourceManager.geometryEngine;let i=new d(e);for(const r of t){const t=p(r);t&&(i=t.execute(i,r,this.geomUnitsPerPoint(),s))}return i}drawSymbolLayers(t,e){let s=t.length;for(;s--;){const i=t[s];if(!i||!1===i.enable)continue;const r=i.effects;if(r&&r.length>0){const t=this.executeEffects(r,e);if(t){let e=null;for(;(e=t.next())&&(this.drawSymbolLayer(i,e),!this._earlyReturn););}}else this.drawSymbolLayer(i,e);if(this._earlyReturn)return}}drawSymbolLayer(t,e){switch(t.type){case\"CIMSolidFill\":this.drawSolidFill(e,t.color);break;case\"CIMHatchFill\":this.drawHatchFill(e,t);break;case\"CIMPictureFill\":this.drawPictureFill(e,t);break;case\"CIMGradientFill\":this.drawGradientFill(e,t);break;case\"CIMSolidStroke\":this.drawSolidStroke(e,t.color,t.width,t.capStyle,t.joinStyle,t.miterLimit);break;case\"CIMPictureStroke\":this.drawPictureStroke(e,t);break;case\"CIMGradientStroke\":this.drawGradientStroke(e,t);break;case\"CIMCharacterMarker\":case\"CIMPictureMarker\":case\"CIMVectorMarker\":this.drawMarkerLayer(t,e)}}drawHatchFill(t,e){const s=this._buildHatchPolyline(e,t,this.geomUnitsPerPoint());s&&(this.pushClipPath(t),this.drawMultiLayerSymbol(e.lineSymbol,s),this.popClipPath())}drawPictureFill(t,e){}drawGradientFill(t,e){}drawPictureStroke(t,e){}drawGradientStroke(t,e){}drawMarkerLayer(t,e){const s=t.markerPlacement;if(s){const i=y(s);if(i){const r=\"CIMMarkerPlacementInsidePolygon\"===s.type;r&&this.pushClipPath(e);const n=i.execute(e,s,this.geomUnitsPerPoint(),this._resourceManager.geometryEngine);if(n){let e=null;for(;(e=n.next())&&(this.drawMarker(t,e),!this._earlyReturn););}r&&this.popClipPath()}}else{const s=this._placementPool.acquire();if(c(e))s.tx=e.x,s.ty=e.y,this.drawMarker(t,s);else if(m(e))[s.tx,s.ty]=l(e),this.drawMarker(t,s);else for(const i of e.points)if(s.tx=i[0],s.ty=i[1],this.drawMarker(t,s),this._earlyReturn)break;this._placementPool.release(s)}}drawMarker(t,e){switch(t.type){case\"CIMCharacterMarker\":case\"CIMPictureMarker\":this.drawPictureMarker(t,e);break;case\"CIMVectorMarker\":this.drawVectorMarker(t,e)}}drawPictureMarker(t,e){var i,r,n,o,a;if(!t)return;const h=this._resourceManager.getResource(t.url),l=null!=(i=t.size)?i:10;if(s(h)||l<=0)return;const c=h.width,m=h.height;if(!c||!m)return;const f=c/m,u=null!=(r=t.scaleX)?r:1,_=z.createIdentity(),d=t.anchorPoint;if(d){let e=d.x,s=d.y;\"Absolute\"!==t.anchorPointUnits&&(e*=l*f*u,s*=l),_.translate(-e,-s)}let p=null!=(n=t.rotation)?n:0;t.rotateClockwise&&(p=-p),this._mapRotation&&(p+=this._mapRotation),p&&_.rotate(p*I);let y=null!=(o=t.offsetX)?o:0,g=null!=(a=t.offsetY)?a:0;if(y||g){if(this._mapRotation){const t=I*this._mapRotation,e=Math.cos(t),s=Math.sin(t),i=y*s+g*e;y=y*e-g*s,g=i}_.translate(y,g)}const x=this.geomUnitsPerPoint();1!==x&&_.scale(x,x);const P=e.getAngle();P&&_.rotate(P),_.translate(e.tx,e.ty),this.push(_,!1),this.drawImage(t.url,l,t.scaleX),this.pop()}drawVectorMarker(t,e){var s,i,r,n;if(!t)return;const o=t.markerGraphics;if(!o)return;const a=null!=(s=t.size)?s:10,h=t.frame,l=h?h.ymax-h.ymin:0,c=a&&l?a/l:1,m=z.createIdentity();h&&m.translate(.5*-(h.xmax+h.xmin),.5*-(h.ymax+h.ymin));const f=t.anchorPoint;if(f){let e=f.x,s=f.y;\"Absolute\"!==t.anchorPointUnits?h&&(e*=h.xmax-h.xmin,s*=h.ymax-h.ymin):(e/=c,s/=c),m.translate(-e,-s)}1!==c&&m.scale(c,c);let u=null!=(i=t.rotation)?i:0;t.rotateClockwise&&(u=-u),this._mapRotation&&(u+=this._mapRotation),u&&m.rotate(u*I);let _=null!=(r=t.offsetX)?r:0,d=null!=(n=t.offsetY)?n:0;if(_||d){if(this._mapRotation){const t=I*this._mapRotation,e=Math.cos(t),s=Math.sin(t),i=_*s+d*e;_=_*e-d*s,d=i}m.translate(_,d)}const p=this.geomUnitsPerPoint();1!==p&&m.scale(p,p);const y=e.getAngle();y&&m.rotate(y),m.translate(e.tx,e.ty),this.push(m,t.scaleSymbolsProportionally);for(const g of o)if(g&&g.symbol&&g.geometry||L.error(\"Invalid marker graphic\",g),this.drawSymbol(g.symbol,g.geometry),this._earlyReturn)break;this.pop()}drawTextSymbol(t,e){var s,i,r,n;if(!t)return;if(!c(e))return;if((null!=(s=t.height)?s:10)<=0)return;const o=z.createIdentity();let a=null!=(i=t.angle)?i:0;a=-a,a&&o.rotate(a*I);const h=null!=(r=t.offsetX)?r:0,l=null!=(n=t.offsetY)?n:0;(h||l)&&o.translate(h,l);const m=this.geomUnitsPerPoint();1!==m&&o.scale(m,m),o.translate(e.x,e.y),this.push(o,!1),this.drawText(t),this.pop()}_buildHatchPolyline(t,e,s){let i=(void 0!==t.separation?t.separation:4)*s,r=void 0!==t.rotation?t.rotation:0;if(0===i)return null;i<0&&(i=-i);let n=0;const a=.5*i;for(;n>a;)n-=i;for(;n<-a;)n+=i;const l=o();h(l,e),l[0]-=a,l[1]-=a,l[2]+=a,l[3]+=a;const c=[[l[0],l[1]],[l[0],l[3]],[l[2],l[3]],[l[2],l[1]]];for(;r>180;)r-=180;for(;r<0;)r+=180;const m=Math.cos(r*I),f=Math.sin(r*I),u=-i*f,_=i*m;let d,p,y,g;n=(void 0!==t.offsetX?t.offsetX*s:0)*f-(void 0!==t.offsetY?t.offsetY*s:0)*m,d=y=Number.MAX_VALUE,p=g=-Number.MAX_VALUE;for(const o of c){const t=o[0],e=o[1],s=m*t+f*e,i=-f*t+m*e;d=Math.min(d,s),y=Math.min(y,i),p=Math.max(p,s),g=Math.max(g,i)}y=Math.floor(y/i)*i;let x=m*d-f*y-u*n/i,P=f*d+m*y-_*n/i,w=m*p-f*y-u*n/i,M=f*p+m*y-_*n/i;const b=1+Math.round((g-y)/i),S=[];for(let o=0;o<b;o++)x+=u,P+=_,w+=u,M+=_,S.push([[x,P],[w,M]]);return{paths:S}}}class F extends U{constructor(t,e){super(t,e),this.reset()}reset(){this._xmin=this._ymin=1/0,this._xmax=this._ymax=-1/0,this._clipCount=0}envelope(){return new M(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)}bounds(){return a(this._xmin,this._ymin,this._xmax,this._ymax)}drawSolidFill(t){if(t&&!(this._clipCount>0))if(m(t))this._processPath(t.rings,0);else if(f(t))this._processPath(t.paths,0);else if(u(t)){const e=G(t);e&&this._processPath(e.rings,0)}else console.error(\"drawSolidFill Unexpected geometry type!\")}drawSolidStroke(t,e,s){if(!t||this._clipCount>0)return;const i=.5*this.transformSize(s);if(m(t))this._processPath(t.rings,i);else if(f(t))this._processPath(t.paths,i);else if(u(t)){const e=G(t);e&&this._processPath(e.rings,i)}else console.error(\"drawSolidStroke unexpected geometry type!\")}pushClipPath(t){this.drawSolidFill(t),++this._clipCount}popClipPath(){--this._clipCount}drawImage(t,e,s){let r=s*e,n=e;const o=this._resourceManager.getResource(t);!e&&i(o)&&(r=s*o.width,n=o.height),this._merge(this.transformPt([-r/2,-n/2]),0),this._merge(this.transformPt([-r/2,n/2]),0),this._merge(this.transformPt([r/2,-n/2]),0),this._merge(this.transformPt([r/2,n/2]),0)}drawText(t){this._textRasterizer||(this._textRasterizer=new b)}_processPath(t,e){if(t)for(const s of t){const t=s?s.length:0;if(t>1){this._merge(this.transformPt(s[0]),e);for(let i=1;i<t;++i)this._merge(this.transformPt(s[i]),e)}}}_merge(t,e){t[0]-e<this._xmin&&(this._xmin=t[0]-e),t[0]+e>this._xmax&&(this._xmax=t[0]+e),t[1]-e<this._ymin&&(this._ymin=t[1]-e),t[1]+e>this._ymax&&(this._ymax=t[1]+e)}}class j extends U{constructor(){super(...arguments),this._searchPoint=[0,0],this._searchDistPoint=0}hitTest(t,e,s,i,r,o){const a=o*n(1);this.setTransform(),this.setGeomUnitsPerPoint(a),this._searchPoint=[(t[0]+t[2])/2,(t[1]+t[3])/2],this._searchDistPoint=(t[2]-t[0])/2/a,this._textInfo=i;const h=e&&(\"CIMPointSymbol\"===e.type&&\"Map\"!==e.angleAlignment||\"CIMTextSymbol\"===e.type);return this._mapRotation=h?r:0,this._earlyReturn=!1,this.drawSymbol(e,s),this._earlyReturn}drawSolidFill(t,e){this._hitTestFill(t)}drawHatchFill(t,e){this._hitTestFill(t)}drawPictureFill(t,e){this._hitTestFill(t)}drawGradientFill(t,e){this._hitTestFill(t)}drawSolidStroke(t,e,s,i,r,n){this._hitTestStroke(t,s)}drawPictureStroke(t,e){this._hitTestStroke(t,e.width)}drawGradientStroke(t,e){this._hitTestStroke(t,e.width)}pushClipPath(t){}popClipPath(){}drawImage(t,e,i){const r=this._resourceManager.getResource(t);if(s(r)||0===r.height||0===e)return;const n=e*this.geomUnitsPerPoint(),o=n*i*(r.width/r.height),a=this.reverseTransformPt(this._searchPoint),h=this._searchDistPoint;Math.abs(a[0])<o/2+h&&Math.abs(a[1])<n/2+h&&(this._earlyReturn=!0)}drawText(e){var s,i;const r=this._textInfo;if(!r)return;const n=r.get(e);if(!n)return;const{text:o,mosaicItem:a}=n;if(!a||0===a.glyphMosaicItems.length)return;const h=null!=(s=e.height)?s:v,l=H(e.lineGapType,null!=(i=e.lineGap)?i:0,h),c=t(o)[1],m=a.glyphMosaicItems,f=T(m,c,{scale:h/C,angle:0,xOffset:0,yOffset:0,hAlign:E(e.horizontalAlignment),vAlign:B(e.verticalAlignment),maxLineWidth:512,lineHeight:R*Math.max(.25,Math.min(l||1,4)),decoration:e.font.decoration||\"none\",isCIM:!0}),u=this.reverseTransformPt(this._searchPoint),_=u[0],d=u[1];for(const t of f.glyphs)if(_>t.xTopLeft&&_<t.xBottomRight&&d>-t.yBottomRight&&d<-t.yTopLeft){this._earlyReturn=!0;break}}_hitTestFill(t){let e=null;if(u(t)){const s=t;e=[[[s.xmin,s.ymin],[s.xmin,s.ymax],[s.xmax,s.ymax],[s.xmax,s.ymin],[s.xmin,s.ymin]]]}else if(m(t))e=t.rings;else{if(!f(t))return;e=t.paths}const s=this.reverseTransformPt(this._searchPoint);this._pointInPolygon(s,e)&&(this._earlyReturn=!0);const i=this.reverseTransformSize(this._searchDistPoint)*this.geomUnitsPerPoint();this._nearLine(s,e,i)&&(this._earlyReturn=!0)}_hitTestStroke(t,e){let s=null;if(u(t)){const e=t;s=[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]}else if(m(t))s=t.rings;else{if(!f(t))return;s=t.paths}const i=this.reverseTransformPt(this._searchPoint),r=e*this.geomUnitsPerPoint(),n=this.reverseTransformSize(this._searchDistPoint)*this.geomUnitsPerPoint();this._nearLine(i,s,r/2+n)&&(this._earlyReturn=!0)}_pointInPolygon(t,e){let s=0;for(const i of e){const e=i.length;for(let r=1;r<e;++r){const e=i[r-1],n=i[r];if(e[1]>t[1]==n[1]>t[1])continue;(n[0]-e[0])*(t[1]-e[1])-(n[1]-e[1])*(t[0]-e[0])>0?s++:s--}}return 0!==s}_nearLine(t,e,s){for(const i of e){const e=i.length;for(let r=1;r<e;++r){const e=i[r-1],n=i[r];let o=(n[0]-e[0])*(n[0]-e[0])+(n[1]-e[1])*(n[1]-e[1]);if(0===o)continue;o=Math.sqrt(o);const a=((n[0]-e[0])*(t[1]-e[1])-(n[1]-e[1])*(t[0]-e[0]))/o;if(Math.abs(a)<s){const i=((n[0]-e[0])*(t[0]-e[0])+(n[1]-e[1])*(t[1]-e[1]))/o;if(i>-s&&i<o+s)return!0}}}return!1}}class A extends U{constructor(t,e,s){super(e,s),this._ctx=t}drawSolidFill(t,e){if(!t)return;if(m(t))this._buildPath(t.rings,!0);else if(f(t))this._buildPath(t.paths,!0);else if(u(t))this._buildPath(G(t).rings,!0);else{if(!_(t))return;console.log(\"CanvasDrawHelper.drawSolidFill - No implementation!\")}const s=this._ctx;s.fillStyle=\"string\"==typeof e?e:\"rgba(\"+Math.round(e[0])+\",\"+Math.round(e[1])+\",\"+Math.round(e[2])+\",\"+e[3]/255+\")\",s.fill(\"evenodd\")}drawSolidStroke(t,e,s,i,r,n){if(!t||!e||0===s)return;if(m(t))this._buildPath(t.rings,!0);else if(f(t))this._buildPath(t.paths,!1);else{if(!u(t))return void console.log(\"CanvasDrawHelper.drawSolidStroke isn't implemented!\");this._buildPath(G(t).rings,!0)}const o=this._ctx;o.strokeStyle=\"string\"==typeof e?e:\"rgba(\"+Math.round(e[0])+\",\"+Math.round(e[1])+\",\"+Math.round(e[2])+\",\"+e[3]/255+\")\",o.lineWidth=this.transformSize(s)+.5,this._setCapStyle(i),this._setJoinStyle(r),o.miterLimit=n,o.stroke()}pushClipPath(t){if(this._ctx.save(),m(t))this._buildPath(t.rings,!0);else if(f(t))this._buildPath(t.paths,!0);else{if(!u(t))return;this._buildPath(G(t).rings,!0)}this._ctx.clip(\"evenodd\")}popClipPath(){this._ctx.restore()}drawImage(t,e,i){const r=this._resourceManager.getResource(t);if(s(r))return;const n=this._ctx,o=n.canvas.width,a=n.canvas.height;let h=e*i*(r.width/r.height),l=i*e;e||(h=i*r.width,l=i*r.height),this._ctx.drawImage(r,0,0,r.width,r.height,0,0,Math.min(this.transformSize(h),o),Math.min(this.transformSize(l),a))}drawText(t){this._textRasterizer||(this._textRasterizer=new b)}_buildPath(t,e){const s=this._ctx;if(s.beginPath(),t)for(const i of t){const t=i?i.length:0;if(t>1){let r=this.transformPt(i[0]);s.moveTo(r[0],r[1]);for(let e=1;e<t;++e)r=this.transformPt(i[e]),s.lineTo(r[0],r[1]);e&&s.closePath()}}}_setCapStyle(t){switch(t){case P.Butt:this._ctx.lineCap=\"butt\";break;case P.Round:this._ctx.lineCap=\"round\";break;case P.Square:this._ctx.lineCap=\"square\"}}_setJoinStyle(t){switch(t){case w.Bevel:this._ctx.lineJoin=\"bevel\";break;case w.Round:this._ctx.lineJoin=\"round\";break;case w.Miter:this._ctx.lineJoin=\"miter\"}}}const G=t=>t?{spatialReference:t.spatialReference,rings:[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]}:null,E=t=>{switch(t){case\"Left\":return S.Left;case\"Right\":return S.Right;case\"Center\":case\"Justify\":return S.Center}},B=t=>{switch(t){case\"Top\":return k.Top;case\"Center\":return k.Center;case\"Bottom\":return k.Bottom;case\"Baseline\":return k.Baseline}},H=(t,e,s)=>{switch(t){case\"ExtraLeading\":return 1+e/s;case\"Multiple\":return e;case\"Exact\":return e/s}};export{U as CIMSymbolDrawHelper,I as C_DEG_TO_RAD,A as CanvasDrawHelper,F as EnvDrawHelper,j as HittestDrawHelper,z as Transformation,E as horizontalAlignment2HAlign,H as lineGapType2LineHeight,B as verticalAlignment2VAlign};\n"]},"metadata":{},"sourceType":"module"}