{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../chunks/tslib.es6.js\";\nimport r from \"../config.js\";\nimport t from \"../Graphic.js\";\nimport s from \"../PopupTemplate.js\";\nimport o from \"../request.js\";\nimport i from \"../core/Collection.js\";\nimport a from \"../core/CollectionFlattener.js\";\nimport { HandleOwnerMixin as n } from \"../core/HandleOwner.js\";\nimport { JSONMap as l } from \"../core/jsonMap.js\";\nimport { clone as p } from \"../core/lang.js\";\nimport { isSome as m } from \"../core/maybe.js\";\nimport { MultiOriginJSONMixin as u } from \"../core/MultiOriginJSONSupport.js\";\nimport { throwIfAbortError as y } from \"../core/promiseUtils.js\";\nimport { addQueryParameters as c, Url as d } from \"../core/urlUtils.js\";\nimport { property as f } from \"../core/accessorSupport/decorators/property.js\";\nimport { Integer as h } from \"../core/accessorSupport/ensureType.js\";\nimport { reader as g } from \"../core/accessorSupport/decorators/reader.js\";\nimport { subclass as b } from \"../core/accessorSupport/decorators/subclass.js\";\nimport { writer as w } from \"../core/accessorSupport/decorators/writer.js\";\nimport { willPropertyWrite as v } from \"../core/accessorSupport/write.js\";\nimport x from \"../geometry/Extent.js\";\nimport j from \"../geometry/SpatialReference.js\";\nimport { getScale as S } from \"../geometry/support/scaleUtils.js\";\nimport { equals as I } from \"../geometry/support/spatialReferenceUtils.js\";\nimport R from \"./Layer.js\";\nimport { BlendLayer as E } from \"./mixins/BlendLayer.js\";\nimport { OperationalLayer as U } from \"./mixins/OperationalLayer.js\";\nimport { PortalLayer as O } from \"./mixins/PortalLayer.js\";\nimport { RefreshableLayer as P } from \"./mixins/RefreshableLayer.js\";\nimport { ScaleRangeLayer as F } from \"./mixins/ScaleRangeLayer.js\";\nimport { TemporalLayer as L } from \"./mixins/TemporalLayer.js\";\nimport { isAxesOrderReversedForWkid as q } from \"./ogc/crsUtils.js\";\nimport { isWmsServer as M } from \"./support/arcgisLayerUrl.js\";\nimport { legendEnabled as T, url as C } from \"./support/commonProperties.js\";\nimport { ExportWMSImageParameters as W } from \"./support/ExportWMSImageParameters.js\";\nimport $ from \"./support/WMSSublayer.js\";\nimport { normalizeWKID as N, toISOString as _, getPopupLayers as H, parseCapabilities as k } from \"./support/wmsUtils.js\";\nconst A = new l({\n  bmp: \"image/bmp\",\n  gif: \"image/gif\",\n  jpg: \"image/jpeg\",\n  png: \"image/png\",\n  svg: \"image/svg+xml\"\n}, {\n  ignoreUnknown: !1\n});\nlet B = class extends n(E(L(P(F(U(O(u(R)))))))) {\n  constructor() {\n    super(...arguments), this.allSublayers = new a({\n      getCollections: () => [this.sublayers],\n      getChildrenFunction: e => e.sublayers\n    }), this.customParameters = null, this.customLayerParameters = null, this.copyright = null, this.description = null, this.dimensions = null, this.fullExtent = null, this.fullExtents = null, this.featureInfoFormat = null, this.featureInfoUrl = null, this.imageFormat = null, this.imageMaxHeight = 2048, this.imageMaxWidth = 2048, this.imageTransparency = !0, this.legendEnabled = !0, this.mapUrl = null, this.isReference = null, this.operationalLayerType = \"WMS\", this.spatialReference = null, this.spatialReferences = null, this.sublayers = null, this.type = \"wms\", this.url = null, this.version = null, this.watch(\"sublayers\", (e, r) => {\n      if (r) {\n        for (const e of r) e.layer = null;\n\n        this.handles.remove(\"wms-sublayer\");\n      }\n\n      if (e) {\n        for (const r of e) r.parent = this, r.layer = this;\n\n        this.handles.add([e.on(\"after-add\", _ref => {\n          let {\n            item: e\n          } = _ref;\n          e.parent = this, e.layer = this;\n        }), e.on(\"after-remove\", _ref2 => {\n          let {\n            item: e\n          } = _ref2;\n          e.parent = null, e.layer = null;\n        })], \"wms-sublayer\");\n      }\n    }, !0);\n  }\n\n  normalizeCtorArgs(e, r) {\n    return \"string\" == typeof e ? {\n      url: e,\n      ...r\n    } : e;\n  }\n\n  load(e) {\n    const r = m(e) ? e.signal : null;\n    return this.addResolvingPromise(this.loadFromPortal({\n      supportedTypes: [\"WMS\"]\n    }, e).catch(y).then(() => this._fetchService(r))), Promise.resolve(this);\n  }\n\n  readFullExtentFromItemOrMap(e, r) {\n    const t = r.extent;\n    return new x({\n      xmin: t[0][0],\n      ymin: t[0][1],\n      xmax: t[1][0],\n      ymax: t[1][1]\n    });\n  }\n\n  writeFullExtent(e, r) {\n    r.extent = [[e.xmin, e.ymin], [e.xmax, e.ymax]];\n  }\n\n  readImageFormat(e, r) {\n    const t = r.supportedImageFormatTypes;\n    return t && t.indexOf(\"image/png\") > -1 ? \"image/png\" : t && t[0];\n  }\n\n  readSpatialReferenceFromItemOrDocument(e, r) {\n    return new j(r.spatialReferences[0]);\n  }\n\n  writeSpatialReferences(e, r) {\n    const t = this.spatialReference && this.spatialReference.wkid;\n    e && t ? (r.spatialReferences = e.filter(e => e !== t), r.spatialReferences.unshift(t)) : r.spatialReferences = e;\n  }\n\n  readSublayersFromItemOrMap(e, r, t) {\n    return G(r.layers, t, r.visibleLayers);\n  }\n\n  readSublayers(e, r, t) {\n    return G(r.layers, t);\n  }\n\n  writeSublayers(e, r, t, s) {\n    r.layers = [];\n    const o = new Map(),\n          i = e.flatten(_ref3 => {\n      let {\n        sublayers: e\n      } = _ref3;\n      return e && e.toArray();\n    }).toArray();\n    i.forEach(e => {\n      \"number\" == typeof e.parent.id && (o.has(e.parent.id) ? o.get(e.parent.id).push(e.id) : o.set(e.parent.id, [e.id]));\n    }), i.forEach(e => {\n      const t = {\n        sublayer: e,\n        ...s\n      },\n            i = e.write({\n        parentLayerId: \"number\" == typeof e.parent.id ? e.parent.id : -1\n      }, t);\n\n      if (o.has(e.id) && (i.sublayerIds = o.get(e.id)), !e.sublayers && e.name) {\n        const s = e.write({}, t);\n        delete s.id, r.layers.push(s);\n      }\n    }), r.visibleLayers = i.filter(e => e.visible && !e.sublayers).map(e => e.name);\n  }\n\n  createExportImageParameters(e, r, t, s) {\n    const o = s && s.pixelRatio || 1,\n          i = S({\n      extent: e,\n      width: r\n    }) * o,\n          a = new W({\n      layer: this,\n      scale: i\n    }),\n          {\n      xmin: n,\n      ymin: l,\n      xmax: p,\n      ymax: m,\n      spatialReference: u\n    } = e,\n          y = N(u, this.spatialReferences),\n          c = \"1.3.0\" === this.version && q(y) ? `${l},${n},${m},${p}` : `${n},${l},${p},${m}`,\n          d = a.toJSON();\n    return {\n      bbox: c,\n      [\"1.3.0\" === this.version ? \"crs\" : \"srs\"]: isNaN(y) ? void 0 : \"EPSG:\" + y,\n      ...d\n    };\n  }\n\n  async fetchImage(e, r, t, s) {\n    var i, a;\n    const n = this.mapUrl,\n          l = this.createExportImageParameters(e, r, t, s);\n\n    if (!l.layers) {\n      const e = document.createElement(\"canvas\");\n      return e.width = r, e.height = t, e;\n    }\n\n    const p = null == s || null == (i = s.timeExtent) ? void 0 : i.start,\n          u = null == s || null == (a = s.timeExtent) ? void 0 : a.end,\n          y = m(p) && m(u) ? p.getTime() === u.getTime() ? _(p) : `${_(p)}/${_(u)}` : void 0,\n          c = {\n      responseType: \"image\",\n      query: this._mixCustomParameters({\n        width: r,\n        height: t,\n        ...l,\n        time: y,\n        ...this.refreshParameters\n      }),\n      signal: null == s ? void 0 : s.signal\n    };\n    return o(n, c).then(e => e.data);\n  }\n\n  fetchFeatureInfo(e, r, o, i, a) {\n    const n = S({\n      extent: e,\n      width: r\n    }),\n          l = new W({\n      layer: this,\n      scale: n\n    }),\n          p = H(l.visibleSublayers);\n    if (!this.featureInfoUrl || !p) return null;\n\n    const m = \"1.3.0\" === this.version ? {\n      I: i,\n      J: a\n    } : {\n      x: i,\n      y: a\n    },\n          u = {\n      query_layers: p,\n      request: \"GetFeatureInfo\",\n      info_format: this.featureInfoFormat,\n      feature_count: 25,\n      width: r,\n      height: o,\n      ...m\n    },\n          y = { ...this.createExportImageParameters(e, r, o),\n      ...u\n    },\n          d = this._mixCustomParameters(y),\n          f = c(this.featureInfoUrl, d),\n          h = document.createElement(\"iframe\");\n\n    h.src = f, h.style.border = \"none\", h.style.margin = \"0\", h.style.width = \"100%\", h.setAttribute(\"sandbox\", \"\");\n    const g = new s({\n      title: this.title,\n      content: h\n    });\n    return new t({\n      sourceLayer: this,\n      popupTemplate: g\n    });\n  }\n\n  findSublayerById(e) {\n    return this.allSublayers.find(r => r.id === e);\n  }\n\n  findSublayerByName(e) {\n    return this.allSublayers.find(r => r.name === e);\n  }\n\n  serviceSupportsSpatialReference(e) {\n    return M(this.url) || this.spatialReferences.some(r => {\n      const t = 900913 === r ? j.WebMercator : new j({\n        wkid: r\n      });\n      return I(t, e);\n    });\n  }\n\n  async _fetchService(e) {\n    if (!this.resourceInfo) {\n      this.parsedUrl.query && this.parsedUrl.query.service && (this.parsedUrl.query.SERVICE = this.parsedUrl.query.service, delete this.parsedUrl.query.service), this.parsedUrl.query && this.parsedUrl.query.request && (this.parsedUrl.query.REQUEST = this.parsedUrl.query.request, delete this.parsedUrl.query.request);\n      const r = await o(this.parsedUrl.path, {\n        query: {\n          SERVICE: \"WMS\",\n          REQUEST: \"GetCapabilities\",\n          ...this.parsedUrl.query,\n          ...this.customParameters\n        },\n        responseType: \"xml\",\n        signal: e\n      });\n      this.resourceInfo = k(r.data);\n    }\n\n    if (this.parsedUrl) {\n      const e = new d(this.parsedUrl.path);\n      \"https\" !== e.scheme || e.port && \"443\" !== e.port || -1 !== r.request.httpsDomains.indexOf(e.host) || r.request.httpsDomains.push(e.host);\n    }\n\n    this.read(this.resourceInfo, {\n      origin: \"service\"\n    });\n  }\n\n  _mixCustomParameters(e) {\n    if (!this.customLayerParameters && !this.customParameters) return e;\n    const r = { ...this.customParameters,\n      ...this.customLayerParameters\n    };\n\n    for (const t in r) e[t.toLowerCase()] = r[t];\n\n    return e;\n  }\n\n};\n\nfunction D(e, r) {\n  return e.some(e => {\n    for (const t in e) if (v(e, t, null, r)) return !0;\n\n    return !1;\n  });\n}\n\nfunction G(e, r, t) {\n  const s = new Map();\n  e.every(e => null == e.id) && (e = p(e)).forEach((e, r) => e.id = r);\n\n  for (const i of e) {\n    const e = new $();\n    e.read(i, r), -1 === (null == t ? void 0 : t.indexOf(e.name)) && (e.visible = !1), s.set(e.id, e);\n  }\n\n  const o = [];\n\n  for (const a of e) {\n    const e = s.get(a.id);\n\n    if (null != a.parentLayerId && a.parentLayerId >= 0) {\n      const r = s.get(a.parentLayerId);\n      r.sublayers || (r.sublayers = new i()), r.sublayers.unshift(e);\n    } else o.unshift(e);\n  }\n\n  return o;\n}\n\ne([f({\n  readOnly: !0\n})], B.prototype, \"allSublayers\", void 0), e([f({\n  json: {\n    type: Object,\n    write: !0\n  }\n})], B.prototype, \"customParameters\", void 0), e([f({\n  json: {\n    type: Object,\n    write: !0\n  }\n})], B.prototype, \"customLayerParameters\", void 0), e([f({\n  type: String,\n  json: {\n    write: !0\n  }\n})], B.prototype, \"copyright\", void 0), e([f()], B.prototype, \"description\", void 0), e([f({\n  readOnly: !0\n})], B.prototype, \"dimensions\", void 0), e([f({\n  json: {\n    type: [[Number]],\n    read: {\n      source: \"extent\"\n    },\n    write: {\n      target: \"extent\"\n    },\n    origins: {\n      \"web-document\": {\n        write: {\n          ignoreOrigin: !0\n        }\n      },\n      \"portal-item\": {\n        write: {\n          ignoreOrigin: !0\n        }\n      }\n    }\n  }\n})], B.prototype, \"fullExtent\", void 0), e([g([\"web-document\", \"portal-item\"], \"fullExtent\", [\"extent\"])], B.prototype, \"readFullExtentFromItemOrMap\", null), e([w([\"web-document\", \"portal-item\"], \"fullExtent\", {\n  extent: {\n    type: [[Number]]\n  }\n})], B.prototype, \"writeFullExtent\", null), e([f()], B.prototype, \"fullExtents\", void 0), e([f({\n  type: String,\n  json: {\n    write: {\n      ignoreOrigin: !0\n    }\n  }\n})], B.prototype, \"featureInfoFormat\", void 0), e([f({\n  type: String,\n  json: {\n    write: {\n      ignoreOrigin: !0\n    }\n  }\n})], B.prototype, \"featureInfoUrl\", void 0), e([f({\n  type: String,\n  json: {\n    origins: {\n      \"web-document\": {\n        default: \"image/png\",\n        type: A.jsonValues,\n        read: {\n          reader: A.read,\n          source: \"format\"\n        },\n        write: {\n          writer: A.write,\n          target: \"format\"\n        }\n      }\n    }\n  }\n})], B.prototype, \"imageFormat\", void 0), e([g(\"imageFormat\", [\"supportedImageFormatTypes\"])], B.prototype, \"readImageFormat\", null), e([f({\n  type: Number,\n  json: {\n    read: {\n      source: \"maxHeight\"\n    },\n    write: {\n      target: \"maxHeight\"\n    }\n  }\n})], B.prototype, \"imageMaxHeight\", void 0), e([f({\n  type: Number,\n  json: {\n    read: {\n      source: \"maxWidth\"\n    },\n    write: {\n      target: \"maxWidth\"\n    }\n  }\n})], B.prototype, \"imageMaxWidth\", void 0), e([f()], B.prototype, \"imageTransparency\", void 0), e([f(T)], B.prototype, \"legendEnabled\", void 0), e([f({\n  type: [\"show\", \"hide\", \"hide-children\"]\n})], B.prototype, \"listMode\", void 0), e([f({\n  type: String,\n  json: {\n    write: {\n      ignoreOrigin: !0\n    }\n  }\n})], B.prototype, \"mapUrl\", void 0), e([f({\n  type: Boolean,\n  json: {\n    read: !1,\n    write: {\n      enabled: !0,\n      overridePolicy: () => ({\n        enabled: !1\n      })\n    }\n  }\n})], B.prototype, \"isReference\", void 0), e([f({\n  type: [\"WMS\"]\n})], B.prototype, \"operationalLayerType\", void 0), e([f()], B.prototype, \"resourceInfo\", void 0), e([f({\n  type: j,\n  json: {\n    origins: {\n      service: {\n        read: {\n          source: \"extent.spatialReference\"\n        }\n      }\n    },\n    write: !1\n  }\n})], B.prototype, \"spatialReference\", void 0), e([g([\"web-document\", \"portal-item\"], \"spatialReference\", [\"spatialReferences\"])], B.prototype, \"readSpatialReferenceFromItemOrDocument\", null), e([f({\n  type: [h],\n  json: {\n    read: !1,\n    origins: {\n      service: {\n        read: !0\n      },\n      \"web-document\": {\n        read: !1,\n        write: {\n          ignoreOrigin: !0\n        }\n      },\n      \"portal-item\": {\n        read: !1,\n        write: {\n          ignoreOrigin: !0\n        }\n      }\n    }\n  }\n})], B.prototype, \"spatialReferences\", void 0), e([w([\"web-document\", \"portal-item\"], \"spatialReferences\")], B.prototype, \"writeSpatialReferences\", null), e([f({\n  type: i.ofType($),\n  json: {\n    write: {\n      target: \"layers\",\n\n      overridePolicy(e, r, t) {\n        if (D(this.allSublayers, t)) return {\n          ignoreOrigin: !0\n        };\n      }\n\n    }\n  }\n})], B.prototype, \"sublayers\", void 0), e([g([\"web-document\", \"portal-item\"], \"sublayers\", [\"layers\", \"visibleLayers\"])], B.prototype, \"readSublayersFromItemOrMap\", null), e([g(\"service\", \"sublayers\", [\"layers\"])], B.prototype, \"readSublayers\", null), e([w(\"sublayers\", {\n  layers: {\n    type: [$]\n  },\n  visibleLayers: {\n    type: [String]\n  }\n})], B.prototype, \"writeSublayers\", null), e([f({\n  json: {\n    read: !1\n  },\n  readOnly: !0,\n  value: \"wms\"\n})], B.prototype, \"type\", void 0), e([f(C)], B.prototype, \"url\", void 0), e([f({\n  type: String,\n  json: {\n    write: {\n      ignoreOrigin: !0\n    }\n  }\n})], B.prototype, \"version\", void 0), B = e([b(\"esri.layers.WMSLayer\")], B);\nconst J = B;\nexport { J as default };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/layers/WMSLayer.js"],"names":["_","e","r","t","s","o","i","a","HandleOwnerMixin","n","JSONMap","l","clone","p","isSome","m","MultiOriginJSONMixin","u","throwIfAbortError","y","addQueryParameters","c","Url","d","property","f","Integer","h","reader","g","subclass","b","writer","w","willPropertyWrite","v","x","j","getScale","S","equals","I","R","BlendLayer","E","OperationalLayer","U","PortalLayer","O","RefreshableLayer","P","ScaleRangeLayer","F","TemporalLayer","L","isAxesOrderReversedForWkid","q","isWmsServer","M","legendEnabled","T","url","C","ExportWMSImageParameters","W","$","normalizeWKID","N","toISOString","getPopupLayers","H","parseCapabilities","k","A","bmp","gif","jpg","png","svg","ignoreUnknown","B","constructor","allSublayers","getCollections","sublayers","getChildrenFunction","customParameters","customLayerParameters","copyright","description","dimensions","fullExtent","fullExtents","featureInfoFormat","featureInfoUrl","imageFormat","imageMaxHeight","imageMaxWidth","imageTransparency","mapUrl","isReference","operationalLayerType","spatialReference","spatialReferences","type","version","watch","layer","handles","remove","parent","add","on","item","normalizeCtorArgs","load","signal","addResolvingPromise","loadFromPortal","supportedTypes","catch","then","_fetchService","Promise","resolve","readFullExtentFromItemOrMap","extent","xmin","ymin","xmax","ymax","writeFullExtent","readImageFormat","supportedImageFormatTypes","indexOf","readSpatialReferenceFromItemOrDocument","writeSpatialReferences","wkid","filter","unshift","readSublayersFromItemOrMap","G","layers","visibleLayers","readSublayers","writeSublayers","Map","flatten","toArray","forEach","id","has","get","push","set","sublayer","write","parentLayerId","sublayerIds","name","visible","map","createExportImageParameters","pixelRatio","width","scale","toJSON","bbox","isNaN","fetchImage","document","createElement","height","timeExtent","start","end","getTime","responseType","query","_mixCustomParameters","time","refreshParameters","data","fetchFeatureInfo","visibleSublayers","J","query_layers","request","info_format","feature_count","src","style","border","margin","setAttribute","title","content","sourceLayer","popupTemplate","findSublayerById","find","findSublayerByName","serviceSupportsSpatialReference","some","WebMercator","resourceInfo","parsedUrl","service","SERVICE","REQUEST","path","scheme","port","httpsDomains","host","read","origin","toLowerCase","D","every","readOnly","prototype","json","Object","String","Number","source","target","origins","ignoreOrigin","default","jsonValues","Boolean","enabled","overridePolicy","ofType","value"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../chunks/tslib.es6.js\";import r from\"../config.js\";import t from\"../Graphic.js\";import s from\"../PopupTemplate.js\";import o from\"../request.js\";import i from\"../core/Collection.js\";import a from\"../core/CollectionFlattener.js\";import{HandleOwnerMixin as n}from\"../core/HandleOwner.js\";import{JSONMap as l}from\"../core/jsonMap.js\";import{clone as p}from\"../core/lang.js\";import{isSome as m}from\"../core/maybe.js\";import{MultiOriginJSONMixin as u}from\"../core/MultiOriginJSONSupport.js\";import{throwIfAbortError as y}from\"../core/promiseUtils.js\";import{addQueryParameters as c,Url as d}from\"../core/urlUtils.js\";import{property as f}from\"../core/accessorSupport/decorators/property.js\";import{Integer as h}from\"../core/accessorSupport/ensureType.js\";import{reader as g}from\"../core/accessorSupport/decorators/reader.js\";import{subclass as b}from\"../core/accessorSupport/decorators/subclass.js\";import{writer as w}from\"../core/accessorSupport/decorators/writer.js\";import{willPropertyWrite as v}from\"../core/accessorSupport/write.js\";import x from\"../geometry/Extent.js\";import j from\"../geometry/SpatialReference.js\";import{getScale as S}from\"../geometry/support/scaleUtils.js\";import{equals as I}from\"../geometry/support/spatialReferenceUtils.js\";import R from\"./Layer.js\";import{BlendLayer as E}from\"./mixins/BlendLayer.js\";import{OperationalLayer as U}from\"./mixins/OperationalLayer.js\";import{PortalLayer as O}from\"./mixins/PortalLayer.js\";import{RefreshableLayer as P}from\"./mixins/RefreshableLayer.js\";import{ScaleRangeLayer as F}from\"./mixins/ScaleRangeLayer.js\";import{TemporalLayer as L}from\"./mixins/TemporalLayer.js\";import{isAxesOrderReversedForWkid as q}from\"./ogc/crsUtils.js\";import{isWmsServer as M}from\"./support/arcgisLayerUrl.js\";import{legendEnabled as T,url as C}from\"./support/commonProperties.js\";import{ExportWMSImageParameters as W}from\"./support/ExportWMSImageParameters.js\";import $ from\"./support/WMSSublayer.js\";import{normalizeWKID as N,toISOString as _,getPopupLayers as H,parseCapabilities as k}from\"./support/wmsUtils.js\";const A=new l({bmp:\"image/bmp\",gif:\"image/gif\",jpg:\"image/jpeg\",png:\"image/png\",svg:\"image/svg+xml\"},{ignoreUnknown:!1});let B=class extends(n(E(L(P(F(U(O(u(R))))))))){constructor(...e){super(...e),this.allSublayers=new a({getCollections:()=>[this.sublayers],getChildrenFunction:e=>e.sublayers}),this.customParameters=null,this.customLayerParameters=null,this.copyright=null,this.description=null,this.dimensions=null,this.fullExtent=null,this.fullExtents=null,this.featureInfoFormat=null,this.featureInfoUrl=null,this.imageFormat=null,this.imageMaxHeight=2048,this.imageMaxWidth=2048,this.imageTransparency=!0,this.legendEnabled=!0,this.mapUrl=null,this.isReference=null,this.operationalLayerType=\"WMS\",this.spatialReference=null,this.spatialReferences=null,this.sublayers=null,this.type=\"wms\",this.url=null,this.version=null,this.watch(\"sublayers\",((e,r)=>{if(r){for(const e of r)e.layer=null;this.handles.remove(\"wms-sublayer\")}if(e){for(const r of e)r.parent=this,r.layer=this;this.handles.add([e.on(\"after-add\",(({item:e})=>{e.parent=this,e.layer=this})),e.on(\"after-remove\",(({item:e})=>{e.parent=null,e.layer=null}))],\"wms-sublayer\")}}),!0)}normalizeCtorArgs(e,r){return\"string\"==typeof e?{url:e,...r}:e}load(e){const r=m(e)?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:[\"WMS\"]},e).catch(y).then((()=>this._fetchService(r)))),Promise.resolve(this)}readFullExtentFromItemOrMap(e,r){const t=r.extent;return new x({xmin:t[0][0],ymin:t[0][1],xmax:t[1][0],ymax:t[1][1]})}writeFullExtent(e,r){r.extent=[[e.xmin,e.ymin],[e.xmax,e.ymax]]}readImageFormat(e,r){const t=r.supportedImageFormatTypes;return t&&t.indexOf(\"image/png\")>-1?\"image/png\":t&&t[0]}readSpatialReferenceFromItemOrDocument(e,r){return new j(r.spatialReferences[0])}writeSpatialReferences(e,r){const t=this.spatialReference&&this.spatialReference.wkid;e&&t?(r.spatialReferences=e.filter((e=>e!==t)),r.spatialReferences.unshift(t)):r.spatialReferences=e}readSublayersFromItemOrMap(e,r,t){return G(r.layers,t,r.visibleLayers)}readSublayers(e,r,t){return G(r.layers,t)}writeSublayers(e,r,t,s){r.layers=[];const o=new Map,i=e.flatten((({sublayers:e})=>e&&e.toArray())).toArray();i.forEach((e=>{\"number\"==typeof e.parent.id&&(o.has(e.parent.id)?o.get(e.parent.id).push(e.id):o.set(e.parent.id,[e.id]))})),i.forEach((e=>{const t={sublayer:e,...s},i=e.write({parentLayerId:\"number\"==typeof e.parent.id?e.parent.id:-1},t);if(o.has(e.id)&&(i.sublayerIds=o.get(e.id)),!e.sublayers&&e.name){const s=e.write({},t);delete s.id,r.layers.push(s)}})),r.visibleLayers=i.filter((e=>e.visible&&!e.sublayers)).map((e=>e.name))}createExportImageParameters(e,r,t,s){const o=s&&s.pixelRatio||1,i=S({extent:e,width:r})*o,a=new W({layer:this,scale:i}),{xmin:n,ymin:l,xmax:p,ymax:m,spatialReference:u}=e,y=N(u,this.spatialReferences),c=\"1.3.0\"===this.version&&q(y)?`${l},${n},${m},${p}`:`${n},${l},${p},${m}`,d=a.toJSON();return{bbox:c,[\"1.3.0\"===this.version?\"crs\":\"srs\"]:isNaN(y)?void 0:\"EPSG:\"+y,...d}}async fetchImage(e,r,t,s){var i,a;const n=this.mapUrl,l=this.createExportImageParameters(e,r,t,s);if(!l.layers){const e=document.createElement(\"canvas\");return e.width=r,e.height=t,e}const p=null==s||null==(i=s.timeExtent)?void 0:i.start,u=null==s||null==(a=s.timeExtent)?void 0:a.end,y=m(p)&&m(u)?p.getTime()===u.getTime()?_(p):`${_(p)}/${_(u)}`:void 0,c={responseType:\"image\",query:this._mixCustomParameters({width:r,height:t,...l,time:y,...this.refreshParameters}),signal:null==s?void 0:s.signal};return o(n,c).then((e=>e.data))}fetchFeatureInfo(e,r,o,i,a){const n=S({extent:e,width:r}),l=new W({layer:this,scale:n}),p=H(l.visibleSublayers);if(!this.featureInfoUrl||!p)return null;const m=\"1.3.0\"===this.version?{I:i,J:a}:{x:i,y:a},u={query_layers:p,request:\"GetFeatureInfo\",info_format:this.featureInfoFormat,feature_count:25,width:r,height:o,...m},y={...this.createExportImageParameters(e,r,o),...u},d=this._mixCustomParameters(y),f=c(this.featureInfoUrl,d),h=document.createElement(\"iframe\");h.src=f,h.style.border=\"none\",h.style.margin=\"0\",h.style.width=\"100%\",h.setAttribute(\"sandbox\",\"\");const g=new s({title:this.title,content:h});return new t({sourceLayer:this,popupTemplate:g})}findSublayerById(e){return this.allSublayers.find((r=>r.id===e))}findSublayerByName(e){return this.allSublayers.find((r=>r.name===e))}serviceSupportsSpatialReference(e){return M(this.url)||this.spatialReferences.some((r=>{const t=900913===r?j.WebMercator:new j({wkid:r});return I(t,e)}))}async _fetchService(e){if(!this.resourceInfo){this.parsedUrl.query&&this.parsedUrl.query.service&&(this.parsedUrl.query.SERVICE=this.parsedUrl.query.service,delete this.parsedUrl.query.service),this.parsedUrl.query&&this.parsedUrl.query.request&&(this.parsedUrl.query.REQUEST=this.parsedUrl.query.request,delete this.parsedUrl.query.request);const r=await o(this.parsedUrl.path,{query:{SERVICE:\"WMS\",REQUEST:\"GetCapabilities\",...this.parsedUrl.query,...this.customParameters},responseType:\"xml\",signal:e});this.resourceInfo=k(r.data)}if(this.parsedUrl){const e=new d(this.parsedUrl.path);\"https\"!==e.scheme||e.port&&\"443\"!==e.port||-1!==r.request.httpsDomains.indexOf(e.host)||r.request.httpsDomains.push(e.host)}this.read(this.resourceInfo,{origin:\"service\"})}_mixCustomParameters(e){if(!this.customLayerParameters&&!this.customParameters)return e;const r={...this.customParameters,...this.customLayerParameters};for(const t in r)e[t.toLowerCase()]=r[t];return e}};function D(e,r){return e.some((e=>{for(const t in e)if(v(e,t,null,r))return!0;return!1}))}function G(e,r,t){const s=new Map;e.every((e=>null==e.id))&&(e=p(e)).forEach(((e,r)=>e.id=r));for(const i of e){const e=new $;e.read(i,r),-1===(null==t?void 0:t.indexOf(e.name))&&(e.visible=!1),s.set(e.id,e)}const o=[];for(const a of e){const e=s.get(a.id);if(null!=a.parentLayerId&&a.parentLayerId>=0){const r=s.get(a.parentLayerId);r.sublayers||(r.sublayers=new i),r.sublayers.unshift(e)}else o.unshift(e)}return o}e([f({readOnly:!0})],B.prototype,\"allSublayers\",void 0),e([f({json:{type:Object,write:!0}})],B.prototype,\"customParameters\",void 0),e([f({json:{type:Object,write:!0}})],B.prototype,\"customLayerParameters\",void 0),e([f({type:String,json:{write:!0}})],B.prototype,\"copyright\",void 0),e([f()],B.prototype,\"description\",void 0),e([f({readOnly:!0})],B.prototype,\"dimensions\",void 0),e([f({json:{type:[[Number]],read:{source:\"extent\"},write:{target:\"extent\"},origins:{\"web-document\":{write:{ignoreOrigin:!0}},\"portal-item\":{write:{ignoreOrigin:!0}}}}})],B.prototype,\"fullExtent\",void 0),e([g([\"web-document\",\"portal-item\"],\"fullExtent\",[\"extent\"])],B.prototype,\"readFullExtentFromItemOrMap\",null),e([w([\"web-document\",\"portal-item\"],\"fullExtent\",{extent:{type:[[Number]]}})],B.prototype,\"writeFullExtent\",null),e([f()],B.prototype,\"fullExtents\",void 0),e([f({type:String,json:{write:{ignoreOrigin:!0}}})],B.prototype,\"featureInfoFormat\",void 0),e([f({type:String,json:{write:{ignoreOrigin:!0}}})],B.prototype,\"featureInfoUrl\",void 0),e([f({type:String,json:{origins:{\"web-document\":{default:\"image/png\",type:A.jsonValues,read:{reader:A.read,source:\"format\"},write:{writer:A.write,target:\"format\"}}}}})],B.prototype,\"imageFormat\",void 0),e([g(\"imageFormat\",[\"supportedImageFormatTypes\"])],B.prototype,\"readImageFormat\",null),e([f({type:Number,json:{read:{source:\"maxHeight\"},write:{target:\"maxHeight\"}}})],B.prototype,\"imageMaxHeight\",void 0),e([f({type:Number,json:{read:{source:\"maxWidth\"},write:{target:\"maxWidth\"}}})],B.prototype,\"imageMaxWidth\",void 0),e([f()],B.prototype,\"imageTransparency\",void 0),e([f(T)],B.prototype,\"legendEnabled\",void 0),e([f({type:[\"show\",\"hide\",\"hide-children\"]})],B.prototype,\"listMode\",void 0),e([f({type:String,json:{write:{ignoreOrigin:!0}}})],B.prototype,\"mapUrl\",void 0),e([f({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],B.prototype,\"isReference\",void 0),e([f({type:[\"WMS\"]})],B.prototype,\"operationalLayerType\",void 0),e([f()],B.prototype,\"resourceInfo\",void 0),e([f({type:j,json:{origins:{service:{read:{source:\"extent.spatialReference\"}}},write:!1}})],B.prototype,\"spatialReference\",void 0),e([g([\"web-document\",\"portal-item\"],\"spatialReference\",[\"spatialReferences\"])],B.prototype,\"readSpatialReferenceFromItemOrDocument\",null),e([f({type:[h],json:{read:!1,origins:{service:{read:!0},\"web-document\":{read:!1,write:{ignoreOrigin:!0}},\"portal-item\":{read:!1,write:{ignoreOrigin:!0}}}}})],B.prototype,\"spatialReferences\",void 0),e([w([\"web-document\",\"portal-item\"],\"spatialReferences\")],B.prototype,\"writeSpatialReferences\",null),e([f({type:i.ofType($),json:{write:{target:\"layers\",overridePolicy(e,r,t){if(D(this.allSublayers,t))return{ignoreOrigin:!0}}}}})],B.prototype,\"sublayers\",void 0),e([g([\"web-document\",\"portal-item\"],\"sublayers\",[\"layers\",\"visibleLayers\"])],B.prototype,\"readSublayersFromItemOrMap\",null),e([g(\"service\",\"sublayers\",[\"layers\"])],B.prototype,\"readSublayers\",null),e([w(\"sublayers\",{layers:{type:[$]},visibleLayers:{type:[String]}})],B.prototype,\"writeSublayers\",null),e([f({json:{read:!1},readOnly:!0,value:\"wms\"})],B.prototype,\"type\",void 0),e([f(C)],B.prototype,\"url\",void 0),e([f({type:String,json:{write:{ignoreOrigin:!0}}})],B.prototype,\"version\",void 0),B=e([b(\"esri.layers.WMSLayer\")],B);const J=B;export{J as default};\n"]},"metadata":{},"sourceType":"module"}