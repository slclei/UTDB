{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nconst t = \"esriJSAPIOAuth\";\n\nclass e {\n  constructor(t, e) {\n    this.oAuthInfo = null, this.storage = null, this.appId = null, this.codeVerifier = null, this.expires = null, this.refreshToken = null, this.ssl = null, this.stateUID = null, this.token = null, this.userId = null, this.oAuthInfo = t, this.storage = e, this._init();\n  }\n\n  isValid() {\n    let t = !1;\n    if (this.oAuthInfo && this.userId && (this.refreshToken || this.token)) if (null == this.expires && this.refreshToken) t = !0;else {\n      const e = Date.now();\n\n      if (this.expires > e) {\n        (this.expires - e) / 1e3 > 60 * this.oAuthInfo.minTimeUntilExpiration && (t = !0);\n      }\n    }\n    return t;\n  }\n\n  save() {\n    if (!this.storage) return !1;\n\n    const e = this._load(),\n          s = this.oAuthInfo;\n\n    if (s && s.authNamespace && s.portalUrl) {\n      let r = e[s.authNamespace];\n      r || (r = e[s.authNamespace] = {}), this.appId || (this.appId = s.appId), r[s.portalUrl] = {\n        appId: this.appId,\n        codeVerifier: this.codeVerifier,\n        expires: this.expires,\n        refreshToken: this.refreshToken,\n        ssl: this.ssl,\n        stateUID: this.stateUID,\n        token: this.token,\n        userId: this.userId\n      };\n\n      try {\n        this.storage.setItem(t, JSON.stringify(e));\n      } catch (i) {\n        return console.warn(i), !1;\n      }\n\n      return !0;\n    }\n\n    return !1;\n  }\n\n  destroy() {\n    const e = this._load(),\n          s = this.oAuthInfo;\n\n    if (s && s.appId && s.portalUrl && (null == this.expires || this.expires > Date.now()) && (this.refreshToken || this.token)) {\n      const t = s.portalUrl.replace(/^http:/i, \"https:\") + \"/sharing/rest/oauth2/revokeToken\",\n            e = new FormData();\n      if (e.append(\"f\", \"json\"), e.append(\"auth_token\", this.refreshToken || this.token), e.append(\"client_id\", s.appId), e.append(\"token_type_hint\", this.refreshToken ? \"refresh_token\" : \"access_token\"), \"function\" == typeof navigator.sendBeacon) navigator.sendBeacon(t, e);else {\n        const s = new XMLHttpRequest();\n        s.open(\"POST\", t), s.send(e);\n      }\n    }\n\n    if (s && s.authNamespace && s.portalUrl && this.storage) {\n      const r = e[s.authNamespace];\n\n      if (r) {\n        delete r[s.portalUrl];\n\n        try {\n          this.storage.setItem(t, JSON.stringify(e));\n        } catch (i) {\n          console.log(i);\n        }\n      }\n    }\n\n    s && (s._oAuthCred = null, this.oAuthInfo = null);\n  }\n\n  _init() {\n    const t = this._load(),\n          e = this.oAuthInfo;\n\n    if (e && e.authNamespace && e.portalUrl) {\n      let s = t[e.authNamespace];\n      s && (s = s[e.portalUrl], s && (this.appId = s.appId, this.codeVerifier = s.codeVerifier, this.expires = s.expires, this.refreshToken = s.refreshToken, this.ssl = s.ssl, this.stateUID = s.stateUID, this.token = s.token, this.userId = s.userId));\n    }\n  }\n\n  _load() {\n    let e = {};\n\n    if (this.storage) {\n      const i = this.storage.getItem(t);\n      if (i) try {\n        e = JSON.parse(i);\n      } catch (s) {\n        console.warn(s);\n      }\n    }\n\n    return e;\n  }\n\n}\n\ne.prototype.declaredClass = \"esri.identity.OAuthCredential\";\nexport { e as default };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/identity/OAuthCredential.js"],"names":["t","e","constructor","oAuthInfo","storage","appId","codeVerifier","expires","refreshToken","ssl","stateUID","token","userId","_init","isValid","Date","now","minTimeUntilExpiration","save","_load","s","authNamespace","portalUrl","r","setItem","JSON","stringify","i","console","warn","destroy","replace","FormData","append","navigator","sendBeacon","XMLHttpRequest","open","send","log","_oAuthCred","getItem","parse","prototype","declaredClass","default"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nconst t=\"esriJSAPIOAuth\";class e{constructor(t,e){this.oAuthInfo=null,this.storage=null,this.appId=null,this.codeVerifier=null,this.expires=null,this.refreshToken=null,this.ssl=null,this.stateUID=null,this.token=null,this.userId=null,this.oAuthInfo=t,this.storage=e,this._init()}isValid(){let t=!1;if(this.oAuthInfo&&this.userId&&(this.refreshToken||this.token))if(null==this.expires&&this.refreshToken)t=!0;else{const e=Date.now();if(this.expires>e){(this.expires-e)/1e3>60*this.oAuthInfo.minTimeUntilExpiration&&(t=!0)}}return t}save(){if(!this.storage)return!1;const e=this._load(),s=this.oAuthInfo;if(s&&s.authNamespace&&s.portalUrl){let r=e[s.authNamespace];r||(r=e[s.authNamespace]={}),this.appId||(this.appId=s.appId),r[s.portalUrl]={appId:this.appId,codeVerifier:this.codeVerifier,expires:this.expires,refreshToken:this.refreshToken,ssl:this.ssl,stateUID:this.stateUID,token:this.token,userId:this.userId};try{this.storage.setItem(t,JSON.stringify(e))}catch(i){return console.warn(i),!1}return!0}return!1}destroy(){const e=this._load(),s=this.oAuthInfo;if(s&&s.appId&&s.portalUrl&&(null==this.expires||this.expires>Date.now())&&(this.refreshToken||this.token)){const t=s.portalUrl.replace(/^http:/i,\"https:\")+\"/sharing/rest/oauth2/revokeToken\",e=new FormData;if(e.append(\"f\",\"json\"),e.append(\"auth_token\",this.refreshToken||this.token),e.append(\"client_id\",s.appId),e.append(\"token_type_hint\",this.refreshToken?\"refresh_token\":\"access_token\"),\"function\"==typeof navigator.sendBeacon)navigator.sendBeacon(t,e);else{const s=new XMLHttpRequest;s.open(\"POST\",t),s.send(e)}}if(s&&s.authNamespace&&s.portalUrl&&this.storage){const r=e[s.authNamespace];if(r){delete r[s.portalUrl];try{this.storage.setItem(t,JSON.stringify(e))}catch(i){console.log(i)}}}s&&(s._oAuthCred=null,this.oAuthInfo=null)}_init(){const t=this._load(),e=this.oAuthInfo;if(e&&e.authNamespace&&e.portalUrl){let s=t[e.authNamespace];s&&(s=s[e.portalUrl],s&&(this.appId=s.appId,this.codeVerifier=s.codeVerifier,this.expires=s.expires,this.refreshToken=s.refreshToken,this.ssl=s.ssl,this.stateUID=s.stateUID,this.token=s.token,this.userId=s.userId))}}_load(){let e={};if(this.storage){const i=this.storage.getItem(t);if(i)try{e=JSON.parse(i)}catch(s){console.warn(s)}}return e}}e.prototype.declaredClass=\"esri.identity.OAuthCredential\";export{e as default};\n"]},"metadata":{},"sourceType":"module"}