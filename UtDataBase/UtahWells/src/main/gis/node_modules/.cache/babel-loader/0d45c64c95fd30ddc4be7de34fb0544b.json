{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport \"../geometry.js\";\nimport e from \"../request.js\";\nimport { isSome as t } from \"../core/maybe.js\";\nimport { normalizeCentralMeridian as n } from \"../geometry/support/normalizeUtils.js\";\nimport { parseUrl as o, encode as a, asValidOptions as s } from \"./utils.js\";\nimport r from \"./support/ImageAngleResult.js\";\nimport i from \"./support/ImageIdentifyResult.js\";\nimport l from \"./support/ImageSampleResult.js\";\nimport m from \"./support/ImagePixelLocationResult.js\";\nimport u from \"../geometry/SpatialReference.js\";\n\nfunction c(e) {\n  const t = null == e ? void 0 : e.time;\n\n  if (t && (null != t.start || null != t.end)) {\n    const n = [];\n    null != t.start && n.push(t.start), null != t.end && -1 === n.indexOf(t.end) && n.push(t.end), e.time = n.join(\",\");\n  }\n}\n\nasync function p(e, r, i) {\n  const l = o(e),\n        m = r.geometry ? [r.geometry] : [],\n        u = await n(m),\n        p = r.toJSON();\n  c(p);\n  const f = u && u[0];\n  t(f) && (p.geometry = f.toJSON());\n  const g = a({ ...l.query,\n    f: \"json\",\n    ...p\n  });\n  return s(g, i);\n}\n\nasync function f(n, i, l) {\n  var m;\n  const c = i.toJSON();\n  t(c.angleName) && (c.angleName = c.angleName.join(\",\")), t(i.point) && null != (m = i.point.spatialReference) && m.imageCoordinateSystem && (c.point.spatialReference = h(i.point.spatialReference)), t(i.spatialReference) && i.spatialReference.imageCoordinateSystem && (c.spatialReference = R(i.spatialReference));\n  const p = o(n),\n        f = a({ ...p.query,\n    f: \"json\",\n    ...c\n  }),\n        g = s(f, l),\n        {\n    data: d\n  } = await e(`${p.path}/computeAngles`, g);\n  return d.spatialReference = d.spatialReference ? null != d.spatialReference.geodataXform ? new u({\n    wkid: 0,\n    imageCoordinateSystem: d.spatialReference\n  }) : u.fromJSON(d.spatialReference) : null, \"NaN\" === d.north && (d.north = null), \"NaN\" === d.up && (d.up = null), new r(d);\n}\n\nasync function g(t, n, r) {\n  const i = n.toJSON(),\n        {\n    geometries: l\n  } = n;\n\n  for (let e = 0; e < l.length; e++) {\n    var u;\n    null != (u = l[e].spatialReference) && u.imageCoordinateSystem && (i.geometries.geometries[e].spatialReference = h(l[e].spatialReference));\n  }\n\n  const c = o(t),\n        p = a({ ...c.query,\n    f: \"json\",\n    ...i\n  }),\n        f = s(p, r),\n        {\n    data: g\n  } = await e(`${c.path}/computePixelLocation`, f);\n  return m.fromJSON(g);\n}\n\nasync function d(t, n, a) {\n  const s = await p(t, n, a),\n        r = o(t),\n        {\n    data: i\n  } = await e(`${r.path}/computeStatisticsHistograms`, s),\n        {\n    statistics: l\n  } = i;\n  return null != l && l.length && l.forEach(e => {\n    e.avg = e.mean, e.stddev = e.standardDeviation;\n  }), {\n    statistics: l,\n    histograms: i.histograms\n  };\n}\n\nasync function y(t, n, a) {\n  const s = await p(t, n, a),\n        r = o(t),\n        {\n    data: i\n  } = await e(`${r.path}/computeHistograms`, s);\n  return {\n    histograms: i.histograms\n  };\n}\n\nasync function N(r, i, m) {\n  var u, p;\n  const f = i.toJSON();\n  c(f), null != (u = f.outFields) && u.length && (f.outFields = f.outFields.join(\",\"));\n  const g = await n(i.geometry),\n        d = null == g ? void 0 : g[0];\n  t(d) && (f.geometry = d.toJSON());\n  const y = o(r),\n        N = a({ ...y.query,\n    f: \"json\",\n    ...f\n  }),\n        S = s(N, m),\n        {\n    data: h\n  } = await e(`${y.path}/getSamples`, S),\n        R = null == h || null == (p = h.samples) ? void 0 : p.map(e => {\n    const t = \"NaN\" === e.value || \"\" === e.value ? null : e.value.split(\" \").map(e => Number(e));\n    return { ...e,\n      pixelValue: t\n    };\n  });\n  return l.fromJSON({\n    samples: R\n  });\n}\n\nasync function S(r, l, m) {\n  const u = o(r),\n        c = l.geometry ? [l.geometry] : [];\n  return n(c).then(n => {\n    const o = l.toJSON(),\n          r = n && n[0];\n    t(r) && (o.geometry = JSON.stringify(r.toJSON()));\n    const i = a({ ...u.query,\n      f: \"json\",\n      ...o\n    }),\n          c = s(i, m);\n    return e(u.path + \"/identify\", c);\n  }).then(e => i.fromJSON(e.data));\n}\n\nfunction h(e) {\n  const {\n    imageCoordinateSystem: t\n  } = e;\n\n  if (t) {\n    const {\n      id: e,\n      referenceServiceName: n\n    } = t;\n    return null != e ? n ? {\n      icsid: e,\n      icsns: n\n    } : {\n      icsid: e\n    } : {\n      ics: t\n    };\n  }\n\n  return e.toJSON();\n}\n\nfunction R(e, t) {\n  const n = h(e),\n        {\n    icsid: o,\n    icsns: a,\n    wkid: s\n  } = n;\n  return null != o ? null == a || null != t && t.toLowerCase().includes(\"/\" + a.toLowerCase() + \"/\") ? `0:${o}` : JSON.stringify(n) : s ? s.toString() : JSON.stringify(n);\n}\n\nexport { f as computeAngles, y as computeHistograms, g as computePixelSpaceLocations, d as computeStatisticsHistograms, h as getImageSpatialReferenceJSON, R as getImageSpatialReferenceQueryParameter, N as getSamples, S as identify };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/rest/imageService.js"],"names":["e","isSome","t","normalizeCentralMeridian","n","parseUrl","o","encode","a","asValidOptions","s","r","i","l","m","u","c","time","start","end","push","indexOf","join","p","geometry","toJSON","f","g","query","angleName","point","spatialReference","imageCoordinateSystem","h","R","data","d","path","geodataXform","wkid","fromJSON","north","up","geometries","length","statistics","forEach","avg","mean","stddev","standardDeviation","histograms","y","N","outFields","S","samples","map","value","split","Number","pixelValue","then","JSON","stringify","id","referenceServiceName","icsid","icsns","ics","toLowerCase","includes","toString","computeAngles","computeHistograms","computePixelSpaceLocations","computeStatisticsHistograms","getImageSpatialReferenceJSON","getImageSpatialReferenceQueryParameter","getSamples","identify"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport\"../geometry.js\";import e from\"../request.js\";import{isSome as t}from\"../core/maybe.js\";import{normalizeCentralMeridian as n}from\"../geometry/support/normalizeUtils.js\";import{parseUrl as o,encode as a,asValidOptions as s}from\"./utils.js\";import r from\"./support/ImageAngleResult.js\";import i from\"./support/ImageIdentifyResult.js\";import l from\"./support/ImageSampleResult.js\";import m from\"./support/ImagePixelLocationResult.js\";import u from\"../geometry/SpatialReference.js\";function c(e){const t=null==e?void 0:e.time;if(t&&(null!=t.start||null!=t.end)){const n=[];null!=t.start&&n.push(t.start),null!=t.end&&-1===n.indexOf(t.end)&&n.push(t.end),e.time=n.join(\",\")}}async function p(e,r,i){const l=o(e),m=r.geometry?[r.geometry]:[],u=await n(m),p=r.toJSON();c(p);const f=u&&u[0];t(f)&&(p.geometry=f.toJSON());const g=a({...l.query,f:\"json\",...p});return s(g,i)}async function f(n,i,l){var m;const c=i.toJSON();t(c.angleName)&&(c.angleName=c.angleName.join(\",\")),t(i.point)&&null!=(m=i.point.spatialReference)&&m.imageCoordinateSystem&&(c.point.spatialReference=h(i.point.spatialReference)),t(i.spatialReference)&&i.spatialReference.imageCoordinateSystem&&(c.spatialReference=R(i.spatialReference));const p=o(n),f=a({...p.query,f:\"json\",...c}),g=s(f,l),{data:d}=await e(`${p.path}/computeAngles`,g);return d.spatialReference=d.spatialReference?null!=d.spatialReference.geodataXform?new u({wkid:0,imageCoordinateSystem:d.spatialReference}):u.fromJSON(d.spatialReference):null,\"NaN\"===d.north&&(d.north=null),\"NaN\"===d.up&&(d.up=null),new r(d)}async function g(t,n,r){const i=n.toJSON(),{geometries:l}=n;for(let e=0;e<l.length;e++){var u;null!=(u=l[e].spatialReference)&&u.imageCoordinateSystem&&(i.geometries.geometries[e].spatialReference=h(l[e].spatialReference))}const c=o(t),p=a({...c.query,f:\"json\",...i}),f=s(p,r),{data:g}=await e(`${c.path}/computePixelLocation`,f);return m.fromJSON(g)}async function d(t,n,a){const s=await p(t,n,a),r=o(t),{data:i}=await e(`${r.path}/computeStatisticsHistograms`,s),{statistics:l}=i;return null!=l&&l.length&&l.forEach((e=>{e.avg=e.mean,e.stddev=e.standardDeviation})),{statistics:l,histograms:i.histograms}}async function y(t,n,a){const s=await p(t,n,a),r=o(t),{data:i}=await e(`${r.path}/computeHistograms`,s);return{histograms:i.histograms}}async function N(r,i,m){var u,p;const f=i.toJSON();c(f),null!=(u=f.outFields)&&u.length&&(f.outFields=f.outFields.join(\",\"));const g=await n(i.geometry),d=null==g?void 0:g[0];t(d)&&(f.geometry=d.toJSON());const y=o(r),N=a({...y.query,f:\"json\",...f}),S=s(N,m),{data:h}=await e(`${y.path}/getSamples`,S),R=null==h||null==(p=h.samples)?void 0:p.map((e=>{const t=\"NaN\"===e.value||\"\"===e.value?null:e.value.split(\" \").map((e=>Number(e)));return{...e,pixelValue:t}}));return l.fromJSON({samples:R})}async function S(r,l,m){const u=o(r),c=l.geometry?[l.geometry]:[];return n(c).then((n=>{const o=l.toJSON(),r=n&&n[0];t(r)&&(o.geometry=JSON.stringify(r.toJSON()));const i=a({...u.query,f:\"json\",...o}),c=s(i,m);return e(u.path+\"/identify\",c)})).then((e=>i.fromJSON(e.data)))}function h(e){const{imageCoordinateSystem:t}=e;if(t){const{id:e,referenceServiceName:n}=t;return null!=e?n?{icsid:e,icsns:n}:{icsid:e}:{ics:t}}return e.toJSON()}function R(e,t){const n=h(e),{icsid:o,icsns:a,wkid:s}=n;return null!=o?null==a||null!=t&&t.toLowerCase().includes(\"/\"+a.toLowerCase()+\"/\")?`0:${o}`:JSON.stringify(n):s?s.toString():JSON.stringify(n)}export{f as computeAngles,y as computeHistograms,g as computePixelSpaceLocations,d as computeStatisticsHistograms,h as getImageSpatialReferenceJSON,R as getImageSpatialReferenceQueryParameter,N as getSamples,S as identify};\n"]},"metadata":{},"sourceType":"module"}