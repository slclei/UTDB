{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport { WGLGeometryType as e } from \"../enums.js\";\nimport { createProgramDescriptor as t } from \"../Utils.js\";\nimport a from \"./WGLGeometryBrush.js\";\nimport { LabelMaterialKey as o } from \"../materialKey/MaterialKey.js\";\nimport { DataType as n, CompareFunction as r, PrimitiveType as i } from \"../../../../webgl/enums.js\";\n\nconst s = e => t(e.data, {\n  geometry: [{\n    location: 0,\n    name: \"a_pos\",\n    count: 2,\n    type: n.SHORT\n  }, {\n    location: 1,\n    name: \"a_id\",\n    count: 4,\n    type: n.UNSIGNED_BYTE\n  }, {\n    location: 2,\n    name: \"a_color\",\n    count: 4,\n    type: n.UNSIGNED_BYTE,\n    normalized: !0\n  }, {\n    location: 3,\n    name: \"a_haloColor\",\n    count: 4,\n    type: n.UNSIGNED_BYTE,\n    normalized: !0\n  }, {\n    location: 4,\n    name: \"a_texAndSize\",\n    count: 4,\n    type: n.UNSIGNED_BYTE\n  }, {\n    location: 5,\n    name: \"a_refSymbolAndPlacementOffset\",\n    count: 4,\n    type: n.UNSIGNED_BYTE\n  }, {\n    location: 6,\n    name: \"a_glyphData\",\n    count: 4,\n    type: n.UNSIGNED_BYTE\n  }, {\n    location: 7,\n    name: \"a_vertexOffset\",\n    count: 2,\n    type: n.SHORT\n  }, {\n    location: 8,\n    name: \"a_texCoords\",\n    count: 2,\n    type: n.UNSIGNED_SHORT\n  }]\n});\n\nclass m extends a {\n  dispose() {}\n\n  getGeometryType() {\n    return e.LABEL;\n  }\n\n  drawGeometry(e, t, a, m) {\n    const {\n      context: l,\n      painter: c,\n      state: f,\n      rendererInfo: u\n    } = e,\n          d = o.load(a.materialKey),\n          _ = d.mapAligned ? 1 : 0;\n\n    if (!_ && Math.abs(t.key.level - Math.round(100 * e.displayLevel) / 100) >= 1) return;\n    const {\n      bufferLayouts: p,\n      attributes: E\n    } = s(d),\n          y = c.materialManager.getMaterialProgram(e, d, \"materials/label\", E, m);\n    e.context.setStencilFunction(r.EQUAL, 0, 255), l.useProgram(y), this._setSharedUniforms(y, e, t), c.textureManager.bindTextures(l, y, d);\n    const N = 1 === _ ? f.displayViewMat3 : f.displayMat3;\n    this._setSizeVVUniforms(d, y, u, t), y.setUniform1f(\"u_mapRotation\", Math.floor(f.rotation / 360 * 254)), y.setUniform1f(\"u_mapAligned\", _), y.setUniformMatrix3fv(\"u_displayMat3\", N), y.setUniform1f(\"u_opacity\", 1), y.setUniform2fv(\"u_screenSize\", e.state.size), y.setUniform1f(\"u_isHalo\", 1);\n    const S = a.target.getVAO(l, p, E),\n          U = a.indexFrom * Uint32Array.BYTES_PER_ELEMENT;\n    l.bindVAO(S), l.drawElements(i.TRIANGLES, a.indexCount, n.UNSIGNED_INT, U), y.setUniform1f(\"u_isHalo\", 0), l.drawElements(i.TRIANGLES, a.indexCount, n.UNSIGNED_INT, U), l.setStencilTestEnabled(!0), l.setBlendingEnabled(!0);\n  }\n\n}\n\nexport { m as default };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/views/2d/engine/webgl/brushes/WGLGeometryBrushLabel.js"],"names":["WGLGeometryType","e","createProgramDescriptor","t","a","LabelMaterialKey","o","DataType","n","CompareFunction","r","PrimitiveType","i","s","data","geometry","location","name","count","type","SHORT","UNSIGNED_BYTE","normalized","UNSIGNED_SHORT","m","dispose","getGeometryType","LABEL","drawGeometry","context","l","painter","c","state","f","rendererInfo","u","d","load","materialKey","_","mapAligned","Math","abs","key","level","round","displayLevel","bufferLayouts","p","attributes","E","y","materialManager","getMaterialProgram","setStencilFunction","EQUAL","useProgram","_setSharedUniforms","textureManager","bindTextures","N","displayViewMat3","displayMat3","_setSizeVVUniforms","setUniform1f","floor","rotation","setUniformMatrix3fv","setUniform2fv","size","S","target","getVAO","U","indexFrom","Uint32Array","BYTES_PER_ELEMENT","bindVAO","drawElements","TRIANGLES","indexCount","UNSIGNED_INT","setStencilTestEnabled","setBlendingEnabled","default"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{WGLGeometryType as e}from\"../enums.js\";import{createProgramDescriptor as t}from\"../Utils.js\";import a from\"./WGLGeometryBrush.js\";import{LabelMaterialKey as o}from\"../materialKey/MaterialKey.js\";import{DataType as n,CompareFunction as r,PrimitiveType as i}from\"../../../../webgl/enums.js\";const s=e=>t(e.data,{geometry:[{location:0,name:\"a_pos\",count:2,type:n.SHORT},{location:1,name:\"a_id\",count:4,type:n.UNSIGNED_BYTE},{location:2,name:\"a_color\",count:4,type:n.UNSIGNED_BYTE,normalized:!0},{location:3,name:\"a_haloColor\",count:4,type:n.UNSIGNED_BYTE,normalized:!0},{location:4,name:\"a_texAndSize\",count:4,type:n.UNSIGNED_BYTE},{location:5,name:\"a_refSymbolAndPlacementOffset\",count:4,type:n.UNSIGNED_BYTE},{location:6,name:\"a_glyphData\",count:4,type:n.UNSIGNED_BYTE},{location:7,name:\"a_vertexOffset\",count:2,type:n.SHORT},{location:8,name:\"a_texCoords\",count:2,type:n.UNSIGNED_SHORT}]});class m extends a{dispose(){}getGeometryType(){return e.LABEL}drawGeometry(e,t,a,m){const{context:l,painter:c,state:f,rendererInfo:u}=e,d=o.load(a.materialKey),_=d.mapAligned?1:0;if(!_&&Math.abs(t.key.level-Math.round(100*e.displayLevel)/100)>=1)return;const{bufferLayouts:p,attributes:E}=s(d),y=c.materialManager.getMaterialProgram(e,d,\"materials/label\",E,m);e.context.setStencilFunction(r.EQUAL,0,255),l.useProgram(y),this._setSharedUniforms(y,e,t),c.textureManager.bindTextures(l,y,d);const N=1===_?f.displayViewMat3:f.displayMat3;this._setSizeVVUniforms(d,y,u,t),y.setUniform1f(\"u_mapRotation\",Math.floor(f.rotation/360*254)),y.setUniform1f(\"u_mapAligned\",_),y.setUniformMatrix3fv(\"u_displayMat3\",N),y.setUniform1f(\"u_opacity\",1),y.setUniform2fv(\"u_screenSize\",e.state.size),y.setUniform1f(\"u_isHalo\",1);const S=a.target.getVAO(l,p,E),U=a.indexFrom*Uint32Array.BYTES_PER_ELEMENT;l.bindVAO(S),l.drawElements(i.TRIANGLES,a.indexCount,n.UNSIGNED_INT,U),y.setUniform1f(\"u_isHalo\",0),l.drawElements(i.TRIANGLES,a.indexCount,n.UNSIGNED_INT,U),l.setStencilTestEnabled(!0),l.setBlendingEnabled(!0)}}export{m as default};\n"]},"metadata":{},"sourceType":"module"}