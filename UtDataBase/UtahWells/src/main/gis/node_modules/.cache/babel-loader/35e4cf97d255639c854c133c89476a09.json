{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../chunks/tslib.es6.js\";\nimport { eventKey as t } from \"../../core/events.js\";\nimport { init as i } from \"../../core/watchUtils.js\";\nimport { aliasOf as r } from \"../../core/accessorSupport/decorators/aliasOf.js\";\nimport \"../../core/arrayUtils.js\";\nimport \"../../core/has.js\";\nimport \"../../core/accessorSupport/ensureType.js\";\nimport { property as a } from \"../../core/accessorSupport/decorators/property.js\";\nimport { subclass as o } from \"../../core/accessorSupport/decorators/subclass.js\";\nimport s from \"../Widget.js\";\nimport n from \"./FeatureMedia/FeatureMediaViewModel.js\";\nimport l from \"./support/FeatureElementInfo.js\";\nimport { shouldOpenInNewTab as d } from \"./support/featureUtils.js\";\nimport { loadChartsModule as c, getColorSet as m } from \"../support/chartUtils.js\";\nimport { isRTL as u } from \"../support/widgetUtils.js\";\nimport { messageBundle as h } from \"../support/decorators/messageBundle.js\";\nimport \"../../core/Logger.js\";\nimport { tsx as p } from \"../support/jsxFactory.js\";\nimport { isDarkTheme as f } from \"../support/widgetThemeUtils.js\";\nconst v = {\n  base: \"esri-feature-media\",\n  mediaContainer: \"esri-feature-media__container\",\n  mediaItemContainer: \"esri-feature-media__item-container\",\n  mediaItem: \"esri-feature-media__item\",\n  mediaItemTitle: \"esri-feature-media__item-title\",\n  mediaItemCaption: \"esri-feature-media__item-caption\",\n  mediaPrevious: \"esri-feature-media__previous\",\n  mediaPreviousIconLTR: \"esri-feature-media__previous-icon\",\n  mediaPreviousIconRTL: \"esri-feature-media__previous-icon--rtl\",\n  mediaNext: \"esri-feature-media__next\",\n  mediaNextIconLTR: \"esri-feature-media__next-icon\",\n  mediaNextIconRTL: \"esri-feature-media__next-icon--rtl\",\n  mediaChart: \"esri-feature-media__chart\",\n  mediaButton: \"esri-feature-media__button\",\n  mediaIcon: \"esri-feature-media__icon\",\n  iconLeftTriangleArrow: \"esri-icon-left-triangle-arrow\",\n  iconRightTriangleArrow: \"esri-icon-right-triangle-arrow\"\n},\n      _ = .05,\n      I = .95,\n      M = 15;\nlet w = class extends s {\n  constructor(e, t) {\n    super(e, t), this._refreshTimer = null, this._refreshIntervalInfo = null, this._featureElementInfo = null, this.attributes = null, this.activeMediaInfoIndex = null, this.description = null, this.fieldInfoMap = null, this.layer = null, this.mediaInfos = null, this.popupTemplate = null, this.relatedInfos = null, this.title = null, this.viewModel = new n(), this.messages = null, this._getChartDependencies = async e => {\n      const t = await c(),\n            {\n        destroyed: i,\n        viewModel: r\n      } = this;\n      if (i || !r || !e) return;\n      const {\n        activeMediaInfo: a\n      } = r;\n\n      this._renderChart({\n        chartDiv: e,\n        mediaInfo: a,\n        chartsModule: t\n      });\n    };\n  }\n\n  initialize() {\n    this._featureElementInfo = new l(), this.own(i(this, [\"viewModel.activeMediaInfo\", \"viewModel.activeMediaInfoIndex\"], () => this._setupMediaRefreshTimer()), i(this, [\"viewModel.description\", \"viewModel.title\"], () => this._setupFeatureElementInfo()));\n  }\n\n  destroy() {\n    this._clearMediaRefreshTimer(), this._featureElementInfo.destroy();\n  }\n\n  render() {\n    var e;\n    return p(\"div\", {\n      bind: this,\n      class: v.base,\n      onkeyup: this._handleMediaKeyup\n    }, null == (e = this._featureElementInfo) ? void 0 : e.render(), this.renderMedia());\n  }\n\n  renderMedia() {\n    const {\n      formattedMediaInfoCount: e\n    } = this.viewModel;\n    return e ? p(\"div\", {\n      key: \"media-element-container\",\n      class: v.mediaContainer\n    }, this.renderMediaPageButton(\"previous\"), this.renderMediaInfo(), this.renderMediaPageButton(\"next\")) : null;\n  }\n\n  renderImageMediaInfo(e) {\n    const {\n      _refreshIntervalInfo: t\n    } = this,\n          {\n      activeMediaInfoIndex: i,\n      formattedMediaInfoCount: r\n    } = this.viewModel,\n          {\n      value: a,\n      refreshInterval: o,\n      altText: s,\n      title: n,\n      type: l\n    } = e,\n          {\n      sourceURL: c,\n      linkURL: m\n    } = a,\n          u = d(m) ? \"_blank\" : \"_self\",\n          h = \"_blank\" === u ? \"noreferrer\" : \"\",\n          f = o ? t : null,\n          v = f ? f.timestamp : 0,\n          _ = f ? f.sourceURL : c,\n          I = p(\"img\", {\n      alt: s || n,\n      key: `media-${l}-${i}-${r}-${v}`,\n      src: _\n    }),\n          M = m ? p(\"a\", {\n      title: n,\n      href: m,\n      rel: h,\n      target: u\n    }, I) : null;\n\n    return M || I;\n  }\n\n  renderChartMediaInfo(e) {\n    const {\n      activeMediaInfoIndex: t,\n      formattedMediaInfoCount: i\n    } = this.viewModel;\n    return p(\"div\", {\n      key: `media-${e.type}-${t}-${i}`,\n      bind: this,\n      class: v.mediaChart,\n      afterCreate: this._getChartDependencies\n    });\n  }\n\n  renderMediaInfoType() {\n    const {\n      activeMediaInfo: e\n    } = this.viewModel;\n    return e ? \"image\" === e.type ? this.renderImageMediaInfo(e) : -1 !== e.type.indexOf(\"chart\") ? this.renderChartMediaInfo(e) : null : null;\n  }\n\n  renderMediaInfo() {\n    const {\n      activeMediaInfo: e\n    } = this.viewModel;\n    if (!e) return null;\n    const t = e.title ? p(\"div\", {\n      key: \"media-title\",\n      class: v.mediaItemTitle,\n      innerHTML: e.title\n    }) : null,\n          i = e.caption ? p(\"div\", {\n      key: \"media-caption\",\n      class: v.mediaItemCaption,\n      innerHTML: e.caption\n    }) : null;\n    return p(\"div\", {\n      key: \"media-container\",\n      class: v.mediaItemContainer\n    }, p(\"div\", {\n      key: \"media-item-container\",\n      class: v.mediaItem\n    }, this.renderMediaInfoType()), t, i);\n  }\n\n  renderMediaPageButton(e) {\n    if (this.viewModel.formattedMediaInfoCount < 2) return null;\n    const t = \"previous\" === e,\n          i = t ? this.messages.previous : this.messages.next,\n          r = t ? this.classes(v.mediaButton, v.mediaPrevious) : this.classes(v.mediaButton, v.mediaNext),\n          a = t ? this.classes(v.mediaIcon, v.mediaPreviousIconLTR, v.iconLeftTriangleArrow) : this.classes(v.mediaIcon, v.mediaNextIconLTR, v.iconRightTriangleArrow),\n          o = t ? this.classes(v.mediaIcon, v.mediaPreviousIconRTL, v.iconRightTriangleArrow) : this.classes(v.mediaIcon, v.mediaNextIconRTL, v.iconLeftTriangleArrow),\n          s = t ? \"media-previous\" : \"media-next\",\n          n = t ? this._previous : this._next;\n    return p(\"button\", {\n      type: \"button\",\n      key: s,\n      title: i,\n      \"aria-label\": i,\n      tabIndex: 0,\n      class: r,\n      bind: this,\n      onclick: n\n    }, p(\"span\", {\n      \"aria-hidden\": \"true\",\n      class: a\n    }), p(\"span\", {\n      \"aria-hidden\": \"true\",\n      class: o\n    }));\n  }\n\n  _setupFeatureElementInfo() {\n    const {\n      description: e,\n      title: t\n    } = this;\n\n    this._featureElementInfo.set({\n      description: e,\n      title: t\n    });\n  }\n\n  _next() {\n    this.viewModel.next();\n  }\n\n  _previous() {\n    this.viewModel.previous();\n  }\n\n  _handleMediaKeyup(e) {\n    const i = t(e);\n    \"ArrowLeft\" === i && (e.stopPropagation(), this.viewModel.previous()), \"ArrowRight\" === i && (e.stopPropagation(), this.viewModel.next());\n  }\n\n  _renderChart(e) {\n    const {\n      abilities: t\n    } = this.viewModel,\n          {\n      chartsModule: i,\n      chartDiv: r,\n      mediaInfo: a\n    } = e,\n          {\n      value: o,\n      type: s\n    } = a,\n          {\n      am4core: n\n    } = i,\n          l = m(n);\n\n    function d(e) {\n      e instanceof n.ColorSet && l && (e.list = l);\n    }\n\n    f() && n.useTheme(i.am4themes_dark);\n    const c = window.matchMedia(\"(prefers-reduced-motion: reduce)\");\n    t.chartAnimation && !c.matches ? n.useTheme(i.am4themes_animated) : n.unuseTheme(i.am4themes_animated), n.useTheme(d);\n    const u = \"pie-chart\" === s ? this._createPieChart(e) : this._createXYChart(e);\n    r.setAttribute(\"aria-label\", a.altText || a.title), u.data = o.series.map(e => ({\n      tooltip: e.tooltip,\n      value: e.value\n    })).filter(e => \"pie-chart\" !== s || e.value > 0);\n  }\n\n  _customizeChartTooltip(e, t) {\n    e.label.wrap = !0, e.label.maxWidth = 200, e.autoTextColor = !1, e.getFillFromObject = !1, e.label.fill = t.color(\"#ffffff\"), e.background.fill = t.color({\n      r: 0,\n      g: 0,\n      b: 0,\n      a: .7\n    });\n  }\n\n  _createPieChart(e) {\n    const {\n      chartDiv: t,\n      chartsModule: i\n    } = e,\n          {\n      am4core: r,\n      am4charts: a\n    } = i,\n          o = r.create(t, a.PieChart);\n    o.rtl = u(this.container);\n    const s = o.series.push(new a.PieSeries());\n    return s.labels.template.disabled = !0, s.ticks.template.disabled = !0, s.dataFields.value = \"value\", s.dataFields.category = \"tooltip\", this._customizeChartTooltip(s.tooltip, r), s.slices.template.tooltipText = o.rtl ? \"{category}: %{value.percent.formatNumber('#.0')}\" : \"{category}: {value.percent.formatNumber('#.0')}%\", o;\n  }\n\n  _getMinSeriesValue(e) {\n    let t = 0;\n    return e.forEach(e => t = Math.min(e.value, t)), t;\n  }\n\n  _createColumnChart(e, t) {\n    const {\n      chartsModule: i,\n      mediaInfo: r\n    } = t,\n          {\n      value: a\n    } = r,\n          {\n      am4core: o,\n      am4charts: s\n    } = i,\n          n = e.xAxes.push(new s.CategoryAxis());\n    n.dataFields.category = \"tooltip\", n.renderer.labels.template.disabled = !0, this._customizeChartTooltip(n.tooltip, o), n.tooltip.events.on(\"sizechanged\", () => {\n      n.tooltip.dy = -n.tooltip.contentHeight;\n    });\n    const l = e.yAxes.push(new s.ValueAxis()),\n          d = l.renderer.labels.template;\n    l.renderer.minLabelPosition = _, l.renderer.maxLabelPosition = I, l.min = this._getMinSeriesValue(a.series), this._customizeChartTooltip(l.tooltip, o), d.wrap = !0;\n    const c = e.series.push(new s.ColumnSeries());\n    c.dataFields.valueY = \"value\", c.dataFields.categoryX = \"tooltip\", e.cursor = new s.XYCursor(), a.series.length > M && (e.scrollbarX = new o.Scrollbar());\n  }\n\n  _createBarChart(e, t) {\n    const {\n      chartsModule: i,\n      mediaInfo: r\n    } = t,\n          {\n      value: a\n    } = r,\n          {\n      am4core: o,\n      am4charts: s\n    } = i,\n          n = e.yAxes.push(new s.CategoryAxis());\n    n.dataFields.category = \"tooltip\", n.renderer.inversed = !0, n.renderer.labels.template.disabled = !0, this._customizeChartTooltip(n.tooltip, o), n.tooltip.events.on(\"sizechanged\", () => {\n      n.tooltip.dx = n.tooltip.contentWidth;\n    });\n    const l = e.xAxes.push(new s.ValueAxis()),\n          d = l.renderer.labels.template;\n    l.renderer.minLabelPosition = _, l.renderer.maxLabelPosition = I, l.min = this._getMinSeriesValue(a.series), this._customizeChartTooltip(l.tooltip, o), d.wrap = !0;\n    const c = e.series.push(new s.ColumnSeries());\n    c.dataFields.valueX = \"value\", c.dataFields.categoryY = \"tooltip\", e.cursor = new s.XYCursor(), a.series.length > M && (e.scrollbarY = new o.Scrollbar());\n  }\n\n  _createLineChart(e, t) {\n    const {\n      chartsModule: i,\n      mediaInfo: r\n    } = t,\n          {\n      value: a\n    } = r,\n          {\n      am4core: o,\n      am4charts: s\n    } = i,\n          n = e.xAxes.push(new s.CategoryAxis());\n    n.dataFields.category = \"tooltip\", n.renderer.labels.template.disabled = !0, this._customizeChartTooltip(n.tooltip, o), n.tooltip.events.on(\"sizechanged\", () => {\n      n.tooltip.dy = -n.tooltip.contentHeight;\n    });\n    const l = e.yAxes.push(new s.ValueAxis()),\n          d = l.renderer.labels.template;\n    l.renderer.minLabelPosition = _, l.renderer.maxLabelPosition = I, l.min = this._getMinSeriesValue(a.series), this._customizeChartTooltip(l.tooltip, o), d.wrap = !0;\n    const c = e.series.push(new s.LineSeries());\n    c.dataFields.categoryX = \"tooltip\", c.dataFields.valueY = \"value\", e.cursor = new s.XYCursor(), a.series.length > M && (e.scrollbarX = new o.Scrollbar());\n  }\n\n  _createXYChart(e) {\n    const {\n      chartDiv: t,\n      chartsModule: i,\n      mediaInfo: r\n    } = e,\n          {\n      type: a\n    } = r,\n          {\n      am4core: o,\n      am4charts: s\n    } = i,\n          n = o.create(t, s.XYChart);\n    return n.rtl = u(this.container), \"column-chart\" === a && this._createColumnChart(n, e), \"bar-chart\" === a && this._createBarChart(n, e), \"line-chart\" === a && this._createLineChart(n, e), n;\n  }\n\n  _clearMediaRefreshTimer() {\n    const {\n      _refreshTimer: e\n    } = this;\n    e && (clearTimeout(e), this._refreshTimer = null);\n  }\n\n  _updateMediaInfoTimestamp(e) {\n    const t = Date.now();\n    this._refreshIntervalInfo = {\n      timestamp: t,\n      sourceURL: this._getImageSource(e, t)\n    }, this.scheduleRender();\n  }\n\n  _setupMediaRefreshTimer() {\n    this._clearMediaRefreshTimer();\n\n    const {\n      activeMediaInfo: e\n    } = this.viewModel;\n    e && \"image\" === e.type && e.refreshInterval && this._setRefreshTimeout(e);\n  }\n\n  _setRefreshTimeout(e) {\n    const {\n      refreshInterval: t,\n      value: i\n    } = e;\n    if (!t) return;\n    const r = 6e4 * t;\n\n    this._updateMediaInfoTimestamp(i.sourceURL);\n\n    const a = setInterval(() => {\n      this._updateMediaInfoTimestamp(i.sourceURL);\n    }, r);\n    this._refreshTimer = a;\n  }\n\n  _getImageSource(e, t) {\n    const i = -1 !== e.indexOf(\"?\") ? \"&\" : \"?\",\n          [r, a = \"\"] = e.split(\"#\");\n    return `${r}${i}timestamp=${t}${a ? \"#\" : \"\"}${a}`;\n  }\n\n};\ne([r(\"viewModel.attributes\")], w.prototype, \"attributes\", void 0), e([r(\"viewModel.activeMediaInfoIndex\")], w.prototype, \"activeMediaInfoIndex\", void 0), e([r(\"viewModel.description\")], w.prototype, \"description\", void 0), e([r(\"viewModel.fieldInfoMap\")], w.prototype, \"fieldInfoMap\", void 0), e([r(\"viewModel.layer\")], w.prototype, \"layer\", void 0), e([r(\"viewModel.mediaInfos\")], w.prototype, \"mediaInfos\", void 0), e([r(\"viewModel.popupTemplate\")], w.prototype, \"popupTemplate\", void 0), e([r(\"viewModel.relatedInfos\")], w.prototype, \"relatedInfos\", void 0), e([r(\"viewModel.title\")], w.prototype, \"title\", void 0), e([a({\n  type: n\n})], w.prototype, \"viewModel\", void 0), e([a(), h(\"esri/widgets/Feature/t9n/Feature\")], w.prototype, \"messages\", void 0), w = e([o(\"esri.widgets.Feature.FeatureMedia\")], w);\nconst g = w;\nexport { g as default };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/widgets/Feature/FeatureMedia.js"],"names":["_","e","eventKey","t","init","i","aliasOf","r","property","a","subclass","o","s","n","l","shouldOpenInNewTab","d","loadChartsModule","c","getColorSet","m","isRTL","u","messageBundle","h","tsx","p","isDarkTheme","f","v","base","mediaContainer","mediaItemContainer","mediaItem","mediaItemTitle","mediaItemCaption","mediaPrevious","mediaPreviousIconLTR","mediaPreviousIconRTL","mediaNext","mediaNextIconLTR","mediaNextIconRTL","mediaChart","mediaButton","mediaIcon","iconLeftTriangleArrow","iconRightTriangleArrow","I","M","w","constructor","_refreshTimer","_refreshIntervalInfo","_featureElementInfo","attributes","activeMediaInfoIndex","description","fieldInfoMap","layer","mediaInfos","popupTemplate","relatedInfos","title","viewModel","messages","_getChartDependencies","destroyed","activeMediaInfo","_renderChart","chartDiv","mediaInfo","chartsModule","initialize","own","_setupMediaRefreshTimer","_setupFeatureElementInfo","destroy","_clearMediaRefreshTimer","render","bind","class","onkeyup","_handleMediaKeyup","renderMedia","formattedMediaInfoCount","key","renderMediaPageButton","renderMediaInfo","renderImageMediaInfo","value","refreshInterval","altText","type","sourceURL","linkURL","timestamp","alt","src","href","rel","target","renderChartMediaInfo","afterCreate","renderMediaInfoType","indexOf","innerHTML","caption","previous","next","classes","_previous","_next","tabIndex","onclick","set","stopPropagation","abilities","am4core","ColorSet","list","useTheme","am4themes_dark","window","matchMedia","chartAnimation","matches","am4themes_animated","unuseTheme","_createPieChart","_createXYChart","setAttribute","data","series","map","tooltip","filter","_customizeChartTooltip","label","wrap","maxWidth","autoTextColor","getFillFromObject","fill","color","background","g","b","am4charts","create","PieChart","rtl","container","push","PieSeries","labels","template","disabled","ticks","dataFields","category","slices","tooltipText","_getMinSeriesValue","forEach","Math","min","_createColumnChart","xAxes","CategoryAxis","renderer","events","on","dy","contentHeight","yAxes","ValueAxis","minLabelPosition","maxLabelPosition","ColumnSeries","valueY","categoryX","cursor","XYCursor","length","scrollbarX","Scrollbar","_createBarChart","inversed","dx","contentWidth","valueX","categoryY","scrollbarY","_createLineChart","LineSeries","XYChart","clearTimeout","_updateMediaInfoTimestamp","Date","now","_getImageSource","scheduleRender","_setRefreshTimeout","setInterval","split","prototype","default"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import{eventKey as t}from\"../../core/events.js\";import{init as i}from\"../../core/watchUtils.js\";import{aliasOf as r}from\"../../core/accessorSupport/decorators/aliasOf.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import{property as a}from\"../../core/accessorSupport/decorators/property.js\";import{subclass as o}from\"../../core/accessorSupport/decorators/subclass.js\";import s from\"../Widget.js\";import n from\"./FeatureMedia/FeatureMediaViewModel.js\";import l from\"./support/FeatureElementInfo.js\";import{shouldOpenInNewTab as d}from\"./support/featureUtils.js\";import{loadChartsModule as c,getColorSet as m}from\"../support/chartUtils.js\";import{isRTL as u}from\"../support/widgetUtils.js\";import{messageBundle as h}from\"../support/decorators/messageBundle.js\";import\"../../core/Logger.js\";import{tsx as p}from\"../support/jsxFactory.js\";import{isDarkTheme as f}from\"../support/widgetThemeUtils.js\";const v={base:\"esri-feature-media\",mediaContainer:\"esri-feature-media__container\",mediaItemContainer:\"esri-feature-media__item-container\",mediaItem:\"esri-feature-media__item\",mediaItemTitle:\"esri-feature-media__item-title\",mediaItemCaption:\"esri-feature-media__item-caption\",mediaPrevious:\"esri-feature-media__previous\",mediaPreviousIconLTR:\"esri-feature-media__previous-icon\",mediaPreviousIconRTL:\"esri-feature-media__previous-icon--rtl\",mediaNext:\"esri-feature-media__next\",mediaNextIconLTR:\"esri-feature-media__next-icon\",mediaNextIconRTL:\"esri-feature-media__next-icon--rtl\",mediaChart:\"esri-feature-media__chart\",mediaButton:\"esri-feature-media__button\",mediaIcon:\"esri-feature-media__icon\",iconLeftTriangleArrow:\"esri-icon-left-triangle-arrow\",iconRightTriangleArrow:\"esri-icon-right-triangle-arrow\"},_=.05,I=.95,M=15;let w=class extends s{constructor(e,t){super(e,t),this._refreshTimer=null,this._refreshIntervalInfo=null,this._featureElementInfo=null,this.attributes=null,this.activeMediaInfoIndex=null,this.description=null,this.fieldInfoMap=null,this.layer=null,this.mediaInfos=null,this.popupTemplate=null,this.relatedInfos=null,this.title=null,this.viewModel=new n,this.messages=null,this._getChartDependencies=async e=>{const t=await c(),{destroyed:i,viewModel:r}=this;if(i||!r||!e)return;const{activeMediaInfo:a}=r;this._renderChart({chartDiv:e,mediaInfo:a,chartsModule:t})}}initialize(){this._featureElementInfo=new l,this.own(i(this,[\"viewModel.activeMediaInfo\",\"viewModel.activeMediaInfoIndex\"],(()=>this._setupMediaRefreshTimer())),i(this,[\"viewModel.description\",\"viewModel.title\"],(()=>this._setupFeatureElementInfo())))}destroy(){this._clearMediaRefreshTimer(),this._featureElementInfo.destroy()}render(){var e;return p(\"div\",{bind:this,class:v.base,onkeyup:this._handleMediaKeyup},null==(e=this._featureElementInfo)?void 0:e.render(),this.renderMedia())}renderMedia(){const{formattedMediaInfoCount:e}=this.viewModel;return e?p(\"div\",{key:\"media-element-container\",class:v.mediaContainer},this.renderMediaPageButton(\"previous\"),this.renderMediaInfo(),this.renderMediaPageButton(\"next\")):null}renderImageMediaInfo(e){const{_refreshIntervalInfo:t}=this,{activeMediaInfoIndex:i,formattedMediaInfoCount:r}=this.viewModel,{value:a,refreshInterval:o,altText:s,title:n,type:l}=e,{sourceURL:c,linkURL:m}=a,u=d(m)?\"_blank\":\"_self\",h=\"_blank\"===u?\"noreferrer\":\"\",f=o?t:null,v=f?f.timestamp:0,_=f?f.sourceURL:c,I=p(\"img\",{alt:s||n,key:`media-${l}-${i}-${r}-${v}`,src:_}),M=m?p(\"a\",{title:n,href:m,rel:h,target:u},I):null;return M||I}renderChartMediaInfo(e){const{activeMediaInfoIndex:t,formattedMediaInfoCount:i}=this.viewModel;return p(\"div\",{key:`media-${e.type}-${t}-${i}`,bind:this,class:v.mediaChart,afterCreate:this._getChartDependencies})}renderMediaInfoType(){const{activeMediaInfo:e}=this.viewModel;return e?\"image\"===e.type?this.renderImageMediaInfo(e):-1!==e.type.indexOf(\"chart\")?this.renderChartMediaInfo(e):null:null}renderMediaInfo(){const{activeMediaInfo:e}=this.viewModel;if(!e)return null;const t=e.title?p(\"div\",{key:\"media-title\",class:v.mediaItemTitle,innerHTML:e.title}):null,i=e.caption?p(\"div\",{key:\"media-caption\",class:v.mediaItemCaption,innerHTML:e.caption}):null;return p(\"div\",{key:\"media-container\",class:v.mediaItemContainer},p(\"div\",{key:\"media-item-container\",class:v.mediaItem},this.renderMediaInfoType()),t,i)}renderMediaPageButton(e){if(this.viewModel.formattedMediaInfoCount<2)return null;const t=\"previous\"===e,i=t?this.messages.previous:this.messages.next,r=t?this.classes(v.mediaButton,v.mediaPrevious):this.classes(v.mediaButton,v.mediaNext),a=t?this.classes(v.mediaIcon,v.mediaPreviousIconLTR,v.iconLeftTriangleArrow):this.classes(v.mediaIcon,v.mediaNextIconLTR,v.iconRightTriangleArrow),o=t?this.classes(v.mediaIcon,v.mediaPreviousIconRTL,v.iconRightTriangleArrow):this.classes(v.mediaIcon,v.mediaNextIconRTL,v.iconLeftTriangleArrow),s=t?\"media-previous\":\"media-next\",n=t?this._previous:this._next;return p(\"button\",{type:\"button\",key:s,title:i,\"aria-label\":i,tabIndex:0,class:r,bind:this,onclick:n},p(\"span\",{\"aria-hidden\":\"true\",class:a}),p(\"span\",{\"aria-hidden\":\"true\",class:o}))}_setupFeatureElementInfo(){const{description:e,title:t}=this;this._featureElementInfo.set({description:e,title:t})}_next(){this.viewModel.next()}_previous(){this.viewModel.previous()}_handleMediaKeyup(e){const i=t(e);\"ArrowLeft\"===i&&(e.stopPropagation(),this.viewModel.previous()),\"ArrowRight\"===i&&(e.stopPropagation(),this.viewModel.next())}_renderChart(e){const{abilities:t}=this.viewModel,{chartsModule:i,chartDiv:r,mediaInfo:a}=e,{value:o,type:s}=a,{am4core:n}=i,l=m(n);function d(e){e instanceof n.ColorSet&&l&&(e.list=l)}f()&&n.useTheme(i.am4themes_dark);const c=window.matchMedia(\"(prefers-reduced-motion: reduce)\");t.chartAnimation&&!c.matches?n.useTheme(i.am4themes_animated):n.unuseTheme(i.am4themes_animated),n.useTheme(d);const u=\"pie-chart\"===s?this._createPieChart(e):this._createXYChart(e);r.setAttribute(\"aria-label\",a.altText||a.title),u.data=o.series.map((e=>({tooltip:e.tooltip,value:e.value}))).filter((e=>\"pie-chart\"!==s||e.value>0))}_customizeChartTooltip(e,t){e.label.wrap=!0,e.label.maxWidth=200,e.autoTextColor=!1,e.getFillFromObject=!1,e.label.fill=t.color(\"#ffffff\"),e.background.fill=t.color({r:0,g:0,b:0,a:.7})}_createPieChart(e){const{chartDiv:t,chartsModule:i}=e,{am4core:r,am4charts:a}=i,o=r.create(t,a.PieChart);o.rtl=u(this.container);const s=o.series.push(new a.PieSeries);return s.labels.template.disabled=!0,s.ticks.template.disabled=!0,s.dataFields.value=\"value\",s.dataFields.category=\"tooltip\",this._customizeChartTooltip(s.tooltip,r),s.slices.template.tooltipText=o.rtl?\"{category}: %{value.percent.formatNumber('#.0')}\":\"{category}: {value.percent.formatNumber('#.0')}%\",o}_getMinSeriesValue(e){let t=0;return e.forEach((e=>t=Math.min(e.value,t))),t}_createColumnChart(e,t){const{chartsModule:i,mediaInfo:r}=t,{value:a}=r,{am4core:o,am4charts:s}=i,n=e.xAxes.push(new s.CategoryAxis);n.dataFields.category=\"tooltip\",n.renderer.labels.template.disabled=!0,this._customizeChartTooltip(n.tooltip,o),n.tooltip.events.on(\"sizechanged\",(()=>{n.tooltip.dy=-n.tooltip.contentHeight}));const l=e.yAxes.push(new s.ValueAxis),d=l.renderer.labels.template;l.renderer.minLabelPosition=_,l.renderer.maxLabelPosition=I,l.min=this._getMinSeriesValue(a.series),this._customizeChartTooltip(l.tooltip,o),d.wrap=!0;const c=e.series.push(new s.ColumnSeries);c.dataFields.valueY=\"value\",c.dataFields.categoryX=\"tooltip\",e.cursor=new s.XYCursor,a.series.length>M&&(e.scrollbarX=new o.Scrollbar)}_createBarChart(e,t){const{chartsModule:i,mediaInfo:r}=t,{value:a}=r,{am4core:o,am4charts:s}=i,n=e.yAxes.push(new s.CategoryAxis);n.dataFields.category=\"tooltip\",n.renderer.inversed=!0,n.renderer.labels.template.disabled=!0,this._customizeChartTooltip(n.tooltip,o),n.tooltip.events.on(\"sizechanged\",(()=>{n.tooltip.dx=n.tooltip.contentWidth}));const l=e.xAxes.push(new s.ValueAxis),d=l.renderer.labels.template;l.renderer.minLabelPosition=_,l.renderer.maxLabelPosition=I,l.min=this._getMinSeriesValue(a.series),this._customizeChartTooltip(l.tooltip,o),d.wrap=!0;const c=e.series.push(new s.ColumnSeries);c.dataFields.valueX=\"value\",c.dataFields.categoryY=\"tooltip\",e.cursor=new s.XYCursor,a.series.length>M&&(e.scrollbarY=new o.Scrollbar)}_createLineChart(e,t){const{chartsModule:i,mediaInfo:r}=t,{value:a}=r,{am4core:o,am4charts:s}=i,n=e.xAxes.push(new s.CategoryAxis);n.dataFields.category=\"tooltip\",n.renderer.labels.template.disabled=!0,this._customizeChartTooltip(n.tooltip,o),n.tooltip.events.on(\"sizechanged\",(()=>{n.tooltip.dy=-n.tooltip.contentHeight}));const l=e.yAxes.push(new s.ValueAxis),d=l.renderer.labels.template;l.renderer.minLabelPosition=_,l.renderer.maxLabelPosition=I,l.min=this._getMinSeriesValue(a.series),this._customizeChartTooltip(l.tooltip,o),d.wrap=!0;const c=e.series.push(new s.LineSeries);c.dataFields.categoryX=\"tooltip\",c.dataFields.valueY=\"value\",e.cursor=new s.XYCursor,a.series.length>M&&(e.scrollbarX=new o.Scrollbar)}_createXYChart(e){const{chartDiv:t,chartsModule:i,mediaInfo:r}=e,{type:a}=r,{am4core:o,am4charts:s}=i,n=o.create(t,s.XYChart);return n.rtl=u(this.container),\"column-chart\"===a&&this._createColumnChart(n,e),\"bar-chart\"===a&&this._createBarChart(n,e),\"line-chart\"===a&&this._createLineChart(n,e),n}_clearMediaRefreshTimer(){const{_refreshTimer:e}=this;e&&(clearTimeout(e),this._refreshTimer=null)}_updateMediaInfoTimestamp(e){const t=Date.now();this._refreshIntervalInfo={timestamp:t,sourceURL:this._getImageSource(e,t)},this.scheduleRender()}_setupMediaRefreshTimer(){this._clearMediaRefreshTimer();const{activeMediaInfo:e}=this.viewModel;e&&\"image\"===e.type&&e.refreshInterval&&this._setRefreshTimeout(e)}_setRefreshTimeout(e){const{refreshInterval:t,value:i}=e;if(!t)return;const r=6e4*t;this._updateMediaInfoTimestamp(i.sourceURL);const a=setInterval((()=>{this._updateMediaInfoTimestamp(i.sourceURL)}),r);this._refreshTimer=a}_getImageSource(e,t){const i=-1!==e.indexOf(\"?\")?\"&\":\"?\",[r,a=\"\"]=e.split(\"#\");return`${r}${i}timestamp=${t}${a?\"#\":\"\"}${a}`}};e([r(\"viewModel.attributes\")],w.prototype,\"attributes\",void 0),e([r(\"viewModel.activeMediaInfoIndex\")],w.prototype,\"activeMediaInfoIndex\",void 0),e([r(\"viewModel.description\")],w.prototype,\"description\",void 0),e([r(\"viewModel.fieldInfoMap\")],w.prototype,\"fieldInfoMap\",void 0),e([r(\"viewModel.layer\")],w.prototype,\"layer\",void 0),e([r(\"viewModel.mediaInfos\")],w.prototype,\"mediaInfos\",void 0),e([r(\"viewModel.popupTemplate\")],w.prototype,\"popupTemplate\",void 0),e([r(\"viewModel.relatedInfos\")],w.prototype,\"relatedInfos\",void 0),e([r(\"viewModel.title\")],w.prototype,\"title\",void 0),e([a({type:n})],w.prototype,\"viewModel\",void 0),e([a(),h(\"esri/widgets/Feature/t9n/Feature\")],w.prototype,\"messages\",void 0),w=e([o(\"esri.widgets.Feature.FeatureMedia\")],w);const g=w;export{g as default};\n"]},"metadata":{},"sourceType":"module"}