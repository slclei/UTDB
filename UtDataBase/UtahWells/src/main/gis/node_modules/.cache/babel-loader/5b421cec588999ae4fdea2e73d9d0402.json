{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport { isSome as t, isNone as e, unwrap as i } from \"../../../../../../core/maybe.js\";\nimport { pt2px as r } from \"../../../../../../core/screenUtils.js\";\nimport { a as s, r as o } from \"../../../../../../chunks/mat2d.js\";\nimport { c as h } from \"../../../../../../chunks/mat2df32.js\";\nimport { s as f, t as n } from \"../../../../../../chunks/vec2.js\";\nimport { f as x, c as a } from \"../../../../../../chunks/vec2f32.js\";\nimport { deltaDecodeGeometry as m, convertFromGeometry as _ } from \"../../../../../../layers/graphics/featureConversionUtils.js\";\nimport { CIMMarkerPlacementHelper as l } from \"../../../../../../symbols/cim/placements/CIMMarkerPlacementHelper.js\";\nimport { WGLGeometryType as p } from \"../../enums.js\";\nimport { i1616to32 as c } from \"../../number.js\";\n\nconst d = 3.14159265359 / 180,\n      v = 8,\n      g = g => class extends g {\n  constructor() {\n    super(...arguments), this.angle = 0, this.xOffset = 0, this.yOffset = 0, this.width = 0, this.height = 0, this.boundsType = \"square\", this._anchorX = 0, this._anchorY = 0, this._computedWidth = 0, this._computedHeight = 0, this._vertexBoundsScaleX = 1, this._vertexBoundsScaleY = 1, this._offsets = {\n      xUpperLeft: 0,\n      yUpperLeft: 0,\n      xUpperRight: 0,\n      yUpperRight: 0,\n      xBottomLeft: 0,\n      yBottomLeft: 0,\n      xBottomRight: 0,\n      yBottomRight: 0\n    }, this.geometryType = p.MARKER;\n  }\n\n  _write(t, e, i, r) {\n    const s = e.getDisplayId();\n    t.recordStart(s, this._materialKey, this.geometryType, !0), this._writeGeometry(t, e, s, i, r), t.recordEnd();\n  }\n\n  _writeGeometry(i, r, s, o, h) {\n    if (t(this._markerPlacement)) return this._writePlacedMarkers(i, r, o, h);\n\n    if (!h && \"esriGeometryPoint\" === r.geometryType) {\n      const t = r.getX(),\n            e = r.getY();\n      if (!i.hasAggregates && i.hasPixelBufferEnabled && (t < 0 || t >= 513 || e < 0 || e >= 513)) return;\n      return this._writeVertices(i, s, this._getPos(t, e), t, e);\n    }\n\n    const f = h ? m(_(h), 2) : \"esriGeometryPolygon\" === r.geometryType ? r.readCentroid() : r.readGeometryForDisplay();\n\n    if (!e(f)) {\n      if (f.isPoint) {\n        const [t, e] = f.coords;\n        if (!i.hasAggregates && i.hasPixelBufferEnabled && (t < 0 || t >= 512 || e < 0 || e >= 512)) return;\n        return this._writeVertices(i, s, this._getPos(t, e), t, e);\n      }\n\n      f.forEachVertex((t, e) => this._writeVertices(i, s, this._getPos(t, e), t, e));\n    }\n  }\n\n  _writePlacedMarkers(t, e, s, o) {\n    const f = null != o ? o : e.readLegacyGeometryForDisplay(),\n          n = l.getPlacement(f, i(this._markerPlacement), r(1), s.geometryEngine);\n    if (!n) return;\n\n    const x = e.getDisplayId(),\n          m = a(),\n          _ = h(),\n          p = -128,\n          c = 640;\n\n    let v = n.next();\n\n    for (; null != v;) {\n      const e = v.tx,\n            i = -v.ty;\n      e >= p && e <= c && i >= p && i <= c && (this._applyTransformation(_, m, -v.getAngle() / d), this._writeVertices(t, x, this._getPos(e, i), e, i)), v = n.next();\n    }\n  }\n\n  _writeVertices(t, e, i, r, s) {\n    const o = t.vertexCount();\n\n    if (this.angle) {\n      const e = Math.max(this._computedWidth * this._vertexBoundsScaleX, this._computedHeight * this._vertexBoundsScaleY);\n      t.vertexBounds(r + this.xOffset, s - this.yOffset, e, e);\n    } else t.vertexBounds(r + this.xOffset, s - this.yOffset, this._computedWidth * this._vertexBoundsScaleX, this._computedHeight * this._vertexBoundsScaleY);\n\n    t.vertexWrite(i), t.vertexWrite(this._offsetUpperLeft), t.vertexWrite(this._texUpperLeft), t.vertexWrite(this._bitestAndDistRatio), t.vertexWrite(e), t.vertexWrite(this._fillColor), t.vertexWrite(this._outlineColor), t.vertexWrite(this._sizeOutlineWidth), t.vertexWrite(this._minMaxZoom), t.vertexEnd(), t.vertexWrite(i), t.vertexWrite(this._offsetUpperRight), t.vertexWrite(this._texUpperRight), t.vertexWrite(this._bitestAndDistRatio), t.vertexWrite(e), t.vertexWrite(this._fillColor), t.vertexWrite(this._outlineColor), t.vertexWrite(this._sizeOutlineWidth), t.vertexWrite(this._minMaxZoom), t.vertexEnd(), t.vertexWrite(i), t.vertexWrite(this._offsetBottomLeft), t.vertexWrite(this._texBottomLeft), t.vertexWrite(this._bitestAndDistRatio), t.vertexWrite(e), t.vertexWrite(this._fillColor), t.vertexWrite(this._outlineColor), t.vertexWrite(this._sizeOutlineWidth), t.vertexWrite(this._minMaxZoom), t.vertexEnd(), t.vertexWrite(i), t.vertexWrite(this._offsetBottomRight), t.vertexWrite(this._texBottomRight), t.vertexWrite(this._bitestAndDistRatio), t.vertexWrite(e), t.vertexWrite(this._fillColor), t.vertexWrite(this._outlineColor), t.vertexWrite(this._sizeOutlineWidth), t.vertexWrite(this._minMaxZoom), t.vertexEnd(), t.indexWrite(o + 0), t.indexWrite(o + 1), t.indexWrite(o + 2), t.indexWrite(o + 1), t.indexWrite(o + 3), t.indexWrite(o + 2);\n  }\n\n  _applyTransformation(t, e) {\n    let i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n    s(t, x(this.xOffset, -this.yOffset)), this.angle + i !== 0 && o(t, t, d * (this.angle + i));\n    const r = this._computedWidth,\n          h = this._computedHeight,\n          a = (this._anchorX - .5) * r,\n          m = (this._anchorY - .5) * h;\n    f(e, a, m), n(e, e, t), this._offsetUpperLeft = c(16 * e[0], 16 * e[1]), this._offsets.xUpperLeft = e[0], this._offsets.yUpperLeft = e[1], f(e, a + r, m), n(e, e, t), this._offsetUpperRight = c(16 * e[0], 16 * e[1]), this._offsets.xUpperRight = e[0], this._offsets.yUpperRight = e[1], f(e, a, m + h), n(e, e, t), this._offsetBottomLeft = c(16 * e[0], 16 * e[1]), this._offsets.xBottomLeft = e[0], this._offsets.yBottomLeft = e[1], f(e, a + r, m + h), n(e, e, t), this._offsetBottomRight = c(16 * e[0], 16 * e[1]), this._offsets.xBottomRight = e[0], this._offsets.yBottomRight = e[1];\n  }\n\n  _getPos(t, e) {\n    return c(Math.round(v * t), Math.round(v * e));\n  }\n\n};\n\nexport { g as default };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/views/2d/engine/webgl/mesh/templates/WGLBaseMarkerTemplate.js"],"names":["isSome","t","isNone","e","unwrap","i","pt2px","r","a","s","o","c","h","f","n","x","deltaDecodeGeometry","m","convertFromGeometry","_","CIMMarkerPlacementHelper","l","WGLGeometryType","p","i1616to32","d","v","g","constructor","angle","xOffset","yOffset","width","height","boundsType","_anchorX","_anchorY","_computedWidth","_computedHeight","_vertexBoundsScaleX","_vertexBoundsScaleY","_offsets","xUpperLeft","yUpperLeft","xUpperRight","yUpperRight","xBottomLeft","yBottomLeft","xBottomRight","yBottomRight","geometryType","MARKER","_write","getDisplayId","recordStart","_materialKey","_writeGeometry","recordEnd","_markerPlacement","_writePlacedMarkers","getX","getY","hasAggregates","hasPixelBufferEnabled","_writeVertices","_getPos","readCentroid","readGeometryForDisplay","isPoint","coords","forEachVertex","readLegacyGeometryForDisplay","getPlacement","geometryEngine","next","tx","ty","_applyTransformation","getAngle","vertexCount","Math","max","vertexBounds","vertexWrite","_offsetUpperLeft","_texUpperLeft","_bitestAndDistRatio","_fillColor","_outlineColor","_sizeOutlineWidth","_minMaxZoom","vertexEnd","_offsetUpperRight","_texUpperRight","_offsetBottomLeft","_texBottomLeft","_offsetBottomRight","_texBottomRight","indexWrite","round","default"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{isSome as t,isNone as e,unwrap as i}from\"../../../../../../core/maybe.js\";import{pt2px as r}from\"../../../../../../core/screenUtils.js\";import{a as s,r as o}from\"../../../../../../chunks/mat2d.js\";import{c as h}from\"../../../../../../chunks/mat2df32.js\";import{s as f,t as n}from\"../../../../../../chunks/vec2.js\";import{f as x,c as a}from\"../../../../../../chunks/vec2f32.js\";import{deltaDecodeGeometry as m,convertFromGeometry as _}from\"../../../../../../layers/graphics/featureConversionUtils.js\";import{CIMMarkerPlacementHelper as l}from\"../../../../../../symbols/cim/placements/CIMMarkerPlacementHelper.js\";import{WGLGeometryType as p}from\"../../enums.js\";import{i1616to32 as c}from\"../../number.js\";const d=3.14159265359/180,v=8,g=g=>class extends g{constructor(...t){super(...t),this.angle=0,this.xOffset=0,this.yOffset=0,this.width=0,this.height=0,this.boundsType=\"square\",this._anchorX=0,this._anchorY=0,this._computedWidth=0,this._computedHeight=0,this._vertexBoundsScaleX=1,this._vertexBoundsScaleY=1,this._offsets={xUpperLeft:0,yUpperLeft:0,xUpperRight:0,yUpperRight:0,xBottomLeft:0,yBottomLeft:0,xBottomRight:0,yBottomRight:0},this.geometryType=p.MARKER}_write(t,e,i,r){const s=e.getDisplayId();t.recordStart(s,this._materialKey,this.geometryType,!0),this._writeGeometry(t,e,s,i,r),t.recordEnd()}_writeGeometry(i,r,s,o,h){if(t(this._markerPlacement))return this._writePlacedMarkers(i,r,o,h);if(!h&&\"esriGeometryPoint\"===r.geometryType){const t=r.getX(),e=r.getY();if(!i.hasAggregates&&i.hasPixelBufferEnabled&&(t<0||t>=513||e<0||e>=513))return;return this._writeVertices(i,s,this._getPos(t,e),t,e)}const f=h?m(_(h),2):\"esriGeometryPolygon\"===r.geometryType?r.readCentroid():r.readGeometryForDisplay();if(!e(f)){if(f.isPoint){const[t,e]=f.coords;if(!i.hasAggregates&&i.hasPixelBufferEnabled&&(t<0||t>=512||e<0||e>=512))return;return this._writeVertices(i,s,this._getPos(t,e),t,e)}f.forEachVertex(((t,e)=>this._writeVertices(i,s,this._getPos(t,e),t,e)))}}_writePlacedMarkers(t,e,s,o){const f=null!=o?o:e.readLegacyGeometryForDisplay(),n=l.getPlacement(f,i(this._markerPlacement),r(1),s.geometryEngine);if(!n)return;const x=e.getDisplayId(),m=a(),_=h(),p=-128,c=640;let v=n.next();for(;null!=v;){const e=v.tx,i=-v.ty;e>=p&&e<=c&&i>=p&&i<=c&&(this._applyTransformation(_,m,-v.getAngle()/d),this._writeVertices(t,x,this._getPos(e,i),e,i)),v=n.next()}}_writeVertices(t,e,i,r,s){const o=t.vertexCount();if(this.angle){const e=Math.max(this._computedWidth*this._vertexBoundsScaleX,this._computedHeight*this._vertexBoundsScaleY);t.vertexBounds(r+this.xOffset,s-this.yOffset,e,e)}else t.vertexBounds(r+this.xOffset,s-this.yOffset,this._computedWidth*this._vertexBoundsScaleX,this._computedHeight*this._vertexBoundsScaleY);t.vertexWrite(i),t.vertexWrite(this._offsetUpperLeft),t.vertexWrite(this._texUpperLeft),t.vertexWrite(this._bitestAndDistRatio),t.vertexWrite(e),t.vertexWrite(this._fillColor),t.vertexWrite(this._outlineColor),t.vertexWrite(this._sizeOutlineWidth),t.vertexWrite(this._minMaxZoom),t.vertexEnd(),t.vertexWrite(i),t.vertexWrite(this._offsetUpperRight),t.vertexWrite(this._texUpperRight),t.vertexWrite(this._bitestAndDistRatio),t.vertexWrite(e),t.vertexWrite(this._fillColor),t.vertexWrite(this._outlineColor),t.vertexWrite(this._sizeOutlineWidth),t.vertexWrite(this._minMaxZoom),t.vertexEnd(),t.vertexWrite(i),t.vertexWrite(this._offsetBottomLeft),t.vertexWrite(this._texBottomLeft),t.vertexWrite(this._bitestAndDistRatio),t.vertexWrite(e),t.vertexWrite(this._fillColor),t.vertexWrite(this._outlineColor),t.vertexWrite(this._sizeOutlineWidth),t.vertexWrite(this._minMaxZoom),t.vertexEnd(),t.vertexWrite(i),t.vertexWrite(this._offsetBottomRight),t.vertexWrite(this._texBottomRight),t.vertexWrite(this._bitestAndDistRatio),t.vertexWrite(e),t.vertexWrite(this._fillColor),t.vertexWrite(this._outlineColor),t.vertexWrite(this._sizeOutlineWidth),t.vertexWrite(this._minMaxZoom),t.vertexEnd(),t.indexWrite(o+0),t.indexWrite(o+1),t.indexWrite(o+2),t.indexWrite(o+1),t.indexWrite(o+3),t.indexWrite(o+2)}_applyTransformation(t,e,i=0){s(t,x(this.xOffset,-this.yOffset)),this.angle+i!==0&&o(t,t,d*(this.angle+i));const r=this._computedWidth,h=this._computedHeight,a=(this._anchorX-.5)*r,m=(this._anchorY-.5)*h;f(e,a,m),n(e,e,t),this._offsetUpperLeft=c(16*e[0],16*e[1]),this._offsets.xUpperLeft=e[0],this._offsets.yUpperLeft=e[1],f(e,a+r,m),n(e,e,t),this._offsetUpperRight=c(16*e[0],16*e[1]),this._offsets.xUpperRight=e[0],this._offsets.yUpperRight=e[1],f(e,a,m+h),n(e,e,t),this._offsetBottomLeft=c(16*e[0],16*e[1]),this._offsets.xBottomLeft=e[0],this._offsets.yBottomLeft=e[1],f(e,a+r,m+h),n(e,e,t),this._offsetBottomRight=c(16*e[0],16*e[1]),this._offsets.xBottomRight=e[0],this._offsets.yBottomRight=e[1]}_getPos(t,e){return c(Math.round(v*t),Math.round(v*e))}};export{g as default};\n"]},"metadata":{},"sourceType":"module"}