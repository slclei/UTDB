{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport { TILE_SIZE as i } from \"./definitions.js\";\nimport { Point as t, GeometryType as s } from \"./Geometry.js\";\nimport { between as h } from \"./GeometryUtils.js\";\n\nclass e {\n  constructor(i, t, s) {\n    this.ratio = i, this.x = t, this.y = s;\n  }\n\n}\n\nclass n {\n  constructor(t, s, h) {\n    let e = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 8;\n    let n = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 8;\n    this.lines = [], this.starts = [], this.validateTessellation = !0, this.pixelRatio = e, this.pixelMargin = n, this.tileSize = i * e, this.dz = t, this.yPos = s, this.xPos = h;\n  }\n\n  setPixelMargin(i) {\n    i !== this.pixelMargin && (this.pixelMargin = i, this.setExtent(this._extent));\n  }\n\n  setExtent(i) {\n    this._extent = i, this.finalRatio = this.tileSize / i * (1 << this.dz);\n    let t = this.pixelRatio * this.pixelMargin;\n    t /= this.finalRatio;\n    const s = i >> this.dz;\n    t > s && (t = s), this.margin = t, this.xmin = s * this.xPos - t, this.ymin = s * this.yPos - t, this.xmax = this.xmin + s + 2 * t, this.ymax = this.ymin + s + 2 * t;\n  }\n\n  reset(i) {\n    this.type = i, this.lines = [], this.starts = [], this.line = null, this.start = 0;\n  }\n\n  moveTo(i, s) {\n    this._pushLine(), this._prevIsIn = this._isIn(i, s), this._moveTo(i, s, this._prevIsIn), this._prevPt = new t(i, s), this._firstPt = new t(i, s), this._dist = 0;\n  }\n\n  lineTo(i, s) {\n    const h = this._isIn(i, s),\n          n = new t(i, s),\n          l = t.distance(this._prevPt, n);\n\n    let x, a, y, o, r, m, p, u;\n    if (h) this._prevIsIn ? this._lineTo(i, s, !0) : (x = this._prevPt, a = n, y = this._intersect(a, x), this.start = this._dist + l * (1 - this._r), this._lineTo(y.x, y.y, !0), this._lineTo(a.x, a.y, !0));else if (this._prevIsIn) a = this._prevPt, x = n, y = this._intersect(a, x), this._lineTo(y.x, y.y, !0), this._lineTo(x.x, x.y, !1);else {\n      const i = this._prevPt,\n            t = n;\n      if (i.x <= this.xmin && t.x <= this.xmin || i.x >= this.xmax && t.x >= this.xmax || i.y <= this.ymin && t.y <= this.ymin || i.y >= this.ymax && t.y >= this.ymax) this._lineTo(t.x, t.y, !1);else {\n        const s = [];\n        if ((i.x < this.xmin && t.x > this.xmin || i.x > this.xmin && t.x < this.xmin) && (o = (this.xmin - i.x) / (t.x - i.x), u = i.y + o * (t.y - i.y), u <= this.ymin ? m = !1 : u >= this.ymax ? m = !0 : s.push(new e(o, this.xmin, u))), (i.x < this.xmax && t.x > this.xmax || i.x > this.xmax && t.x < this.xmax) && (o = (this.xmax - i.x) / (t.x - i.x), u = i.y + o * (t.y - i.y), u <= this.ymin ? m = !1 : u >= this.ymax ? m = !0 : s.push(new e(o, this.xmax, u))), (i.y < this.ymin && t.y > this.ymin || i.y > this.ymin && t.y < this.ymin) && (o = (this.ymin - i.y) / (t.y - i.y), p = i.x + o * (t.x - i.x), p <= this.xmin ? r = !1 : p >= this.xmax ? r = !0 : s.push(new e(o, p, this.ymin))), (i.y < this.ymax && t.y > this.ymax || i.y > this.ymax && t.y < this.ymax) && (o = (this.ymax - i.y) / (t.y - i.y), p = i.x + o * (t.x - i.x), p <= this.xmin ? r = !1 : p >= this.xmax ? r = !0 : s.push(new e(o, p, this.ymax))), 0 === s.length) r ? m ? this._lineTo(this.xmax, this.ymax, !0) : this._lineTo(this.xmax, this.ymin, !0) : m ? this._lineTo(this.xmin, this.ymax, !0) : this._lineTo(this.xmin, this.ymin, !0);else if (s.length > 1 && s[0].ratio > s[1].ratio) this.start = this._dist + l * s[1].ratio, this._lineTo(s[1].x, s[1].y, !0), this._lineTo(s[0].x, s[0].y, !0);else {\n          this.start = this._dist + l * s[0].ratio;\n\n          for (let i = 0; i < s.length; i++) this._lineTo(s[i].x, s[i].y, !0);\n        }\n\n        this._lineTo(t.x, t.y, !1);\n      }\n    }\n    this._dist += l, this._prevIsIn = h, this._prevPt = n;\n  }\n\n  close() {\n    if (this.line.length > 2) {\n      const i = this._firstPt,\n            t = this._prevPt;\n      i.x === t.x && i.y === t.y || this.lineTo(i.x, i.y);\n      const s = this.line;\n      let h = s.length;\n\n      for (; h >= 4 && (s[0].x === s[1].x && s[0].x === s[h - 2].x || s[0].y === s[1].y && s[0].y === s[h - 2].y);) s.pop(), s[0].x = s[h - 2].x, s[0].y = s[h - 2].y, --h;\n    }\n  }\n\n  result() {\n    let i = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : !0;\n    return this._pushLine(), 0 === this.lines.length ? null : (this.type === s.Polygon && i && a.simplify(this.tileSize, this.margin * this.finalRatio, this.lines), this.lines);\n  }\n\n  resultWithStarts() {\n    if (this.type !== s.LineString) throw new Error(\"Only valid for lines\");\n\n    this._pushLine();\n\n    const i = this.lines,\n          t = i.length;\n    if (0 === t) return null;\n    const h = [];\n\n    for (let s = 0; s < t; s++) h.push({\n      line: i[s],\n      start: this.starts[s] || 0\n    });\n\n    return h;\n  }\n\n  _isIn(i, t) {\n    return i >= this.xmin && i <= this.xmax && t >= this.ymin && t <= this.ymax;\n  }\n\n  _intersect(i, s) {\n    let h, e, n;\n    if (s.x >= this.xmin && s.x <= this.xmax) e = s.y <= this.ymin ? this.ymin : this.ymax, n = (e - i.y) / (s.y - i.y), h = i.x + n * (s.x - i.x);else if (s.y >= this.ymin && s.y <= this.ymax) h = s.x <= this.xmin ? this.xmin : this.xmax, n = (h - i.x) / (s.x - i.x), e = i.y + n * (s.y - i.y);else {\n      e = s.y <= this.ymin ? this.ymin : this.ymax, h = s.x <= this.xmin ? this.xmin : this.xmax;\n      const t = (h - i.x) / (s.x - i.x),\n            l = (e - i.y) / (s.y - i.y);\n      t < l ? (n = t, e = i.y + t * (s.y - i.y)) : (n = l, h = i.x + l * (s.x - i.x));\n    }\n    return this._r = n, new t(h, e);\n  }\n\n  _pushLine() {\n    this.line && (this.type === s.Point ? this.line.length > 0 && (this.lines.push(this.line), this.starts.push(this.start)) : this.type === s.LineString ? this.line.length > 1 && (this.lines.push(this.line), this.starts.push(this.start)) : this.type === s.Polygon && this.line.length > 3 && (this.lines.push(this.line), this.starts.push(this.start))), this.line = [], this.start = 0;\n  }\n\n  _moveTo(i, h, e) {\n    this.type !== s.Polygon ? e && (i = Math.round((i - (this.xmin + this.margin)) * this.finalRatio), h = Math.round((h - (this.ymin + this.margin)) * this.finalRatio), this.line.push(new t(i, h))) : (e || (i < this.xmin && (i = this.xmin), i > this.xmax && (i = this.xmax), h < this.ymin && (h = this.ymin), h > this.ymax && (h = this.ymax)), i = Math.round((i - (this.xmin + this.margin)) * this.finalRatio), h = Math.round((h - (this.ymin + this.margin)) * this.finalRatio), this.line.push(new t(i, h)), this._is_h = !1, this._is_v = !1);\n  }\n\n  _lineTo(i, h, e) {\n    let n, l;\n    if (this.type !== s.Polygon) {\n      if (e) {\n        if (i = Math.round((i - (this.xmin + this.margin)) * this.finalRatio), h = Math.round((h - (this.ymin + this.margin)) * this.finalRatio), this.line.length > 0 && (n = this.line[this.line.length - 1], n.equals(i, h))) return;\n        this.line.push(new t(i, h));\n      } else this.line && this.line.length > 0 && this._pushLine();\n    } else if (e || (i < this.xmin && (i = this.xmin), i > this.xmax && (i = this.xmax), h < this.ymin && (h = this.ymin), h > this.ymax && (h = this.ymax)), i = Math.round((i - (this.xmin + this.margin)) * this.finalRatio), h = Math.round((h - (this.ymin + this.margin)) * this.finalRatio), this.line && this.line.length > 0) {\n      n = this.line[this.line.length - 1];\n      const s = n.x === i,\n            e = n.y === h;\n      if (s && e) return;\n      this._is_h && s || this._is_v && e ? (n.x = i, n.y = h, l = this.line[this.line.length - 2], l.x === i && l.y === h ? (this.line.pop(), this.line.length <= 1 ? (this._is_h = !1, this._is_v = !1) : (l = this.line[this.line.length - 2], this._is_h = l.x === i, this._is_v = l.y === h)) : (this._is_h = l.x === i, this._is_v = l.y === h)) : (this.line.push(new t(i, h)), this._is_h = s, this._is_v = e);\n    } else this.line.push(new t(i, h));\n  }\n\n}\n\nclass l {\n  setExtent(i) {\n    this._ratio = 4096 === i ? 1 : 4096 / i;\n  }\n\n  get validateTessellation() {\n    return this._ratio < 1;\n  }\n\n  reset(i) {\n    this.lines = [], this.line = null;\n  }\n\n  moveTo(i, s) {\n    this.line && this.lines.push(this.line), this.line = [];\n    const h = this._ratio;\n    this.line.push(new t(i * h, s * h));\n  }\n\n  lineTo(i, s) {\n    const h = this._ratio;\n    this.line.push(new t(i * h, s * h));\n  }\n\n  close() {\n    const i = this.line;\n    i && !i[0].isEqual(i[i.length - 1]) && i.push(i[0]);\n  }\n\n  result() {\n    return this.line && this.lines.push(this.line), 0 === this.lines.length ? null : this.lines;\n  }\n\n}\n\nvar x;\n!function (i) {\n  i[i.sideLeft = 0] = \"sideLeft\", i[i.sideRight = 1] = \"sideRight\", i[i.sideTop = 2] = \"sideTop\", i[i.sideBottom = 3] = \"sideBottom\";\n}(x || (x = {}));\n\nclass a {\n  static simplify(i, t, s) {\n    if (!s) return;\n    const h = -t,\n          e = i + t,\n          n = -t,\n          l = i + t,\n          y = [],\n          o = [],\n          r = s.length;\n\n    for (let a = 0; a < r; ++a) {\n      const i = s[a];\n      if (!i || i.length < 2) continue;\n      let t,\n          r = i[0];\n      const m = i.length;\n\n      for (let s = 1; s < m; ++s) t = i[s], r.x === t.x && (r.x <= h && (r.y > t.y ? (y.push(a), y.push(s), y.push(x.sideLeft), y.push(-1)) : (o.push(a), o.push(s), o.push(x.sideLeft), o.push(-1))), r.x >= e && (r.y < t.y ? (y.push(a), y.push(s), y.push(x.sideRight), y.push(-1)) : (o.push(a), o.push(s), o.push(x.sideRight), o.push(-1)))), r.y === t.y && (r.y <= n && (r.x < t.x ? (y.push(a), y.push(s), y.push(x.sideTop), y.push(-1)) : (o.push(a), o.push(s), o.push(x.sideTop), o.push(-1))), r.y >= l && (r.x > t.x ? (y.push(a), y.push(s), y.push(x.sideBottom), y.push(-1)) : (o.push(a), o.push(s), o.push(x.sideBottom), o.push(-1)))), r = t;\n    }\n\n    if (0 === y.length || 0 === o.length) return;\n    a.fillParent(s, o, y), a.fillParent(s, y, o);\n    const m = [];\n    a.calcDeltas(m, o, y), a.calcDeltas(m, y, o), a.addDeltas(m, s);\n  }\n\n  static fillParent(i, t, s) {\n    const e = s.length,\n          n = t.length;\n\n    for (let l = 0; l < n; l += 4) {\n      const n = t[l],\n            a = t[l + 1],\n            y = t[l + 2],\n            o = i[n][a - 1],\n            r = i[n][a];\n      let m = 8092,\n          p = -1;\n\n      for (let t = 0; t < e; t += 4) {\n        if (s[t + 2] !== y) continue;\n        const e = s[t],\n              n = s[t + 1],\n              l = i[e][n - 1],\n              a = i[e][n];\n\n        switch (y) {\n          case x.sideLeft:\n          case x.sideRight:\n            if (h(o.y, l.y, a.y) && h(r.y, l.y, a.y)) {\n              const i = Math.abs(a.y - l.y);\n              i < m && (m = i, p = t);\n            }\n\n            break;\n\n          case x.sideTop:\n          case x.sideBottom:\n            if (h(o.x, l.x, a.x) && h(r.x, l.x, a.x)) {\n              const i = Math.abs(a.x - l.x);\n              i < m && (m = i, p = t);\n            }\n\n        }\n      }\n\n      t[l + 3] = p;\n    }\n  }\n\n  static calcDeltas(i, t, s) {\n    const h = t.length;\n\n    for (let e = 0; e < h; e += 4) {\n      const h = [],\n            n = a.calcDelta(e, t, s, h);\n      i.push(t[e]), i.push(t[e + 1]), i.push(t[e + 2]), i.push(n);\n    }\n  }\n\n  static calcDelta(i, t, s, h) {\n    const e = t[i + 3];\n    if (-1 === e) return 0;\n    const n = h.length;\n    return n > 1 && h[n - 2] === e ? 0 : (h.push(e), a.calcDelta(e, s, t, h) + 1);\n  }\n\n  static addDeltas(i, t) {\n    const s = i.length;\n    let h = 0;\n\n    for (let e = 0; e < s; e += 4) {\n      const t = i[e + 3];\n      t > h && (h = t);\n    }\n\n    for (let e = 0; e < s; e += 4) {\n      const s = t[i[e]],\n            n = i[e + 1],\n            l = h - i[e + 3];\n\n      switch (i[e + 2]) {\n        case x.sideLeft:\n          s[n - 1].x -= l, s[n].x -= l, 1 === n && (s[s.length - 1].x -= l), n === s.length - 1 && (s[0].x -= l);\n          break;\n\n        case x.sideRight:\n          s[n - 1].x += l, s[n].x += l, 1 === n && (s[s.length - 1].x += l), n === s.length - 1 && (s[0].x += l);\n          break;\n\n        case x.sideTop:\n          s[n - 1].y -= l, s[n].y -= l, 1 === n && (s[s.length - 1].y -= l), n === s.length - 1 && (s[0].y -= l);\n          break;\n\n        case x.sideBottom:\n          s[n - 1].y += l, s[n].y += l, 1 === n && (s[s.length - 1].y += l), n === s.length - 1 && (s[0].y += l);\n      }\n    }\n  }\n\n}\n\nexport { l as SimpleBuilder, n as TileClipper };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/views/2d/engine/webgl/TileClipper.js"],"names":["TILE_SIZE","i","Point","t","GeometryType","s","between","h","e","constructor","ratio","x","y","n","lines","starts","validateTessellation","pixelRatio","pixelMargin","tileSize","dz","yPos","xPos","setPixelMargin","setExtent","_extent","finalRatio","margin","xmin","ymin","xmax","ymax","reset","type","line","start","moveTo","_pushLine","_prevIsIn","_isIn","_moveTo","_prevPt","_firstPt","_dist","lineTo","l","distance","a","o","r","m","p","u","_lineTo","_intersect","_r","push","length","close","pop","result","Polygon","simplify","resultWithStarts","LineString","Error","Math","round","_is_h","_is_v","equals","_ratio","isEqual","sideLeft","sideRight","sideTop","sideBottom","fillParent","calcDeltas","addDeltas","abs","calcDelta","SimpleBuilder","TileClipper"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{TILE_SIZE as i}from\"./definitions.js\";import{Point as t,GeometryType as s}from\"./Geometry.js\";import{between as h}from\"./GeometryUtils.js\";class e{constructor(i,t,s){this.ratio=i,this.x=t,this.y=s}}class n{constructor(t,s,h,e=8,n=8){this.lines=[],this.starts=[],this.validateTessellation=!0,this.pixelRatio=e,this.pixelMargin=n,this.tileSize=i*e,this.dz=t,this.yPos=s,this.xPos=h}setPixelMargin(i){i!==this.pixelMargin&&(this.pixelMargin=i,this.setExtent(this._extent))}setExtent(i){this._extent=i,this.finalRatio=this.tileSize/i*(1<<this.dz);let t=this.pixelRatio*this.pixelMargin;t/=this.finalRatio;const s=i>>this.dz;t>s&&(t=s),this.margin=t,this.xmin=s*this.xPos-t,this.ymin=s*this.yPos-t,this.xmax=this.xmin+s+2*t,this.ymax=this.ymin+s+2*t}reset(i){this.type=i,this.lines=[],this.starts=[],this.line=null,this.start=0}moveTo(i,s){this._pushLine(),this._prevIsIn=this._isIn(i,s),this._moveTo(i,s,this._prevIsIn),this._prevPt=new t(i,s),this._firstPt=new t(i,s),this._dist=0}lineTo(i,s){const h=this._isIn(i,s),n=new t(i,s),l=t.distance(this._prevPt,n);let x,a,y,o,r,m,p,u;if(h)this._prevIsIn?this._lineTo(i,s,!0):(x=this._prevPt,a=n,y=this._intersect(a,x),this.start=this._dist+l*(1-this._r),this._lineTo(y.x,y.y,!0),this._lineTo(a.x,a.y,!0));else if(this._prevIsIn)a=this._prevPt,x=n,y=this._intersect(a,x),this._lineTo(y.x,y.y,!0),this._lineTo(x.x,x.y,!1);else{const i=this._prevPt,t=n;if(i.x<=this.xmin&&t.x<=this.xmin||i.x>=this.xmax&&t.x>=this.xmax||i.y<=this.ymin&&t.y<=this.ymin||i.y>=this.ymax&&t.y>=this.ymax)this._lineTo(t.x,t.y,!1);else{const s=[];if((i.x<this.xmin&&t.x>this.xmin||i.x>this.xmin&&t.x<this.xmin)&&(o=(this.xmin-i.x)/(t.x-i.x),u=i.y+o*(t.y-i.y),u<=this.ymin?m=!1:u>=this.ymax?m=!0:s.push(new e(o,this.xmin,u))),(i.x<this.xmax&&t.x>this.xmax||i.x>this.xmax&&t.x<this.xmax)&&(o=(this.xmax-i.x)/(t.x-i.x),u=i.y+o*(t.y-i.y),u<=this.ymin?m=!1:u>=this.ymax?m=!0:s.push(new e(o,this.xmax,u))),(i.y<this.ymin&&t.y>this.ymin||i.y>this.ymin&&t.y<this.ymin)&&(o=(this.ymin-i.y)/(t.y-i.y),p=i.x+o*(t.x-i.x),p<=this.xmin?r=!1:p>=this.xmax?r=!0:s.push(new e(o,p,this.ymin))),(i.y<this.ymax&&t.y>this.ymax||i.y>this.ymax&&t.y<this.ymax)&&(o=(this.ymax-i.y)/(t.y-i.y),p=i.x+o*(t.x-i.x),p<=this.xmin?r=!1:p>=this.xmax?r=!0:s.push(new e(o,p,this.ymax))),0===s.length)r?m?this._lineTo(this.xmax,this.ymax,!0):this._lineTo(this.xmax,this.ymin,!0):m?this._lineTo(this.xmin,this.ymax,!0):this._lineTo(this.xmin,this.ymin,!0);else if(s.length>1&&s[0].ratio>s[1].ratio)this.start=this._dist+l*s[1].ratio,this._lineTo(s[1].x,s[1].y,!0),this._lineTo(s[0].x,s[0].y,!0);else{this.start=this._dist+l*s[0].ratio;for(let i=0;i<s.length;i++)this._lineTo(s[i].x,s[i].y,!0)}this._lineTo(t.x,t.y,!1)}}this._dist+=l,this._prevIsIn=h,this._prevPt=n}close(){if(this.line.length>2){const i=this._firstPt,t=this._prevPt;i.x===t.x&&i.y===t.y||this.lineTo(i.x,i.y);const s=this.line;let h=s.length;for(;h>=4&&(s[0].x===s[1].x&&s[0].x===s[h-2].x||s[0].y===s[1].y&&s[0].y===s[h-2].y);)s.pop(),s[0].x=s[h-2].x,s[0].y=s[h-2].y,--h}}result(i=!0){return this._pushLine(),0===this.lines.length?null:(this.type===s.Polygon&&i&&a.simplify(this.tileSize,this.margin*this.finalRatio,this.lines),this.lines)}resultWithStarts(){if(this.type!==s.LineString)throw new Error(\"Only valid for lines\");this._pushLine();const i=this.lines,t=i.length;if(0===t)return null;const h=[];for(let s=0;s<t;s++)h.push({line:i[s],start:this.starts[s]||0});return h}_isIn(i,t){return i>=this.xmin&&i<=this.xmax&&t>=this.ymin&&t<=this.ymax}_intersect(i,s){let h,e,n;if(s.x>=this.xmin&&s.x<=this.xmax)e=s.y<=this.ymin?this.ymin:this.ymax,n=(e-i.y)/(s.y-i.y),h=i.x+n*(s.x-i.x);else if(s.y>=this.ymin&&s.y<=this.ymax)h=s.x<=this.xmin?this.xmin:this.xmax,n=(h-i.x)/(s.x-i.x),e=i.y+n*(s.y-i.y);else{e=s.y<=this.ymin?this.ymin:this.ymax,h=s.x<=this.xmin?this.xmin:this.xmax;const t=(h-i.x)/(s.x-i.x),l=(e-i.y)/(s.y-i.y);t<l?(n=t,e=i.y+t*(s.y-i.y)):(n=l,h=i.x+l*(s.x-i.x))}return this._r=n,new t(h,e)}_pushLine(){this.line&&(this.type===s.Point?this.line.length>0&&(this.lines.push(this.line),this.starts.push(this.start)):this.type===s.LineString?this.line.length>1&&(this.lines.push(this.line),this.starts.push(this.start)):this.type===s.Polygon&&this.line.length>3&&(this.lines.push(this.line),this.starts.push(this.start))),this.line=[],this.start=0}_moveTo(i,h,e){this.type!==s.Polygon?e&&(i=Math.round((i-(this.xmin+this.margin))*this.finalRatio),h=Math.round((h-(this.ymin+this.margin))*this.finalRatio),this.line.push(new t(i,h))):(e||(i<this.xmin&&(i=this.xmin),i>this.xmax&&(i=this.xmax),h<this.ymin&&(h=this.ymin),h>this.ymax&&(h=this.ymax)),i=Math.round((i-(this.xmin+this.margin))*this.finalRatio),h=Math.round((h-(this.ymin+this.margin))*this.finalRatio),this.line.push(new t(i,h)),this._is_h=!1,this._is_v=!1)}_lineTo(i,h,e){let n,l;if(this.type!==s.Polygon)if(e){if(i=Math.round((i-(this.xmin+this.margin))*this.finalRatio),h=Math.round((h-(this.ymin+this.margin))*this.finalRatio),this.line.length>0&&(n=this.line[this.line.length-1],n.equals(i,h)))return;this.line.push(new t(i,h))}else this.line&&this.line.length>0&&this._pushLine();else if(e||(i<this.xmin&&(i=this.xmin),i>this.xmax&&(i=this.xmax),h<this.ymin&&(h=this.ymin),h>this.ymax&&(h=this.ymax)),i=Math.round((i-(this.xmin+this.margin))*this.finalRatio),h=Math.round((h-(this.ymin+this.margin))*this.finalRatio),this.line&&this.line.length>0){n=this.line[this.line.length-1];const s=n.x===i,e=n.y===h;if(s&&e)return;this._is_h&&s||this._is_v&&e?(n.x=i,n.y=h,l=this.line[this.line.length-2],l.x===i&&l.y===h?(this.line.pop(),this.line.length<=1?(this._is_h=!1,this._is_v=!1):(l=this.line[this.line.length-2],this._is_h=l.x===i,this._is_v=l.y===h)):(this._is_h=l.x===i,this._is_v=l.y===h)):(this.line.push(new t(i,h)),this._is_h=s,this._is_v=e)}else this.line.push(new t(i,h))}}class l{setExtent(i){this._ratio=4096===i?1:4096/i}get validateTessellation(){return this._ratio<1}reset(i){this.lines=[],this.line=null}moveTo(i,s){this.line&&this.lines.push(this.line),this.line=[];const h=this._ratio;this.line.push(new t(i*h,s*h))}lineTo(i,s){const h=this._ratio;this.line.push(new t(i*h,s*h))}close(){const i=this.line;i&&!i[0].isEqual(i[i.length-1])&&i.push(i[0])}result(){return this.line&&this.lines.push(this.line),0===this.lines.length?null:this.lines}}var x;!function(i){i[i.sideLeft=0]=\"sideLeft\",i[i.sideRight=1]=\"sideRight\",i[i.sideTop=2]=\"sideTop\",i[i.sideBottom=3]=\"sideBottom\"}(x||(x={}));class a{static simplify(i,t,s){if(!s)return;const h=-t,e=i+t,n=-t,l=i+t,y=[],o=[],r=s.length;for(let a=0;a<r;++a){const i=s[a];if(!i||i.length<2)continue;let t,r=i[0];const m=i.length;for(let s=1;s<m;++s)t=i[s],r.x===t.x&&(r.x<=h&&(r.y>t.y?(y.push(a),y.push(s),y.push(x.sideLeft),y.push(-1)):(o.push(a),o.push(s),o.push(x.sideLeft),o.push(-1))),r.x>=e&&(r.y<t.y?(y.push(a),y.push(s),y.push(x.sideRight),y.push(-1)):(o.push(a),o.push(s),o.push(x.sideRight),o.push(-1)))),r.y===t.y&&(r.y<=n&&(r.x<t.x?(y.push(a),y.push(s),y.push(x.sideTop),y.push(-1)):(o.push(a),o.push(s),o.push(x.sideTop),o.push(-1))),r.y>=l&&(r.x>t.x?(y.push(a),y.push(s),y.push(x.sideBottom),y.push(-1)):(o.push(a),o.push(s),o.push(x.sideBottom),o.push(-1)))),r=t}if(0===y.length||0===o.length)return;a.fillParent(s,o,y),a.fillParent(s,y,o);const m=[];a.calcDeltas(m,o,y),a.calcDeltas(m,y,o),a.addDeltas(m,s)}static fillParent(i,t,s){const e=s.length,n=t.length;for(let l=0;l<n;l+=4){const n=t[l],a=t[l+1],y=t[l+2],o=i[n][a-1],r=i[n][a];let m=8092,p=-1;for(let t=0;t<e;t+=4){if(s[t+2]!==y)continue;const e=s[t],n=s[t+1],l=i[e][n-1],a=i[e][n];switch(y){case x.sideLeft:case x.sideRight:if(h(o.y,l.y,a.y)&&h(r.y,l.y,a.y)){const i=Math.abs(a.y-l.y);i<m&&(m=i,p=t)}break;case x.sideTop:case x.sideBottom:if(h(o.x,l.x,a.x)&&h(r.x,l.x,a.x)){const i=Math.abs(a.x-l.x);i<m&&(m=i,p=t)}}}t[l+3]=p}}static calcDeltas(i,t,s){const h=t.length;for(let e=0;e<h;e+=4){const h=[],n=a.calcDelta(e,t,s,h);i.push(t[e]),i.push(t[e+1]),i.push(t[e+2]),i.push(n)}}static calcDelta(i,t,s,h){const e=t[i+3];if(-1===e)return 0;const n=h.length;return n>1&&h[n-2]===e?0:(h.push(e),a.calcDelta(e,s,t,h)+1)}static addDeltas(i,t){const s=i.length;let h=0;for(let e=0;e<s;e+=4){const t=i[e+3];t>h&&(h=t)}for(let e=0;e<s;e+=4){const s=t[i[e]],n=i[e+1],l=h-i[e+3];switch(i[e+2]){case x.sideLeft:s[n-1].x-=l,s[n].x-=l,1===n&&(s[s.length-1].x-=l),n===s.length-1&&(s[0].x-=l);break;case x.sideRight:s[n-1].x+=l,s[n].x+=l,1===n&&(s[s.length-1].x+=l),n===s.length-1&&(s[0].x+=l);break;case x.sideTop:s[n-1].y-=l,s[n].y-=l,1===n&&(s[s.length-1].y-=l),n===s.length-1&&(s[0].y-=l);break;case x.sideBottom:s[n-1].y+=l,s[n].y+=l,1===n&&(s[s.length-1].y+=l),n===s.length-1&&(s[0].y+=l)}}}}export{l as SimpleBuilder,n as TileClipper};\n"]},"metadata":{},"sourceType":"module"}