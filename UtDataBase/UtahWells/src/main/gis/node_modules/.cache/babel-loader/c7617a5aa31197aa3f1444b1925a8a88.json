{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport e from \"../../core/Error.js\";\nimport { isNone as n, isSome as i } from \"../../core/maybe.js\";\nimport { getDeepValue as t, setDeepValue as r } from \"../../core/object.js\";\nimport { validateDomainValue as l, getDomainRange as o, DomainValidationError as s } from \"./domainUtils.js\";\nimport { loadArcade as a } from \"../../support/arcadeOnDemand.js\";\nconst u = [\"field\", \"field2\", \"field3\", \"normalizationField\", \"rotationInfo.field\", \"proportionalSymbolInfo.field\", \"proportionalSymbolInfo.normalizationField\", \"colorInfo.field\", \"colorInfo.normalizationField\"],\n      f = [\"field\", \"normalizationField\"];\n\nfunction d(e, n) {\n  if (null != e && null != n) for (const i of Array.isArray(e) ? e : [e]) if (c(u, i, n), \"visualVariables\" in i && i.visualVariables) for (const e of i.visualVariables) c(f, e, n);\n}\n\nfunction c(e, n, i) {\n  if (e) for (const l of e) {\n    const e = t(l, n),\n          o = e && \"function\" != typeof e && i.get(e);\n    o && r(l, o.name, n);\n  }\n}\n\nfunction m(e, n) {\n  if (null != e && null != n && n.fields.length) if (\"startField\" in e) {\n    const i = n.get(e.startField),\n          t = n.get(e.endField);\n    e.startField = i && i.name || null, e.endField = t && t.name || null;\n  } else {\n    const i = n.get(e.startTimeField),\n          t = n.get(e.endTimeField);\n    e.startTimeField = i && i.name || null, e.endTimeField = t && t.name || null;\n  }\n}\n\nconst p = new Set();\n\nfunction y(e, n) {\n  return e && n ? (p.clear(), g(p, e, n), Array.from(p).sort()) : [];\n}\n\nfunction g(e, n, i) {\n  var t;\n  if (i) if (null != n && null != (t = n.fields) && t.length) {\n    if (i.includes(\"*\")) for (const {\n      name: r\n    } of n.fields) e.add(r);else for (const r of i) F(e, n, r);\n  } else {\n    if (i.includes(\"*\")) return e.clear(), void e.add(\"*\");\n\n    for (const n of i) e.add(n);\n  }\n}\n\nfunction F(e, n, i) {\n  if (\"string\" == typeof i) if (n) {\n    const t = n.get(i);\n    t && e.add(t.name);\n  } else e.add(i);\n}\n\nfunction I(e, i) {\n  return n(i) || n(e) ? [] : i.includes(\"*\") ? e.fields.map(e => e.name) : i;\n}\n\nfunction x(e, n) {\n  let i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n  if (!n || !e) return [];\n  if (n.includes(\"*\")) return [\"*\"];\n  const t = y(e, n);\n  return t.length / e.fields.length >= i ? [\"*\"] : t;\n}\n\nasync function b(e, n, i) {\n  var t;\n  if (!i) return;\n  const {\n    arcadeUtils: r\n  } = await a(),\n        l = r.extractFieldNames(i, null == n || null == (t = n.fields) ? void 0 : t.map(e => e.name));\n\n  for (const o of l) F(e, n, o);\n}\n\nasync function T(n, i, t) {\n  if (t && \"1=1\" !== t) {\n    const r = (await import(\"../../core/sql/WhereClause.js\")).WhereClause.create(t, i);\n    if (!r.isStandardized) throw new e(\"fieldUtils:collectFilterFields\", \"Where clause is not standardized\");\n    g(n, i, r.fieldNames);\n  }\n}\n\nfunction h(_ref) {\n  let {\n    displayField: e,\n    fields: n\n  } = _ref;\n  return e || (n && n.length ? w(n, \"name-or-title\") || w(n, \"unique-identifier\") || w(n, \"type-or-category\") || v(n) : null);\n}\n\nfunction v(e) {\n  for (const n of e) {\n    if (!n || !n.name) continue;\n    const e = n.name.toLowerCase();\n    if (e.indexOf(\"name\") > -1 || e.indexOf(\"title\") > -1) return n.name;\n  }\n\n  return null;\n}\n\nfunction w(e, n) {\n  for (const i of e) if (i && i.valueType && i.valueType === n) return i.name;\n\n  return null;\n}\n\nasync function S(e) {\n  if (!e) return [];\n  const n = new Set();\n  return await A(n, e), Array.from(n).sort();\n}\n\nasync function A(e, n) {\n  if (!n) return;\n  const i = t(\"elevationInfo.featureExpressionInfo\", n);\n  return i ? i.collectRequiredFields(e, n.fieldsIndex) : void 0;\n}\n\nasync function E(e, n, i) {\n  i.outStatistic.onStatisticValueExpression ? b(e, n, i.outStatistic.onStatisticValueExpression) : e.add(i.outStatistic.onStatisticField);\n}\n\nasync function N(e, n, i) {\n  var t, r;\n  if (!n || !i || \"cluster\" !== i.type) return;\n  const l = [];\n\n  if (null != (t = i.popupTemplate) && t.expressionInfos && l.push(...i.popupTemplate.expressionInfos.map(i => b(e, n.fieldsIndex, i.expression))), Array.isArray(null == (r = i.popupTemplate) ? void 0 : r.content)) {\n    const t = i.popupTemplate.content;\n\n    for (const i of t) \"expression\" === i.type && i.expressionInfo && l.push(b(e, n.fieldsIndex, i.expressionInfo.expression));\n  }\n\n  i.fields && l.push(...i.fields.map(i => E(e, n.fieldsIndex, i))), await Promise.all(l);\n}\n\nasync function V(e, n, t) {\n  n && (n.timeInfo && i(t) && t.timeExtent && g(e, n.fieldsIndex, [n.timeInfo.startField, n.timeInfo.endField]), n.floorInfo && g(e, n.fieldsIndex, [n.floorInfo.floorField]), i(t) && i(t.where) && (await T(e, n.fieldsIndex, t.where)));\n}\n\nasync function _(e, n, i) {\n  n && i && (await Promise.all(i.map(i => D(e, n, i))));\n}\n\nasync function D(e, n, i) {\n  n && i && (i.valueExpression ? await b(e, n.fieldsIndex, i.valueExpression) : i.field && F(e, n.fieldsIndex, i.field));\n}\n\nasync function $(e) {\n  if (!e) return [];\n  const n = \"timeInfo\" in e && e.timeInfo;\n  return n ? y(e.fieldsIndex, [e.trackIdField, n.startField, n.endField]) : [];\n}\n\nfunction O(e) {\n  if (!e) return [];\n  const n = \"editFieldsInfo\" in e && e.editFieldsInfo;\n  return n ? y(e.fieldsIndex, [n && n.creatorField, n && n.creationDateField, n && n.editorField, n && n.editDateField]) : [];\n}\n\nfunction L(e) {\n  if (!e) return [];\n  const n = e.geometryFieldsInfo;\n  return n ? y(e.fieldsIndex, [n.shapeAreaField, n.shapeLengthField]) : [];\n}\n\nasync function U(e) {\n  if (!e) return [];\n  const n = new Set();\n  return await j(n, e), Array.from(n).sort();\n}\n\nasync function j(e, n) {\n  const {\n    labelingInfo: i,\n    fieldsIndex: t\n  } = n;\n  i && i.length && (await Promise.all(i.map(n => z(e, t, n))));\n}\n\nasync function z(e, n, i) {\n  if (!i) return;\n  const t = i.getLabelExpression(),\n        r = i.where;\n  if (\"arcade\" === t.type) await b(e, n, t.expression);else {\n    const i = t.expression.match(/{[^}]*}/g);\n    i && i.forEach(i => {\n      F(e, n, i.slice(1, -1));\n    });\n  }\n  await T(e, n, r);\n}\n\nfunction P(e) {\n  const n = e.defaultValue;\n  return void 0 !== n && Y(e, n) ? n : e.nullable ? null : void 0;\n}\n\nfunction k(e) {\n  return \"number\" == typeof e && !isNaN(e) && isFinite(e);\n}\n\nfunction R(e) {\n  return null === e || k(e);\n}\n\nconst C = \"isInteger\" in Number ? Number.isInteger : e => \"number\" == typeof e && isFinite(e) && Math.floor(e) === e;\n\nfunction G(e) {\n  return null === e || C(e);\n}\n\nfunction q(e) {\n  return null != e && \"string\" == typeof e;\n}\n\nfunction M(e) {\n  return null === e || q(e);\n}\n\nfunction W() {\n  return !0;\n}\n\nfunction Y(e, n) {\n  let i;\n\n  switch (e.type) {\n    case \"date\":\n    case \"integer\":\n    case \"long\":\n    case \"small-integer\":\n    case \"esriFieldTypeDate\":\n    case \"esriFieldTypeInteger\":\n    case \"esriFieldTypeLong\":\n    case \"esriFieldTypeSmallInteger\":\n      i = e.nullable ? G : C;\n      break;\n\n    case \"double\":\n    case \"single\":\n    case \"esriFieldTypeSingle\":\n    case \"esriFieldTypeDouble\":\n      i = e.nullable ? R : k;\n      break;\n\n    case \"string\":\n    case \"esriFieldTypeString\":\n      i = e.nullable ? M : q;\n      break;\n\n    default:\n      i = W;\n  }\n\n  return 1 === arguments.length ? i : i(n);\n}\n\nconst J = [\"integer\", \"small-integer\", \"single\", \"double\"],\n      X = new Set([...J, \"esriFieldTypeInteger\", \"esriFieldTypeSmallInteger\", \"esriFieldTypeSingle\", \"esriFieldTypeDouble\"]);\n\nfunction B(e) {\n  return null != e && X.has(e.type);\n}\n\nfunction H(e) {\n  return null != e && (\"string\" === e.type || \"esriFieldTypeString\" === e.type);\n}\n\nfunction K(e) {\n  return null != e && (\"date\" === e.type || \"esriFieldTypeDate\" === e.type);\n}\n\nfunction Q(e, n) {\n  return null === ie(e, n);\n}\n\nvar Z, ee;\n\nfunction ne(e) {\n  return null == e || \"number\" == typeof e && isNaN(e) ? null : e;\n}\n\nfunction ie(e, n) {\n  return e.nullable && null === n ? null : B(e) && !te(e.type, Number(n)) ? Z.OUT_OF_RANGE : Y(e, n) ? e.domain ? l(e.domain, n) : null : ee.INVALID_TYPE;\n}\n\nfunction te(e, n) {\n  const i = \"string\" == typeof e ? le(e) : e;\n  return !!i && (i.isInteger ? C(n) && n >= i.min && n <= i.max : n >= i.min && n <= i.max);\n}\n\nfunction re(e) {\n  const n = o(e.domain);\n  return n || (B(e) ? le(e.type) : void 0);\n}\n\nfunction le(e) {\n  switch (e) {\n    case \"esriFieldTypeSmallInteger\":\n    case \"small-integer\":\n      return se;\n\n    case \"esriFieldTypeInteger\":\n    case \"integer\":\n      return ae;\n\n    case \"esriFieldTypeSingle\":\n    case \"single\":\n      return ue;\n\n    case \"esriFieldTypeDouble\":\n    case \"double\":\n      return fe;\n  }\n}\n\nfunction oe(e) {\n  if (!k(e)) return null;\n\n  if (C(e)) {\n    if (e >= se.min && e <= se.max) return \"esriFieldTypeSmallInteger\";\n    if (e >= ae.min && e <= ae.max) return \"esriFieldTypeInteger\";\n  }\n\n  return e >= ue.min && e <= ue.max ? \"esriFieldTypeSingle\" : \"esriFieldTypeDouble\";\n}\n\n!function (e) {\n  e.OUT_OF_RANGE = \"numeric-range-validation-error::out-of-range\";\n}(Z || (Z = {})), function (e) {\n  e.INVALID_TYPE = \"type-validation-error::invalid-type\";\n}(ee || (ee = {}));\nconst se = {\n  min: -32768,\n  max: 32767,\n  isInteger: !0\n},\n      ae = {\n  min: -2147483648,\n  max: 2147483647,\n  isInteger: !0\n},\n      ue = {\n  min: -34e37,\n  max: 12e37,\n  isInteger: !1\n},\n      fe = {\n  min: -Number.MAX_VALUE,\n  max: Number.MAX_VALUE,\n  isInteger: !1\n};\n\nfunction de(e, n, i) {\n  switch (e) {\n    case s.INVALID_CODED_VALUE:\n      return `Value ${i} is not in the coded domain - field: ${n.name}, domain: ${JSON.stringify(n.domain)}`;\n\n    case s.VALUE_OUT_OF_RANGE:\n      return `Value ${i} is out of the range of valid values - field: ${n.name}, domain: ${JSON.stringify(n.domain)}`;\n\n    case ee.INVALID_TYPE:\n      return `Value ${i} is not a valid value for the field type - field: ${n.name}, type: ${n.type}, nullable: ${n.nullable}`;\n\n    case Z.OUT_OF_RANGE:\n      {\n        const {\n          min: e,\n          max: t\n        } = le(n.type);\n        return `Value ${i} is out of range for the number type - field: ${n.name}, type: ${n.type}, value range is ${e} to ${t}`;\n      }\n  }\n}\n\nfunction ce(e, n) {\n  return !me(e, n, null);\n}\n\nfunction me(e, n, t) {\n  if (!n || !n.attributes || !e) {\n    if (i(t)) for (const n of e) t.add(n);\n    return !0;\n  }\n\n  const r = n.attributes;\n  let l = !1;\n\n  for (const o of e) if (!(o in r)) {\n    if (l = !0, !i(t)) break;\n    t.add(o);\n  }\n\n  return l;\n}\n\nasync function pe(e, n) {\n  const i = new Set();\n\n  for (const t of n) await b(i, e.fieldsIndex, t);\n\n  return Array.from(i).sort();\n}\n\nexport { Z as NumericRangeValidationError, ee as TypeValidationError, b as collectArcadeFieldNames, A as collectElevationFields, N as collectFeatureReductionFields, F as collectField, g as collectFields, V as collectFilterFields, j as collectLabelingFields, _ as collectOrderByInfos, fe as doubleRange, ce as featureHasFields, y as fixFields, d as fixRendererFields, m as fixTimeInfoFields, h as getDisplayFieldName, S as getElevationFields, pe as getExpressionFields, O as getFeatureEditFields, L as getFeatureGeometryFields, P as getFieldDefaultValue, re as getFieldRange, U as getLabelingFields, oe as getNumericTypeForValue, $ as getTimeFields, ae as integerRange, K as isDateField, te as isNumberInRange, B as isNumericField, H as isStringField, Q as isValidFieldValue, Y as isValueMatchingFieldType, J as numericTypes, x as packFields, me as populateMissingFields, u as rendererFields, ne as sanitizeNullFieldValue, ue as singleRange, se as smallIntegerRange, I as unpackFieldNames, ie as validateFieldValue, de as validationErrorToString, f as visualVariableFields };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/layers/support/fieldUtils.js"],"names":["e","isNone","n","isSome","i","getDeepValue","t","setDeepValue","r","validateDomainValue","l","getDomainRange","o","DomainValidationError","s","loadArcade","a","u","f","d","Array","isArray","c","visualVariables","get","name","m","fields","length","startField","endField","startTimeField","endTimeField","p","Set","y","clear","g","from","sort","includes","add","F","I","map","x","b","arcadeUtils","extractFieldNames","T","WhereClause","create","isStandardized","fieldNames","h","displayField","w","v","toLowerCase","indexOf","valueType","S","A","collectRequiredFields","fieldsIndex","E","outStatistic","onStatisticValueExpression","onStatisticField","N","type","popupTemplate","expressionInfos","push","expression","content","expressionInfo","Promise","all","V","timeInfo","timeExtent","floorInfo","floorField","where","_","D","valueExpression","field","$","trackIdField","O","editFieldsInfo","creatorField","creationDateField","editorField","editDateField","L","geometryFieldsInfo","shapeAreaField","shapeLengthField","U","j","labelingInfo","z","getLabelExpression","match","forEach","slice","P","defaultValue","Y","nullable","k","isNaN","isFinite","R","C","Number","isInteger","Math","floor","G","q","M","W","arguments","J","X","B","has","H","K","Q","ie","Z","ee","ne","te","OUT_OF_RANGE","domain","INVALID_TYPE","le","min","max","re","se","ae","ue","fe","oe","MAX_VALUE","de","INVALID_CODED_VALUE","JSON","stringify","VALUE_OUT_OF_RANGE","ce","me","attributes","pe","NumericRangeValidationError","TypeValidationError","collectArcadeFieldNames","collectElevationFields","collectFeatureReductionFields","collectField","collectFields","collectFilterFields","collectLabelingFields","collectOrderByInfos","doubleRange","featureHasFields","fixFields","fixRendererFields","fixTimeInfoFields","getDisplayFieldName","getElevationFields","getExpressionFields","getFeatureEditFields","getFeatureGeometryFields","getFieldDefaultValue","getFieldRange","getLabelingFields","getNumericTypeForValue","getTimeFields","integerRange","isDateField","isNumberInRange","isNumericField","isStringField","isValidFieldValue","isValueMatchingFieldType","numericTypes","packFields","populateMissingFields","rendererFields","sanitizeNullFieldValue","singleRange","smallIntegerRange","unpackFieldNames","validateFieldValue","validationErrorToString","visualVariableFields"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport e from\"../../core/Error.js\";import{isNone as n,isSome as i}from\"../../core/maybe.js\";import{getDeepValue as t,setDeepValue as r}from\"../../core/object.js\";import{validateDomainValue as l,getDomainRange as o,DomainValidationError as s}from\"./domainUtils.js\";import{loadArcade as a}from\"../../support/arcadeOnDemand.js\";const u=[\"field\",\"field2\",\"field3\",\"normalizationField\",\"rotationInfo.field\",\"proportionalSymbolInfo.field\",\"proportionalSymbolInfo.normalizationField\",\"colorInfo.field\",\"colorInfo.normalizationField\"],f=[\"field\",\"normalizationField\"];function d(e,n){if(null!=e&&null!=n)for(const i of Array.isArray(e)?e:[e])if(c(u,i,n),\"visualVariables\"in i&&i.visualVariables)for(const e of i.visualVariables)c(f,e,n)}function c(e,n,i){if(e)for(const l of e){const e=t(l,n),o=e&&\"function\"!=typeof e&&i.get(e);o&&r(l,o.name,n)}}function m(e,n){if(null!=e&&null!=n&&n.fields.length)if(\"startField\"in e){const i=n.get(e.startField),t=n.get(e.endField);e.startField=i&&i.name||null,e.endField=t&&t.name||null}else{const i=n.get(e.startTimeField),t=n.get(e.endTimeField);e.startTimeField=i&&i.name||null,e.endTimeField=t&&t.name||null}}const p=new Set;function y(e,n){return e&&n?(p.clear(),g(p,e,n),Array.from(p).sort()):[]}function g(e,n,i){var t;if(i)if(null!=n&&null!=(t=n.fields)&&t.length)if(i.includes(\"*\"))for(const{name:r}of n.fields)e.add(r);else for(const r of i)F(e,n,r);else{if(i.includes(\"*\"))return e.clear(),void e.add(\"*\");for(const n of i)e.add(n)}}function F(e,n,i){if(\"string\"==typeof i)if(n){const t=n.get(i);t&&e.add(t.name)}else e.add(i)}function I(e,i){return n(i)||n(e)?[]:i.includes(\"*\")?e.fields.map((e=>e.name)):i}function x(e,n,i=1){if(!n||!e)return[];if(n.includes(\"*\"))return[\"*\"];const t=y(e,n);return t.length/e.fields.length>=i?[\"*\"]:t}async function b(e,n,i){var t;if(!i)return;const{arcadeUtils:r}=await a(),l=r.extractFieldNames(i,null==n||null==(t=n.fields)?void 0:t.map((e=>e.name)));for(const o of l)F(e,n,o)}async function T(n,i,t){if(t&&\"1=1\"!==t){const r=(await import(\"../../core/sql/WhereClause.js\")).WhereClause.create(t,i);if(!r.isStandardized)throw new e(\"fieldUtils:collectFilterFields\",\"Where clause is not standardized\");g(n,i,r.fieldNames)}}function h({displayField:e,fields:n}){return e||(n&&n.length?w(n,\"name-or-title\")||w(n,\"unique-identifier\")||w(n,\"type-or-category\")||v(n):null)}function v(e){for(const n of e){if(!n||!n.name)continue;const e=n.name.toLowerCase();if(e.indexOf(\"name\")>-1||e.indexOf(\"title\")>-1)return n.name}return null}function w(e,n){for(const i of e)if(i&&i.valueType&&i.valueType===n)return i.name;return null}async function S(e){if(!e)return[];const n=new Set;return await A(n,e),Array.from(n).sort()}async function A(e,n){if(!n)return;const i=t(\"elevationInfo.featureExpressionInfo\",n);return i?i.collectRequiredFields(e,n.fieldsIndex):void 0}async function E(e,n,i){i.outStatistic.onStatisticValueExpression?b(e,n,i.outStatistic.onStatisticValueExpression):e.add(i.outStatistic.onStatisticField)}async function N(e,n,i){var t,r;if(!n||!i||\"cluster\"!==i.type)return;const l=[];if(null!=(t=i.popupTemplate)&&t.expressionInfos&&l.push(...i.popupTemplate.expressionInfos.map((i=>b(e,n.fieldsIndex,i.expression)))),Array.isArray(null==(r=i.popupTemplate)?void 0:r.content)){const t=i.popupTemplate.content;for(const i of t)\"expression\"===i.type&&i.expressionInfo&&l.push(b(e,n.fieldsIndex,i.expressionInfo.expression))}i.fields&&l.push(...i.fields.map((i=>E(e,n.fieldsIndex,i)))),await Promise.all(l)}async function V(e,n,t){n&&(n.timeInfo&&i(t)&&t.timeExtent&&g(e,n.fieldsIndex,[n.timeInfo.startField,n.timeInfo.endField]),n.floorInfo&&g(e,n.fieldsIndex,[n.floorInfo.floorField]),i(t)&&i(t.where)&&await T(e,n.fieldsIndex,t.where))}async function _(e,n,i){n&&i&&await Promise.all(i.map((i=>D(e,n,i))))}async function D(e,n,i){n&&i&&(i.valueExpression?await b(e,n.fieldsIndex,i.valueExpression):i.field&&F(e,n.fieldsIndex,i.field))}async function $(e){if(!e)return[];const n=\"timeInfo\"in e&&e.timeInfo;return n?y(e.fieldsIndex,[e.trackIdField,n.startField,n.endField]):[]}function O(e){if(!e)return[];const n=\"editFieldsInfo\"in e&&e.editFieldsInfo;return n?y(e.fieldsIndex,[n&&n.creatorField,n&&n.creationDateField,n&&n.editorField,n&&n.editDateField]):[]}function L(e){if(!e)return[];const n=e.geometryFieldsInfo;return n?y(e.fieldsIndex,[n.shapeAreaField,n.shapeLengthField]):[]}async function U(e){if(!e)return[];const n=new Set;return await j(n,e),Array.from(n).sort()}async function j(e,n){const{labelingInfo:i,fieldsIndex:t}=n;i&&i.length&&await Promise.all(i.map((n=>z(e,t,n))))}async function z(e,n,i){if(!i)return;const t=i.getLabelExpression(),r=i.where;if(\"arcade\"===t.type)await b(e,n,t.expression);else{const i=t.expression.match(/{[^}]*}/g);i&&i.forEach((i=>{F(e,n,i.slice(1,-1))}))}await T(e,n,r)}function P(e){const n=e.defaultValue;return void 0!==n&&Y(e,n)?n:e.nullable?null:void 0}function k(e){return\"number\"==typeof e&&!isNaN(e)&&isFinite(e)}function R(e){return null===e||k(e)}const C=\"isInteger\"in Number?Number.isInteger:e=>\"number\"==typeof e&&isFinite(e)&&Math.floor(e)===e;function G(e){return null===e||C(e)}function q(e){return null!=e&&\"string\"==typeof e}function M(e){return null===e||q(e)}function W(){return!0}function Y(e,n){let i;switch(e.type){case\"date\":case\"integer\":case\"long\":case\"small-integer\":case\"esriFieldTypeDate\":case\"esriFieldTypeInteger\":case\"esriFieldTypeLong\":case\"esriFieldTypeSmallInteger\":i=e.nullable?G:C;break;case\"double\":case\"single\":case\"esriFieldTypeSingle\":case\"esriFieldTypeDouble\":i=e.nullable?R:k;break;case\"string\":case\"esriFieldTypeString\":i=e.nullable?M:q;break;default:i=W}return 1===arguments.length?i:i(n)}const J=[\"integer\",\"small-integer\",\"single\",\"double\"],X=new Set([...J,\"esriFieldTypeInteger\",\"esriFieldTypeSmallInteger\",\"esriFieldTypeSingle\",\"esriFieldTypeDouble\"]);function B(e){return null!=e&&X.has(e.type)}function H(e){return null!=e&&(\"string\"===e.type||\"esriFieldTypeString\"===e.type)}function K(e){return null!=e&&(\"date\"===e.type||\"esriFieldTypeDate\"===e.type)}function Q(e,n){return null===ie(e,n)}var Z,ee;function ne(e){return null==e||\"number\"==typeof e&&isNaN(e)?null:e}function ie(e,n){return e.nullable&&null===n?null:B(e)&&!te(e.type,Number(n))?Z.OUT_OF_RANGE:Y(e,n)?e.domain?l(e.domain,n):null:ee.INVALID_TYPE}function te(e,n){const i=\"string\"==typeof e?le(e):e;return!!i&&(i.isInteger?C(n)&&n>=i.min&&n<=i.max:n>=i.min&&n<=i.max)}function re(e){const n=o(e.domain);return n||(B(e)?le(e.type):void 0)}function le(e){switch(e){case\"esriFieldTypeSmallInteger\":case\"small-integer\":return se;case\"esriFieldTypeInteger\":case\"integer\":return ae;case\"esriFieldTypeSingle\":case\"single\":return ue;case\"esriFieldTypeDouble\":case\"double\":return fe}}function oe(e){if(!k(e))return null;if(C(e)){if(e>=se.min&&e<=se.max)return\"esriFieldTypeSmallInteger\";if(e>=ae.min&&e<=ae.max)return\"esriFieldTypeInteger\"}return e>=ue.min&&e<=ue.max?\"esriFieldTypeSingle\":\"esriFieldTypeDouble\"}!function(e){e.OUT_OF_RANGE=\"numeric-range-validation-error::out-of-range\"}(Z||(Z={})),function(e){e.INVALID_TYPE=\"type-validation-error::invalid-type\"}(ee||(ee={}));const se={min:-32768,max:32767,isInteger:!0},ae={min:-2147483648,max:2147483647,isInteger:!0},ue={min:-34e37,max:12e37,isInteger:!1},fe={min:-Number.MAX_VALUE,max:Number.MAX_VALUE,isInteger:!1};function de(e,n,i){switch(e){case s.INVALID_CODED_VALUE:return`Value ${i} is not in the coded domain - field: ${n.name}, domain: ${JSON.stringify(n.domain)}`;case s.VALUE_OUT_OF_RANGE:return`Value ${i} is out of the range of valid values - field: ${n.name}, domain: ${JSON.stringify(n.domain)}`;case ee.INVALID_TYPE:return`Value ${i} is not a valid value for the field type - field: ${n.name}, type: ${n.type}, nullable: ${n.nullable}`;case Z.OUT_OF_RANGE:{const{min:e,max:t}=le(n.type);return`Value ${i} is out of range for the number type - field: ${n.name}, type: ${n.type}, value range is ${e} to ${t}`}}}function ce(e,n){return!me(e,n,null)}function me(e,n,t){if(!n||!n.attributes||!e){if(i(t))for(const n of e)t.add(n);return!0}const r=n.attributes;let l=!1;for(const o of e)if(!(o in r)){if(l=!0,!i(t))break;t.add(o)}return l}async function pe(e,n){const i=new Set;for(const t of n)await b(i,e.fieldsIndex,t);return Array.from(i).sort()}export{Z as NumericRangeValidationError,ee as TypeValidationError,b as collectArcadeFieldNames,A as collectElevationFields,N as collectFeatureReductionFields,F as collectField,g as collectFields,V as collectFilterFields,j as collectLabelingFields,_ as collectOrderByInfos,fe as doubleRange,ce as featureHasFields,y as fixFields,d as fixRendererFields,m as fixTimeInfoFields,h as getDisplayFieldName,S as getElevationFields,pe as getExpressionFields,O as getFeatureEditFields,L as getFeatureGeometryFields,P as getFieldDefaultValue,re as getFieldRange,U as getLabelingFields,oe as getNumericTypeForValue,$ as getTimeFields,ae as integerRange,K as isDateField,te as isNumberInRange,B as isNumericField,H as isStringField,Q as isValidFieldValue,Y as isValueMatchingFieldType,J as numericTypes,x as packFields,me as populateMissingFields,u as rendererFields,ne as sanitizeNullFieldValue,ue as singleRange,se as smallIntegerRange,I as unpackFieldNames,ie as validateFieldValue,de as validationErrorToString,f as visualVariableFields};\n"]},"metadata":{},"sourceType":"module"}