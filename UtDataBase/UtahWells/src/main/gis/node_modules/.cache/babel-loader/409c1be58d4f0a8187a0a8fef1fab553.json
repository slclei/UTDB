{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport t from \"../../../../core/Handles.js\";\nimport { addFrameTask as i } from \"../../../../core/scheduling.js\";\nimport { init as a } from \"../../../../core/watchUtils.js\";\nimport { translateBy as e, scaleAndRotateBy as s } from \"../../viewpointUtils.js\";\nimport { InputHandler as n } from \"../../../input/InputHandler.js\";\nimport { resetTransformation as r, extractTransformation as o, isZeroTransformation as h } from \"../../../navigation/gamepadAndKeyboardUtils.js\";\n\nclass l extends n {\n  constructor(i) {\n    super(!0), this.view = i, this.frameTask = null, this.watchHandles = new t(), this.currentDevice = null, this.transformation = {\n      translation: [0, 0, 0],\n      heading: 0,\n      tilt: 0,\n      zoom: 0\n    }, this.handle = this.registerIncoming(\"gamepad\", t => this._handleGamePadEvent(t)), this.handle.pause();\n  }\n\n  onInstall(t) {\n    super.onInstall(t), this.watchHandles.add([a(this.view.navigation.gamepad, \"enabled\", t => {\n      t ? (this.handle.resume(), this.frameTask || (this.frameTask = i({\n        update: t => this._frameUpdate(t.deltaTime)\n      }))) : (this.handle.pause(), this.frameTask && (this.frameTask.remove(), this.frameTask = null));\n    })]);\n  }\n\n  onUninstall() {\n    this.watchHandles.removeAll(), this.frameTask && (this.frameTask.remove(), this.frameTask = null), super.onUninstall();\n  }\n\n  _handleGamePadEvent(t) {\n    const i = this.view.navigation.gamepad.device;\n    i && t.data.device !== i || this.currentDevice && this.currentDevice !== t.data.device || (\"end\" === t.data.action ? (this.currentDevice = null, r(this.transformation)) : (this.currentDevice = t.data.device, o(t.data, this.view.navigation.gamepad, this.transformation)));\n  }\n\n  _frameUpdate(t) {\n    const i = this.transformation;\n    if (h(i)) return;\n    const a = this.view.viewpoint.clone(),\n          n = this.view.navigation.gamepad.velocityFactor,\n          r = m * n * t;\n    e(a, a, [i.translation[0] * r, -i.translation[1] * r]);\n    const o = 1 + i.translation[2] * c * t,\n          l = this.view.constraints.rotationEnabled ? -i.heading * d * t : 0,\n          v = this.view.size,\n          p = [v[0] / 2, v[1]];\n    s(a, a, o, l, p, v);\n    const f = this.view.constraints.constrain(a, this.view.viewpoint);\n    this.view.viewpoint = f;\n  }\n\n}\n\nconst d = .06,\n      m = .7,\n      c = 6e-4;\nexport { l as GamepadNavigation };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/views/2d/input/handlers/GamepadNavigation.js"],"names":["t","addFrameTask","i","init","a","translateBy","e","scaleAndRotateBy","s","InputHandler","n","resetTransformation","r","extractTransformation","o","isZeroTransformation","h","l","constructor","view","frameTask","watchHandles","currentDevice","transformation","translation","heading","tilt","zoom","handle","registerIncoming","_handleGamePadEvent","pause","onInstall","add","navigation","gamepad","resume","update","_frameUpdate","deltaTime","remove","onUninstall","removeAll","device","data","action","viewpoint","clone","velocityFactor","m","c","constraints","rotationEnabled","d","v","size","p","f","constrain","GamepadNavigation"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport t from\"../../../../core/Handles.js\";import{addFrameTask as i}from\"../../../../core/scheduling.js\";import{init as a}from\"../../../../core/watchUtils.js\";import{translateBy as e,scaleAndRotateBy as s}from\"../../viewpointUtils.js\";import{InputHandler as n}from\"../../../input/InputHandler.js\";import{resetTransformation as r,extractTransformation as o,isZeroTransformation as h}from\"../../../navigation/gamepadAndKeyboardUtils.js\";class l extends n{constructor(i){super(!0),this.view=i,this.frameTask=null,this.watchHandles=new t,this.currentDevice=null,this.transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this.handle=this.registerIncoming(\"gamepad\",(t=>this._handleGamePadEvent(t))),this.handle.pause()}onInstall(t){super.onInstall(t),this.watchHandles.add([a(this.view.navigation.gamepad,\"enabled\",(t=>{t?(this.handle.resume(),this.frameTask||(this.frameTask=i({update:t=>this._frameUpdate(t.deltaTime)}))):(this.handle.pause(),this.frameTask&&(this.frameTask.remove(),this.frameTask=null))}))])}onUninstall(){this.watchHandles.removeAll(),this.frameTask&&(this.frameTask.remove(),this.frameTask=null),super.onUninstall()}_handleGamePadEvent(t){const i=this.view.navigation.gamepad.device;i&&t.data.device!==i||this.currentDevice&&this.currentDevice!==t.data.device||(\"end\"===t.data.action?(this.currentDevice=null,r(this.transformation)):(this.currentDevice=t.data.device,o(t.data,this.view.navigation.gamepad,this.transformation)))}_frameUpdate(t){const i=this.transformation;if(h(i))return;const a=this.view.viewpoint.clone(),n=this.view.navigation.gamepad.velocityFactor,r=m*n*t;e(a,a,[i.translation[0]*r,-i.translation[1]*r]);const o=1+i.translation[2]*c*t,l=this.view.constraints.rotationEnabled?-i.heading*d*t:0,v=this.view.size,p=[v[0]/2,v[1]];s(a,a,o,l,p,v);const f=this.view.constraints.constrain(a,this.view.viewpoint);this.view.viewpoint=f}}const d=.06,m=.7,c=6e-4;export{l as GamepadNavigation};\n"]},"metadata":{},"sourceType":"module"}