{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../chunks/tslib.es6.js\";\nimport s from \"../../core/Accessor.js\";\nimport t from \"../../core/Handles.js\";\nimport { isNone as i } from \"../../core/maybe.js\";\nimport { watch as n, when as d, on as r, sync as a } from \"../../core/reactiveUtils.js\";\nimport { schedule as h } from \"../../core/scheduling.js\";\nimport { property as o } from \"../../core/accessorSupport/decorators/property.js\";\nimport { subclass as l } from \"../../core/accessorSupport/decorators/subclass.js\";\nlet c = class extends s {\n  constructor() {\n    super(...arguments), this.updating = !1, this.handleId = 0, this.handles = new t(), this.scheduleHandleId = 0, this.pendingPromises = new Set();\n  }\n\n  destroy() {\n    this.removeAll(), this.handles.destroy();\n  }\n\n  add(e, s) {\n    let t = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    return this._installWatch(e, s, t, n);\n  }\n\n  addWhen(e, s) {\n    let t = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    return this._installWatch(e, s, t, d);\n  }\n\n  addOnCollectionChange(e, s) {\n    let {\n      initial: t = !1\n    } = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    const i = ++this.handleId;\n    return this.handles.add([r(e, \"after-changes\", this._createSyncUpdatingCallback(), a), r(e, \"change\", s, {\n      onListenerAdd: t ? e => s({\n        added: e.toArray(),\n        removed: []\n      }) : void 0\n    })], i), {\n      remove: () => this.handles.remove(i)\n    };\n  }\n\n  addPromise(e) {\n    if (i(e)) return e;\n    const s = ++this.handleId;\n    this.handles.add({\n      remove: () => {\n        this.pendingPromises.delete(e) && (0 !== this.pendingPromises.size || this.handles.has(p) || this._set(\"updating\", !1));\n      }\n    }, s), this.pendingPromises.add(e), this._set(\"updating\", !0);\n\n    const t = () => this.handles.remove(s);\n\n    return e.then(t, t), e;\n  }\n\n  removeAll() {\n    this.pendingPromises.clear(), this.handles.removeAll(), this._set(\"updating\", !1);\n  }\n\n  _installWatch(e, s) {\n    let t = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    let i = arguments.length > 3 ? arguments[3] : undefined;\n    const n = ++this.handleId;\n    t.sync || this._installSyncUpdatingWatch(e, n);\n    const d = i(e, s, t);\n    return this.handles.add(d, n), {\n      remove: () => this.handles.remove(n)\n    };\n  }\n\n  _installSyncUpdatingWatch(e, s) {\n    const t = this._createSyncUpdatingCallback(),\n          i = n(e, t, {\n      sync: !0,\n      equals: () => !1\n    });\n\n    return this.handles.add(i, s), i;\n  }\n\n  _createSyncUpdatingCallback() {\n    return () => {\n      this.handles.remove(p), ++this.scheduleHandleId;\n      const e = this.scheduleHandleId;\n      this._get(\"updating\") || this._set(\"updating\", !0), this.handles.add(h(() => {\n        e === this.scheduleHandleId && (this._set(\"updating\", this.pendingPromises.size > 0), this.handles.remove(p));\n      }), p);\n    };\n  }\n\n};\ne([o({\n  readOnly: !0\n})], c.prototype, \"updating\", void 0), c = e([l(\"esri.views.support.WatchUpdatingTracking\")], c);\nconst p = -42;\nvar m;\n!function (e) {\n  e[e.NONE = 0] = \"NONE\", e[e.SYNC = 1] = \"SYNC\", e[e.INIT = 2] = \"INIT\";\n}(m || (m = {}));\nexport { m as WatchFlags, c as WatchUpdatingTracking };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/views/support/WatchUpdatingTracking.js"],"names":["_","e","s","t","isNone","i","watch","n","when","d","on","r","sync","a","schedule","h","property","o","subclass","l","c","constructor","arguments","updating","handleId","handles","scheduleHandleId","pendingPromises","Set","destroy","removeAll","add","_installWatch","addWhen","addOnCollectionChange","initial","_createSyncUpdatingCallback","onListenerAdd","added","toArray","removed","remove","addPromise","delete","size","has","p","_set","then","clear","_installSyncUpdatingWatch","equals","_get","readOnly","prototype","m","NONE","SYNC","INIT","WatchFlags","WatchUpdatingTracking"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import s from\"../../core/Accessor.js\";import t from\"../../core/Handles.js\";import{isNone as i}from\"../../core/maybe.js\";import{watch as n,when as d,on as r,sync as a}from\"../../core/reactiveUtils.js\";import{schedule as h}from\"../../core/scheduling.js\";import{property as o}from\"../../core/accessorSupport/decorators/property.js\";import{subclass as l}from\"../../core/accessorSupport/decorators/subclass.js\";let c=class extends s{constructor(){super(...arguments),this.updating=!1,this.handleId=0,this.handles=new t,this.scheduleHandleId=0,this.pendingPromises=new Set}destroy(){this.removeAll(),this.handles.destroy()}add(e,s,t={}){return this._installWatch(e,s,t,n)}addWhen(e,s,t={}){return this._installWatch(e,s,t,d)}addOnCollectionChange(e,s,{initial:t=!1}={}){const i=++this.handleId;return this.handles.add([r(e,\"after-changes\",this._createSyncUpdatingCallback(),a),r(e,\"change\",s,{onListenerAdd:t?e=>s({added:e.toArray(),removed:[]}):void 0})],i),{remove:()=>this.handles.remove(i)}}addPromise(e){if(i(e))return e;const s=++this.handleId;this.handles.add({remove:()=>{this.pendingPromises.delete(e)&&(0!==this.pendingPromises.size||this.handles.has(p)||this._set(\"updating\",!1))}},s),this.pendingPromises.add(e),this._set(\"updating\",!0);const t=()=>this.handles.remove(s);return e.then(t,t),e}removeAll(){this.pendingPromises.clear(),this.handles.removeAll(),this._set(\"updating\",!1)}_installWatch(e,s,t={},i){const n=++this.handleId;t.sync||this._installSyncUpdatingWatch(e,n);const d=i(e,s,t);return this.handles.add(d,n),{remove:()=>this.handles.remove(n)}}_installSyncUpdatingWatch(e,s){const t=this._createSyncUpdatingCallback(),i=n(e,t,{sync:!0,equals:()=>!1});return this.handles.add(i,s),i}_createSyncUpdatingCallback(){return()=>{this.handles.remove(p),++this.scheduleHandleId;const e=this.scheduleHandleId;this._get(\"updating\")||this._set(\"updating\",!0),this.handles.add(h((()=>{e===this.scheduleHandleId&&(this._set(\"updating\",this.pendingPromises.size>0),this.handles.remove(p))})),p)}}};e([o({readOnly:!0})],c.prototype,\"updating\",void 0),c=e([l(\"esri.views.support.WatchUpdatingTracking\")],c);const p=-42;var m;!function(e){e[e.NONE=0]=\"NONE\",e[e.SYNC=1]=\"SYNC\",e[e.INIT=2]=\"INIT\"}(m||(m={}));export{m as WatchFlags,c as WatchUpdatingTracking};\n"]},"metadata":{},"sourceType":"module"}