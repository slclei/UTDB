{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../chunks/tslib.es6.js\";\nimport r from \"../request.js\";\nimport t from \"../TimeExtent.js\";\nimport o from \"../core/Error.js\";\nimport { HandleOwnerMixin as i } from \"../core/HandleOwner.js\";\nimport { loadAll as s } from \"../core/loadAll.js\";\nimport { isSome as a } from \"../core/maybe.js\";\nimport { MultiOriginJSONMixin as p } from \"../core/MultiOriginJSONSupport.js\";\nimport { throwIfAbortError as n, isAbortError as m } from \"../core/promiseUtils.js\";\nimport { property as l } from \"../core/accessorSupport/decorators/property.js\";\nimport \"../core/arrayUtils.js\";\nimport \"../core/has.js\";\nimport { Integer as c } from \"../core/accessorSupport/ensureType.js\";\nimport { reader as u } from \"../core/accessorSupport/decorators/reader.js\";\nimport { subclass as y } from \"../core/accessorSupport/decorators/subclass.js\";\nimport { writer as d } from \"../core/accessorSupport/decorators/writer.js\";\nimport { nameToId as h, OriginId as f } from \"../core/accessorSupport/PropertyOrigin.js\";\nimport g from \"../geometry/Extent.js\";\nimport { getScale as v } from \"../geometry/support/scaleUtils.js\";\nimport j from \"./Layer.js\";\nimport { APIKeyMixin as x } from \"./mixins/APIKeyMixin.js\";\nimport { ArcGISMapService as b } from \"./mixins/ArcGISMapService.js\";\nimport { ArcGISService as S } from \"./mixins/ArcGISService.js\";\nimport { BlendLayer as O } from \"./mixins/BlendLayer.js\";\nimport { CustomParametersMixin as w } from \"./mixins/CustomParametersMixin.js\";\nimport { OperationalLayer as I } from \"./mixins/OperationalLayer.js\";\nimport { PortalLayer as E } from \"./mixins/PortalLayer.js\";\nimport { RefreshableLayer as L } from \"./mixins/RefreshableLayer.js\";\nimport { ScaleRangeLayer as P } from \"./mixins/ScaleRangeLayer.js\";\nimport { SublayersOwner as M } from \"./mixins/SublayersOwner.js\";\nimport { TemporalLayer as T } from \"./mixins/TemporalLayer.js\";\nimport { url as U } from \"./support/commonProperties.js\";\nimport { ExportImageParameters as R } from \"./support/ExportImageParameters.js\";\nimport N from \"./support/Sublayer.js\";\nimport { shouldWriteSublayerStructure as A } from \"./support/sublayerUtils.js\";\nimport { serviceSupportsSpatialReference as J } from \"./support/versionUtils.js\";\nlet q = class extends O(T(P(M(b(S(I(E(p(L(x(w(i(j))))))))))))) {\n  constructor() {\n    super(...arguments), this.datesInUnknownTimezone = !1, this.dpi = 96, this.gdbVersion = null, this.imageFormat = \"png24\", this.imageMaxHeight = 2048, this.imageMaxWidth = 2048, this.imageTransparency = !0, this.isReference = null, this.labelsVisible = !1, this.operationalLayerType = \"ArcGISMapServiceLayer\", this.sourceJSON = null, this.sublayers = null, this.type = \"map-image\", this.url = null;\n  }\n\n  normalizeCtorArgs(e, r) {\n    return \"string\" == typeof e ? {\n      url: e,\n      ...r\n    } : e;\n  }\n\n  load(e) {\n    const r = a(e) ? e.signal : null;\n    return this.addResolvingPromise(this.loadFromPortal({\n      supportedTypes: [\"Map Service\"]\n    }, e).catch(n).then(() => this._fetchService(r))), Promise.resolve(this);\n  }\n\n  readImageFormat(e, r) {\n    const t = r.supportedImageFormatTypes;\n    return t && t.indexOf(\"PNG32\") > -1 ? \"png32\" : \"png24\";\n  }\n\n  writeSublayers(e, r, t, o) {\n    if (!this.loaded || !e) return;\n    const i = e.slice().reverse().flatten(_ref => {\n      let {\n        sublayers: e\n      } = _ref;\n      return e && e.toArray().reverse();\n    }).toArray();\n    let s = !1;\n\n    if (this.capabilities && this.capabilities.operations.supportsExportMap && this.capabilities.exportMap.supportsDynamicLayers) {\n      const e = h(o.origin);\n\n      if (e === f.PORTAL_ITEM) {\n        const e = this.createSublayersForOrigin(\"service\").sublayers;\n        s = A(i, e, f.SERVICE);\n      } else if (e > f.PORTAL_ITEM) {\n        const e = this.createSublayersForOrigin(\"portal-item\");\n        s = A(i, e.sublayers, h(e.origin));\n      }\n    }\n\n    const a = [],\n          p = {\n      writeSublayerStructure: s,\n      ...o\n    };\n    let n = s;\n    i.forEach(e => {\n      const r = e.write({}, p);\n      a.push(r), n = n || \"user\" === e.originOf(\"visible\");\n    });\n    a.some(e => Object.keys(e).length > 1) && (r.layers = a), n && (r.visibleLayers = i.filter(e => e.visible).map(e => e.id));\n  }\n\n  createExportImageParameters(e, r, t, o) {\n    const i = o && o.pixelRatio || 1;\n    e && this.version >= 10 && (e = e.clone().shiftCentralMeridian());\n    const s = new R({\n      layer: this,\n      floors: null == o ? void 0 : o.floors,\n      scale: v({\n        extent: e,\n        width: r\n      }) * i\n    }),\n          a = s.toJSON();\n    s.destroy();\n    const p = !o || !o.rotation || this.version < 10.3 ? {} : {\n      rotation: -o.rotation\n    },\n          n = e && e.spatialReference,\n          m = n.wkid || JSON.stringify(n.toJSON());\n    a.dpi *= i;\n    const l = {};\n\n    if (null != o && o.timeExtent) {\n      const {\n        start: e,\n        end: r\n      } = o.timeExtent.toJSON();\n      l.time = e && r && e === r ? \"\" + e : `${null == e ? \"null\" : e},${null == r ? \"null\" : r}`;\n    } else this.timeInfo && !this.timeInfo.hasLiveData && (l.time = \"null,null\");\n\n    return {\n      bbox: e && e.xmin + \",\" + e.ymin + \",\" + e.xmax + \",\" + e.ymax,\n      bboxSR: m,\n      imageSR: m,\n      size: r + \",\" + t,\n      ...a,\n      ...p,\n      ...l\n    };\n  }\n\n  async fetchImage(e, t, i, s) {\n    var a;\n    const p = {\n      responseType: \"image\",\n      signal: null != (a = null == s ? void 0 : s.signal) ? a : null,\n      query: { ...this.parsedUrl.query,\n        ...this.createExportImageParameters(e, t, i, s),\n        f: \"image\",\n        ...this.refreshParameters,\n        ...this.customParameters,\n        token: this.apiKey\n      }\n    },\n          n = this.parsedUrl.path + \"/export\";\n    if (null != p.query.dynamicLayers && !this.capabilities.exportMap.supportsDynamicLayers) return Promise.reject(new o(\"mapimagelayer:dynamiclayer-not-supported\", `service ${this.url} doesn't support dynamic layers, which is required to be able to change the sublayer's order, rendering, labeling or source.`, {\n      query: p.query\n    }));\n    return r(n, p).then(e => e.data).catch(e => {\n      if (m(e)) throw e;\n      throw new o(\"mapimagelayer:image-fetch-error\", `Unable to load image: ${n}`, {\n        error: e\n      });\n    });\n  }\n\n  async fetchRecomputedExtents() {\n    let e = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    const o = { ...e,\n      query: {\n        returnUpdates: !0,\n        f: \"json\",\n        ...this.customParameters,\n        token: this.apiKey\n      }\n    },\n          {\n      data: i\n    } = await r(this.url, o),\n          {\n      extent: s,\n      fullExtent: a,\n      timeExtent: p\n    } = i,\n          n = s || a;\n    return {\n      fullExtent: n && g.fromJSON(n),\n      timeExtent: p && t.fromJSON({\n        start: p[0],\n        end: p[1]\n      })\n    };\n  }\n\n  loadAll() {\n    return s(this, e => {\n      e(this.allSublayers);\n    });\n  }\n\n  serviceSupportsSpatialReference(e) {\n    return J(this, e);\n  }\n\n  async _fetchService(e) {\n    if (this.sourceJSON) return void this.read(this.sourceJSON, {\n      origin: \"service\",\n      url: this.parsedUrl\n    });\n    const {\n      data: t,\n      ssl: o\n    } = await r(this.parsedUrl.path, {\n      query: {\n        f: \"json\",\n        ...this.parsedUrl.query,\n        ...this.customParameters,\n        token: this.apiKey\n      },\n      signal: e\n    });\n    o && (this.url = this.url.replace(/^http:/i, \"https:\")), this.sourceJSON = t, this.read(t, {\n      origin: \"service\",\n      url: this.parsedUrl\n    });\n  }\n\n};\ne([l({\n  type: Boolean\n})], q.prototype, \"datesInUnknownTimezone\", void 0), e([l()], q.prototype, \"dpi\", void 0), e([l()], q.prototype, \"gdbVersion\", void 0), e([l()], q.prototype, \"imageFormat\", void 0), e([u(\"imageFormat\", [\"supportedImageFormatTypes\"])], q.prototype, \"readImageFormat\", null), e([l({\n  json: {\n    origins: {\n      service: {\n        read: {\n          source: \"maxImageHeight\"\n        }\n      }\n    }\n  }\n})], q.prototype, \"imageMaxHeight\", void 0), e([l({\n  json: {\n    origins: {\n      service: {\n        read: {\n          source: \"maxImageWidth\"\n        }\n      }\n    }\n  }\n})], q.prototype, \"imageMaxWidth\", void 0), e([l()], q.prototype, \"imageTransparency\", void 0), e([l({\n  type: Boolean,\n  json: {\n    read: !1,\n    write: {\n      enabled: !0,\n      overridePolicy: () => ({\n        enabled: !1\n      })\n    }\n  }\n})], q.prototype, \"isReference\", void 0), e([l({\n  json: {\n    read: !1,\n    write: !1\n  }\n})], q.prototype, \"labelsVisible\", void 0), e([l({\n  type: [\"ArcGISMapServiceLayer\"]\n})], q.prototype, \"operationalLayerType\", void 0), e([l({\n  json: {\n    read: !1,\n    write: !1\n  }\n})], q.prototype, \"popupEnabled\", void 0), e([l()], q.prototype, \"sourceJSON\", void 0), e([l({\n  json: {\n    write: {\n      ignoreOrigin: !0\n    }\n  }\n})], q.prototype, \"sublayers\", void 0), e([d(\"sublayers\", {\n  layers: {\n    type: [N]\n  },\n  visibleLayers: {\n    type: [c]\n  }\n})], q.prototype, \"writeSublayers\", null), e([l({\n  type: [\"show\", \"hide\", \"hide-children\"]\n})], q.prototype, \"listMode\", void 0), e([l({\n  json: {\n    read: !1\n  },\n  readOnly: !0,\n  value: \"map-image\"\n})], q.prototype, \"type\", void 0), e([l(U)], q.prototype, \"url\", void 0), q = e([y(\"esri.layers.MapImageLayer\")], q);\nconst F = q;\nexport { F as default };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/layers/MapImageLayer.js"],"names":["_","e","r","t","o","HandleOwnerMixin","i","loadAll","s","isSome","a","MultiOriginJSONMixin","p","throwIfAbortError","n","isAbortError","m","property","l","Integer","c","reader","u","subclass","y","writer","d","nameToId","h","OriginId","f","g","getScale","v","j","APIKeyMixin","x","ArcGISMapService","b","ArcGISService","S","BlendLayer","O","CustomParametersMixin","w","OperationalLayer","I","PortalLayer","E","RefreshableLayer","L","ScaleRangeLayer","P","SublayersOwner","M","TemporalLayer","T","url","U","ExportImageParameters","R","N","shouldWriteSublayerStructure","A","serviceSupportsSpatialReference","J","q","constructor","datesInUnknownTimezone","dpi","gdbVersion","imageFormat","imageMaxHeight","imageMaxWidth","imageTransparency","isReference","labelsVisible","operationalLayerType","sourceJSON","sublayers","type","normalizeCtorArgs","load","signal","addResolvingPromise","loadFromPortal","supportedTypes","catch","then","_fetchService","Promise","resolve","readImageFormat","supportedImageFormatTypes","indexOf","writeSublayers","loaded","slice","reverse","flatten","toArray","capabilities","operations","supportsExportMap","exportMap","supportsDynamicLayers","origin","PORTAL_ITEM","createSublayersForOrigin","SERVICE","writeSublayerStructure","forEach","write","push","originOf","some","Object","keys","length","layers","visibleLayers","filter","visible","map","id","createExportImageParameters","pixelRatio","version","clone","shiftCentralMeridian","layer","floors","scale","extent","width","toJSON","destroy","rotation","spatialReference","wkid","JSON","stringify","timeExtent","start","end","time","timeInfo","hasLiveData","bbox","xmin","ymin","xmax","ymax","bboxSR","imageSR","size","fetchImage","responseType","query","parsedUrl","refreshParameters","customParameters","token","apiKey","path","dynamicLayers","reject","data","error","fetchRecomputedExtents","returnUpdates","fullExtent","fromJSON","allSublayers","read","ssl","replace","Boolean","prototype","json","origins","service","source","enabled","overridePolicy","ignoreOrigin","readOnly","value","F","default"],"mappings":"AAAA;AACA;AACA;AACA;AACA,SAAOA,CAAC,IAAIC,CAAZ,QAAkB,wBAAlB;AAA2C,OAAOC,CAAP,MAAa,eAAb;AAA6B,OAAOC,CAAP,MAAa,kBAAb;AAAgC,OAAOC,CAAP,MAAa,kBAAb;AAAgC,SAAOC,gBAAgB,IAAIC,CAA3B,QAAiC,wBAAjC;AAA0D,SAAOC,OAAO,IAAIC,CAAlB,QAAwB,oBAAxB;AAA6C,SAAOC,MAAM,IAAIC,CAAjB,QAAuB,kBAAvB;AAA0C,SAAOC,oBAAoB,IAAIC,CAA/B,QAAqC,mCAArC;AAAyE,SAAOC,iBAAiB,IAAIC,CAA5B,EAA8BC,YAAY,IAAIC,CAA9C,QAAoD,yBAApD;AAA8E,SAAOC,QAAQ,IAAIC,CAAnB,QAAyB,gDAAzB;AAA0E,OAAM,uBAAN;AAA8B,OAAM,gBAAN;AAAuB,SAAOC,OAAO,IAAIC,CAAlB,QAAwB,uCAAxB;AAAgE,SAAOC,MAAM,IAAIC,CAAjB,QAAuB,8CAAvB;AAAsE,SAAOC,QAAQ,IAAIC,CAAnB,QAAyB,gDAAzB;AAA0E,SAAOC,MAAM,IAAIC,CAAjB,QAAuB,8CAAvB;AAAsE,SAAOC,QAAQ,IAAIC,CAAnB,EAAqBC,QAAQ,IAAIC,CAAjC,QAAuC,2CAAvC;AAAmF,OAAOC,CAAP,MAAa,uBAAb;AAAqC,SAAOC,QAAQ,IAAIC,CAAnB,QAAyB,mCAAzB;AAA6D,OAAOC,CAAP,MAAa,YAAb;AAA0B,SAAOC,WAAW,IAAIC,CAAtB,QAA4B,yBAA5B;AAAsD,SAAOC,gBAAgB,IAAIC,CAA3B,QAAiC,8BAAjC;AAAgE,SAAOC,aAAa,IAAIC,CAAxB,QAA8B,2BAA9B;AAA0D,SAAOC,UAAU,IAAIC,CAArB,QAA2B,wBAA3B;AAAoD,SAAOC,qBAAqB,IAAIC,CAAhC,QAAsC,mCAAtC;AAA0E,SAAOC,gBAAgB,IAAIC,CAA3B,QAAiC,8BAAjC;AAAgE,SAAOC,WAAW,IAAIC,CAAtB,QAA4B,yBAA5B;AAAsD,SAAOC,gBAAgB,IAAIC,CAA3B,QAAiC,8BAAjC;AAAgE,SAAOC,eAAe,IAAIC,CAA1B,QAAgC,6BAAhC;AAA8D,SAAOC,cAAc,IAAIC,CAAzB,QAA+B,4BAA/B;AAA4D,SAAOC,aAAa,IAAIC,CAAxB,QAA8B,2BAA9B;AAA0D,SAAOC,GAAG,IAAIC,CAAd,QAAoB,+BAApB;AAAoD,SAAOC,qBAAqB,IAAIC,CAAhC,QAAsC,oCAAtC;AAA2E,OAAOC,CAAP,MAAa,uBAAb;AAAqC,SAAOC,4BAA4B,IAAIC,CAAvC,QAA6C,4BAA7C;AAA0E,SAAOC,+BAA+B,IAAIC,CAA1C,QAAgD,2BAAhD;AAA4E,IAAIC,CAAC,GAAC,cAAcxB,CAAC,CAACc,CAAC,CAACJ,CAAC,CAACE,CAAC,CAAChB,CAAC,CAACE,CAAC,CAACM,CAAC,CAACE,CAAC,CAACpC,CAAC,CAACsC,CAAC,CAACd,CAAC,CAACQ,CAAC,CAACtC,CAAC,CAAC4B,CAAD,CAAF,CAAF,CAAF,CAAF,CAAF,CAAF,CAAF,CAAF,CAAF,CAAF,CAAF,CAAF,CAAf,CAAuD;AAACiC,EAAAA,WAAW,GAAM;AAAC,UAAM,YAAN,GAAY,KAAKC,sBAAL,GAA4B,CAAC,CAAzC,EAA2C,KAAKC,GAAL,GAAS,EAApD,EAAuD,KAAKC,UAAL,GAAgB,IAAvE,EAA4E,KAAKC,WAAL,GAAiB,OAA7F,EAAqG,KAAKC,cAAL,GAAoB,IAAzH,EAA8H,KAAKC,aAAL,GAAmB,IAAjJ,EAAsJ,KAAKC,iBAAL,GAAuB,CAAC,CAA9K,EAAgL,KAAKC,WAAL,GAAiB,IAAjM,EAAsM,KAAKC,aAAL,GAAmB,CAAC,CAA1N,EAA4N,KAAKC,oBAAL,GAA0B,uBAAtP,EAA8Q,KAAKC,UAAL,GAAgB,IAA9R,EAAmS,KAAKC,SAAL,GAAe,IAAlT,EAAuT,KAAKC,IAAL,GAAU,WAAjU,EAA6U,KAAKvB,GAAL,GAAS,IAAtV;AAA2V;;AAAAwB,EAAAA,iBAAiB,CAAChF,CAAD,EAAGC,CAAH,EAAK;AAAC,WAAM,YAAU,OAAOD,CAAjB,GAAmB;AAACwD,MAAAA,GAAG,EAACxD,CAAL;AAAO,SAAGC;AAAV,KAAnB,GAAgCD,CAAtC;AAAwC;;AAAAiF,EAAAA,IAAI,CAACjF,CAAD,EAAG;AAAC,UAAMC,CAAC,GAACQ,CAAC,CAACT,CAAD,CAAD,GAAKA,CAAC,CAACkF,MAAP,GAAc,IAAtB;AAA2B,WAAO,KAAKC,mBAAL,CAAyB,KAAKC,cAAL,CAAoB;AAACC,MAAAA,cAAc,EAAC,CAAC,aAAD;AAAhB,KAApB,EAAqDrF,CAArD,EAAwDsF,KAAxD,CAA8DzE,CAA9D,EAAiE0E,IAAjE,CAAuE,MAAI,KAAKC,aAAL,CAAmBvF,CAAnB,CAA3E,CAAzB,GAA6HwF,OAAO,CAACC,OAAR,CAAgB,IAAhB,CAApI;AAA0J;;AAAAC,EAAAA,eAAe,CAAC3F,CAAD,EAAGC,CAAH,EAAK;AAAC,UAAMC,CAAC,GAACD,CAAC,CAAC2F,yBAAV;AAAoC,WAAO1F,CAAC,IAAEA,CAAC,CAAC2F,OAAF,CAAU,OAAV,IAAmB,CAAC,CAAvB,GAAyB,OAAzB,GAAiC,OAAxC;AAAgD;;AAAAC,EAAAA,cAAc,CAAC9F,CAAD,EAAGC,CAAH,EAAKC,CAAL,EAAOC,CAAP,EAAS;AAAC,QAAG,CAAC,KAAK4F,MAAN,IAAc,CAAC/F,CAAlB,EAAoB;AAAO,UAAMK,CAAC,GAACL,CAAC,CAACgG,KAAF,GAAUC,OAAV,GAAoBC,OAApB,CAA6B;AAAA,UAAC;AAACpB,QAAAA,SAAS,EAAC9E;AAAX,OAAD;AAAA,aAAiBA,CAAC,IAAEA,CAAC,CAACmG,OAAF,GAAYF,OAAZ,EAApB;AAAA,KAA7B,EAAyEE,OAAzE,EAAR;AAA2F,QAAI5F,CAAC,GAAC,CAAC,CAAP;;AAAS,QAAG,KAAK6F,YAAL,IAAmB,KAAKA,YAAL,CAAkBC,UAAlB,CAA6BC,iBAAhD,IAAmE,KAAKF,YAAL,CAAkBG,SAAlB,CAA4BC,qBAAlG,EAAwH;AAAC,YAAMxG,CAAC,GAAC2B,CAAC,CAACxB,CAAC,CAACsG,MAAH,CAAT;;AAAoB,UAAGzG,CAAC,KAAG6B,CAAC,CAAC6E,WAAT,EAAqB;AAAC,cAAM1G,CAAC,GAAC,KAAK2G,wBAAL,CAA8B,SAA9B,EAAyC7B,SAAjD;AAA2DvE,QAAAA,CAAC,GAACuD,CAAC,CAACzD,CAAD,EAAGL,CAAH,EAAK6B,CAAC,CAAC+E,OAAP,CAAH;AAAmB,OAApG,MAAyG,IAAG5G,CAAC,GAAC6B,CAAC,CAAC6E,WAAP,EAAmB;AAAC,cAAM1G,CAAC,GAAC,KAAK2G,wBAAL,CAA8B,aAA9B,CAAR;AAAqDpG,QAAAA,CAAC,GAACuD,CAAC,CAACzD,CAAD,EAAGL,CAAC,CAAC8E,SAAL,EAAenD,CAAC,CAAC3B,CAAC,CAACyG,MAAH,CAAhB,CAAH;AAA+B;AAAC;;AAAA,UAAMhG,CAAC,GAAC,EAAR;AAAA,UAAWE,CAAC,GAAC;AAACkG,MAAAA,sBAAsB,EAACtG,CAAxB;AAA0B,SAAGJ;AAA7B,KAAb;AAA6C,QAAIU,CAAC,GAACN,CAAN;AAAQF,IAAAA,CAAC,CAACyG,OAAF,CAAW9G,CAAC,IAAE;AAAC,YAAMC,CAAC,GAACD,CAAC,CAAC+G,KAAF,CAAQ,EAAR,EAAWpG,CAAX,CAAR;AAAsBF,MAAAA,CAAC,CAACuG,IAAF,CAAO/G,CAAP,GAAUY,CAAC,GAACA,CAAC,IAAE,WAASb,CAAC,CAACiH,QAAF,CAAW,SAAX,CAAxB;AAA8C,KAAnF;AAAsFxG,IAAAA,CAAC,CAACyG,IAAF,CAAQlH,CAAC,IAAEmH,MAAM,CAACC,IAAP,CAAYpH,CAAZ,EAAeqH,MAAf,GAAsB,CAAjC,MAAuCpH,CAAC,CAACqH,MAAF,GAAS7G,CAAhD,GAAmDI,CAAC,KAAGZ,CAAC,CAACsH,aAAF,GAAgBlH,CAAC,CAACmH,MAAF,CAAUxH,CAAC,IAAEA,CAAC,CAACyH,OAAf,EAAyBC,GAAzB,CAA8B1H,CAAC,IAAEA,CAAC,CAAC2H,EAAnC,CAAnB,CAApD;AAAgH;;AAAAC,EAAAA,2BAA2B,CAAC5H,CAAD,EAAGC,CAAH,EAAKC,CAAL,EAAOC,CAAP,EAAS;AAAC,UAAME,CAAC,GAACF,CAAC,IAAEA,CAAC,CAAC0H,UAAL,IAAiB,CAAzB;AAA2B7H,IAAAA,CAAC,IAAE,KAAK8H,OAAL,IAAc,EAAjB,KAAsB9H,CAAC,GAACA,CAAC,CAAC+H,KAAF,GAAUC,oBAAV,EAAxB;AAA0D,UAAMzH,CAAC,GAAC,IAAIoD,CAAJ,CAAM;AAACsE,MAAAA,KAAK,EAAC,IAAP;AAAYC,MAAAA,MAAM,EAAC,QAAM/H,CAAN,GAAQ,KAAK,CAAb,GAAeA,CAAC,CAAC+H,MAApC;AAA2CC,MAAAA,KAAK,EAACnG,CAAC,CAAC;AAACoG,QAAAA,MAAM,EAACpI,CAAR;AAAUqI,QAAAA,KAAK,EAACpI;AAAhB,OAAD,CAAD,GAAsBI;AAAvE,KAAN,CAAR;AAAA,UAAyFI,CAAC,GAACF,CAAC,CAAC+H,MAAF,EAA3F;AAAsG/H,IAAAA,CAAC,CAACgI,OAAF;AAAY,UAAM5H,CAAC,GAAC,CAACR,CAAD,IAAI,CAACA,CAAC,CAACqI,QAAP,IAAiB,KAAKV,OAAL,GAAa,IAA9B,GAAmC,EAAnC,GAAsC;AAACU,MAAAA,QAAQ,EAAC,CAACrI,CAAC,CAACqI;AAAb,KAA9C;AAAA,UAAqE3H,CAAC,GAACb,CAAC,IAAEA,CAAC,CAACyI,gBAA5E;AAAA,UAA6F1H,CAAC,GAACF,CAAC,CAAC6H,IAAF,IAAQC,IAAI,CAACC,SAAL,CAAe/H,CAAC,CAACyH,MAAF,EAAf,CAAvG;AAAkI7H,IAAAA,CAAC,CAAC2D,GAAF,IAAO/D,CAAP;AAAS,UAAMY,CAAC,GAAC,EAAR;;AAAW,QAAG,QAAMd,CAAN,IAASA,CAAC,CAAC0I,UAAd,EAAyB;AAAC,YAAK;AAACC,QAAAA,KAAK,EAAC9I,CAAP;AAAS+I,QAAAA,GAAG,EAAC9I;AAAb,UAAgBE,CAAC,CAAC0I,UAAF,CAAaP,MAAb,EAArB;AAA2CrH,MAAAA,CAAC,CAAC+H,IAAF,GAAOhJ,CAAC,IAAEC,CAAH,IAAMD,CAAC,KAAGC,CAAV,GAAY,KAAGD,CAAf,GAAkB,GAAE,QAAMA,CAAN,GAAQ,MAAR,GAAeA,CAAE,IAAG,QAAMC,CAAN,GAAQ,MAAR,GAAeA,CAAE,EAAhE;AAAkE,KAAvI,MAA4I,KAAKgJ,QAAL,IAAe,CAAC,KAAKA,QAAL,CAAcC,WAA9B,KAA4CjI,CAAC,CAAC+H,IAAF,GAAO,WAAnD;;AAAgE,WAAM;AAACG,MAAAA,IAAI,EAACnJ,CAAC,IAAEA,CAAC,CAACoJ,IAAF,GAAO,GAAP,GAAWpJ,CAAC,CAACqJ,IAAb,GAAkB,GAAlB,GAAsBrJ,CAAC,CAACsJ,IAAxB,GAA6B,GAA7B,GAAiCtJ,CAAC,CAACuJ,IAA5C;AAAiDC,MAAAA,MAAM,EAACzI,CAAxD;AAA0D0I,MAAAA,OAAO,EAAC1I,CAAlE;AAAoE2I,MAAAA,IAAI,EAACzJ,CAAC,GAAC,GAAF,GAAMC,CAA/E;AAAiF,SAAGO,CAApF;AAAsF,SAAGE,CAAzF;AAA2F,SAAGM;AAA9F,KAAN;AAAuG;;AAAgB,QAAV0I,UAAU,CAAC3J,CAAD,EAAGE,CAAH,EAAKG,CAAL,EAAOE,CAAP,EAAS;AAAC,QAAIE,CAAJ;AAAM,UAAME,CAAC,GAAC;AAACiJ,MAAAA,YAAY,EAAC,OAAd;AAAsB1E,MAAAA,MAAM,EAAC,SAAOzE,CAAC,GAAC,QAAMF,CAAN,GAAQ,KAAK,CAAb,GAAeA,CAAC,CAAC2E,MAA1B,IAAkCzE,CAAlC,GAAoC,IAAjE;AAAsEoJ,MAAAA,KAAK,EAAC,EAAC,GAAG,KAAKC,SAAL,CAAeD,KAAnB;AAAyB,WAAG,KAAKjC,2BAAL,CAAiC5H,CAAjC,EAAmCE,CAAnC,EAAqCG,CAArC,EAAuCE,CAAvC,CAA5B;AAAsEsB,QAAAA,CAAC,EAAC,OAAxE;AAAgF,WAAG,KAAKkI,iBAAxF;AAA0G,WAAG,KAAKC,gBAAlH;AAAmIC,QAAAA,KAAK,EAAC,KAAKC;AAA9I;AAA5E,KAAR;AAAA,UAA2OrJ,CAAC,GAAC,KAAKiJ,SAAL,CAAeK,IAAf,GAAoB,SAAjQ;AAA2Q,QAAG,QAAMxJ,CAAC,CAACkJ,KAAF,CAAQO,aAAd,IAA6B,CAAC,KAAKhE,YAAL,CAAkBG,SAAlB,CAA4BC,qBAA7D,EAAmF,OAAOf,OAAO,CAAC4E,MAAR,CAAe,IAAIlK,CAAJ,CAAM,0CAAN,EAAkD,WAAU,KAAKqD,GAAI,8HAArE,EAAmM;AAACqG,MAAAA,KAAK,EAAClJ,CAAC,CAACkJ;AAAT,KAAnM,CAAf,CAAP;AAA2O,WAAO5J,CAAC,CAACY,CAAD,EAAGF,CAAH,CAAD,CAAO4E,IAAP,CAAavF,CAAC,IAAEA,CAAC,CAACsK,IAAlB,EAAyBhF,KAAzB,CAAgCtF,CAAC,IAAE;AAAC,UAAGe,CAAC,CAACf,CAAD,CAAJ,EAAQ,MAAMA,CAAN;AAAQ,YAAM,IAAIG,CAAJ,CAAM,iCAAN,EAAyC,yBAAwBU,CAAE,EAAnE,EAAqE;AAAC0J,QAAAA,KAAK,EAACvK;AAAP,OAArE,CAAN;AAAsF,KAA1I,CAAP;AAAoJ;;AAA4B,QAAtBwK,sBAAsB,GAAM;AAAA,QAALxK,CAAK,uEAAH,EAAG;AAAC,UAAMG,CAAC,GAAC,EAAC,GAAGH,CAAJ;AAAM6J,MAAAA,KAAK,EAAC;AAACY,QAAAA,aAAa,EAAC,CAAC,CAAhB;AAAkB5I,QAAAA,CAAC,EAAC,MAApB;AAA2B,WAAG,KAAKmI,gBAAnC;AAAoDC,QAAAA,KAAK,EAAC,KAAKC;AAA/D;AAAZ,KAAR;AAAA,UAA4F;AAACI,MAAAA,IAAI,EAACjK;AAAN,QAAS,MAAMJ,CAAC,CAAC,KAAKuD,GAAN,EAAUrD,CAAV,CAA5G;AAAA,UAAyH;AAACiI,MAAAA,MAAM,EAAC7H,CAAR;AAAUmK,MAAAA,UAAU,EAACjK,CAArB;AAAuBoI,MAAAA,UAAU,EAAClI;AAAlC,QAAqCN,CAA9J;AAAA,UAAgKQ,CAAC,GAACN,CAAC,IAAEE,CAArK;AAAuK,WAAM;AAACiK,MAAAA,UAAU,EAAC7J,CAAC,IAAEiB,CAAC,CAAC6I,QAAF,CAAW9J,CAAX,CAAf;AAA6BgI,MAAAA,UAAU,EAAClI,CAAC,IAAET,CAAC,CAACyK,QAAF,CAAW;AAAC7B,QAAAA,KAAK,EAACnI,CAAC,CAAC,CAAD,CAAR;AAAYoI,QAAAA,GAAG,EAACpI,CAAC,CAAC,CAAD;AAAjB,OAAX;AAA3C,KAAN;AAAoF;;AAAAL,EAAAA,OAAO,GAAE;AAAC,WAAOC,CAAC,CAAC,IAAD,EAAOP,CAAC,IAAE;AAACA,MAAAA,CAAC,CAAC,KAAK4K,YAAN,CAAD;AAAqB,KAAhC,CAAR;AAA2C;;AAAA7G,EAAAA,+BAA+B,CAAC/D,CAAD,EAAG;AAAC,WAAOgE,CAAC,CAAC,IAAD,EAAMhE,CAAN,CAAR;AAAiB;;AAAmB,QAAbwF,aAAa,CAACxF,CAAD,EAAG;AAAC,QAAG,KAAK6E,UAAR,EAAmB,OAAO,KAAK,KAAKgG,IAAL,CAAU,KAAKhG,UAAf,EAA0B;AAAC4B,MAAAA,MAAM,EAAC,SAAR;AAAkBjD,MAAAA,GAAG,EAAC,KAAKsG;AAA3B,KAA1B,CAAZ;AAA6E,UAAK;AAACQ,MAAAA,IAAI,EAACpK,CAAN;AAAQ4K,MAAAA,GAAG,EAAC3K;AAAZ,QAAe,MAAMF,CAAC,CAAC,KAAK6J,SAAL,CAAeK,IAAhB,EAAqB;AAACN,MAAAA,KAAK,EAAC;AAAChI,QAAAA,CAAC,EAAC,MAAH;AAAU,WAAG,KAAKiI,SAAL,CAAeD,KAA5B;AAAkC,WAAG,KAAKG,gBAA1C;AAA2DC,QAAAA,KAAK,EAAC,KAAKC;AAAtE,OAAP;AAAqFhF,MAAAA,MAAM,EAAClF;AAA5F,KAArB,CAA3B;AAAgJG,IAAAA,CAAC,KAAG,KAAKqD,GAAL,GAAS,KAAKA,GAAL,CAASuH,OAAT,CAAiB,SAAjB,EAA2B,QAA3B,CAAZ,CAAD,EAAmD,KAAKlG,UAAL,GAAgB3E,CAAnE,EAAqE,KAAK2K,IAAL,CAAU3K,CAAV,EAAY;AAACuG,MAAAA,MAAM,EAAC,SAAR;AAAkBjD,MAAAA,GAAG,EAAC,KAAKsG;AAA3B,KAAZ,CAArE;AAAwH;;AAA5nH,CAA7D;AAA2rH9J,CAAC,CAAC,CAACiB,CAAC,CAAC;AAAC8D,EAAAA,IAAI,EAACiG;AAAN,CAAD,CAAF,CAAD,EAAqB/G,CAAC,CAACgH,SAAvB,EAAiC,wBAAjC,EAA0D,KAAK,CAA/D,CAAD,EAAmEjL,CAAC,CAAC,CAACiB,CAAC,EAAF,CAAD,EAAOgD,CAAC,CAACgH,SAAT,EAAmB,KAAnB,EAAyB,KAAK,CAA9B,CAApE,EAAqGjL,CAAC,CAAC,CAACiB,CAAC,EAAF,CAAD,EAAOgD,CAAC,CAACgH,SAAT,EAAmB,YAAnB,EAAgC,KAAK,CAArC,CAAtG,EAA8IjL,CAAC,CAAC,CAACiB,CAAC,EAAF,CAAD,EAAOgD,CAAC,CAACgH,SAAT,EAAmB,aAAnB,EAAiC,KAAK,CAAtC,CAA/I,EAAwLjL,CAAC,CAAC,CAACqB,CAAC,CAAC,aAAD,EAAe,CAAC,2BAAD,CAAf,CAAF,CAAD,EAAkD4C,CAAC,CAACgH,SAApD,EAA8D,iBAA9D,EAAgF,IAAhF,CAAzL,EAA+QjL,CAAC,CAAC,CAACiB,CAAC,CAAC;AAACiK,EAAAA,IAAI,EAAC;AAACC,IAAAA,OAAO,EAAC;AAACC,MAAAA,OAAO,EAAC;AAACP,QAAAA,IAAI,EAAC;AAACQ,UAAAA,MAAM,EAAC;AAAR;AAAN;AAAT;AAAT;AAAN,CAAD,CAAF,CAAD,EAAkEpH,CAAC,CAACgH,SAApE,EAA8E,gBAA9E,EAA+F,KAAK,CAApG,CAAhR,EAAuXjL,CAAC,CAAC,CAACiB,CAAC,CAAC;AAACiK,EAAAA,IAAI,EAAC;AAACC,IAAAA,OAAO,EAAC;AAACC,MAAAA,OAAO,EAAC;AAACP,QAAAA,IAAI,EAAC;AAACQ,UAAAA,MAAM,EAAC;AAAR;AAAN;AAAT;AAAT;AAAN,CAAD,CAAF,CAAD,EAAiEpH,CAAC,CAACgH,SAAnE,EAA6E,eAA7E,EAA6F,KAAK,CAAlG,CAAxX,EAA6djL,CAAC,CAAC,CAACiB,CAAC,EAAF,CAAD,EAAOgD,CAAC,CAACgH,SAAT,EAAmB,mBAAnB,EAAuC,KAAK,CAA5C,CAA9d,EAA6gBjL,CAAC,CAAC,CAACiB,CAAC,CAAC;AAAC8D,EAAAA,IAAI,EAACiG,OAAN;AAAcE,EAAAA,IAAI,EAAC;AAACL,IAAAA,IAAI,EAAC,CAAC,CAAP;AAAS9D,IAAAA,KAAK,EAAC;AAACuE,MAAAA,OAAO,EAAC,CAAC,CAAV;AAAYC,MAAAA,cAAc,EAAC,OAAK;AAACD,QAAAA,OAAO,EAAC,CAAC;AAAV,OAAL;AAA3B;AAAf;AAAnB,CAAD,CAAF,CAAD,EAAyFrH,CAAC,CAACgH,SAA3F,EAAqG,aAArG,EAAmH,KAAK,CAAxH,CAA9gB,EAAyoBjL,CAAC,CAAC,CAACiB,CAAC,CAAC;AAACiK,EAAAA,IAAI,EAAC;AAACL,IAAAA,IAAI,EAAC,CAAC,CAAP;AAAS9D,IAAAA,KAAK,EAAC,CAAC;AAAhB;AAAN,CAAD,CAAF,CAAD,EAAgC9C,CAAC,CAACgH,SAAlC,EAA4C,eAA5C,EAA4D,KAAK,CAAjE,CAA1oB,EAA8sBjL,CAAC,CAAC,CAACiB,CAAC,CAAC;AAAC8D,EAAAA,IAAI,EAAC,CAAC,uBAAD;AAAN,CAAD,CAAF,CAAD,EAAuCd,CAAC,CAACgH,SAAzC,EAAmD,sBAAnD,EAA0E,KAAK,CAA/E,CAA/sB,EAAiyBjL,CAAC,CAAC,CAACiB,CAAC,CAAC;AAACiK,EAAAA,IAAI,EAAC;AAACL,IAAAA,IAAI,EAAC,CAAC,CAAP;AAAS9D,IAAAA,KAAK,EAAC,CAAC;AAAhB;AAAN,CAAD,CAAF,CAAD,EAAgC9C,CAAC,CAACgH,SAAlC,EAA4C,cAA5C,EAA2D,KAAK,CAAhE,CAAlyB,EAAq2BjL,CAAC,CAAC,CAACiB,CAAC,EAAF,CAAD,EAAOgD,CAAC,CAACgH,SAAT,EAAmB,YAAnB,EAAgC,KAAK,CAArC,CAAt2B,EAA84BjL,CAAC,CAAC,CAACiB,CAAC,CAAC;AAACiK,EAAAA,IAAI,EAAC;AAACnE,IAAAA,KAAK,EAAC;AAACyE,MAAAA,YAAY,EAAC,CAAC;AAAf;AAAP;AAAN,CAAD,CAAF,CAAD,EAAuCvH,CAAC,CAACgH,SAAzC,EAAmD,WAAnD,EAA+D,KAAK,CAApE,CAA/4B,EAAs9BjL,CAAC,CAAC,CAACyB,CAAC,CAAC,WAAD,EAAa;AAAC6F,EAAAA,MAAM,EAAC;AAACvC,IAAAA,IAAI,EAAC,CAACnB,CAAD;AAAN,GAAR;AAAmB2D,EAAAA,aAAa,EAAC;AAACxC,IAAAA,IAAI,EAAC,CAAC5D,CAAD;AAAN;AAAjC,CAAb,CAAF,CAAD,EAA+D8C,CAAC,CAACgH,SAAjE,EAA2E,gBAA3E,EAA4F,IAA5F,CAAv9B,EAAyjCjL,CAAC,CAAC,CAACiB,CAAC,CAAC;AAAC8D,EAAAA,IAAI,EAAC,CAAC,MAAD,EAAQ,MAAR,EAAe,eAAf;AAAN,CAAD,CAAF,CAAD,EAA6Cd,CAAC,CAACgH,SAA/C,EAAyD,UAAzD,EAAoE,KAAK,CAAzE,CAA1jC,EAAsoCjL,CAAC,CAAC,CAACiB,CAAC,CAAC;AAACiK,EAAAA,IAAI,EAAC;AAACL,IAAAA,IAAI,EAAC,CAAC;AAAP,GAAN;AAAgBY,EAAAA,QAAQ,EAAC,CAAC,CAA1B;AAA4BC,EAAAA,KAAK,EAAC;AAAlC,CAAD,CAAF,CAAD,EAAqDzH,CAAC,CAACgH,SAAvD,EAAiE,MAAjE,EAAwE,KAAK,CAA7E,CAAvoC,EAAutCjL,CAAC,CAAC,CAACiB,CAAC,CAACwC,CAAD,CAAF,CAAD,EAAQQ,CAAC,CAACgH,SAAV,EAAoB,KAApB,EAA0B,KAAK,CAA/B,CAAxtC,EAA0vChH,CAAC,GAACjE,CAAC,CAAC,CAACuB,CAAC,CAAC,2BAAD,CAAF,CAAD,EAAkC0C,CAAlC,CAA7vC;AAAkyC,MAAM0H,CAAC,GAAC1H,CAAR;AAAU,SAAO0H,CAAC,IAAIC,OAAZ","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../chunks/tslib.es6.js\";import r from\"../request.js\";import t from\"../TimeExtent.js\";import o from\"../core/Error.js\";import{HandleOwnerMixin as i}from\"../core/HandleOwner.js\";import{loadAll as s}from\"../core/loadAll.js\";import{isSome as a}from\"../core/maybe.js\";import{MultiOriginJSONMixin as p}from\"../core/MultiOriginJSONSupport.js\";import{throwIfAbortError as n,isAbortError as m}from\"../core/promiseUtils.js\";import{property as l}from\"../core/accessorSupport/decorators/property.js\";import\"../core/arrayUtils.js\";import\"../core/has.js\";import{Integer as c}from\"../core/accessorSupport/ensureType.js\";import{reader as u}from\"../core/accessorSupport/decorators/reader.js\";import{subclass as y}from\"../core/accessorSupport/decorators/subclass.js\";import{writer as d}from\"../core/accessorSupport/decorators/writer.js\";import{nameToId as h,OriginId as f}from\"../core/accessorSupport/PropertyOrigin.js\";import g from\"../geometry/Extent.js\";import{getScale as v}from\"../geometry/support/scaleUtils.js\";import j from\"./Layer.js\";import{APIKeyMixin as x}from\"./mixins/APIKeyMixin.js\";import{ArcGISMapService as b}from\"./mixins/ArcGISMapService.js\";import{ArcGISService as S}from\"./mixins/ArcGISService.js\";import{BlendLayer as O}from\"./mixins/BlendLayer.js\";import{CustomParametersMixin as w}from\"./mixins/CustomParametersMixin.js\";import{OperationalLayer as I}from\"./mixins/OperationalLayer.js\";import{PortalLayer as E}from\"./mixins/PortalLayer.js\";import{RefreshableLayer as L}from\"./mixins/RefreshableLayer.js\";import{ScaleRangeLayer as P}from\"./mixins/ScaleRangeLayer.js\";import{SublayersOwner as M}from\"./mixins/SublayersOwner.js\";import{TemporalLayer as T}from\"./mixins/TemporalLayer.js\";import{url as U}from\"./support/commonProperties.js\";import{ExportImageParameters as R}from\"./support/ExportImageParameters.js\";import N from\"./support/Sublayer.js\";import{shouldWriteSublayerStructure as A}from\"./support/sublayerUtils.js\";import{serviceSupportsSpatialReference as J}from\"./support/versionUtils.js\";let q=class extends(O(T(P(M(b(S(I(E(p(L(x(w(i(j)))))))))))))){constructor(...e){super(...e),this.datesInUnknownTimezone=!1,this.dpi=96,this.gdbVersion=null,this.imageFormat=\"png24\",this.imageMaxHeight=2048,this.imageMaxWidth=2048,this.imageTransparency=!0,this.isReference=null,this.labelsVisible=!1,this.operationalLayerType=\"ArcGISMapServiceLayer\",this.sourceJSON=null,this.sublayers=null,this.type=\"map-image\",this.url=null}normalizeCtorArgs(e,r){return\"string\"==typeof e?{url:e,...r}:e}load(e){const r=a(e)?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:[\"Map Service\"]},e).catch(n).then((()=>this._fetchService(r)))),Promise.resolve(this)}readImageFormat(e,r){const t=r.supportedImageFormatTypes;return t&&t.indexOf(\"PNG32\")>-1?\"png32\":\"png24\"}writeSublayers(e,r,t,o){if(!this.loaded||!e)return;const i=e.slice().reverse().flatten((({sublayers:e})=>e&&e.toArray().reverse())).toArray();let s=!1;if(this.capabilities&&this.capabilities.operations.supportsExportMap&&this.capabilities.exportMap.supportsDynamicLayers){const e=h(o.origin);if(e===f.PORTAL_ITEM){const e=this.createSublayersForOrigin(\"service\").sublayers;s=A(i,e,f.SERVICE)}else if(e>f.PORTAL_ITEM){const e=this.createSublayersForOrigin(\"portal-item\");s=A(i,e.sublayers,h(e.origin))}}const a=[],p={writeSublayerStructure:s,...o};let n=s;i.forEach((e=>{const r=e.write({},p);a.push(r),n=n||\"user\"===e.originOf(\"visible\")}));a.some((e=>Object.keys(e).length>1))&&(r.layers=a),n&&(r.visibleLayers=i.filter((e=>e.visible)).map((e=>e.id)))}createExportImageParameters(e,r,t,o){const i=o&&o.pixelRatio||1;e&&this.version>=10&&(e=e.clone().shiftCentralMeridian());const s=new R({layer:this,floors:null==o?void 0:o.floors,scale:v({extent:e,width:r})*i}),a=s.toJSON();s.destroy();const p=!o||!o.rotation||this.version<10.3?{}:{rotation:-o.rotation},n=e&&e.spatialReference,m=n.wkid||JSON.stringify(n.toJSON());a.dpi*=i;const l={};if(null!=o&&o.timeExtent){const{start:e,end:r}=o.timeExtent.toJSON();l.time=e&&r&&e===r?\"\"+e:`${null==e?\"null\":e},${null==r?\"null\":r}`}else this.timeInfo&&!this.timeInfo.hasLiveData&&(l.time=\"null,null\");return{bbox:e&&e.xmin+\",\"+e.ymin+\",\"+e.xmax+\",\"+e.ymax,bboxSR:m,imageSR:m,size:r+\",\"+t,...a,...p,...l}}async fetchImage(e,t,i,s){var a;const p={responseType:\"image\",signal:null!=(a=null==s?void 0:s.signal)?a:null,query:{...this.parsedUrl.query,...this.createExportImageParameters(e,t,i,s),f:\"image\",...this.refreshParameters,...this.customParameters,token:this.apiKey}},n=this.parsedUrl.path+\"/export\";if(null!=p.query.dynamicLayers&&!this.capabilities.exportMap.supportsDynamicLayers)return Promise.reject(new o(\"mapimagelayer:dynamiclayer-not-supported\",`service ${this.url} doesn't support dynamic layers, which is required to be able to change the sublayer's order, rendering, labeling or source.`,{query:p.query}));return r(n,p).then((e=>e.data)).catch((e=>{if(m(e))throw e;throw new o(\"mapimagelayer:image-fetch-error\",`Unable to load image: ${n}`,{error:e})}))}async fetchRecomputedExtents(e={}){const o={...e,query:{returnUpdates:!0,f:\"json\",...this.customParameters,token:this.apiKey}},{data:i}=await r(this.url,o),{extent:s,fullExtent:a,timeExtent:p}=i,n=s||a;return{fullExtent:n&&g.fromJSON(n),timeExtent:p&&t.fromJSON({start:p[0],end:p[1]})}}loadAll(){return s(this,(e=>{e(this.allSublayers)}))}serviceSupportsSpatialReference(e){return J(this,e)}async _fetchService(e){if(this.sourceJSON)return void this.read(this.sourceJSON,{origin:\"service\",url:this.parsedUrl});const{data:t,ssl:o}=await r(this.parsedUrl.path,{query:{f:\"json\",...this.parsedUrl.query,...this.customParameters,token:this.apiKey},signal:e});o&&(this.url=this.url.replace(/^http:/i,\"https:\")),this.sourceJSON=t,this.read(t,{origin:\"service\",url:this.parsedUrl})}};e([l({type:Boolean})],q.prototype,\"datesInUnknownTimezone\",void 0),e([l()],q.prototype,\"dpi\",void 0),e([l()],q.prototype,\"gdbVersion\",void 0),e([l()],q.prototype,\"imageFormat\",void 0),e([u(\"imageFormat\",[\"supportedImageFormatTypes\"])],q.prototype,\"readImageFormat\",null),e([l({json:{origins:{service:{read:{source:\"maxImageHeight\"}}}}})],q.prototype,\"imageMaxHeight\",void 0),e([l({json:{origins:{service:{read:{source:\"maxImageWidth\"}}}}})],q.prototype,\"imageMaxWidth\",void 0),e([l()],q.prototype,\"imageTransparency\",void 0),e([l({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],q.prototype,\"isReference\",void 0),e([l({json:{read:!1,write:!1}})],q.prototype,\"labelsVisible\",void 0),e([l({type:[\"ArcGISMapServiceLayer\"]})],q.prototype,\"operationalLayerType\",void 0),e([l({json:{read:!1,write:!1}})],q.prototype,\"popupEnabled\",void 0),e([l()],q.prototype,\"sourceJSON\",void 0),e([l({json:{write:{ignoreOrigin:!0}}})],q.prototype,\"sublayers\",void 0),e([d(\"sublayers\",{layers:{type:[N]},visibleLayers:{type:[c]}})],q.prototype,\"writeSublayers\",null),e([l({type:[\"show\",\"hide\",\"hide-children\"]})],q.prototype,\"listMode\",void 0),e([l({json:{read:!1},readOnly:!0,value:\"map-image\"})],q.prototype,\"type\",void 0),e([l(U)],q.prototype,\"url\",void 0),q=e([y(\"esri.layers.MapImageLayer\")],q);const F=q;export{F as default};\n"]},"metadata":{},"sourceType":"module"}