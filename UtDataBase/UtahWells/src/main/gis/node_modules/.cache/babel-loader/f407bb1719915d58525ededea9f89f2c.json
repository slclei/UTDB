{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport t from \"../../Graphic.js\";\nimport { isNone as e, isSome as r } from \"../../core/maybe.js\";\nimport o from \"../../geometry/Extent.js\";\nimport s from \"../../geometry/Mesh.js\";\nimport n from \"../../geometry/Point.js\";\nimport { fromAxisAndAngle as a } from \"../../geometry/support/axisAngleDegrees.js\";\nimport i from \"../../geometry/support/MeshTransform.js\";\nimport { AssetMapFieldRole as u, Status as f } from \"../../layers/support/infoFor3D.js\";\nimport m from \"./FeatureSet.js\";\n\nfunction l(o, s, n) {\n  const a = n.features;\n  n.features = [], delete n.geometryType;\n  const i = m.fromJSON(n);\n  i.geometryType = \"mesh\";\n  const u = i.spatialReference,\n        f = e(o.outFields) || !o.outFields.length ? () => ({}) : c(o.outFields.includes(\"*\") ? null : new Set(o.outFields));\n\n  for (const e of a) {\n    const o = p(e, u, s);\n    r(o) && i.features.push(new t({\n      geometry: o,\n      attributes: f(e)\n    }));\n  }\n\n  return i;\n}\n\nfunction c(t) {\n  return _ref => {\n    let {\n      attributes: e\n    } = _ref;\n    if (!e) return {};\n    if (!t) return e;\n\n    for (const r in e) t.has(r) || delete e[r];\n\n    return e;\n  };\n}\n\nfunction p(t, e, r) {\n  const {\n    status: n,\n    source: a\n  } = D(t);\n  if (n === y.FAILED) return null;\n  const i = g(t, e, r),\n        u = o.fromJSON(t.geometry);\n  u.spatialReference = e;\n  const f = E(t, r);\n  return n === y.PENDING ? s.createIncomplete(i, {\n    extent: u,\n    transform: f\n  }) : s.createWithExternalSource(i, a, {\n    extent: u,\n    transform: f\n  });\n}\n\nfunction g(_ref2, e, _ref3) {\n  let {\n    attributes: t\n  } = _ref2;\n  let {\n    transformFieldRoles: r\n  } = _ref3;\n  return new n({\n    x: t[r.originX],\n    y: t[r.originY],\n    z: t[r.originZ],\n    spatialReference: e\n  });\n}\n\nfunction E(_ref4, _ref5) {\n  let {\n    attributes: t,\n    assetMappings: e\n  } = _ref4;\n  let {\n    transformFieldRoles: r\n  } = _ref5;\n  var o;\n  return new i({\n    translation: [t[r.translationX], t[r.translationY], t[r.translationZ]],\n    rotation: a([t[r.rotationX], t[r.rotationY], t[r.rotationZ]], t[r.rotationDeg]),\n    scale: [t[r.scaleX], t[r.scaleY], t[r.scaleZ]],\n    geographic: !(null != (o = e[u.flags]) && o.includes(\"PROJECT_VERTICES\"))\n  });\n}\n\nfunction D(t) {\n  if (!t.assetMappings) return {\n    status: y.FAILED\n  };\n  const e = [],\n        r = new Map();\n\n  for (const o of t.assetMappings) {\n    const t = o[u.seqNo],\n          s = o[u.assetName],\n          n = o[u.assetURL],\n          a = o[u.conversionStatus];\n    if (a === f.FAILED) return {\n      status: y.FAILED\n    };\n    if (a !== f.COMPLETED) return {\n      status: y.PENDING\n    };\n    if (null == t) e.push({\n      name: s,\n      source: n\n    });else {\n      const o = r.get(s);\n      let a;\n      o ? a = o.multipart : (a = [], e.push({\n        name: s,\n        source: {\n          multipart: a\n        }\n      }), r.set(s, {\n        multipart: a\n      })), a[t] = n;\n    }\n  }\n\n  return {\n    status: y.COMPLETED,\n    source: e\n  };\n}\n\nvar y;\n!function (t) {\n  t[t.FAILED = 0] = \"FAILED\", t[t.PENDING = 1] = \"PENDING\", t[t.COMPLETED = 2] = \"COMPLETED\";\n}(y || (y = {}));\nexport { l as meshFeatureSetFromJSON };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/rest/support/meshFeatureSet.js"],"names":["t","isNone","e","isSome","r","o","s","n","fromAxisAndAngle","a","i","AssetMapFieldRole","u","Status","f","m","l","features","geometryType","fromJSON","spatialReference","outFields","length","c","includes","Set","p","push","geometry","attributes","has","status","source","D","y","FAILED","g","E","PENDING","createIncomplete","extent","transform","createWithExternalSource","transformFieldRoles","x","originX","originY","z","originZ","assetMappings","translation","translationX","translationY","translationZ","rotation","rotationX","rotationY","rotationZ","rotationDeg","scale","scaleX","scaleY","scaleZ","geographic","flags","Map","seqNo","assetName","assetURL","conversionStatus","COMPLETED","name","get","multipart","set","meshFeatureSetFromJSON"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport t from\"../../Graphic.js\";import{isNone as e,isSome as r}from\"../../core/maybe.js\";import o from\"../../geometry/Extent.js\";import s from\"../../geometry/Mesh.js\";import n from\"../../geometry/Point.js\";import{fromAxisAndAngle as a}from\"../../geometry/support/axisAngleDegrees.js\";import i from\"../../geometry/support/MeshTransform.js\";import{AssetMapFieldRole as u,Status as f}from\"../../layers/support/infoFor3D.js\";import m from\"./FeatureSet.js\";function l(o,s,n){const a=n.features;n.features=[],delete n.geometryType;const i=m.fromJSON(n);i.geometryType=\"mesh\";const u=i.spatialReference,f=e(o.outFields)||!o.outFields.length?()=>({}):c(o.outFields.includes(\"*\")?null:new Set(o.outFields));for(const e of a){const o=p(e,u,s);r(o)&&i.features.push(new t({geometry:o,attributes:f(e)}))}return i}function c(t){return({attributes:e})=>{if(!e)return{};if(!t)return e;for(const r in e)t.has(r)||delete e[r];return e}}function p(t,e,r){const{status:n,source:a}=D(t);if(n===y.FAILED)return null;const i=g(t,e,r),u=o.fromJSON(t.geometry);u.spatialReference=e;const f=E(t,r);return n===y.PENDING?s.createIncomplete(i,{extent:u,transform:f}):s.createWithExternalSource(i,a,{extent:u,transform:f})}function g({attributes:t},e,{transformFieldRoles:r}){return new n({x:t[r.originX],y:t[r.originY],z:t[r.originZ],spatialReference:e})}function E({attributes:t,assetMappings:e},{transformFieldRoles:r}){var o;return new i({translation:[t[r.translationX],t[r.translationY],t[r.translationZ]],rotation:a([t[r.rotationX],t[r.rotationY],t[r.rotationZ]],t[r.rotationDeg]),scale:[t[r.scaleX],t[r.scaleY],t[r.scaleZ]],geographic:!(null!=(o=e[u.flags])&&o.includes(\"PROJECT_VERTICES\"))})}function D(t){if(!t.assetMappings)return{status:y.FAILED};const e=[],r=new Map;for(const o of t.assetMappings){const t=o[u.seqNo],s=o[u.assetName],n=o[u.assetURL],a=o[u.conversionStatus];if(a===f.FAILED)return{status:y.FAILED};if(a!==f.COMPLETED)return{status:y.PENDING};if(null==t)e.push({name:s,source:n});else{const o=r.get(s);let a;o?a=o.multipart:(a=[],e.push({name:s,source:{multipart:a}}),r.set(s,{multipart:a})),a[t]=n}}return{status:y.COMPLETED,source:e}}var y;!function(t){t[t.FAILED=0]=\"FAILED\",t[t.PENDING=1]=\"PENDING\",t[t.COMPLETED=2]=\"COMPLETED\"}(y||(y={}));export{l as meshFeatureSetFromJSON};\n"]},"metadata":{},"sourceType":"module"}