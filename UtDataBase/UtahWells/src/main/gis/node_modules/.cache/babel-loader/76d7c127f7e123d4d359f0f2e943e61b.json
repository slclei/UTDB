{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport { _ as t } from \"../../../chunks/tslib.es6.js\";\nimport \"../../../geometry.js\";\nimport e from \"../../../core/has.js\";\nimport o from \"../../../core/Loadable.js\";\nimport { isSome as r } from \"../../../core/maybe.js\";\nimport { debounce as s } from \"../../../core/promiseUtils.js\";\nimport { open as i } from \"../../../core/workers/workers.js\";\nimport { property as n } from \"../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../core/arrayUtils.js\";\nimport \"../../../core/accessorSupport/ensureType.js\";\nimport { subclass as a } from \"../../../core/accessorSupport/decorators/subclass.js\";\nimport c from \"../../../rest/support/FeatureSet.js\";\nimport l from \"../../../geometry/Extent.js\";\nlet u = class extends o {\n  constructor(t) {\n    super(t), this.type = \"csv\", this.refresh = s(async t => {\n      await this.load();\n      const {\n        extent: e,\n        timeExtent: o\n      } = await this._connection.invoke(\"refresh\", t);\n      return this.sourceJSON.extent = e, o && (this.sourceJSON.timeInfo.timeExtent = [o.start, o.end]), {\n        dataChanged: !0,\n        updates: {\n          extent: this.sourceJSON.extent,\n          timeInfo: this.sourceJSON.timeInfo\n        }\n      };\n    });\n  }\n\n  load(t) {\n    const e = r(t) ? t.signal : null;\n    return this.addResolvingPromise(this._startWorker(e)), Promise.resolve(this);\n  }\n\n  destroy() {\n    var t;\n    null == (t = this._connection) || t.close(), this._connection = null;\n  }\n\n  async openPorts() {\n    return await this.load(), this._connection.openPorts();\n  }\n\n  async queryFeatures(t) {\n    let e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    await this.load(e);\n    const o = await this._connection.invoke(\"queryFeatures\", t ? t.toJSON() : null, e);\n    return c.fromJSON(o);\n  }\n\n  async queryFeaturesJSON(t) {\n    let e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    return await this.load(e), this._connection.invoke(\"queryFeatures\", t ? t.toJSON() : null, e);\n  }\n\n  async queryFeatureCount(t) {\n    let e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    return await this.load(e), this._connection.invoke(\"queryFeatureCount\", t ? t.toJSON() : null, e);\n  }\n\n  async queryObjectIds(t) {\n    let e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    return await this.load(e), this._connection.invoke(\"queryObjectIds\", t ? t.toJSON() : null, e);\n  }\n\n  async queryExtent(t) {\n    let e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    await this.load(e);\n    const o = await this._connection.invoke(\"queryExtent\", t ? t.toJSON() : null, e);\n    return {\n      count: o.count,\n      extent: l.fromJSON(o.extent)\n    };\n  }\n\n  async querySnapping(t) {\n    let e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    return await this.load(e), this._connection.invoke(\"querySnapping\", t, e);\n  }\n\n  async _startWorker(t) {\n    this._connection = await i(\"CSVSourceWorker\", {\n      strategy: e(\"feature-layers-workers\") ? \"dedicated\" : \"local\",\n      signal: t\n    });\n    const {\n      url: o,\n      delimiter: r,\n      fields: s,\n      latitudeField: n,\n      longitudeField: a,\n      spatialReference: c,\n      timeInfo: l\n    } = this.loadOptions,\n          u = await this._connection.invoke(\"load\", {\n      url: o,\n      customParameters: this.customParameters,\n      parsingOptions: {\n        delimiter: r,\n        fields: null == s ? void 0 : s.map(t => t.toJSON()),\n        latitudeField: n,\n        longitudeField: a,\n        spatialReference: null == c ? void 0 : c.toJSON(),\n        timeInfo: null == l ? void 0 : l.toJSON()\n      }\n    }, {\n      signal: t\n    });\n    this.locationInfo = u.locationInfo, this.sourceJSON = u.layerDefinition, this.delimiter = u.delimiter;\n  }\n\n};\nt([n()], u.prototype, \"type\", void 0), t([n()], u.prototype, \"loadOptions\", void 0), t([n()], u.prototype, \"customParameters\", void 0), t([n()], u.prototype, \"locationInfo\", void 0), t([n()], u.prototype, \"sourceJSON\", void 0), t([n()], u.prototype, \"delimiter\", void 0), u = t([a(\"esri.layers.graphics.sources.CSVSource\")], u);\nconst p = u;\nexport { p as default };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/layers/graphics/sources/CSVSource.js"],"names":["_","t","e","o","isSome","r","debounce","s","open","i","property","n","subclass","a","c","l","u","constructor","type","refresh","load","extent","timeExtent","_connection","invoke","sourceJSON","timeInfo","start","end","dataChanged","updates","signal","addResolvingPromise","_startWorker","Promise","resolve","destroy","close","openPorts","queryFeatures","toJSON","fromJSON","queryFeaturesJSON","queryFeatureCount","queryObjectIds","queryExtent","count","querySnapping","strategy","url","delimiter","fields","latitudeField","longitudeField","spatialReference","loadOptions","customParameters","parsingOptions","map","locationInfo","layerDefinition","prototype","p","default"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../chunks/tslib.es6.js\";import\"../../../geometry.js\";import e from\"../../../core/has.js\";import o from\"../../../core/Loadable.js\";import{isSome as r}from\"../../../core/maybe.js\";import{debounce as s}from\"../../../core/promiseUtils.js\";import{open as i}from\"../../../core/workers/workers.js\";import{property as n}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/accessorSupport/ensureType.js\";import{subclass as a}from\"../../../core/accessorSupport/decorators/subclass.js\";import c from\"../../../rest/support/FeatureSet.js\";import l from\"../../../geometry/Extent.js\";let u=class extends o{constructor(t){super(t),this.type=\"csv\",this.refresh=s((async t=>{await this.load();const{extent:e,timeExtent:o}=await this._connection.invoke(\"refresh\",t);return this.sourceJSON.extent=e,o&&(this.sourceJSON.timeInfo.timeExtent=[o.start,o.end]),{dataChanged:!0,updates:{extent:this.sourceJSON.extent,timeInfo:this.sourceJSON.timeInfo}}}))}load(t){const e=r(t)?t.signal:null;return this.addResolvingPromise(this._startWorker(e)),Promise.resolve(this)}destroy(){var t;null==(t=this._connection)||t.close(),this._connection=null}async openPorts(){return await this.load(),this._connection.openPorts()}async queryFeatures(t,e={}){await this.load(e);const o=await this._connection.invoke(\"queryFeatures\",t?t.toJSON():null,e);return c.fromJSON(o)}async queryFeaturesJSON(t,e={}){return await this.load(e),this._connection.invoke(\"queryFeatures\",t?t.toJSON():null,e)}async queryFeatureCount(t,e={}){return await this.load(e),this._connection.invoke(\"queryFeatureCount\",t?t.toJSON():null,e)}async queryObjectIds(t,e={}){return await this.load(e),this._connection.invoke(\"queryObjectIds\",t?t.toJSON():null,e)}async queryExtent(t,e={}){await this.load(e);const o=await this._connection.invoke(\"queryExtent\",t?t.toJSON():null,e);return{count:o.count,extent:l.fromJSON(o.extent)}}async querySnapping(t,e={}){return await this.load(e),this._connection.invoke(\"querySnapping\",t,e)}async _startWorker(t){this._connection=await i(\"CSVSourceWorker\",{strategy:e(\"feature-layers-workers\")?\"dedicated\":\"local\",signal:t});const{url:o,delimiter:r,fields:s,latitudeField:n,longitudeField:a,spatialReference:c,timeInfo:l}=this.loadOptions,u=await this._connection.invoke(\"load\",{url:o,customParameters:this.customParameters,parsingOptions:{delimiter:r,fields:null==s?void 0:s.map((t=>t.toJSON())),latitudeField:n,longitudeField:a,spatialReference:null==c?void 0:c.toJSON(),timeInfo:null==l?void 0:l.toJSON()}},{signal:t});this.locationInfo=u.locationInfo,this.sourceJSON=u.layerDefinition,this.delimiter=u.delimiter}};t([n()],u.prototype,\"type\",void 0),t([n()],u.prototype,\"loadOptions\",void 0),t([n()],u.prototype,\"customParameters\",void 0),t([n()],u.prototype,\"locationInfo\",void 0),t([n()],u.prototype,\"sourceJSON\",void 0),t([n()],u.prototype,\"delimiter\",void 0),u=t([a(\"esri.layers.graphics.sources.CSVSource\")],u);const p=u;export{p as default};\n"]},"metadata":{},"sourceType":"module"}