{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport { isSome as s } from \"../../../../../core/maybe.js\";\nimport { j as e } from \"../../../../../chunks/mat4.js\";\nimport { c as i } from \"../../../../../chunks/mat4f64.js\";\nimport { g as a, f as o, b as c, m as l } from \"../../../../../chunks/vec3.js\";\nimport { Z as r, c as t } from \"../../../../../chunks/vec3f64.js\";\nimport { glsl as n } from \"../shaderModules/interfaces.js\";\n\nfunction f(s, e) {\n  if (e.slicePlaneEnabled) {\n    s.extensions.add(\"GL_OES_standard_derivatives\"), e.sliceEnabledForVertexPrograms && (s.vertex.uniforms.add(\"slicePlaneOrigin\", \"vec3\"), s.vertex.uniforms.add(\"slicePlaneBasis1\", \"vec3\"), s.vertex.uniforms.add(\"slicePlaneBasis2\", \"vec3\")), s.fragment.uniforms.add(\"slicePlaneOrigin\", \"vec3\"), s.fragment.uniforms.add(\"slicePlaneBasis1\", \"vec3\"), s.fragment.uniforms.add(\"slicePlaneBasis2\", \"vec3\");\n    const i = n`struct SliceFactors {\nfloat front;\nfloat side0;\nfloat side1;\nfloat side2;\nfloat side3;\n};\nSliceFactors calculateSliceFactors(vec3 pos) {\nvec3 rel = pos - slicePlaneOrigin;\nvec3 slicePlaneNormal = -cross(slicePlaneBasis1, slicePlaneBasis2);\nfloat slicePlaneW = -dot(slicePlaneNormal, slicePlaneOrigin);\nfloat basis1Len2 = dot(slicePlaneBasis1, slicePlaneBasis1);\nfloat basis2Len2 = dot(slicePlaneBasis2, slicePlaneBasis2);\nfloat basis1Dot = dot(slicePlaneBasis1, rel);\nfloat basis2Dot = dot(slicePlaneBasis2, rel);\nreturn SliceFactors(\ndot(slicePlaneNormal, pos) + slicePlaneW,\n-basis1Dot - basis1Len2,\nbasis1Dot - basis1Len2,\n-basis2Dot - basis2Len2,\nbasis2Dot - basis2Len2\n);\n}\nbool sliceByFactors(SliceFactors factors) {\nreturn factors.front < 0.0\n&& factors.side0 < 0.0\n&& factors.side1 < 0.0\n&& factors.side2 < 0.0\n&& factors.side3 < 0.0;\n}\nbool sliceEnabled() {\nreturn dot(slicePlaneBasis1, slicePlaneBasis1) != 0.0;\n}\nbool sliceByPlane(vec3 pos) {\nreturn sliceEnabled() && sliceByFactors(calculateSliceFactors(pos));\n}\n#define rejectBySlice(_pos_) sliceByPlane(_pos_)\n#define discardBySlice(_pos_) { if (sliceByPlane(_pos_)) discard; }`,\n          a = n`vec4 applySliceHighlight(vec4 color, vec3 pos) {\nSliceFactors factors = calculateSliceFactors(pos);\nconst float HIGHLIGHT_WIDTH = 1.0;\nconst vec4 HIGHLIGHT_COLOR = vec4(0.0, 0.0, 0.0, 0.3);\nfactors.front /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.front);\nfactors.side0 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side0);\nfactors.side1 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side1);\nfactors.side2 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side2);\nfactors.side3 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side3);\nif (sliceByFactors(factors)) {\nreturn color;\n}\nfloat highlightFactor = (1.0 - step(0.5, factors.front))\n* (1.0 - step(0.5, factors.side0))\n* (1.0 - step(0.5, factors.side1))\n* (1.0 - step(0.5, factors.side2))\n* (1.0 - step(0.5, factors.side3));\nreturn mix(color, vec4(HIGHLIGHT_COLOR.rgb, color.a), highlightFactor * HIGHLIGHT_COLOR.a);\n}`,\n          o = e.sliceHighlightDisabled ? n`#define highlightSlice(_color_, _pos_) (_color_)` : n`\n        ${a}\n        #define highlightSlice(_color_, _pos_) (sliceEnabled() ? applySliceHighlight(_color_, _pos_) : (_color_))\n      `;\n    e.sliceEnabledForVertexPrograms && s.vertex.code.add(i), s.fragment.code.add(i), s.fragment.code.add(o);\n  } else {\n    const i = n`#define rejectBySlice(_pos_) false\n#define discardBySlice(_pos_) {}\n#define highlightSlice(_color_, _pos_) (_color_)`;\n    e.sliceEnabledForVertexPrograms && s.vertex.code.add(i), s.fragment.code.add(i);\n  }\n}\n\nfunction d(s, e, i) {\n  _(s, e, i.slicePlane, {\n    origin: i.origin\n  });\n}\n\nfunction _(i, t, n, f) {\n  if (t.slicePlaneEnabled) if (s(n)) {\n    if (a(g, n.origin), a(m, n.basis1), a(P, n.basis2), s(f) && s(f.origin) && o(g, n.origin, f.origin), s(f) && s(f.view)) {\n      const i = s(f.origin) ? e(H, f.view, f.origin) : f.view;\n      c(m, m, g), c(P, P, g), l(g, g, i), l(m, m, i), l(P, P, i), o(m, m, g), o(P, P, g);\n    }\n\n    i.setUniform3fv(\"slicePlaneOrigin\", g), i.setUniform3fv(\"slicePlaneBasis1\", m), i.setUniform3fv(\"slicePlaneBasis2\", P);\n  } else i.setUniform3fv(\"slicePlaneBasis1\", r), i.setUniform3fv(\"slicePlaneBasis2\", r), i.setUniform3fv(\"slicePlaneOrigin\", r);\n}\n\nconst g = t(),\n      m = t(),\n      P = t(),\n      H = i();\nexport { f as Slice, _ as bindSliceUniforms, d as bindSliceUniformsWithOrigin };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/Slice.glsl.js"],"names":["isSome","s","j","e","c","i","g","a","f","o","b","m","l","Z","r","t","glsl","n","slicePlaneEnabled","extensions","add","sliceEnabledForVertexPrograms","vertex","uniforms","fragment","sliceHighlightDisabled","code","d","_","slicePlane","origin","basis1","P","basis2","view","H","setUniform3fv","Slice","bindSliceUniforms","bindSliceUniformsWithOrigin"],"mappings":"AAAA;AACA;AACA;AACA;AACA,SAAOA,MAAM,IAAIC,CAAjB,QAAuB,8BAAvB;AAAsD,SAAOC,CAAC,IAAIC,CAAZ,QAAkB,+BAAlB;AAAkD,SAAOC,CAAC,IAAIC,CAAZ,QAAkB,kCAAlB;AAAqD,SAAOC,CAAC,IAAIC,CAAZ,EAAcC,CAAC,IAAIC,CAAnB,EAAqBC,CAAC,IAAIN,CAA1B,EAA4BO,CAAC,IAAIC,CAAjC,QAAuC,+BAAvC;AAAuE,SAAOC,CAAC,IAAIC,CAAZ,EAAcV,CAAC,IAAIW,CAAnB,QAAyB,kCAAzB;AAA4D,SAAOC,IAAI,IAAIC,CAAf,QAAqB,gCAArB;;AAAsD,SAAST,CAAT,CAAWP,CAAX,EAAaE,CAAb,EAAe;AAAC,MAAGA,CAAC,CAACe,iBAAL,EAAuB;AAACjB,IAAAA,CAAC,CAACkB,UAAF,CAAaC,GAAb,CAAiB,6BAAjB,GAAgDjB,CAAC,CAACkB,6BAAF,KAAkCpB,CAAC,CAACqB,MAAF,CAASC,QAAT,CAAkBH,GAAlB,CAAsB,kBAAtB,EAAyC,MAAzC,GAAiDnB,CAAC,CAACqB,MAAF,CAASC,QAAT,CAAkBH,GAAlB,CAAsB,kBAAtB,EAAyC,MAAzC,CAAjD,EAAkGnB,CAAC,CAACqB,MAAF,CAASC,QAAT,CAAkBH,GAAlB,CAAsB,kBAAtB,EAAyC,MAAzC,CAApI,CAAhD,EAAsOnB,CAAC,CAACuB,QAAF,CAAWD,QAAX,CAAoBH,GAApB,CAAwB,kBAAxB,EAA2C,MAA3C,CAAtO,EAAyRnB,CAAC,CAACuB,QAAF,CAAWD,QAAX,CAAoBH,GAApB,CAAwB,kBAAxB,EAA2C,MAA3C,CAAzR,EAA4UnB,CAAC,CAACuB,QAAF,CAAWD,QAAX,CAAoBH,GAApB,CAAwB,kBAAxB,EAA2C,MAA3C,CAA5U;AAA+X,UAAMf,CAAC,GAACY,CAAE;AACvwB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oEArC6vB;AAAA,UAqCxrBV,CAAC,GAACU,CAAE;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAvD6vB;AAAA,UAuD1vBR,CAAC,GAACN,CAAC,CAACsB,sBAAF,GAAyBR,CAAE,kDAA3B,GAA6EA,CAAE;AACpF,UAAUV,CAAE;AACZ;AACA,OA1D6vB;AA0DrvBJ,IAAAA,CAAC,CAACkB,6BAAF,IAAiCpB,CAAC,CAACqB,MAAF,CAASI,IAAT,CAAcN,GAAd,CAAkBf,CAAlB,CAAjC,EAAsDJ,CAAC,CAACuB,QAAF,CAAWE,IAAX,CAAgBN,GAAhB,CAAoBf,CAApB,CAAtD,EAA6EJ,CAAC,CAACuB,QAAF,CAAWE,IAAX,CAAgBN,GAAhB,CAAoBX,CAApB,CAA7E;AAAoG,GA1D0P,MA0DtP;AAAC,UAAMJ,CAAC,GAACY,CAAE;AAC3H;AACA,iDAFiH;AAE/Dd,IAAAA,CAAC,CAACkB,6BAAF,IAAiCpB,CAAC,CAACqB,MAAF,CAASI,IAAT,CAAcN,GAAd,CAAkBf,CAAlB,CAAjC,EAAsDJ,CAAC,CAACuB,QAAF,CAAWE,IAAX,CAAgBN,GAAhB,CAAoBf,CAApB,CAAtD;AAA6E;AAAC;;AAAA,SAASsB,CAAT,CAAW1B,CAAX,EAAaE,CAAb,EAAeE,CAAf,EAAiB;AAACuB,EAAAA,CAAC,CAAC3B,CAAD,EAAGE,CAAH,EAAKE,CAAC,CAACwB,UAAP,EAAkB;AAACC,IAAAA,MAAM,EAACzB,CAAC,CAACyB;AAAV,GAAlB,CAAD;AAAsC;;AAAA,SAASF,CAAT,CAAWvB,CAAX,EAAaU,CAAb,EAAeE,CAAf,EAAiBT,CAAjB,EAAmB;AAAC,MAAGO,CAAC,CAACG,iBAAL,EAAuB,IAAGjB,CAAC,CAACgB,CAAD,CAAJ,EAAQ;AAAC,QAAGV,CAAC,CAACD,CAAD,EAAGW,CAAC,CAACa,MAAL,CAAD,EAAcvB,CAAC,CAACI,CAAD,EAAGM,CAAC,CAACc,MAAL,CAAf,EAA4BxB,CAAC,CAACyB,CAAD,EAAGf,CAAC,CAACgB,MAAL,CAA7B,EAA0ChC,CAAC,CAACO,CAAD,CAAD,IAAMP,CAAC,CAACO,CAAC,CAACsB,MAAH,CAAP,IAAmBrB,CAAC,CAACH,CAAD,EAAGW,CAAC,CAACa,MAAL,EAAYtB,CAAC,CAACsB,MAAd,CAA9D,EAAoF7B,CAAC,CAACO,CAAD,CAAD,IAAMP,CAAC,CAACO,CAAC,CAAC0B,IAAH,CAA9F,EAAuG;AAAC,YAAM7B,CAAC,GAACJ,CAAC,CAACO,CAAC,CAACsB,MAAH,CAAD,GAAY3B,CAAC,CAACgC,CAAD,EAAG3B,CAAC,CAAC0B,IAAL,EAAU1B,CAAC,CAACsB,MAAZ,CAAb,GAAiCtB,CAAC,CAAC0B,IAA3C;AAAgD9B,MAAAA,CAAC,CAACO,CAAD,EAAGA,CAAH,EAAKL,CAAL,CAAD,EAASF,CAAC,CAAC4B,CAAD,EAAGA,CAAH,EAAK1B,CAAL,CAAV,EAAkBM,CAAC,CAACN,CAAD,EAAGA,CAAH,EAAKD,CAAL,CAAnB,EAA2BO,CAAC,CAACD,CAAD,EAAGA,CAAH,EAAKN,CAAL,CAA5B,EAAoCO,CAAC,CAACoB,CAAD,EAAGA,CAAH,EAAK3B,CAAL,CAArC,EAA6CI,CAAC,CAACE,CAAD,EAAGA,CAAH,EAAKL,CAAL,CAA9C,EAAsDG,CAAC,CAACuB,CAAD,EAAGA,CAAH,EAAK1B,CAAL,CAAvD;AAA+D;;AAAAD,IAAAA,CAAC,CAAC+B,aAAF,CAAgB,kBAAhB,EAAmC9B,CAAnC,GAAsCD,CAAC,CAAC+B,aAAF,CAAgB,kBAAhB,EAAmCzB,CAAnC,CAAtC,EAA4EN,CAAC,CAAC+B,aAAF,CAAgB,kBAAhB,EAAmCJ,CAAnC,CAA5E;AAAkH,GAAlV,MAAuV3B,CAAC,CAAC+B,aAAF,CAAgB,kBAAhB,EAAmCtB,CAAnC,GAAsCT,CAAC,CAAC+B,aAAF,CAAgB,kBAAhB,EAAmCtB,CAAnC,CAAtC,EAA4ET,CAAC,CAAC+B,aAAF,CAAgB,kBAAhB,EAAmCtB,CAAnC,CAA5E;AAAkH;;AAAA,MAAMR,CAAC,GAACS,CAAC,EAAT;AAAA,MAAYJ,CAAC,GAACI,CAAC,EAAf;AAAA,MAAkBiB,CAAC,GAACjB,CAAC,EAArB;AAAA,MAAwBoB,CAAC,GAAC9B,CAAC,EAA3B;AAA8B,SAAOG,CAAC,IAAI6B,KAAZ,EAAkBT,CAAC,IAAIU,iBAAvB,EAAyCX,CAAC,IAAIY,2BAA9C","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{isSome as s}from\"../../../../../core/maybe.js\";import{j as e}from\"../../../../../chunks/mat4.js\";import{c as i}from\"../../../../../chunks/mat4f64.js\";import{g as a,f as o,b as c,m as l}from\"../../../../../chunks/vec3.js\";import{Z as r,c as t}from\"../../../../../chunks/vec3f64.js\";import{glsl as n}from\"../shaderModules/interfaces.js\";function f(s,e){if(e.slicePlaneEnabled){s.extensions.add(\"GL_OES_standard_derivatives\"),e.sliceEnabledForVertexPrograms&&(s.vertex.uniforms.add(\"slicePlaneOrigin\",\"vec3\"),s.vertex.uniforms.add(\"slicePlaneBasis1\",\"vec3\"),s.vertex.uniforms.add(\"slicePlaneBasis2\",\"vec3\")),s.fragment.uniforms.add(\"slicePlaneOrigin\",\"vec3\"),s.fragment.uniforms.add(\"slicePlaneBasis1\",\"vec3\"),s.fragment.uniforms.add(\"slicePlaneBasis2\",\"vec3\");const i=n`struct SliceFactors {\nfloat front;\nfloat side0;\nfloat side1;\nfloat side2;\nfloat side3;\n};\nSliceFactors calculateSliceFactors(vec3 pos) {\nvec3 rel = pos - slicePlaneOrigin;\nvec3 slicePlaneNormal = -cross(slicePlaneBasis1, slicePlaneBasis2);\nfloat slicePlaneW = -dot(slicePlaneNormal, slicePlaneOrigin);\nfloat basis1Len2 = dot(slicePlaneBasis1, slicePlaneBasis1);\nfloat basis2Len2 = dot(slicePlaneBasis2, slicePlaneBasis2);\nfloat basis1Dot = dot(slicePlaneBasis1, rel);\nfloat basis2Dot = dot(slicePlaneBasis2, rel);\nreturn SliceFactors(\ndot(slicePlaneNormal, pos) + slicePlaneW,\n-basis1Dot - basis1Len2,\nbasis1Dot - basis1Len2,\n-basis2Dot - basis2Len2,\nbasis2Dot - basis2Len2\n);\n}\nbool sliceByFactors(SliceFactors factors) {\nreturn factors.front < 0.0\n&& factors.side0 < 0.0\n&& factors.side1 < 0.0\n&& factors.side2 < 0.0\n&& factors.side3 < 0.0;\n}\nbool sliceEnabled() {\nreturn dot(slicePlaneBasis1, slicePlaneBasis1) != 0.0;\n}\nbool sliceByPlane(vec3 pos) {\nreturn sliceEnabled() && sliceByFactors(calculateSliceFactors(pos));\n}\n#define rejectBySlice(_pos_) sliceByPlane(_pos_)\n#define discardBySlice(_pos_) { if (sliceByPlane(_pos_)) discard; }`,a=n`vec4 applySliceHighlight(vec4 color, vec3 pos) {\nSliceFactors factors = calculateSliceFactors(pos);\nconst float HIGHLIGHT_WIDTH = 1.0;\nconst vec4 HIGHLIGHT_COLOR = vec4(0.0, 0.0, 0.0, 0.3);\nfactors.front /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.front);\nfactors.side0 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side0);\nfactors.side1 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side1);\nfactors.side2 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side2);\nfactors.side3 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side3);\nif (sliceByFactors(factors)) {\nreturn color;\n}\nfloat highlightFactor = (1.0 - step(0.5, factors.front))\n* (1.0 - step(0.5, factors.side0))\n* (1.0 - step(0.5, factors.side1))\n* (1.0 - step(0.5, factors.side2))\n* (1.0 - step(0.5, factors.side3));\nreturn mix(color, vec4(HIGHLIGHT_COLOR.rgb, color.a), highlightFactor * HIGHLIGHT_COLOR.a);\n}`,o=e.sliceHighlightDisabled?n`#define highlightSlice(_color_, _pos_) (_color_)`:n`\n        ${a}\n        #define highlightSlice(_color_, _pos_) (sliceEnabled() ? applySliceHighlight(_color_, _pos_) : (_color_))\n      `;e.sliceEnabledForVertexPrograms&&s.vertex.code.add(i),s.fragment.code.add(i),s.fragment.code.add(o)}else{const i=n`#define rejectBySlice(_pos_) false\n#define discardBySlice(_pos_) {}\n#define highlightSlice(_color_, _pos_) (_color_)`;e.sliceEnabledForVertexPrograms&&s.vertex.code.add(i),s.fragment.code.add(i)}}function d(s,e,i){_(s,e,i.slicePlane,{origin:i.origin})}function _(i,t,n,f){if(t.slicePlaneEnabled)if(s(n)){if(a(g,n.origin),a(m,n.basis1),a(P,n.basis2),s(f)&&s(f.origin)&&o(g,n.origin,f.origin),s(f)&&s(f.view)){const i=s(f.origin)?e(H,f.view,f.origin):f.view;c(m,m,g),c(P,P,g),l(g,g,i),l(m,m,i),l(P,P,i),o(m,m,g),o(P,P,g)}i.setUniform3fv(\"slicePlaneOrigin\",g),i.setUniform3fv(\"slicePlaneBasis1\",m),i.setUniform3fv(\"slicePlaneBasis2\",P)}else i.setUniform3fv(\"slicePlaneBasis1\",r),i.setUniform3fv(\"slicePlaneBasis2\",r),i.setUniform3fv(\"slicePlaneOrigin\",r)}const g=t(),m=t(),P=t(),H=i();export{f as Slice,_ as bindSliceUniforms,d as bindSliceUniformsWithOrigin};\n"]},"metadata":{},"sourceType":"module"}