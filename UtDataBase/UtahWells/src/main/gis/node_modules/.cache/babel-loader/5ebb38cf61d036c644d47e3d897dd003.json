{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport e from \"../../../../core/Error.js\";\nimport t from \"../../../../core/Logger.js\";\nimport { isPowerOfTwo as r } from \"../../../../core/mathUtils.js\";\nimport { pt2px as n } from \"../../../../core/screenUtils.js\";\nimport { CapType as i, JoinType as o } from \"../../../../symbols/cim/enums.js\";\nimport { copyAndPremultiply as s } from \"./color.js\";\nimport { WGLGeometryType as a, VVType as c } from \"./enums.js\";\nimport { TextProperties as u } from \"./SymbolProperties.js\";\nimport { Usage as l, TextureType as m, PixelFormat as f, PixelType as d, TextureWrapMode as p, DataType as y, TextureSamplingMode as g } from \"../../../webgl/enums.js\";\nimport { Texture as h } from \"../../../webgl/Texture.js\";\nimport { VertexElementDescriptor as T } from \"../../../webgl/VertexElementDescriptor.js\";\nconst w = t.getLogger(\"esri.views.2d.engine.webgl.Utils\"),\n      E = \"geometry\",\n      I = \"per_instance\",\n      S = \"per_instance_vv\",\n      A = [{\n  name: E,\n  strideInBytes: 36\n}],\n      L = [{\n  name: E,\n  strideInBytes: 32\n}],\n      N = [{\n  name: E,\n  strideInBytes: 20\n}],\n      D = [{\n  name: E,\n  strideInBytes: 12\n}],\n      M = [{\n  name: E,\n  strideInBytes: 40\n}],\n      v = [{\n  name: E,\n  strideInBytes: 36\n}],\n      U = [{\n  name: E,\n  strideInBytes: 36\n}];\n\nfunction R(e) {\n  const t = {};\n\n  for (const r of e) t[r.name] = r.strideInBytes;\n\n  return t;\n}\n\nconst _ = R(A),\n      B = R(L),\n      b = R(N),\n      C = R(D),\n      O = R(M),\n      F = R(v),\n      x = R(U);\n\nfunction z(e, _ref) {\n  let {\n    fill: t\n  } = _ref;\n\n  switch (e) {\n    case a.MARKER:\n      return _;\n\n    case a.FILL:\n      return \"dot-density\" === t ? C : \"simple\" === t ? b : B;\n\n    case a.LINE:\n      return O;\n\n    case a.TEXT:\n      return F;\n\n    case a.LABEL:\n      return x;\n  }\n}\n\nconst j = [E],\n      G = [E],\n      P = [E],\n      $ = [E],\n      V = [E];\n\nfunction Y(e) {\n  switch (e) {\n    case a.MARKER:\n      return j;\n\n    case a.FILL:\n      return G;\n\n    case a.LINE:\n      return P;\n\n    case a.TEXT:\n      return $;\n\n    case a.LABEL:\n      return V;\n  }\n}\n\nfunction k(e) {\n  switch (e % 4) {\n    case 0:\n    case 2:\n      return 4;\n\n    case 1:\n    case 3:\n      return 1;\n  }\n}\n\nfunction q(e, t) {\n  switch (t % 4) {\n    case 0:\n    case 2:\n      return new Uint32Array(Math.floor(e * t / 4));\n\n    case 1:\n    case 3:\n      return new Uint8Array(e * t);\n  }\n}\n\nfunction H(e, t) {\n  switch (t % 4) {\n    case 0:\n    case 2:\n      return new Uint32Array(e);\n\n    case 1:\n    case 3:\n      return new Uint8Array(e);\n  }\n}\n\nfunction X(e) {\n  return u.pool.acquire(e.color ? s(e.color) : [255, 255, 255, 255], e.haloColor ? s(e.haloColor) : [255, 255, 255, 255], n(e.haloSize), n(e.font.size), e.angle * Math.PI / 180, e.xoffset / e.font.size, e.yoffset / e.font.size, \"left\" === e.horizontalAlignment ? 0 : \"right\" === e.horizontalAlignment ? 1 : .5, \"top\" === e.verticalAlignment ? 0 : \"bottom\" === e.verticalAlignment ? 1 : .5);\n}\n\nfunction K(e) {\n  return null != e;\n}\n\nfunction Z(e) {\n  return \"number\" == typeof e;\n}\n\nfunction J(t) {\n  switch (t) {\n    case \"butt\":\n      return i.BUTT;\n\n    case \"round\":\n      return i.ROUND;\n\n    case \"square\":\n      return i.SQUARE;\n\n    default:\n      return w.error(new e(\"mapview-invalid-type\", `Cap type ${t} is not a valid option. Defaulting to round`)), i.ROUND;\n  }\n}\n\nfunction Q(t) {\n  switch (t) {\n    case \"miter\":\n      return o.MITER;\n\n    case \"bevel\":\n      return o.BEVEL;\n\n    case \"round\":\n      return o.ROUND;\n\n    default:\n      return w.error(new e(\"mapview-invalid-type\", `Join type ${t} is not a valid option. Defaulting to round`)), o.ROUND;\n  }\n}\n\nfunction W(e) {\n  switch (e) {\n    case \"opacity\":\n      return c.OPACITY;\n\n    case \"color\":\n      return c.COLOR;\n\n    case \"rotation\":\n      return c.ROTATION;\n\n    case \"size\":\n      return c.SIZE;\n\n    default:\n      return w.error(`Cannot interpret unknown vv: ${e}`), null;\n  }\n}\n\nfunction ee(e) {\n  const {\n    transform: t,\n    hasZ: r,\n    hasM: n\n  } = e;\n  return {\n    transform: t,\n    hasZ: r,\n    hasM: n\n  };\n}\n\nfunction te(e, t, r, n, i, o, s) {\n  for (const c in o) {\n    const t = o[c].stride,\n          n = k(t),\n          s = o[c].data,\n          a = r[c].data,\n          u = t * i.vertexCount / n,\n          l = t * e / n,\n          m = t * i.vertexFrom / n;\n\n    for (let e = 0; e < u; ++e) a[e + l] = s[e + m];\n  }\n\n  const a = i.indexCount;\n\n  for (let c = 0; c < a; ++c) n[c + t] = s[c + i.indexFrom] - i.vertexFrom + e;\n}\n\nconst re = {\n  [E]: l.STATIC_DRAW\n};\n\nfunction ne(e, t) {\n  const r = [];\n\n  for (let n = 0; n < 5; ++n) {\n    const i = Y(n),\n          o = {};\n\n    for (const e of i) o[e] = {\n      data: t(n, e)\n    };\n\n    r.push({\n      data: e(n),\n      buffers: o\n    });\n  }\n\n  return r;\n}\n\nfunction ie(e, t) {\n  let n, i;\n  return r(t.width) && r(t.height) ? (n = !0, i = g.LINEAR_MIPMAP_LINEAR) : (n = !1, i = g.LINEAR), new h(e, {\n    target: m.TEXTURE_2D,\n    pixelFormat: f.RGBA,\n    internalFormat: f.RGBA,\n    dataType: d.UNSIGNED_BYTE,\n    hasMipmap: n,\n    samplingMode: i,\n    wrapMode: p.CLAMP_TO_EDGE,\n    flipped: !0\n  }, t);\n}\n\nfunction oe(e) {\n  return {\n    vertexFrom: void 0,\n    vertexTo: void 0,\n    geometry: e\n  };\n}\n\nfunction se(e) {\n  switch (e) {\n    case y.BYTE:\n    case y.UNSIGNED_BYTE:\n      return 1;\n\n    case y.SHORT:\n    case y.UNSIGNED_SHORT:\n      return 2;\n\n    case y.FLOAT:\n    case y.INT:\n    case y.UNSIGNED_INT:\n      return 4;\n  }\n}\n\nfunction ae(t) {\n  switch (t) {\n    case d.UNSIGNED_BYTE:\n      return 1;\n\n    case d.UNSIGNED_SHORT_4_4_4_4:\n      return 2;\n\n    case d.FLOAT:\n      return 4;\n\n    default:\n      return void w.error(new e(\"webgl-utils\", `Unable to handle type ${t}`));\n  }\n}\n\nfunction ce(t) {\n  switch (t) {\n    case d.UNSIGNED_BYTE:\n      return Uint8Array;\n\n    case d.UNSIGNED_SHORT_4_4_4_4:\n      return Uint16Array;\n\n    case d.FLOAT:\n      return Float32Array;\n\n    default:\n      return void w.error(new e(\"webgl-utils\", `Unable to handle type ${t}`));\n  }\n}\n\nfunction ue(e) {\n  const t = {};\n\n  for (const r in e) {\n    const n = e[r];\n    let i = 0;\n    t[r] = n.map(e => {\n      const t = new T(e.name, e.count, e.type, i, 0, e.normalized || !1);\n      return i += e.count * se(e.type), t;\n    }), t[r].forEach(e => e.stride = i);\n  }\n\n  return t;\n}\n\nconst le = e => {\n  const t = new Map();\n\n  for (const r in e) for (const n of e[r]) t.set(n.name, n.location);\n\n  return t;\n},\n      me = e => {\n  const t = {};\n\n  for (const r in e) {\n    const n = e[r];\n    t[r] = n.length ? n[0].stride : 0;\n  }\n\n  return t;\n},\n      fe = new Map(),\n      de = (e, t) => {\n  if (!fe.has(e)) {\n    const r = ue(t),\n          n = {\n      strides: me(r),\n      bufferLayouts: r,\n      attributes: le(t)\n    };\n    fe.set(e, n);\n  }\n\n  return fe.get(e);\n};\n\nfunction pe(e) {\n  e(a.FILL), e(a.LINE), e(a.MARKER), e(a.TEXT), e(a.LABEL);\n}\n\nconst ye = e => \"path\" in e && De(e.path),\n      ge = e => \"url\" in e && e.url || \"imageData\" in e && e.imageData,\n      he = e => \"imageData\" in e && e.imageData && \"contentType\" in e && e.contentType ? `data:${e.contentType};base64,${e.imageData}` : \"url\" in e ? e.url : null,\n      Te = e => \"url\" in e && e.url && e.url.includes(\".gif\") || \"contentType\" in e && \"image/gif\" === e.contentType || \"imageData\" in e && e.imageData.includes(\"data:image/gif\"),\n      we = e => \"url\" in e && e.url && e.url.includes(\".png\") || \"contentType\" in e && \"image/png\" === e.contentType || \"imageData\" in e && e.imageData.includes(\"data:image/png\"),\n      Ee = e => e.type && -1 !== e.type.toLowerCase().indexOf(\"3d\");\n\nfunction Ie(e) {\n  switch (e.type) {\n    case \"line\":\n      {\n        const t = e;\n        return \"CIMSolidStroke\" === t.cim.type && !t.dashTemplate;\n      }\n\n    case \"fill\":\n      return \"CIMSolidFill\" === e.cim.type;\n\n    case \"esriSFS\":\n      return \"esriSFSSolid\" === e.style || \"esriSFSNull\" === e.style;\n\n    case \"esriSLS\":\n      return \"esriSLSSolid\" === e.style || \"esriSLSNull\" === e.style;\n\n    default:\n      return !1;\n  }\n}\n\nconst Se = e => e.includes(\"data:image/svg+xml\");\n\nfunction Ae(e) {\n  switch (\"cim\" in e ? e.cim.type : e.type) {\n    case \"esriSMS\":\n    case \"esriPMS\":\n    case \"CIMPointSymbol\":\n    case \"CIMVectorMarker\":\n    case \"CIMPictureMarker\":\n    case \"CIMCharacterMarker\":\n      return !1;\n\n    default:\n      return !0;\n  }\n}\n\nfunction Le(e) {\n  const t = \"maxVVSize\" in e && e.maxVVSize,\n        r = \"width\" in e && e.width || \"size\" in e && e.size || 0;\n  return t || r;\n}\n\nfunction Ne(e) {\n  const t = [];\n\n  for (let r = 0; r < e.length; r++) t.push(e.charCodeAt(r));\n\n  return t;\n}\n\nconst De = e => !!e && (e = e.trim(), !!(/^[mzlhvcsqta]\\s*[-+.0-9][^mlhvzcsqta]+/i.test(e) && /[\\dz]$/i.test(e) && e.length > 4));\n\nexport { B as C_FILL_STRIDE_SPEC, C as C_FILL_STRIDE_SPEC_DD, b as C_FILL_STRIDE_SPEC_SIMPLE, L as C_FILL_VERTEX_DEF, D as C_FILL_VERTEX_DEF_DD, N as C_FILL_VERTEX_DEF_SIMPLE, _ as C_ICON_STRIDE_SPEC, A as C_ICON_VERTEX_DEF, x as C_LABEL_STRIDE_SPEC, U as C_LABEL_VERTEX_DEF, O as C_LINE_STRIDE_SPEC, M as C_LINE_VERTEX_DEF, F as C_TEXT_STRIDE_SPEC, v as C_TEXT_VERTEX_DEF, E as C_VBO_GEOMETRY, re as C_VBO_INFO, I as C_VBO_PERINSTANCE, S as C_VBO_PERINSTANCE_VV, q as allocateTypedArrayBuffer, H as allocateTypedArrayBufferwithData, Ne as charCodes, te as copyMeshData, ne as createGeometryData, de as createProgramDescriptor, ie as createTextureFromTexelData, pe as forEachGeometryType, oe as geometryToMappedGeometry, se as getBytes, J as getCapType, Q as getJoinType, Y as getNamedBuffers, Le as getPMSResourceSize, ce as getPixelArrayCtor, ae as getPixelBytes, z as getStrides, X as getTextProperties, ee as getTransformParams, he as getUrl, W as getVVType, Ee as is3D, K as isDefined, Te as isGIF, ge as isImageResource, Z as isNumber, we as isPNG, Se as isSVGImage, ye as isSVGResource, Ie as isSimple, De as isValidSVG, Ae as shouldRepeat, k as strideToPackingFactor };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/views/2d/engine/webgl/Utils.js"],"names":["e","t","isPowerOfTwo","r","pt2px","n","CapType","i","JoinType","o","copyAndPremultiply","s","WGLGeometryType","a","VVType","c","TextProperties","u","Usage","l","TextureType","m","PixelFormat","f","PixelType","d","TextureWrapMode","p","DataType","y","TextureSamplingMode","g","Texture","h","VertexElementDescriptor","T","w","getLogger","E","I","S","A","name","strideInBytes","L","N","D","M","v","U","R","_","B","b","C","O","F","x","z","fill","MARKER","FILL","LINE","TEXT","LABEL","j","G","P","$","V","Y","k","q","Uint32Array","Math","floor","Uint8Array","H","X","pool","acquire","color","haloColor","haloSize","font","size","angle","PI","xoffset","yoffset","horizontalAlignment","verticalAlignment","K","Z","J","BUTT","ROUND","SQUARE","error","Q","MITER","BEVEL","W","OPACITY","COLOR","ROTATION","SIZE","ee","transform","hasZ","hasM","te","stride","data","vertexCount","vertexFrom","indexCount","indexFrom","re","STATIC_DRAW","ne","push","buffers","ie","width","height","LINEAR_MIPMAP_LINEAR","LINEAR","target","TEXTURE_2D","pixelFormat","RGBA","internalFormat","dataType","UNSIGNED_BYTE","hasMipmap","samplingMode","wrapMode","CLAMP_TO_EDGE","flipped","oe","vertexTo","geometry","se","BYTE","SHORT","UNSIGNED_SHORT","FLOAT","INT","UNSIGNED_INT","ae","UNSIGNED_SHORT_4_4_4_4","ce","Uint16Array","Float32Array","ue","map","count","type","normalized","forEach","le","Map","set","location","me","length","fe","de","has","strides","bufferLayouts","attributes","get","pe","ye","De","path","ge","url","imageData","he","contentType","Te","includes","we","Ee","toLowerCase","indexOf","Ie","cim","dashTemplate","style","Se","Ae","Le","maxVVSize","Ne","charCodeAt","trim","test","C_FILL_STRIDE_SPEC","C_FILL_STRIDE_SPEC_DD","C_FILL_STRIDE_SPEC_SIMPLE","C_FILL_VERTEX_DEF","C_FILL_VERTEX_DEF_DD","C_FILL_VERTEX_DEF_SIMPLE","C_ICON_STRIDE_SPEC","C_ICON_VERTEX_DEF","C_LABEL_STRIDE_SPEC","C_LABEL_VERTEX_DEF","C_LINE_STRIDE_SPEC","C_LINE_VERTEX_DEF","C_TEXT_STRIDE_SPEC","C_TEXT_VERTEX_DEF","C_VBO_GEOMETRY","C_VBO_INFO","C_VBO_PERINSTANCE","C_VBO_PERINSTANCE_VV","allocateTypedArrayBuffer","allocateTypedArrayBufferwithData","charCodes","copyMeshData","createGeometryData","createProgramDescriptor","createTextureFromTexelData","forEachGeometryType","geometryToMappedGeometry","getBytes","getCapType","getJoinType","getNamedBuffers","getPMSResourceSize","getPixelArrayCtor","getPixelBytes","getStrides","getTextProperties","getTransformParams","getUrl","getVVType","is3D","isDefined","isGIF","isImageResource","isNumber","isPNG","isSVGImage","isSVGResource","isSimple","isValidSVG","shouldRepeat","strideToPackingFactor"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport e from\"../../../../core/Error.js\";import t from\"../../../../core/Logger.js\";import{isPowerOfTwo as r}from\"../../../../core/mathUtils.js\";import{pt2px as n}from\"../../../../core/screenUtils.js\";import{CapType as i,JoinType as o}from\"../../../../symbols/cim/enums.js\";import{copyAndPremultiply as s}from\"./color.js\";import{WGLGeometryType as a,VVType as c}from\"./enums.js\";import{TextProperties as u}from\"./SymbolProperties.js\";import{Usage as l,TextureType as m,PixelFormat as f,PixelType as d,TextureWrapMode as p,DataType as y,TextureSamplingMode as g}from\"../../../webgl/enums.js\";import{Texture as h}from\"../../../webgl/Texture.js\";import{VertexElementDescriptor as T}from\"../../../webgl/VertexElementDescriptor.js\";const w=t.getLogger(\"esri.views.2d.engine.webgl.Utils\"),E=\"geometry\",I=\"per_instance\",S=\"per_instance_vv\",A=[{name:E,strideInBytes:36}],L=[{name:E,strideInBytes:32}],N=[{name:E,strideInBytes:20}],D=[{name:E,strideInBytes:12}],M=[{name:E,strideInBytes:40}],v=[{name:E,strideInBytes:36}],U=[{name:E,strideInBytes:36}];function R(e){const t={};for(const r of e)t[r.name]=r.strideInBytes;return t}const _=R(A),B=R(L),b=R(N),C=R(D),O=R(M),F=R(v),x=R(U);function z(e,{fill:t}){switch(e){case a.MARKER:return _;case a.FILL:return\"dot-density\"===t?C:\"simple\"===t?b:B;case a.LINE:return O;case a.TEXT:return F;case a.LABEL:return x}}const j=[E],G=[E],P=[E],$=[E],V=[E];function Y(e){switch(e){case a.MARKER:return j;case a.FILL:return G;case a.LINE:return P;case a.TEXT:return $;case a.LABEL:return V}}function k(e){switch(e%4){case 0:case 2:return 4;case 1:case 3:return 1}}function q(e,t){switch(t%4){case 0:case 2:return new Uint32Array(Math.floor(e*t/4));case 1:case 3:return new Uint8Array(e*t)}}function H(e,t){switch(t%4){case 0:case 2:return new Uint32Array(e);case 1:case 3:return new Uint8Array(e)}}function X(e){return u.pool.acquire(e.color?s(e.color):[255,255,255,255],e.haloColor?s(e.haloColor):[255,255,255,255],n(e.haloSize),n(e.font.size),e.angle*Math.PI/180,e.xoffset/e.font.size,e.yoffset/e.font.size,\"left\"===e.horizontalAlignment?0:\"right\"===e.horizontalAlignment?1:.5,\"top\"===e.verticalAlignment?0:\"bottom\"===e.verticalAlignment?1:.5)}function K(e){return null!=e}function Z(e){return\"number\"==typeof e}function J(t){switch(t){case\"butt\":return i.BUTT;case\"round\":return i.ROUND;case\"square\":return i.SQUARE;default:return w.error(new e(\"mapview-invalid-type\",`Cap type ${t} is not a valid option. Defaulting to round`)),i.ROUND}}function Q(t){switch(t){case\"miter\":return o.MITER;case\"bevel\":return o.BEVEL;case\"round\":return o.ROUND;default:return w.error(new e(\"mapview-invalid-type\",`Join type ${t} is not a valid option. Defaulting to round`)),o.ROUND}}function W(e){switch(e){case\"opacity\":return c.OPACITY;case\"color\":return c.COLOR;case\"rotation\":return c.ROTATION;case\"size\":return c.SIZE;default:return w.error(`Cannot interpret unknown vv: ${e}`),null}}function ee(e){const{transform:t,hasZ:r,hasM:n}=e;return{transform:t,hasZ:r,hasM:n}}function te(e,t,r,n,i,o,s){for(const c in o){const t=o[c].stride,n=k(t),s=o[c].data,a=r[c].data,u=t*i.vertexCount/n,l=t*e/n,m=t*i.vertexFrom/n;for(let e=0;e<u;++e)a[e+l]=s[e+m]}const a=i.indexCount;for(let c=0;c<a;++c)n[c+t]=s[c+i.indexFrom]-i.vertexFrom+e}const re={[E]:l.STATIC_DRAW};function ne(e,t){const r=[];for(let n=0;n<5;++n){const i=Y(n),o={};for(const e of i)o[e]={data:t(n,e)};r.push({data:e(n),buffers:o})}return r}function ie(e,t){let n,i;return r(t.width)&&r(t.height)?(n=!0,i=g.LINEAR_MIPMAP_LINEAR):(n=!1,i=g.LINEAR),new h(e,{target:m.TEXTURE_2D,pixelFormat:f.RGBA,internalFormat:f.RGBA,dataType:d.UNSIGNED_BYTE,hasMipmap:n,samplingMode:i,wrapMode:p.CLAMP_TO_EDGE,flipped:!0},t)}function oe(e){return{vertexFrom:void 0,vertexTo:void 0,geometry:e}}function se(e){switch(e){case y.BYTE:case y.UNSIGNED_BYTE:return 1;case y.SHORT:case y.UNSIGNED_SHORT:return 2;case y.FLOAT:case y.INT:case y.UNSIGNED_INT:return 4}}function ae(t){switch(t){case d.UNSIGNED_BYTE:return 1;case d.UNSIGNED_SHORT_4_4_4_4:return 2;case d.FLOAT:return 4;default:return void w.error(new e(\"webgl-utils\",`Unable to handle type ${t}`))}}function ce(t){switch(t){case d.UNSIGNED_BYTE:return Uint8Array;case d.UNSIGNED_SHORT_4_4_4_4:return Uint16Array;case d.FLOAT:return Float32Array;default:return void w.error(new e(\"webgl-utils\",`Unable to handle type ${t}`))}}function ue(e){const t={};for(const r in e){const n=e[r];let i=0;t[r]=n.map((e=>{const t=new T(e.name,e.count,e.type,i,0,e.normalized||!1);return i+=e.count*se(e.type),t})),t[r].forEach((e=>e.stride=i))}return t}const le=e=>{const t=new Map;for(const r in e)for(const n of e[r])t.set(n.name,n.location);return t},me=e=>{const t={};for(const r in e){const n=e[r];t[r]=n.length?n[0].stride:0}return t},fe=new Map,de=(e,t)=>{if(!fe.has(e)){const r=ue(t),n={strides:me(r),bufferLayouts:r,attributes:le(t)};fe.set(e,n)}return fe.get(e)};function pe(e){e(a.FILL),e(a.LINE),e(a.MARKER),e(a.TEXT),e(a.LABEL)}const ye=e=>\"path\"in e&&De(e.path),ge=e=>\"url\"in e&&e.url||\"imageData\"in e&&e.imageData,he=e=>\"imageData\"in e&&e.imageData&&\"contentType\"in e&&e.contentType?`data:${e.contentType};base64,${e.imageData}`:\"url\"in e?e.url:null,Te=e=>\"url\"in e&&e.url&&e.url.includes(\".gif\")||\"contentType\"in e&&\"image/gif\"===e.contentType||\"imageData\"in e&&e.imageData.includes(\"data:image/gif\"),we=e=>\"url\"in e&&e.url&&e.url.includes(\".png\")||\"contentType\"in e&&\"image/png\"===e.contentType||\"imageData\"in e&&e.imageData.includes(\"data:image/png\"),Ee=e=>e.type&&-1!==e.type.toLowerCase().indexOf(\"3d\");function Ie(e){switch(e.type){case\"line\":{const t=e;return\"CIMSolidStroke\"===t.cim.type&&!t.dashTemplate}case\"fill\":return\"CIMSolidFill\"===e.cim.type;case\"esriSFS\":return\"esriSFSSolid\"===e.style||\"esriSFSNull\"===e.style;case\"esriSLS\":return\"esriSLSSolid\"===e.style||\"esriSLSNull\"===e.style;default:return!1}}const Se=e=>e.includes(\"data:image/svg+xml\");function Ae(e){switch(\"cim\"in e?e.cim.type:e.type){case\"esriSMS\":case\"esriPMS\":case\"CIMPointSymbol\":case\"CIMVectorMarker\":case\"CIMPictureMarker\":case\"CIMCharacterMarker\":return!1;default:return!0}}function Le(e){const t=\"maxVVSize\"in e&&e.maxVVSize,r=\"width\"in e&&e.width||\"size\"in e&&e.size||0;return t||r}function Ne(e){const t=[];for(let r=0;r<e.length;r++)t.push(e.charCodeAt(r));return t}const De=e=>!!e&&(e=e.trim(),!!(/^[mzlhvcsqta]\\s*[-+.0-9][^mlhvzcsqta]+/i.test(e)&&/[\\dz]$/i.test(e)&&e.length>4));export{B as C_FILL_STRIDE_SPEC,C as C_FILL_STRIDE_SPEC_DD,b as C_FILL_STRIDE_SPEC_SIMPLE,L as C_FILL_VERTEX_DEF,D as C_FILL_VERTEX_DEF_DD,N as C_FILL_VERTEX_DEF_SIMPLE,_ as C_ICON_STRIDE_SPEC,A as C_ICON_VERTEX_DEF,x as C_LABEL_STRIDE_SPEC,U as C_LABEL_VERTEX_DEF,O as C_LINE_STRIDE_SPEC,M as C_LINE_VERTEX_DEF,F as C_TEXT_STRIDE_SPEC,v as C_TEXT_VERTEX_DEF,E as C_VBO_GEOMETRY,re as C_VBO_INFO,I as C_VBO_PERINSTANCE,S as C_VBO_PERINSTANCE_VV,q as allocateTypedArrayBuffer,H as allocateTypedArrayBufferwithData,Ne as charCodes,te as copyMeshData,ne as createGeometryData,de as createProgramDescriptor,ie as createTextureFromTexelData,pe as forEachGeometryType,oe as geometryToMappedGeometry,se as getBytes,J as getCapType,Q as getJoinType,Y as getNamedBuffers,Le as getPMSResourceSize,ce as getPixelArrayCtor,ae as getPixelBytes,z as getStrides,X as getTextProperties,ee as getTransformParams,he as getUrl,W as getVVType,Ee as is3D,K as isDefined,Te as isGIF,ge as isImageResource,Z as isNumber,we as isPNG,Se as isSVGImage,ye as isSVGResource,Ie as isSimple,De as isValidSVG,Ae as shouldRepeat,k as strideToPackingFactor};\n"]},"metadata":{},"sourceType":"module"}