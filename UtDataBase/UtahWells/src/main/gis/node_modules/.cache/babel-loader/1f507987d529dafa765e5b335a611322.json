{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport t from \"../../../core/Error.js\";\nimport e from \"../PixelBlock.js\";\nimport i from \"./ImageCanvasDecoder.js\";\nimport a from \"./JpgPlus.js\";\nimport { load as s, decode as r } from \"./Lerc.js\";\nimport { decode as n } from \"./Lzw.js\";\nimport { Z as o } from \"../../../chunks/Zlib.js\";\nimport h from \"./Raw.js\";\nimport { decodeTileOrStrip as c, decode as p } from \"./TiffDecoder.js\";\nimport { isPlatformLittleEndian as l } from \"./utils.js\";\n\nvar d = function (t) {\n  var e, i, a, s, r, n;\n\n  function h(t) {\n    var e, i, a, s, r, n, o, h, c, p, l, d, f;\n\n    for (this.data = t, this.pos = 8, this.palette = [], this.imgData = [], this.transparency = {}, this.animation = null, this.text = {}, r = null;;) {\n      switch (e = this.readUInt32(), h = function () {\n        var t, e;\n\n        for (e = [], t = 0; t < 4; ++t) e.push(String.fromCharCode(this.data[this.pos++]));\n\n        return e;\n      }.call(this).join(\"\"), h) {\n        case \"IHDR\":\n          this.width = this.readUInt32(), this.height = this.readUInt32(), this.bits = this.data[this.pos++], this.colorType = this.data[this.pos++], this.compressionMethod = this.data[this.pos++], this.filterMethod = this.data[this.pos++], this.interlaceMethod = this.data[this.pos++];\n          break;\n\n        case \"acTL\":\n          this.animation = {\n            numFrames: this.readUInt32(),\n            numPlays: this.readUInt32() || 1 / 0,\n            frames: []\n          };\n          break;\n\n        case \"PLTE\":\n          this.palette = this.read(e);\n          break;\n\n        case \"fcTL\":\n          r && this.animation.frames.push(r), this.pos += 4, r = {\n            width: this.readUInt32(),\n            height: this.readUInt32(),\n            xOffset: this.readUInt32(),\n            yOffset: this.readUInt32()\n          }, s = this.readUInt16(), a = this.readUInt16() || 100, r.delay = 1e3 * s / a, r.disposeOp = this.data[this.pos++], r.blendOp = this.data[this.pos++], r.data = [];\n          break;\n\n        case \"IDAT\":\n        case \"fdAT\":\n          for (\"fdAT\" === h && (this.pos += 4, e -= 4), t = (null != r ? r.data : void 0) || this.imgData, l = 0; 0 <= e ? l < e : l > e; 0 <= e ? ++l : --l) t.push(this.data[this.pos++]);\n\n          break;\n\n        case \"tRNS\":\n          switch (this.transparency = {}, this.colorType) {\n            case 3:\n              if (this.transparency.indexed = this.read(e), (c = 255 - this.transparency.indexed.length) > 0) for (d = 0; 0 <= c ? d < c : d > c; 0 <= c ? ++d : --d) this.transparency.indexed.push(255);\n              break;\n\n            case 0:\n              this.transparency.grayscale = this.read(e)[0];\n              break;\n\n            case 2:\n              this.transparency.rgb = this.read(e);\n          }\n\n          break;\n\n        case \"tEXt\":\n          n = (p = this.read(e)).indexOf(0), o = String.fromCharCode.apply(String, p.slice(0, n)), this.text[o] = String.fromCharCode.apply(String, p.slice(n + 1));\n          break;\n\n        case \"IEND\":\n          return r && this.animation.frames.push(r), this.colors = function () {\n            switch (this.colorType) {\n              case 0:\n              case 3:\n              case 4:\n                return 1;\n\n              case 2:\n              case 6:\n                return 3;\n            }\n          }.call(this), this.hasAlphaChannel = 4 === (f = this.colorType) || 6 === f, i = this.colors + (this.hasAlphaChannel ? 1 : 0), this.pixelBitlength = this.bits * i, this.colorSpace = function () {\n            switch (this.colors) {\n              case 1:\n                return \"DeviceGray\";\n\n              case 3:\n                return \"DeviceRGB\";\n            }\n          }.call(this), void (this.imgData = new Uint8Array(this.imgData));\n\n        default:\n          this.pos += e;\n      }\n\n      if (this.pos += 4, this.pos > this.data.length) throw new Error(\"Incomplete or corrupt PNG file\");\n    }\n  }\n\n  return h.load = function (t, e, i) {\n    var a;\n    return \"function\" == typeof e && (i = e), (a = new XMLHttpRequest()).open(\"GET\", t, !0), a.responseType = \"arraybuffer\", a.onload = function () {\n      var t;\n      return t = new h(new Uint8Array(a.response || a.mozResponseArrayBuffer)), \"function\" == typeof (null != e ? e.getContext : void 0) && t.render(e), \"function\" == typeof i ? i(t) : void 0;\n    }, a.send(null);\n  }, i = 1, a = 2, e = 0, h.prototype.read = function (t) {\n    var e, i;\n\n    for (i = [], e = 0; 0 <= t ? e < t : e > t; 0 <= t ? ++e : --e) i.push(this.data[this.pos++]);\n\n    return i;\n  }, h.prototype.readUInt32 = function () {\n    return this.data[this.pos++] << 24 | this.data[this.pos++] << 16 | this.data[this.pos++] << 8 | this.data[this.pos++];\n  }, h.prototype.readUInt16 = function () {\n    return this.data[this.pos++] << 8 | this.data[this.pos++];\n  }, h.prototype.decodePixels = function (t) {\n    var e, i, a, s, r, n, h, c, p, l, d, f, u, m, g, w, y, x, b, k, T, U, v;\n    if (null == t && (t = this.imgData), 0 === t.length) return new Uint8Array(0);\n\n    for (t = (t = new o(t)).getBytes(), w = (f = this.pixelBitlength / 8) * this.width, u = new Uint8Array(w * this.height), n = t.length, g = 0, m = 0, i = 0; m < n;) {\n      switch (t[m++]) {\n        case 0:\n          for (s = b = 0; b < w; s = b += 1) u[i++] = t[m++];\n\n          break;\n\n        case 1:\n          for (s = k = 0; k < w; s = k += 1) e = t[m++], r = s < f ? 0 : u[i - f], u[i++] = (e + r) % 256;\n\n          break;\n\n        case 2:\n          for (s = T = 0; T < w; s = T += 1) e = t[m++], a = (s - s % f) / f, y = g && u[(g - 1) * w + a * f + s % f], u[i++] = (y + e) % 256;\n\n          break;\n\n        case 3:\n          for (s = U = 0; U < w; s = U += 1) e = t[m++], a = (s - s % f) / f, r = s < f ? 0 : u[i - f], y = g && u[(g - 1) * w + a * f + s % f], u[i++] = (e + Math.floor((r + y) / 2)) % 256;\n\n          break;\n\n        case 4:\n          for (s = v = 0; v < w; s = v += 1) e = t[m++], a = (s - s % f) / f, r = s < f ? 0 : u[i - f], 0 === g ? y = x = 0 : (y = u[(g - 1) * w + a * f + s % f], x = a && u[(g - 1) * w + (a - 1) * f + s % f]), h = r + y - x, c = Math.abs(h - r), l = Math.abs(h - y), d = Math.abs(h - x), p = c <= l && c <= d ? r : l <= d ? y : x, u[i++] = (e + p) % 256;\n\n          break;\n\n        default:\n          throw new Error(\"Invalid filter algorithm: \" + t[m - 1]);\n      }\n\n      g++;\n    }\n\n    return u;\n  }, h.prototype.decodePalette = function () {\n    var t, e, i, a, s, r, n, o, h;\n\n    for (i = this.palette, r = this.transparency.indexed || [], s = new Uint8Array((r.length || 0) + i.length), a = 0, t = 0, e = n = 0, o = i.length; n < o; e = n += 3) s[a++] = i[e], s[a++] = i[e + 1], s[a++] = i[e + 2], s[a++] = null != (h = r[t++]) ? h : 255;\n\n    return s;\n  }, h.prototype.copyToImageData = function (t, e) {\n    var i, a, s, r, n, o, h, c, p, l, d;\n    if (a = this.colors, p = null, i = this.hasAlphaChannel, this.palette.length && (p = null != (d = this._decodedPalette) ? d : this._decodedPalette = this.decodePalette(), a = 4, i = !0), c = (s = t.data || t).length, n = p || e, r = o = 0, 1 === a) for (; r < c;) h = p ? 4 * e[r / 4] : o, l = n[h++], s[r++] = l, s[r++] = l, s[r++] = l, s[r++] = i ? n[h++] : this.transparency.grayscale && this.transparency.grayscale === l ? 0 : 255, o = h;else for (; r < c;) h = p ? 4 * e[r / 4] : o, s[r++] = n[h++], s[r++] = n[h++], s[r++] = n[h++], s[r++] = i ? n[h++] : this.transparency.rgb && this.transparency.rgb[1] === n[h - 3] && this.transparency.rgb[3] === n[h - 2] && this.transparency.rgb[5] === n[h - 1] ? 0 : 255, o = h;\n  }, h.prototype.decode = function () {\n    var t;\n    return t = new Uint8Array(this.width * this.height * 4), this.copyToImageData(t, this.decodePixels()), t;\n  }, r = t.document && t.document.createElement(\"canvas\"), n = r && r.getContext(\"2d\"), s = function (t) {\n    var e;\n    return n.width = t.width, n.height = t.height, n.clearRect(0, 0, t.width, t.height), n.putImageData(t, 0, 0), (e = new Image()).src = r.toDataURL(), e;\n  }, h.prototype.decodeFrames = function (t) {\n    var e, i, a, r, n, o, h, c;\n\n    if (this.animation) {\n      for (c = [], i = n = 0, o = (h = this.animation.frames).length; n < o; i = ++n) e = h[i], a = t.createImageData(e.width, e.height), r = this.decodePixels(new Uint8Array(e.data)), this.copyToImageData(a, r), e.imageData = a, c.push(e.image = s(a));\n\n      return c;\n    }\n  }, h.prototype.renderFrame = function (t, s) {\n    var r, n, o;\n    return r = (n = this.animation.frames)[s], o = n[s - 1], 0 === s && t.clearRect(0, 0, this.width, this.height), (null != o ? o.disposeOp : void 0) === i ? t.clearRect(o.xOffset, o.yOffset, o.width, o.height) : (null != o ? o.disposeOp : void 0) === a && t.putImageData(o.imageData, o.xOffset, o.yOffset), r.blendOp === e && t.clearRect(r.xOffset, r.yOffset, r.width, r.height), t.drawImage(r.image, r.xOffset, r.yOffset);\n  }, h.prototype.animate = function (t) {\n    var e,\n        i,\n        a,\n        s,\n        r,\n        n,\n        o = this;\n    return i = 0, n = this.animation, s = n.numFrames, a = n.frames, r = n.numPlays, (e = function () {\n      var n, h;\n      if (n = i++ % s, h = a[n], o.renderFrame(t, n), s > 1 && i / s < r) return o.animation._timeout = setTimeout(e, h.delay);\n    })();\n  }, h.prototype.stopAnimation = function () {\n    var t;\n    return clearTimeout(null != (t = this.animation) ? t._timeout : void 0);\n  }, h.prototype.render = function (t) {\n    var e, i;\n    return t._png && t._png.stopAnimation(), t._png = this, t.width = this.width, t.height = this.height, e = t.getContext(\"2d\"), this.animation ? (this.decodeFrames(e), this.animate(e)) : (i = e.createImageData(this.width, this.height), this.copyToImageData(i, this.decodePixels()), e.putImageData(i, 0, 0));\n  }, h;\n}(self);\n\nconst f = new Set([\"jpg\", \"png\", \"bmp\", \"gif\"]),\n      u = new Set([\"S8\", \"U8\", \"S16\", \"U16\", \"S32\", \"U32\", \"F32\", \"F64\"]);\n\nasync function m(i, a) {\n  var n;\n  if (!l) throw new t(\"rasterCoded:decode\", \"lerc decoder is not supported on big endian platform\");\n  await s();\n  const {\n    offset: o,\n    noDataValue: h\n  } = a;\n  let c = null == (n = a.pixelType) ? void 0 : n.toUpperCase();\n  c && !u.has(c) && (c = null);\n  const {\n    width: p,\n    height: d,\n    pixelType: f,\n    statistics: m,\n    pixels: g,\n    mask: w\n  } = r(i, {\n    inputOffset: o,\n    noDataValue: h,\n    pixelType: c\n  });\n  return new e({\n    width: p,\n    height: d,\n    pixelType: f.toLowerCase(),\n    pixels: g,\n    mask: w,\n    statistics: m\n  });\n}\n\nasync function g(t, i) {\n  const a = await p(t, i.pyramidLevel || 0),\n        s = new e({\n    width: a.width,\n    height: a.height,\n    pixels: a.pixels,\n    pixelType: a.pixelType.toLowerCase(),\n    mask: a.mask,\n    statistics: null\n  });\n  return s.updateStatistics(), s;\n}\n\nasync function w(t, i) {\n  const a = await c(t, i.customOptions),\n        s = new e({\n    width: a.width,\n    height: a.height,\n    pixels: a.pixels,\n    pixelType: a.pixelType.toLowerCase(),\n    mask: a.mask,\n    statistics: null\n  });\n  return s.updateStatistics(), s;\n}\n\nfunction y(t, i) {\n  const a = i.pixelType || \"u8\",\n        s = e.getPixelArrayConstructor(a),\n        r = \"u8\" === a ? t : new s(t.buffer),\n        n = [],\n        o = i.planes || 1;\n  if (1 === o) n.push(r);else for (let e = 0; e < o; e++) {\n    const a = (i.width || 1) * (i.height || t.length),\n          h = new s(a);\n\n    for (let t = 0; t < a; t++) h[t] = r[t * o + e];\n\n    n.push(h);\n  }\n  const h = new e({\n    width: i.width || 1,\n    height: i.height || t.length,\n    pixels: n,\n    pixelType: a,\n    statistics: null\n  });\n  return h.updateStatistics(), h;\n}\n\nfunction x(t, e) {\n  return y(new o(new Uint8Array(t)).getBytes(), e);\n}\n\nfunction b(t, e) {\n  return y(n(t, e.offset, e.eof, !e.isInputBigEndian), e);\n}\n\nfunction k(t, i, a) {\n  const {\n    pixelTypeCtor: s\n  } = A(i.pixelType),\n        r = (0, h.decode)(t, {\n    width: i.width,\n    height: i.height,\n    pixelType: s,\n    format: a\n  }),\n        n = new e({\n    width: i.width,\n    height: i.height,\n    pixels: r.pixels,\n    pixelType: i.pixelType,\n    mask: r.mask,\n    statistics: null\n  });\n  return n.updateStatistics(), n;\n}\n\nfunction T(t) {\n  const i = a.decode(t),\n        s = new e({\n    width: i.width,\n    height: i.height,\n    pixels: i.pixels,\n    pixelType: \"U8\",\n    mask: i.mask,\n    statistics: null\n  });\n  return s.updateStatistics(), s;\n}\n\nfunction U(t, i) {\n  const a = new Uint8Array(t),\n        s = new d(a),\n        {\n    width: r,\n    height: n\n  } = i,\n        o = r * n,\n        h = s.decode();\n  let c,\n      p = 0,\n      l = 0;\n  const f = new Uint8Array(o);\n\n  for (p = 0; p < o; p++) f[p] = h[4 * p + 3];\n\n  const u = new e({\n    width: r,\n    height: n,\n    pixels: [],\n    pixelType: \"U8\",\n    mask: f,\n    statistics: []\n  });\n\n  for (p = 0; p < 3; p++) {\n    for (c = new Uint8Array(o), l = 0; l < o; l++) c[l] = h[4 * l + p];\n\n    u.addData({\n      pixels: c\n    });\n  }\n\n  return u.updateStatistics(), u;\n}\n\nasync function v(t, a, s, r) {\n  const n = new i(),\n        o = {\n    applyJpegMask: !1,\n    format: a,\n    ...s\n  },\n        h = await n.decode(t, o, r),\n        c = new e(h);\n  return c.updateStatistics(), c;\n}\n\nfunction I(e) {\n  if (null == e) throw new t(\"rasterCodec:decode\", \"parameter encodeddata is required.\");\n  const i = new Uint8Array(e, 0, 10);\n  let a = \"\";\n  return 255 === i[0] && 216 === i[1] ? a = \"jpg\" : 137 === i[0] && 80 === i[1] && 78 === i[2] && 71 === i[3] ? a = \"png\" : 67 === i[0] && 110 === i[1] && 116 === i[2] && 90 === i[3] && 73 === i[4] && 109 === i[5] && 97 === i[6] && 103 === i[7] && 101 === i[8] && 32 === i[9] ? a = \"lerc\" : 76 === i[0] && 101 === i[1] && 114 === i[2] && 99 === i[3] && 50 === i[4] && 32 === i[5] ? a = \"lerc2\" : 73 === i[0] && 73 === i[1] && 42 === i[2] && 0 === i[3] || 77 === i[0] && 77 === i[1] && 0 === i[2] && 42 === i[3] || 73 === i[0] && 73 === i[1] && 43 === i[2] && 0 === i[3] || 77 === i[0] && 77 === i[1] && 0 === i[2] && 43 === i[3] ? a = \"tiff\" : 71 === i[0] && 73 === i[1] && 70 === i[2] ? a = \"gif\" : 66 === i[0] && 77 === i[1] ? a = \"bmp\" : String.fromCharCode.apply(null, i).toLowerCase().indexOf(\"error\") > -1 && (a = \"error\"), a;\n}\n\nfunction C(e) {\n  let i = null;\n\n  switch (e) {\n    case \"lerc\":\n    case \"lerc2\":\n      i = m;\n      break;\n\n    case \"jpg\":\n      i = T;\n      break;\n\n    case \"png\":\n      i = U;\n      break;\n\n    case \"bsq\":\n    case \"bip\":\n      i = (t, i) => k(t, i, e);\n\n      break;\n\n    case \"tiff\":\n      i = g;\n      break;\n\n    case \"deflate\":\n      i = x;\n      break;\n\n    case \"lzw\":\n      i = b;\n      break;\n\n    case \"error\":\n      i = () => {\n        throw new t(\"rasterCodec:decode\", \"input data contains error\");\n      };\n\n      break;\n\n    default:\n      i = () => {\n        throw new t(\"rasterCodec:decode\", \"unsupported raster format\");\n      };\n\n  }\n\n  return i;\n}\n\nfunction A(t) {\n  let e = null,\n      i = null;\n\n  switch (t ? t.toLowerCase() : \"f32\") {\n    case \"u1\":\n    case \"u2\":\n    case \"u4\":\n    case \"u8\":\n      i = 255, e = Uint8Array;\n      break;\n\n    case \"u16\":\n      i = i || 65535, e = Uint16Array;\n      break;\n\n    case \"u32\":\n      i = i || 2 ** 32 - 1, e = Uint32Array;\n      break;\n\n    case \"s8\":\n      i = i || -128, e = Int8Array;\n      break;\n\n    case \"s16\":\n      i = i || -32768, e = Int16Array;\n      break;\n\n    case \"s32\":\n      i = i || 0 - 2 ** 31, e = Int32Array;\n      break;\n\n    default:\n      e = Float32Array;\n  }\n\n  return {\n    pixelTypeCtor: e,\n    noDataValue: i\n  };\n}\n\nfunction D(t) {\n  let i = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n  if (!t) return;\n  const {\n    pixels: a,\n    width: s,\n    height: r,\n    mask: n\n  } = t;\n  if (!a || 0 === a.length) return;\n  const o = a.length,\n        h = s - 1,\n        c = r - 1,\n        p = [];\n  let l, d, f, u, m, g, w;\n  const y = e.getPixelArrayConstructor(t.pixelType);\n\n  if (0 === i) {\n    for (l = 0; l < o; l++) {\n      for (m = a[l], g = new y(h * c), d = 0; d < c; d++) for (u = d * s, f = 0; f < h; f++) g[d * h + f] = m[u + f];\n\n      p.push(g);\n    }\n\n    if (n) for (w = new Uint8Array(h * c), d = 0; d < c; d++) for (u = d * s, f = 0; f < h; f++) w[d * h + f] = n[u + f];\n  } else {\n    for (l = 0; l < o; l++) {\n      for (m = a[l], g = new y(h * c), d = 0; d < c; d++) for (u = d * s, f = 0; f < h; f++) g[d * h + f] = (m[u + f] + m[u + f + 1] + m[u + s + f] + m[u + s + f + 1]) / 4;\n\n      p.push(g);\n    }\n\n    if (n) for (w = new Uint8Array(h * c), d = 0; d < c; d++) for (u = d * s, f = 0; f < h; f++) w[d * h + f] = Math.min.apply(null, [n[u + f], n[u + f + 1], n[u + s + f], n[u + s + f + 1]]);\n  }\n\n  t.width = h, t.height = c, t.mask = w, t.pixels = p;\n}\n\nfunction O(t) {\n  let e = I(t);\n  return \"lerc2\" === e ? e = \"lerc\" : \"error\" === e && (e = \"\"), e;\n}\n\nasync function S(e) {\n  let i = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  let a = arguments.length > 2 ? arguments[2] : undefined;\n  if (null == e) throw new t(\"rasterCodec:decode\", \"missing encodeddata parameter.\");\n  let s,\n      r,\n      n = i.format && i.format.toLowerCase();\n  if (!(\"bsq\" !== n && \"bip\" !== n || null != i.width && null != i.height)) throw new t(\"rasterCodec:decode\", \"requires width and height in options parameter.\");\n  return \"tiff\" === n && i.customOptions ? w(e, i) : ((!n || \"bsq\" !== n && \"bip\" !== n && \"deflate\" !== n && \"lzw\" !== n) && (n = I(e)), i.useCanvas && f.has(n) ? r = await v(e, n, i, a) : (s = C(n), i.isPoint && ((i = { ...i\n  }).width++, i.height++), r = await s(e, i), i.isPoint && D(r)), r);\n}\n\nexport { S as decode, O as getFormat };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/layers/support/rasterFormats/RasterCodec.js"],"names":["t","e","i","a","load","s","decode","r","n","Z","o","h","decodeTileOrStrip","c","p","isPlatformLittleEndian","l","d","f","data","pos","palette","imgData","transparency","animation","text","readUInt32","push","String","fromCharCode","call","join","width","height","bits","colorType","compressionMethod","filterMethod","interlaceMethod","numFrames","numPlays","frames","read","xOffset","yOffset","readUInt16","delay","disposeOp","blendOp","indexed","length","grayscale","rgb","indexOf","apply","slice","colors","hasAlphaChannel","pixelBitlength","colorSpace","Uint8Array","Error","XMLHttpRequest","open","responseType","onload","response","mozResponseArrayBuffer","getContext","render","send","prototype","decodePixels","u","m","g","w","y","x","b","k","T","U","v","getBytes","Math","floor","abs","decodePalette","copyToImageData","_decodedPalette","document","createElement","clearRect","putImageData","Image","src","toDataURL","decodeFrames","createImageData","imageData","image","renderFrame","drawImage","animate","_timeout","setTimeout","stopAnimation","clearTimeout","_png","self","Set","offset","noDataValue","pixelType","toUpperCase","has","statistics","pixels","mask","inputOffset","toLowerCase","pyramidLevel","updateStatistics","customOptions","getPixelArrayConstructor","buffer","planes","eof","isInputBigEndian","pixelTypeCtor","A","format","addData","applyJpegMask","I","C","Uint16Array","Uint32Array","Int8Array","Int16Array","Int32Array","Float32Array","D","min","O","S","useCanvas","isPoint","getFormat"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport t from\"../../../core/Error.js\";import e from\"../PixelBlock.js\";import i from\"./ImageCanvasDecoder.js\";import a from\"./JpgPlus.js\";import{load as s,decode as r}from\"./Lerc.js\";import{decode as n}from\"./Lzw.js\";import{Z as o}from\"../../../chunks/Zlib.js\";import h from\"./Raw.js\";import{decodeTileOrStrip as c,decode as p}from\"./TiffDecoder.js\";import{isPlatformLittleEndian as l}from\"./utils.js\";var d=function(t){var e,i,a,s,r,n;function h(t){var e,i,a,s,r,n,o,h,c,p,l,d,f;for(this.data=t,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},r=null;;){switch(e=this.readUInt32(),h=function(){var t,e;for(e=[],t=0;t<4;++t)e.push(String.fromCharCode(this.data[this.pos++]));return e}.call(this).join(\"\"),h){case\"IHDR\":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case\"acTL\":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case\"PLTE\":this.palette=this.read(e);break;case\"fcTL\":r&&this.animation.frames.push(r),this.pos+=4,r={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},s=this.readUInt16(),a=this.readUInt16()||100,r.delay=1e3*s/a,r.disposeOp=this.data[this.pos++],r.blendOp=this.data[this.pos++],r.data=[];break;case\"IDAT\":case\"fdAT\":for(\"fdAT\"===h&&(this.pos+=4,e-=4),t=(null!=r?r.data:void 0)||this.imgData,l=0;0<=e?l<e:l>e;0<=e?++l:--l)t.push(this.data[this.pos++]);break;case\"tRNS\":switch(this.transparency={},this.colorType){case 3:if(this.transparency.indexed=this.read(e),(c=255-this.transparency.indexed.length)>0)for(d=0;0<=c?d<c:d>c;0<=c?++d:--d)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(e)[0];break;case 2:this.transparency.rgb=this.read(e)}break;case\"tEXt\":n=(p=this.read(e)).indexOf(0),o=String.fromCharCode.apply(String,p.slice(0,n)),this.text[o]=String.fromCharCode.apply(String,p.slice(n+1));break;case\"IEND\":return r&&this.animation.frames.push(r),this.colors=function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this),this.hasAlphaChannel=4===(f=this.colorType)||6===f,i=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*i,this.colorSpace=function(){switch(this.colors){case 1:return\"DeviceGray\";case 3:return\"DeviceRGB\"}}.call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=e}if(this.pos+=4,this.pos>this.data.length)throw new Error(\"Incomplete or corrupt PNG file\")}}return h.load=function(t,e,i){var a;return\"function\"==typeof e&&(i=e),(a=new XMLHttpRequest).open(\"GET\",t,!0),a.responseType=\"arraybuffer\",a.onload=function(){var t;return t=new h(new Uint8Array(a.response||a.mozResponseArrayBuffer)),\"function\"==typeof(null!=e?e.getContext:void 0)&&t.render(e),\"function\"==typeof i?i(t):void 0},a.send(null)},i=1,a=2,e=0,h.prototype.read=function(t){var e,i;for(i=[],e=0;0<=t?e<t:e>t;0<=t?++e:--e)i.push(this.data[this.pos++]);return i},h.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},h.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},h.prototype.decodePixels=function(t){var e,i,a,s,r,n,h,c,p,l,d,f,u,m,g,w,y,x,b,k,T,U,v;if(null==t&&(t=this.imgData),0===t.length)return new Uint8Array(0);for(t=(t=new o(t)).getBytes(),w=(f=this.pixelBitlength/8)*this.width,u=new Uint8Array(w*this.height),n=t.length,g=0,m=0,i=0;m<n;){switch(t[m++]){case 0:for(s=b=0;b<w;s=b+=1)u[i++]=t[m++];break;case 1:for(s=k=0;k<w;s=k+=1)e=t[m++],r=s<f?0:u[i-f],u[i++]=(e+r)%256;break;case 2:for(s=T=0;T<w;s=T+=1)e=t[m++],a=(s-s%f)/f,y=g&&u[(g-1)*w+a*f+s%f],u[i++]=(y+e)%256;break;case 3:for(s=U=0;U<w;s=U+=1)e=t[m++],a=(s-s%f)/f,r=s<f?0:u[i-f],y=g&&u[(g-1)*w+a*f+s%f],u[i++]=(e+Math.floor((r+y)/2))%256;break;case 4:for(s=v=0;v<w;s=v+=1)e=t[m++],a=(s-s%f)/f,r=s<f?0:u[i-f],0===g?y=x=0:(y=u[(g-1)*w+a*f+s%f],x=a&&u[(g-1)*w+(a-1)*f+s%f]),h=r+y-x,c=Math.abs(h-r),l=Math.abs(h-y),d=Math.abs(h-x),p=c<=l&&c<=d?r:l<=d?y:x,u[i++]=(e+p)%256;break;default:throw new Error(\"Invalid filter algorithm: \"+t[m-1])}g++}return u},h.prototype.decodePalette=function(){var t,e,i,a,s,r,n,o,h;for(i=this.palette,r=this.transparency.indexed||[],s=new Uint8Array((r.length||0)+i.length),a=0,t=0,e=n=0,o=i.length;n<o;e=n+=3)s[a++]=i[e],s[a++]=i[e+1],s[a++]=i[e+2],s[a++]=null!=(h=r[t++])?h:255;return s},h.prototype.copyToImageData=function(t,e){var i,a,s,r,n,o,h,c,p,l,d;if(a=this.colors,p=null,i=this.hasAlphaChannel,this.palette.length&&(p=null!=(d=this._decodedPalette)?d:this._decodedPalette=this.decodePalette(),a=4,i=!0),c=(s=t.data||t).length,n=p||e,r=o=0,1===a)for(;r<c;)h=p?4*e[r/4]:o,l=n[h++],s[r++]=l,s[r++]=l,s[r++]=l,s[r++]=i?n[h++]:this.transparency.grayscale&&this.transparency.grayscale===l?0:255,o=h;else for(;r<c;)h=p?4*e[r/4]:o,s[r++]=n[h++],s[r++]=n[h++],s[r++]=n[h++],s[r++]=i?n[h++]:this.transparency.rgb&&this.transparency.rgb[1]===n[h-3]&&this.transparency.rgb[3]===n[h-2]&&this.transparency.rgb[5]===n[h-1]?0:255,o=h},h.prototype.decode=function(){var t;return t=new Uint8Array(this.width*this.height*4),this.copyToImageData(t,this.decodePixels()),t},r=t.document&&t.document.createElement(\"canvas\"),n=r&&r.getContext(\"2d\"),s=function(t){var e;return n.width=t.width,n.height=t.height,n.clearRect(0,0,t.width,t.height),n.putImageData(t,0,0),(e=new Image).src=r.toDataURL(),e},h.prototype.decodeFrames=function(t){var e,i,a,r,n,o,h,c;if(this.animation){for(c=[],i=n=0,o=(h=this.animation.frames).length;n<o;i=++n)e=h[i],a=t.createImageData(e.width,e.height),r=this.decodePixels(new Uint8Array(e.data)),this.copyToImageData(a,r),e.imageData=a,c.push(e.image=s(a));return c}},h.prototype.renderFrame=function(t,s){var r,n,o;return r=(n=this.animation.frames)[s],o=n[s-1],0===s&&t.clearRect(0,0,this.width,this.height),(null!=o?o.disposeOp:void 0)===i?t.clearRect(o.xOffset,o.yOffset,o.width,o.height):(null!=o?o.disposeOp:void 0)===a&&t.putImageData(o.imageData,o.xOffset,o.yOffset),r.blendOp===e&&t.clearRect(r.xOffset,r.yOffset,r.width,r.height),t.drawImage(r.image,r.xOffset,r.yOffset)},h.prototype.animate=function(t){var e,i,a,s,r,n,o=this;return i=0,n=this.animation,s=n.numFrames,a=n.frames,r=n.numPlays,(e=function(){var n,h;if(n=i++%s,h=a[n],o.renderFrame(t,n),s>1&&i/s<r)return o.animation._timeout=setTimeout(e,h.delay)})()},h.prototype.stopAnimation=function(){var t;return clearTimeout(null!=(t=this.animation)?t._timeout:void 0)},h.prototype.render=function(t){var e,i;return t._png&&t._png.stopAnimation(),t._png=this,t.width=this.width,t.height=this.height,e=t.getContext(\"2d\"),this.animation?(this.decodeFrames(e),this.animate(e)):(i=e.createImageData(this.width,this.height),this.copyToImageData(i,this.decodePixels()),e.putImageData(i,0,0))},h}(self);const f=new Set([\"jpg\",\"png\",\"bmp\",\"gif\"]),u=new Set([\"S8\",\"U8\",\"S16\",\"U16\",\"S32\",\"U32\",\"F32\",\"F64\"]);async function m(i,a){var n;if(!l)throw new t(\"rasterCoded:decode\",\"lerc decoder is not supported on big endian platform\");await s();const{offset:o,noDataValue:h}=a;let c=null==(n=a.pixelType)?void 0:n.toUpperCase();c&&!u.has(c)&&(c=null);const{width:p,height:d,pixelType:f,statistics:m,pixels:g,mask:w}=r(i,{inputOffset:o,noDataValue:h,pixelType:c});return new e({width:p,height:d,pixelType:f.toLowerCase(),pixels:g,mask:w,statistics:m})}async function g(t,i){const a=await p(t,i.pyramidLevel||0),s=new e({width:a.width,height:a.height,pixels:a.pixels,pixelType:a.pixelType.toLowerCase(),mask:a.mask,statistics:null});return s.updateStatistics(),s}async function w(t,i){const a=await c(t,i.customOptions),s=new e({width:a.width,height:a.height,pixels:a.pixels,pixelType:a.pixelType.toLowerCase(),mask:a.mask,statistics:null});return s.updateStatistics(),s}function y(t,i){const a=i.pixelType||\"u8\",s=e.getPixelArrayConstructor(a),r=\"u8\"===a?t:new s(t.buffer),n=[],o=i.planes||1;if(1===o)n.push(r);else for(let e=0;e<o;e++){const a=(i.width||1)*(i.height||t.length),h=new s(a);for(let t=0;t<a;t++)h[t]=r[t*o+e];n.push(h)}const h=new e({width:i.width||1,height:i.height||t.length,pixels:n,pixelType:a,statistics:null});return h.updateStatistics(),h}function x(t,e){return y(new o(new Uint8Array(t)).getBytes(),e)}function b(t,e){return y(n(t,e.offset,e.eof,!e.isInputBigEndian),e)}function k(t,i,a){const{pixelTypeCtor:s}=A(i.pixelType),r=(0,h.decode)(t,{width:i.width,height:i.height,pixelType:s,format:a}),n=new e({width:i.width,height:i.height,pixels:r.pixels,pixelType:i.pixelType,mask:r.mask,statistics:null});return n.updateStatistics(),n}function T(t){const i=a.decode(t),s=new e({width:i.width,height:i.height,pixels:i.pixels,pixelType:\"U8\",mask:i.mask,statistics:null});return s.updateStatistics(),s}function U(t,i){const a=new Uint8Array(t),s=new d(a),{width:r,height:n}=i,o=r*n,h=s.decode();let c,p=0,l=0;const f=new Uint8Array(o);for(p=0;p<o;p++)f[p]=h[4*p+3];const u=new e({width:r,height:n,pixels:[],pixelType:\"U8\",mask:f,statistics:[]});for(p=0;p<3;p++){for(c=new Uint8Array(o),l=0;l<o;l++)c[l]=h[4*l+p];u.addData({pixels:c})}return u.updateStatistics(),u}async function v(t,a,s,r){const n=new i,o={applyJpegMask:!1,format:a,...s},h=await n.decode(t,o,r),c=new e(h);return c.updateStatistics(),c}function I(e){if(null==e)throw new t(\"rasterCodec:decode\",\"parameter encodeddata is required.\");const i=new Uint8Array(e,0,10);let a=\"\";return 255===i[0]&&216===i[1]?a=\"jpg\":137===i[0]&&80===i[1]&&78===i[2]&&71===i[3]?a=\"png\":67===i[0]&&110===i[1]&&116===i[2]&&90===i[3]&&73===i[4]&&109===i[5]&&97===i[6]&&103===i[7]&&101===i[8]&&32===i[9]?a=\"lerc\":76===i[0]&&101===i[1]&&114===i[2]&&99===i[3]&&50===i[4]&&32===i[5]?a=\"lerc2\":73===i[0]&&73===i[1]&&42===i[2]&&0===i[3]||77===i[0]&&77===i[1]&&0===i[2]&&42===i[3]||73===i[0]&&73===i[1]&&43===i[2]&&0===i[3]||77===i[0]&&77===i[1]&&0===i[2]&&43===i[3]?a=\"tiff\":71===i[0]&&73===i[1]&&70===i[2]?a=\"gif\":66===i[0]&&77===i[1]?a=\"bmp\":String.fromCharCode.apply(null,i).toLowerCase().indexOf(\"error\")>-1&&(a=\"error\"),a}function C(e){let i=null;switch(e){case\"lerc\":case\"lerc2\":i=m;break;case\"jpg\":i=T;break;case\"png\":i=U;break;case\"bsq\":case\"bip\":i=(t,i)=>k(t,i,e);break;case\"tiff\":i=g;break;case\"deflate\":i=x;break;case\"lzw\":i=b;break;case\"error\":i=()=>{throw new t(\"rasterCodec:decode\",\"input data contains error\")};break;default:i=()=>{throw new t(\"rasterCodec:decode\",\"unsupported raster format\")}}return i}function A(t){let e=null,i=null;switch(t?t.toLowerCase():\"f32\"){case\"u1\":case\"u2\":case\"u4\":case\"u8\":i=255,e=Uint8Array;break;case\"u16\":i=i||65535,e=Uint16Array;break;case\"u32\":i=i||2**32-1,e=Uint32Array;break;case\"s8\":i=i||-128,e=Int8Array;break;case\"s16\":i=i||-32768,e=Int16Array;break;case\"s32\":i=i||0-2**31,e=Int32Array;break;default:e=Float32Array}return{pixelTypeCtor:e,noDataValue:i}}function D(t,i=1){if(!t)return;const{pixels:a,width:s,height:r,mask:n}=t;if(!a||0===a.length)return;const o=a.length,h=s-1,c=r-1,p=[];let l,d,f,u,m,g,w;const y=e.getPixelArrayConstructor(t.pixelType);if(0===i){for(l=0;l<o;l++){for(m=a[l],g=new y(h*c),d=0;d<c;d++)for(u=d*s,f=0;f<h;f++)g[d*h+f]=m[u+f];p.push(g)}if(n)for(w=new Uint8Array(h*c),d=0;d<c;d++)for(u=d*s,f=0;f<h;f++)w[d*h+f]=n[u+f]}else{for(l=0;l<o;l++){for(m=a[l],g=new y(h*c),d=0;d<c;d++)for(u=d*s,f=0;f<h;f++)g[d*h+f]=(m[u+f]+m[u+f+1]+m[u+s+f]+m[u+s+f+1])/4;p.push(g)}if(n)for(w=new Uint8Array(h*c),d=0;d<c;d++)for(u=d*s,f=0;f<h;f++)w[d*h+f]=Math.min.apply(null,[n[u+f],n[u+f+1],n[u+s+f],n[u+s+f+1]])}t.width=h,t.height=c,t.mask=w,t.pixels=p}function O(t){let e=I(t);return\"lerc2\"===e?e=\"lerc\":\"error\"===e&&(e=\"\"),e}async function S(e,i={},a){if(null==e)throw new t(\"rasterCodec:decode\",\"missing encodeddata parameter.\");let s,r,n=i.format&&i.format.toLowerCase();if(!(\"bsq\"!==n&&\"bip\"!==n||null!=i.width&&null!=i.height))throw new t(\"rasterCodec:decode\",\"requires width and height in options parameter.\");return\"tiff\"===n&&i.customOptions?w(e,i):((!n||\"bsq\"!==n&&\"bip\"!==n&&\"deflate\"!==n&&\"lzw\"!==n)&&(n=I(e)),i.useCanvas&&f.has(n)?r=await v(e,n,i,a):(s=C(n),i.isPoint&&((i={...i}).width++,i.height++),r=await s(e,i),i.isPoint&&D(r)),r)}export{S as decode,O as getFormat};\n"]},"metadata":{},"sourceType":"module"}