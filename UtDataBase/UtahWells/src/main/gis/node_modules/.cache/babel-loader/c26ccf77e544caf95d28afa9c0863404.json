{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport e from \"../Basemap.js\";\nimport r from \"../config.js\";\nimport a from \"../core/Collection.js\";\nimport n from \"../core/Logger.js\";\nimport { isSome as t, isNone as l } from \"../core/maybe.js\";\nimport { normalize as i, Url as s, makeAbsolute as u } from \"../core/urlUtils.js\";\nimport { ensureType as c } from \"../core/accessorSupport/ensureType.js\";\nimport { esriBasemapDefinitions as o } from \"./basemapDefinitions.js\";\nconst f = n.getLogger(\"esri.support.basemapUtils\");\n\nfunction p() {\n  return {};\n}\n\nfunction y(e) {\n  for (const r in e) {\n    const a = e[r];\n    !1 === (null == a ? void 0 : a.destroyed) && a.destroy(), delete e[r];\n  }\n}\n\nfunction m(a, n) {\n  var t;\n  let l;\n\n  if (\"string\" == typeof a) {\n    if (!(a in o)) {\n      const e = Object.entries(o).filter(_ref => {\n        let [e, a] = _ref;\n        return r.apiKey && !a.classic || !r.apiKey && a.classic && !a.deprecated;\n      }).map(_ref2 => {\n        let [e] = _ref2;\n        return `\"${e}\"`;\n      }).join(\", \");\n      return f.warn(`Unable to find basemap definition for: ${a}. Try one of these: ${e}`), null;\n    }\n\n    n && (l = n[a]), l || (l = e.fromId(a), n && (n[a] = l));\n  } else l = c(e, a);\n\n  return null != (t = l) && t.destroyed && (f.warn(\"The provided basemap is already destroyed\", {\n    basemap: l\n  }), l = null), l;\n}\n\nfunction d(r) {\n  let a = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n  const n = m(r);\n  if (!n) return null;\n  const t = new e({\n    id: n.id,\n    title: n.title,\n    baseLayers: n.baseLayers.slice(),\n    referenceLayers: n.referenceLayers.slice()\n  });\n  return a && (t.baseLayers = v(t.baseLayers, a.baseLayers), t.referenceLayers = v(t.referenceLayers, a.referenceLayers)), t.load().catch(() => {}), t.portalItem = n.portalItem, t;\n}\n\nfunction b(e) {\n  let r = null;\n  const a = T(e),\n        n = !a.baseLayers.length;\n\n  for (const t in o) {\n    const e = M(a, q(o[t]), {\n      mustMatchReferences: n\n    });\n\n    if (\"equal\" === e) {\n      r = t;\n      break;\n    }\n\n    \"base-layers-equal\" === e && (r = t);\n  }\n\n  return r;\n}\n\nfunction L(e, r) {\n  if (e === r) return !0;\n  return \"equal\" === M(T(e), T(r), {\n    mustMatchReferences: !0\n  });\n}\n\nfunction v(e, r) {\n  const n = new a();\n  return e.forEach(e => {\n    const a = r.find(r => $(j(e), j(r))) || e;\n    n.some(e => e === a) ? n.push(e) : n.push(a);\n  }), n;\n}\n\nfunction g(e) {\n  return !(null == e || !e.baseLayers.concat(e.referenceLayers).some(S));\n}\n\nfunction S(e) {\n  if (I(e.url)) return !0;\n  if (\"vector-tile\" === e.type) for (const r in e.sourceNameToSource) {\n    const a = e.sourceNameToSource[r];\n    if (I(null == a ? void 0 : a.sourceUrl)) return !0;\n  }\n  return !1;\n}\n\nfunction h(e, r) {\n  var a, n, t;\n  if (l(r) || l(e)) return {\n    spatialReference: null,\n    updating: !1\n  };\n  if (\"not-loaded\" === r.loadStatus) return r.load(), {\n    spatialReference: null,\n    updating: !0\n  };\n  if (r.spatialReference) return {\n    spatialReference: r.spatialReference,\n    updating: !1\n  };\n  if (0 === r.baseLayers.length) return {\n    spatialReference: null,\n    updating: !1\n  };\n  const i = r.baseLayers.getItemAt(0);\n\n  switch (i.loadStatus) {\n    case \"not-loaded\":\n      i.load();\n\n    case \"loading\":\n      return {\n        spatialReference: null,\n        updating: !0\n      };\n\n    case \"failed\":\n      return {\n        spatialReference: null,\n        updating: !1\n      };\n  }\n\n  const s = ((\"supportedSpatialReferences\" in i ? i.supportedSpatialReferences : null) || [\"tileInfo\" in i ? null == (a = i.tileInfo) ? void 0 : a.spatialReference : i.spatialReference]).filter(Boolean);\n  return e.spatialReference ? {\n    spatialReference: null != (n = null != (t = s.find(r => e.spatialReference.equals(r))) ? t : s[0]) ? n : null,\n    updating: !1\n  } : {\n    spatialReference: s[0],\n    updating: !1\n  };\n}\n\nconst R = /^(basemaps|ibasemaps).*-api\\.arcgis\\.com$/i;\n\nfunction I(e) {\n  if (!e) return !1;\n  const r = new s(u(e));\n  return R.test(r.authority);\n}\n\nfunction T(e) {\n  return e ? !e.loaded && e.resourceInfo ? q(e.resourceInfo.data) : {\n    baseLayers: w(e.baseLayers),\n    referenceLayers: w(e.referenceLayers)\n  } : null;\n}\n\nfunction w(e) {\n  return (a.isCollection(e) ? e.toArray() : e).map(j);\n}\n\nfunction j(e) {\n  var r, a;\n  return {\n    type: e.type,\n    url: A(\"urlTemplate\" in e && e.urlTemplate || e.url || \"styleUrl\" in e && e.styleUrl),\n    minScale: \"minScale\" in e && null != e.minScale ? e.minScale : 0,\n    maxScale: \"maxScale\" in e && null != e.maxScale ? e.maxScale : 0,\n    opacity: null != e.opacity ? e.opacity : 1,\n    visible: null == e.visible || !!e.visible,\n    sublayers: \"map-image\" !== e.type && \"wms\" !== e.type || !t(e.sublayers) || null == (r = e.sublayers) ? void 0 : r.map(e => ({\n      id: e.id,\n      visible: e.visible\n    })),\n    activeLayerId: \"wmts\" === e.type ? null == (a = e.activeLayer) ? void 0 : a.id : void 0\n  };\n}\n\nfunction q(e) {\n  return e ? {\n    baseLayers: x(e.baseMapLayers.filter(e => !e.isReference)),\n    referenceLayers: x(e.baseMapLayers.filter(e => e.isReference))\n  } : null;\n}\n\nfunction x(e) {\n  return e.map(e => U(e));\n}\n\nfunction U(e) {\n  let r;\n\n  switch (e.layerType) {\n    case \"VectorTileLayer\":\n      r = \"vector-tile\";\n      break;\n\n    case \"ArcGISTiledMapServiceLayer\":\n      r = \"tile\";\n      break;\n\n    default:\n      r = \"unknown\";\n  }\n\n  return {\n    type: r,\n    url: A(e.templateUrl || e.urlTemplate || e.styleUrl || e.url),\n    minScale: null != e.minScale ? e.minScale : 0,\n    maxScale: null != e.maxScale ? e.maxScale : 0,\n    opacity: null != e.opacity ? e.opacity : 1,\n    visible: null == e.visibility || !!e.visibility,\n    sublayers: void 0,\n    activeLayerId: void 0\n  };\n}\n\nfunction M(e, r, a) {\n  if (null != e != (null != r)) return \"not-equal\";\n  if (!e) return \"equal\";\n  if (!k(e.baseLayers, r.baseLayers)) return \"not-equal\";\n  return k(e.referenceLayers, r.referenceLayers) ? \"equal\" : a.mustMatchReferences ? \"not-equal\" : \"base-layers-equal\";\n}\n\nfunction k(e, r) {\n  if (e.length !== r.length) return !1;\n\n  for (let a = 0; a < e.length; a++) if (!$(e[a], r[a])) return !1;\n\n  return !0;\n}\n\nfunction $(e, r) {\n  if (e.type !== r.type || e.url !== r.url || e.minScale !== r.minScale || e.maxScale !== r.maxScale || e.visible !== r.visible || e.opacity !== r.opacity) return !1;\n  if (t(e.activeLayerId) || t(r.activeLayerId)) return e.activeLayerId === r.activeLayerId;\n\n  if (t(e.sublayers) || t(r.sublayers)) {\n    if (l(e.sublayers) || l(r.sublayers) || e.sublayers.length !== r.sublayers.length) return !1;\n\n    for (let a = 0; a < e.sublayers.length; a++) {\n      const n = e.sublayers.at(a),\n            t = r.sublayers.at(a);\n      if (n.id !== t.id || n.visible !== t.visible) return !1;\n    }\n  }\n\n  return !0;\n}\n\nfunction A(e) {\n  return e ? i(e).replace(/^\\s*https?:/i, \"\").toLowerCase() : \"\";\n}\n\nexport { d as clonePreservingTiledLayers, L as contentEquals, p as createCache, y as destroyCache, m as ensureType, h as findSpatialReference, b as getWellKnownBasemapId, g as hasDeveloperBasemapLayer, S as isDeveloperBasemapLayer };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/support/basemapUtils.js"],"names":["e","r","a","n","isSome","t","isNone","l","normalize","i","Url","s","makeAbsolute","u","ensureType","c","esriBasemapDefinitions","o","f","getLogger","p","y","destroyed","destroy","m","Object","entries","filter","apiKey","classic","deprecated","map","join","warn","fromId","basemap","d","id","title","baseLayers","slice","referenceLayers","v","load","catch","portalItem","b","T","length","M","q","mustMatchReferences","L","forEach","find","$","j","some","push","g","concat","S","I","url","type","sourceNameToSource","sourceUrl","h","spatialReference","updating","loadStatus","getItemAt","supportedSpatialReferences","tileInfo","Boolean","equals","R","test","authority","loaded","resourceInfo","data","w","isCollection","toArray","A","urlTemplate","styleUrl","minScale","maxScale","opacity","visible","sublayers","activeLayerId","activeLayer","x","baseMapLayers","isReference","U","layerType","templateUrl","visibility","k","at","replace","toLowerCase","clonePreservingTiledLayers","contentEquals","createCache","destroyCache","findSpatialReference","getWellKnownBasemapId","hasDeveloperBasemapLayer","isDeveloperBasemapLayer"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport e from\"../Basemap.js\";import r from\"../config.js\";import a from\"../core/Collection.js\";import n from\"../core/Logger.js\";import{isSome as t,isNone as l}from\"../core/maybe.js\";import{normalize as i,Url as s,makeAbsolute as u}from\"../core/urlUtils.js\";import{ensureType as c}from\"../core/accessorSupport/ensureType.js\";import{esriBasemapDefinitions as o}from\"./basemapDefinitions.js\";const f=n.getLogger(\"esri.support.basemapUtils\");function p(){return{}}function y(e){for(const r in e){const a=e[r];!1===(null==a?void 0:a.destroyed)&&a.destroy(),delete e[r]}}function m(a,n){var t;let l;if(\"string\"==typeof a){if(!(a in o)){const e=Object.entries(o).filter((([e,a])=>r.apiKey&&!a.classic||!r.apiKey&&a.classic&&!a.deprecated)).map((([e])=>`\"${e}\"`)).join(\", \");return f.warn(`Unable to find basemap definition for: ${a}. Try one of these: ${e}`),null}n&&(l=n[a]),l||(l=e.fromId(a),n&&(n[a]=l))}else l=c(e,a);return null!=(t=l)&&t.destroyed&&(f.warn(\"The provided basemap is already destroyed\",{basemap:l}),l=null),l}function d(r,a=null){const n=m(r);if(!n)return null;const t=new e({id:n.id,title:n.title,baseLayers:n.baseLayers.slice(),referenceLayers:n.referenceLayers.slice()});return a&&(t.baseLayers=v(t.baseLayers,a.baseLayers),t.referenceLayers=v(t.referenceLayers,a.referenceLayers)),t.load().catch((()=>{})),t.portalItem=n.portalItem,t}function b(e){let r=null;const a=T(e),n=!a.baseLayers.length;for(const t in o){const e=M(a,q(o[t]),{mustMatchReferences:n});if(\"equal\"===e){r=t;break}\"base-layers-equal\"===e&&(r=t)}return r}function L(e,r){if(e===r)return!0;return\"equal\"===M(T(e),T(r),{mustMatchReferences:!0})}function v(e,r){const n=new a;return e.forEach((e=>{const a=r.find((r=>$(j(e),j(r))))||e;n.some((e=>e===a))?n.push(e):n.push(a)})),n}function g(e){return!(null==e||!e.baseLayers.concat(e.referenceLayers).some(S))}function S(e){if(I(e.url))return!0;if(\"vector-tile\"===e.type)for(const r in e.sourceNameToSource){const a=e.sourceNameToSource[r];if(I(null==a?void 0:a.sourceUrl))return!0}return!1}function h(e,r){var a,n,t;if(l(r)||l(e))return{spatialReference:null,updating:!1};if(\"not-loaded\"===r.loadStatus)return r.load(),{spatialReference:null,updating:!0};if(r.spatialReference)return{spatialReference:r.spatialReference,updating:!1};if(0===r.baseLayers.length)return{spatialReference:null,updating:!1};const i=r.baseLayers.getItemAt(0);switch(i.loadStatus){case\"not-loaded\":i.load();case\"loading\":return{spatialReference:null,updating:!0};case\"failed\":return{spatialReference:null,updating:!1}}const s=((\"supportedSpatialReferences\"in i?i.supportedSpatialReferences:null)||[\"tileInfo\"in i?null==(a=i.tileInfo)?void 0:a.spatialReference:i.spatialReference]).filter(Boolean);return e.spatialReference?{spatialReference:null!=(n=null!=(t=s.find((r=>e.spatialReference.equals(r))))?t:s[0])?n:null,updating:!1}:{spatialReference:s[0],updating:!1}}const R=/^(basemaps|ibasemaps).*-api\\.arcgis\\.com$/i;function I(e){if(!e)return!1;const r=new s(u(e));return R.test(r.authority)}function T(e){return e?!e.loaded&&e.resourceInfo?q(e.resourceInfo.data):{baseLayers:w(e.baseLayers),referenceLayers:w(e.referenceLayers)}:null}function w(e){return(a.isCollection(e)?e.toArray():e).map(j)}function j(e){var r,a;return{type:e.type,url:A(\"urlTemplate\"in e&&e.urlTemplate||e.url||\"styleUrl\"in e&&e.styleUrl),minScale:\"minScale\"in e&&null!=e.minScale?e.minScale:0,maxScale:\"maxScale\"in e&&null!=e.maxScale?e.maxScale:0,opacity:null!=e.opacity?e.opacity:1,visible:null==e.visible||!!e.visible,sublayers:\"map-image\"!==e.type&&\"wms\"!==e.type||!t(e.sublayers)||null==(r=e.sublayers)?void 0:r.map((e=>({id:e.id,visible:e.visible}))),activeLayerId:\"wmts\"===e.type?null==(a=e.activeLayer)?void 0:a.id:void 0}}function q(e){return e?{baseLayers:x(e.baseMapLayers.filter((e=>!e.isReference))),referenceLayers:x(e.baseMapLayers.filter((e=>e.isReference)))}:null}function x(e){return e.map((e=>U(e)))}function U(e){let r;switch(e.layerType){case\"VectorTileLayer\":r=\"vector-tile\";break;case\"ArcGISTiledMapServiceLayer\":r=\"tile\";break;default:r=\"unknown\"}return{type:r,url:A(e.templateUrl||e.urlTemplate||e.styleUrl||e.url),minScale:null!=e.minScale?e.minScale:0,maxScale:null!=e.maxScale?e.maxScale:0,opacity:null!=e.opacity?e.opacity:1,visible:null==e.visibility||!!e.visibility,sublayers:void 0,activeLayerId:void 0}}function M(e,r,a){if(null!=e!=(null!=r))return\"not-equal\";if(!e)return\"equal\";if(!k(e.baseLayers,r.baseLayers))return\"not-equal\";return k(e.referenceLayers,r.referenceLayers)?\"equal\":a.mustMatchReferences?\"not-equal\":\"base-layers-equal\"}function k(e,r){if(e.length!==r.length)return!1;for(let a=0;a<e.length;a++)if(!$(e[a],r[a]))return!1;return!0}function $(e,r){if(e.type!==r.type||e.url!==r.url||e.minScale!==r.minScale||e.maxScale!==r.maxScale||e.visible!==r.visible||e.opacity!==r.opacity)return!1;if(t(e.activeLayerId)||t(r.activeLayerId))return e.activeLayerId===r.activeLayerId;if(t(e.sublayers)||t(r.sublayers)){if(l(e.sublayers)||l(r.sublayers)||e.sublayers.length!==r.sublayers.length)return!1;for(let a=0;a<e.sublayers.length;a++){const n=e.sublayers.at(a),t=r.sublayers.at(a);if(n.id!==t.id||n.visible!==t.visible)return!1}}return!0}function A(e){return e?i(e).replace(/^\\s*https?:/i,\"\").toLowerCase():\"\"}export{d as clonePreservingTiledLayers,L as contentEquals,p as createCache,y as destroyCache,m as ensureType,h as findSpatialReference,b as getWellKnownBasemapId,g as hasDeveloperBasemapLayer,S as isDeveloperBasemapLayer};\n"]},"metadata":{},"sourceType":"module"}