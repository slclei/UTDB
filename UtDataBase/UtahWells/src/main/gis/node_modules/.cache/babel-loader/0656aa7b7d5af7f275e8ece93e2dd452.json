{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport e from \"../../../core/Logger.js\";\nimport { all as r, eachAlways as t } from \"../../../core/promiseUtils.js\";\nimport a from \"../../../layers/FeatureLayer.js\";\nimport { applyTextFormattingHTML as i, htmlEntities as s } from \"./featureUtils.js\";\nconst n = [\"$datastore\", \"$map\", \"$layer\", \"$aggregatedfeatures\"],\n      o = \"esri.widgets.Feature.support.arcadeFeatureUtils\",\n      c = e.getLogger(o);\n\nfunction p(e) {\n  return \"string\" == typeof e ? i(s(e)) : Array.isArray(e) ? l(e) : \"esri.arcade.Dictionary\" === (null == e ? void 0 : e.declaredClass) ? u(e) : e;\n}\n\nfunction l(e) {\n  return `<ul class=\"esri-widget__list\">${e.map(e => `<li>${\"string\" == typeof e ? i(s(e)) : e}</li>`).join(\"\")}</ul>`;\n}\n\nfunction u(e) {\n  return `<table class=\"esri-widget__table\">${e.keys().map(r => {\n    const t = e.field(r);\n    return `<tr><th>${r}</th><td>${\"string\" == typeof t ? i(s(t)) : t}</td></tr>`;\n  }).join(\"\")}</table>`;\n}\n\nfunction f(_ref) {\n  let {\n    aggregatedFeatures: e,\n    arcadeUtils: r,\n    featureSetVars: t,\n    context: i,\n    viewInfo: s,\n    map: n,\n    graphic: o,\n    interceptor: c\n  } = _ref;\n  t.forEach(t => {\n    const p = t.toLowerCase(),\n          l = {\n      map: n,\n      spatialReference: s.sr,\n      interceptor: c\n    };\n\n    if (\"$map\" === p && (i.vars[p] = r.convertMapToFeatureSetCollection(l)), \"$layer\" === p && (i.vars[p] = r.convertFeatureLayerToFeatureSet({\n      layer: o.sourceLayer,\n      spatialReference: s.sr,\n      interceptor: c\n    })), \"$datastore\" === p && (i.vars[p] = r.convertServiceUrlToWorkspace({\n      url: o.sourceLayer.url,\n      spatialReference: s.sr,\n      interceptor: c\n    })), \"$aggregatedfeatures\" === p) {\n      const t = o.layer,\n            {\n        fields: n,\n        objectIdField: l,\n        geometryType: u,\n        spatialReference: f,\n        displayField: d\n      } = t,\n            g = new a({\n        fields: n,\n        objectIdField: l,\n        geometryType: u,\n        spatialReference: f,\n        displayField: d,\n        ...(\"feature\" === t.type ? {\n          templates: t.templates,\n          typeIdField: t.typeIdField,\n          types: t.types\n        } : null),\n        source: e\n      });\n      i.vars[p] = r.convertFeatureLayerToFeatureSet({\n        layer: g,\n        spatialReference: s.sr,\n        interceptor: c\n      });\n    }\n  });\n}\n\nfunction d() {\n  return import(\"../../../support/arcadeUtils.js\");\n}\n\nasync function g(_ref2) {\n  let {\n    graphic: e,\n    view: r\n  } = _ref2;\n  const {\n    isAggregate: t,\n    layer: a\n  } = e;\n  if (!t || !a || \"2d\" !== (null == r ? void 0 : r.type)) return [];\n  const i = await r.whenLayerView(a);\n  if (!i.createQuery || !i.queryFeatures) return [];\n  const s = i.createQuery();\n  s.aggregateIds = [e.getObjectId()];\n  const {\n    features: n\n  } = await i.queryFeatures(s);\n  return n;\n}\n\nasync function y(_ref3) {\n  let {\n    expressionInfo: e,\n    arcadeUtils: t,\n    interceptor: a,\n    spatialReference: i,\n    map: s,\n    graphic: o,\n    view: p\n  } = _ref3;\n  if (!e || !e.expression) return null;\n  const l = t.createSyntaxTree(e.expression),\n        u = n.filter(e => t.hasVariable(l, e)),\n        [d] = await r([g({\n    graphic: o,\n    view: p\n  }), t.loadScriptDependencies(l, !0, u)]),\n        y = t.getViewInfo({\n    spatialReference: i\n  }),\n        m = t.createExecContext(o, y);\n  m.interceptor = a, m.useAsync = !0, f({\n    aggregatedFeatures: d,\n    arcadeUtils: t,\n    featureSetVars: u,\n    context: m,\n    viewInfo: y,\n    map: s,\n    graphic: o,\n    interceptor: a\n  });\n  const w = t.createFunction(l, m);\n  return t.executeAsyncFunction(w, m).catch(r => c.error(\"arcade-execution-error\", {\n    error: r,\n    graphic: o,\n    expressionInfo: e\n  }));\n}\n\nasync function m(_ref4) {\n  let {\n    expressionInfos: e,\n    spatialReference: r,\n    graphic: a,\n    interceptor: i,\n    map: s,\n    view: n\n  } = _ref4;\n  if (!e || !e.length) return {};\n  const o = await d(),\n        c = {};\n\n  for (const t of e) c[`expression/${t.name}`] = y({\n    expressionInfo: t,\n    arcadeUtils: o,\n    interceptor: i,\n    spatialReference: r,\n    map: s,\n    graphic: a,\n    view: n\n  });\n\n  const l = await t(c),\n        u = {};\n\n  for (const t in l) u[t] = p(l[t].value);\n\n  return u;\n}\n\nexport { y as createCompiledExpression, m as createCompiledExpressions, d as loadArcadeUtils };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/widgets/Feature/support/arcadeFeatureUtils.js"],"names":["e","all","r","eachAlways","t","a","applyTextFormattingHTML","i","htmlEntities","s","n","o","c","getLogger","p","Array","isArray","l","declaredClass","u","map","join","keys","field","f","aggregatedFeatures","arcadeUtils","featureSetVars","context","viewInfo","graphic","interceptor","forEach","toLowerCase","spatialReference","sr","vars","convertMapToFeatureSetCollection","convertFeatureLayerToFeatureSet","layer","sourceLayer","convertServiceUrlToWorkspace","url","fields","objectIdField","geometryType","displayField","d","g","type","templates","typeIdField","types","source","view","isAggregate","whenLayerView","createQuery","queryFeatures","aggregateIds","getObjectId","features","y","expressionInfo","expression","createSyntaxTree","filter","hasVariable","loadScriptDependencies","getViewInfo","m","createExecContext","useAsync","w","createFunction","executeAsyncFunction","catch","error","expressionInfos","length","name","value","createCompiledExpression","createCompiledExpressions","loadArcadeUtils"],"mappings":"AAAA;AACA;AACA;AACA;AACA,OAAOA,CAAP,MAAa,yBAAb;AAAuC,SAAOC,GAAG,IAAIC,CAAd,EAAgBC,UAAU,IAAIC,CAA9B,QAAoC,+BAApC;AAAoE,OAAOC,CAAP,MAAa,iCAAb;AAA+C,SAAOC,uBAAuB,IAAIC,CAAlC,EAAoCC,YAAY,IAAIC,CAApD,QAA0D,mBAA1D;AAA8E,MAAMC,CAAC,GAAC,CAAC,YAAD,EAAc,MAAd,EAAqB,QAArB,EAA8B,qBAA9B,CAAR;AAAA,MAA6DC,CAAC,GAAC,iDAA/D;AAAA,MAAiHC,CAAC,GAACZ,CAAC,CAACa,SAAF,CAAYF,CAAZ,CAAnH;;AAAkI,SAASG,CAAT,CAAWd,CAAX,EAAa;AAAC,SAAM,YAAU,OAAOA,CAAjB,GAAmBO,CAAC,CAACE,CAAC,CAACT,CAAD,CAAF,CAApB,GAA2Be,KAAK,CAACC,OAAN,CAAchB,CAAd,IAAiBiB,CAAC,CAACjB,CAAD,CAAlB,GAAsB,8BAA4B,QAAMA,CAAN,GAAQ,KAAK,CAAb,GAAeA,CAAC,CAACkB,aAA7C,IAA4DC,CAAC,CAACnB,CAAD,CAA7D,GAAiEA,CAAxH;AAA0H;;AAAA,SAASiB,CAAT,CAAWjB,CAAX,EAAa;AAAC,SAAO,iCAAgCA,CAAC,CAACoB,GAAF,CAAOpB,CAAC,IAAG,OAAM,YAAU,OAAOA,CAAjB,GAAmBO,CAAC,CAACE,CAAC,CAACT,CAAD,CAAF,CAApB,GAA2BA,CAAE,OAA9C,EAAuDqB,IAAvD,CAA4D,EAA5D,CAAgE,OAAvG;AAA8G;;AAAA,SAASF,CAAT,CAAWnB,CAAX,EAAa;AAAC,SAAO,qCAAoCA,CAAC,CAACsB,IAAF,GAASF,GAAT,CAAclB,CAAC,IAAE;AAAC,UAAME,CAAC,GAACJ,CAAC,CAACuB,KAAF,CAAQrB,CAAR,CAAR;AAAmB,WAAO,WAAUA,CAAE,YAAW,YAAU,OAAOE,CAAjB,GAAmBG,CAAC,CAACE,CAAC,CAACL,CAAD,CAAF,CAApB,GAA2BA,CAAE,YAA3D;AAAuE,GAA5G,EAA+GiB,IAA/G,CAAoH,EAApH,CAAwH,UAAnK;AAA6K;;AAAA,SAASG,CAAT,OAAoH;AAAA,MAAzG;AAACC,IAAAA,kBAAkB,EAACzB,CAApB;AAAsB0B,IAAAA,WAAW,EAACxB,CAAlC;AAAoCyB,IAAAA,cAAc,EAACvB,CAAnD;AAAqDwB,IAAAA,OAAO,EAACrB,CAA7D;AAA+DsB,IAAAA,QAAQ,EAACpB,CAAxE;AAA0EW,IAAAA,GAAG,EAACV,CAA9E;AAAgFoB,IAAAA,OAAO,EAACnB,CAAxF;AAA0FoB,IAAAA,WAAW,EAACnB;AAAtG,GAAyG;AAACR,EAAAA,CAAC,CAAC4B,OAAF,CAAW5B,CAAC,IAAE;AAAC,UAAMU,CAAC,GAACV,CAAC,CAAC6B,WAAF,EAAR;AAAA,UAAwBhB,CAAC,GAAC;AAACG,MAAAA,GAAG,EAACV,CAAL;AAAOwB,MAAAA,gBAAgB,EAACzB,CAAC,CAAC0B,EAA1B;AAA6BJ,MAAAA,WAAW,EAACnB;AAAzC,KAA1B;;AAAsE,QAAG,WAASE,CAAT,KAAaP,CAAC,CAAC6B,IAAF,CAAOtB,CAAP,IAAUZ,CAAC,CAACmC,gCAAF,CAAmCpB,CAAnC,CAAvB,GAA8D,aAAWH,CAAX,KAAeP,CAAC,CAAC6B,IAAF,CAAOtB,CAAP,IAAUZ,CAAC,CAACoC,+BAAF,CAAkC;AAACC,MAAAA,KAAK,EAAC5B,CAAC,CAAC6B,WAAT;AAAqBN,MAAAA,gBAAgB,EAACzB,CAAC,CAAC0B,EAAxC;AAA2CJ,MAAAA,WAAW,EAACnB;AAAvD,KAAlC,CAAzB,CAA9D,EAAqL,iBAAeE,CAAf,KAAmBP,CAAC,CAAC6B,IAAF,CAAOtB,CAAP,IAAUZ,CAAC,CAACuC,4BAAF,CAA+B;AAACC,MAAAA,GAAG,EAAC/B,CAAC,CAAC6B,WAAF,CAAcE,GAAnB;AAAuBR,MAAAA,gBAAgB,EAACzB,CAAC,CAAC0B,EAA1C;AAA6CJ,MAAAA,WAAW,EAACnB;AAAzD,KAA/B,CAA7B,CAArL,EAA+S,0BAAwBE,CAA1U,EAA4U;AAAC,YAAMV,CAAC,GAACO,CAAC,CAAC4B,KAAV;AAAA,YAAgB;AAACI,QAAAA,MAAM,EAACjC,CAAR;AAAUkC,QAAAA,aAAa,EAAC3B,CAAxB;AAA0B4B,QAAAA,YAAY,EAAC1B,CAAvC;AAAyCe,QAAAA,gBAAgB,EAACV,CAA1D;AAA4DsB,QAAAA,YAAY,EAACC;AAAzE,UAA4E3C,CAA5F;AAAA,YAA8F4C,CAAC,GAAC,IAAI3C,CAAJ,CAAM;AAACsC,QAAAA,MAAM,EAACjC,CAAR;AAAUkC,QAAAA,aAAa,EAAC3B,CAAxB;AAA0B4B,QAAAA,YAAY,EAAC1B,CAAvC;AAAyCe,QAAAA,gBAAgB,EAACV,CAA1D;AAA4DsB,QAAAA,YAAY,EAACC,CAAzE;AAA2E,YAAG,cAAY3C,CAAC,CAAC6C,IAAd,GAAmB;AAACC,UAAAA,SAAS,EAAC9C,CAAC,CAAC8C,SAAb;AAAuBC,UAAAA,WAAW,EAAC/C,CAAC,CAAC+C,WAArC;AAAiDC,UAAAA,KAAK,EAAChD,CAAC,CAACgD;AAAzD,SAAnB,GAAmF,IAAtF,CAA3E;AAAsKC,QAAAA,MAAM,EAACrD;AAA7K,OAAN,CAAhG;AAAuRO,MAAAA,CAAC,CAAC6B,IAAF,CAAOtB,CAAP,IAAUZ,CAAC,CAACoC,+BAAF,CAAkC;AAACC,QAAAA,KAAK,EAACS,CAAP;AAASd,QAAAA,gBAAgB,EAACzB,CAAC,CAAC0B,EAA5B;AAA+BJ,QAAAA,WAAW,EAACnB;AAA3C,OAAlC,CAAV;AAA2F;AAAC,GAArxB;AAAwxB;;AAAA,SAASmC,CAAT,GAAY;AAAC,SAAO,OAAO,iCAAP,CAAP;AAAiD;;AAAA,eAAeC,CAAf,QAAoC;AAAA,MAAnB;AAAClB,IAAAA,OAAO,EAAC9B,CAAT;AAAWsD,IAAAA,IAAI,EAACpD;AAAhB,GAAmB;AAAC,QAAK;AAACqD,IAAAA,WAAW,EAACnD,CAAb;AAAemC,IAAAA,KAAK,EAAClC;AAArB,MAAwBL,CAA7B;AAA+B,MAAG,CAACI,CAAD,IAAI,CAACC,CAAL,IAAQ,UAAQ,QAAMH,CAAN,GAAQ,KAAK,CAAb,GAAeA,CAAC,CAAC+C,IAAzB,CAAX,EAA0C,OAAM,EAAN;AAAS,QAAM1C,CAAC,GAAC,MAAML,CAAC,CAACsD,aAAF,CAAgBnD,CAAhB,CAAd;AAAiC,MAAG,CAACE,CAAC,CAACkD,WAAH,IAAgB,CAAClD,CAAC,CAACmD,aAAtB,EAAoC,OAAM,EAAN;AAAS,QAAMjD,CAAC,GAACF,CAAC,CAACkD,WAAF,EAAR;AAAwBhD,EAAAA,CAAC,CAACkD,YAAF,GAAe,CAAC3D,CAAC,CAAC4D,WAAF,EAAD,CAAf;AAAiC,QAAK;AAACC,IAAAA,QAAQ,EAACnD;AAAV,MAAa,MAAMH,CAAC,CAACmD,aAAF,CAAgBjD,CAAhB,CAAxB;AAA2C,SAAOC,CAAP;AAAS;;AAAA,eAAeoD,CAAf,QAA0G;AAAA,MAAzF;AAACC,IAAAA,cAAc,EAAC/D,CAAhB;AAAkB0B,IAAAA,WAAW,EAACtB,CAA9B;AAAgC2B,IAAAA,WAAW,EAAC1B,CAA5C;AAA8C6B,IAAAA,gBAAgB,EAAC3B,CAA/D;AAAiEa,IAAAA,GAAG,EAACX,CAArE;AAAuEqB,IAAAA,OAAO,EAACnB,CAA/E;AAAiF2C,IAAAA,IAAI,EAACxC;AAAtF,GAAyF;AAAC,MAAG,CAACd,CAAD,IAAI,CAACA,CAAC,CAACgE,UAAV,EAAqB,OAAO,IAAP;AAAY,QAAM/C,CAAC,GAACb,CAAC,CAAC6D,gBAAF,CAAmBjE,CAAC,CAACgE,UAArB,CAAR;AAAA,QAAyC7C,CAAC,GAACT,CAAC,CAACwD,MAAF,CAAUlE,CAAC,IAAEI,CAAC,CAAC+D,WAAF,CAAclD,CAAd,EAAgBjB,CAAhB,CAAb,CAA3C;AAAA,QAA6E,CAAC+C,CAAD,IAAI,MAAM7C,CAAC,CAAC,CAAC8C,CAAC,CAAC;AAAClB,IAAAA,OAAO,EAACnB,CAAT;AAAW2C,IAAAA,IAAI,EAACxC;AAAhB,GAAD,CAAF,EAAuBV,CAAC,CAACgE,sBAAF,CAAyBnD,CAAzB,EAA2B,CAAC,CAA5B,EAA8BE,CAA9B,CAAvB,CAAD,CAAxF;AAAA,QAAmJ2C,CAAC,GAAC1D,CAAC,CAACiE,WAAF,CAAc;AAACnC,IAAAA,gBAAgB,EAAC3B;AAAlB,GAAd,CAArJ;AAAA,QAAyL+D,CAAC,GAAClE,CAAC,CAACmE,iBAAF,CAAoB5D,CAApB,EAAsBmD,CAAtB,CAA3L;AAAoNQ,EAAAA,CAAC,CAACvC,WAAF,GAAc1B,CAAd,EAAgBiE,CAAC,CAACE,QAAF,GAAW,CAAC,CAA5B,EAA8BhD,CAAC,CAAC;AAACC,IAAAA,kBAAkB,EAACsB,CAApB;AAAsBrB,IAAAA,WAAW,EAACtB,CAAlC;AAAoCuB,IAAAA,cAAc,EAACR,CAAnD;AAAqDS,IAAAA,OAAO,EAAC0C,CAA7D;AAA+DzC,IAAAA,QAAQ,EAACiC,CAAxE;AAA0E1C,IAAAA,GAAG,EAACX,CAA9E;AAAgFqB,IAAAA,OAAO,EAACnB,CAAxF;AAA0FoB,IAAAA,WAAW,EAAC1B;AAAtG,GAAD,CAA/B;AAA0I,QAAMoE,CAAC,GAACrE,CAAC,CAACsE,cAAF,CAAiBzD,CAAjB,EAAmBqD,CAAnB,CAAR;AAA8B,SAAOlE,CAAC,CAACuE,oBAAF,CAAuBF,CAAvB,EAAyBH,CAAzB,EAA4BM,KAA5B,CAAmC1E,CAAC,IAAEU,CAAC,CAACiE,KAAF,CAAQ,wBAAR,EAAiC;AAACA,IAAAA,KAAK,EAAC3E,CAAP;AAAS4B,IAAAA,OAAO,EAACnB,CAAjB;AAAmBoD,IAAAA,cAAc,EAAC/D;AAAlC,GAAjC,CAAtC,CAAP;AAAsH;;AAAA,eAAesE,CAAf,QAA6F;AAAA,MAA5E;AAACQ,IAAAA,eAAe,EAAC9E,CAAjB;AAAmBkC,IAAAA,gBAAgB,EAAChC,CAApC;AAAsC4B,IAAAA,OAAO,EAACzB,CAA9C;AAAgD0B,IAAAA,WAAW,EAACxB,CAA5D;AAA8Da,IAAAA,GAAG,EAACX,CAAlE;AAAoE6C,IAAAA,IAAI,EAAC5C;AAAzE,GAA4E;AAAC,MAAG,CAACV,CAAD,IAAI,CAACA,CAAC,CAAC+E,MAAV,EAAiB,OAAM,EAAN;AAAS,QAAMpE,CAAC,GAAC,MAAMoC,CAAC,EAAf;AAAA,QAAkBnC,CAAC,GAAC,EAApB;;AAAuB,OAAI,MAAMR,CAAV,IAAeJ,CAAf,EAAiBY,CAAC,CAAE,cAAaR,CAAC,CAAC4E,IAAK,EAAtB,CAAD,GAA0BlB,CAAC,CAAC;AAACC,IAAAA,cAAc,EAAC3D,CAAhB;AAAkBsB,IAAAA,WAAW,EAACf,CAA9B;AAAgCoB,IAAAA,WAAW,EAACxB,CAA5C;AAA8C2B,IAAAA,gBAAgB,EAAChC,CAA/D;AAAiEkB,IAAAA,GAAG,EAACX,CAArE;AAAuEqB,IAAAA,OAAO,EAACzB,CAA/E;AAAiFiD,IAAAA,IAAI,EAAC5C;AAAtF,GAAD,CAA3B;;AAAsH,QAAMO,CAAC,GAAC,MAAMb,CAAC,CAACQ,CAAD,CAAf;AAAA,QAAmBO,CAAC,GAAC,EAArB;;AAAwB,OAAI,MAAMf,CAAV,IAAea,CAAf,EAAiBE,CAAC,CAACf,CAAD,CAAD,GAAKU,CAAC,CAACG,CAAC,CAACb,CAAD,CAAD,CAAK6E,KAAN,CAAN;;AAAmB,SAAO9D,CAAP;AAAS;;AAAA,SAAO2C,CAAC,IAAIoB,wBAAZ,EAAqCZ,CAAC,IAAIa,yBAA1C,EAAoEpC,CAAC,IAAIqC,eAAzE","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport e from\"../../../core/Logger.js\";import{all as r,eachAlways as t}from\"../../../core/promiseUtils.js\";import a from\"../../../layers/FeatureLayer.js\";import{applyTextFormattingHTML as i,htmlEntities as s}from\"./featureUtils.js\";const n=[\"$datastore\",\"$map\",\"$layer\",\"$aggregatedfeatures\"],o=\"esri.widgets.Feature.support.arcadeFeatureUtils\",c=e.getLogger(o);function p(e){return\"string\"==typeof e?i(s(e)):Array.isArray(e)?l(e):\"esri.arcade.Dictionary\"===(null==e?void 0:e.declaredClass)?u(e):e}function l(e){return`<ul class=\"esri-widget__list\">${e.map((e=>`<li>${\"string\"==typeof e?i(s(e)):e}</li>`)).join(\"\")}</ul>`}function u(e){return`<table class=\"esri-widget__table\">${e.keys().map((r=>{const t=e.field(r);return`<tr><th>${r}</th><td>${\"string\"==typeof t?i(s(t)):t}</td></tr>`})).join(\"\")}</table>`}function f({aggregatedFeatures:e,arcadeUtils:r,featureSetVars:t,context:i,viewInfo:s,map:n,graphic:o,interceptor:c}){t.forEach((t=>{const p=t.toLowerCase(),l={map:n,spatialReference:s.sr,interceptor:c};if(\"$map\"===p&&(i.vars[p]=r.convertMapToFeatureSetCollection(l)),\"$layer\"===p&&(i.vars[p]=r.convertFeatureLayerToFeatureSet({layer:o.sourceLayer,spatialReference:s.sr,interceptor:c})),\"$datastore\"===p&&(i.vars[p]=r.convertServiceUrlToWorkspace({url:o.sourceLayer.url,spatialReference:s.sr,interceptor:c})),\"$aggregatedfeatures\"===p){const t=o.layer,{fields:n,objectIdField:l,geometryType:u,spatialReference:f,displayField:d}=t,g=new a({fields:n,objectIdField:l,geometryType:u,spatialReference:f,displayField:d,...\"feature\"===t.type?{templates:t.templates,typeIdField:t.typeIdField,types:t.types}:null,source:e});i.vars[p]=r.convertFeatureLayerToFeatureSet({layer:g,spatialReference:s.sr,interceptor:c})}}))}function d(){return import(\"../../../support/arcadeUtils.js\")}async function g({graphic:e,view:r}){const{isAggregate:t,layer:a}=e;if(!t||!a||\"2d\"!==(null==r?void 0:r.type))return[];const i=await r.whenLayerView(a);if(!i.createQuery||!i.queryFeatures)return[];const s=i.createQuery();s.aggregateIds=[e.getObjectId()];const{features:n}=await i.queryFeatures(s);return n}async function y({expressionInfo:e,arcadeUtils:t,interceptor:a,spatialReference:i,map:s,graphic:o,view:p}){if(!e||!e.expression)return null;const l=t.createSyntaxTree(e.expression),u=n.filter((e=>t.hasVariable(l,e))),[d]=await r([g({graphic:o,view:p}),t.loadScriptDependencies(l,!0,u)]),y=t.getViewInfo({spatialReference:i}),m=t.createExecContext(o,y);m.interceptor=a,m.useAsync=!0,f({aggregatedFeatures:d,arcadeUtils:t,featureSetVars:u,context:m,viewInfo:y,map:s,graphic:o,interceptor:a});const w=t.createFunction(l,m);return t.executeAsyncFunction(w,m).catch((r=>c.error(\"arcade-execution-error\",{error:r,graphic:o,expressionInfo:e})))}async function m({expressionInfos:e,spatialReference:r,graphic:a,interceptor:i,map:s,view:n}){if(!e||!e.length)return{};const o=await d(),c={};for(const t of e)c[`expression/${t.name}`]=y({expressionInfo:t,arcadeUtils:o,interceptor:i,spatialReference:r,map:s,graphic:a,view:n});const l=await t(c),u={};for(const t in l)u[t]=p(l[t].value);return u}export{y as createCompiledExpression,m as createCompiledExpressions,d as loadArcadeUtils};\n"]},"metadata":{},"sourceType":"module"}