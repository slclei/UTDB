{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport { unwrapOr as t } from \"../../../../../../core/maybe.js\";\nimport { pt2px as e } from \"../../../../../../core/screenUtils.js\";\nimport { c as o } from \"../../../../../../chunks/mat2df32.js\";\nimport { c as s } from \"../../../../../../chunks/vec2f32.js\";\nimport { Alignment as i, ExtremityPlacement as r } from \"../../../../../../symbols/cim/enums.js\";\nimport { premultiplyAlphaRGBA as a, premultiplyAlphaRGBAArray as n } from \"../../color.js\";\nimport { MIN_MAX_ZOOM_PRECISION_FACTOR as h, BITSET_MARKER_ALIGNMENT_MAP as l, BITSET_MARKER_ALIGNMENT_SCREEN as m, BITSET_GENERIC_LOCK_COLOR as c, BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE as f, BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY as d, SPRITE_PADDING as u, PICTURE_FILL_COLOR as M } from \"../../definitions.js\";\nimport { i1616to32 as p, i8888to32 as x } from \"../../number.js\";\nimport { MarkerMaterialKey as y } from \"../../materialKey/MaterialKey.js\";\nimport { getMinMaxZoom as S, DEFAULT_MIN_ZOOM as _, DEFAULT_MAX_ZOOM as g } from \"./util.js\";\nimport V from \"./WGLBaseMarkerTemplate.js\";\nimport z from \"./WGLMeshTemplate.js\";\n\nclass B extends V(z) {\n  constructor(t, e, r, a, n, M, S, _, g, V, z, B, b, k, w, j, L, C, P, R, E, v, A) {\n    super(), this.angle = a, this.height = S, this.width = M, this.xOffset = e * P, this.yOffset = r * P, this._markerPlacement = R, this._effects = E, this._anchorX = .5 - (.5 + j) * w.width / w.width, this._anchorY = .5 - (.5 + L) * w.height / w.height, this._minMaxZoom = p(Math.round(v * h), Math.round(A * h));\n    const K = (k === i.MAP ? l : m) | (z ? c : 0) | (b ? f : 0) | (B ? d : 0),\n          U = w && w.sdf,\n          W = y.load(t);\n    W.sdf = U, W.pattern = !0, W.textureBinding = w.textureBinding, this._materialKey = W.data, this._fillColor = n, this._outlineColor = g, this._sizeOutlineWidth = x(Math.round(Math.min(Math.sqrt(128 * M), 255)), Math.round(Math.min(Math.sqrt(128 * S), 255)), Math.round(Math.min(Math.sqrt(128 * V), 255)), Math.round(Math.min(Math.sqrt(128 * _), 255)));\n    const X = w.rect.x + u,\n          q = w.rect.y + u,\n          T = X + w.width,\n          Y = q + w.height;\n    this._offsets.xUpperLeft = X, this._offsets.yUpperLeft = q, this._offsets.xUpperRight = T, this._offsets.yUpperRight = q, this._offsets.xBottomLeft = X, this._offsets.yBottomLeft = Y, this._offsets.xBottomRight = T, this._offsets.yBottomRight = Y, this._texUpperLeft = p(X, q), this._texUpperRight = p(T, q), this._texBottomLeft = p(X, Y), this._texBottomRight = p(T, Y), M *= C, S *= C, M *= P, S *= P;\n    const N = Math.round(64 * C);\n    this._bitestAndDistRatio = p(K, N), this._computedWidth = M, this._computedHeight = S;\n    const H = s(),\n          I = o();\n\n    this._applyTransformation(I, H);\n  }\n\n  static fromCIMMarker(o, s, r) {\n    const n = s && s.width || 1,\n          h = s && s.height || 1,\n          l = o.size,\n          m = n / h * o.scaleX,\n          c = o.scaleSymbolsProportionally && o.frameHeight ? l / o.frameHeight : 1;\n    let f = a(o.color);\n\n    const d = a(o.outlineColor),\n          u = e(l),\n          M = u * m,\n          p = e(o.offsetX || 0),\n          x = e(o.offsetY || 0),\n          y = e(o.outlineWidth || 0) * c,\n          _ = o.alignment || i.SCREEN,\n          g = e(o.referenceSize),\n          [V, z] = S(o.scaleInfo, r);\n\n    s.sdf || 0 !== f || (f = -1);\n    let b = o.rotation || 0;\n    o.rotateClockwise || (b = -b);\n    let k = 0,\n        w = 0;\n    const j = o.anchorPoint;\n    j && (o.isAbsoluteAnchorPoint ? l && (k = -j.x / (l * m), w = j.y / l) : (k = j.x, w = j.y));\n    const L = new B(o.materialKey, p, x, b, f, M, u, g, d, y, o.colorLocked, o.scaleSymbolsProportionally, !1, _, s, k, w, o.sizeRatio, t(o.scaleFactor, 1), o.markerPlacement, o.effects, V, z);\n    return L._vertexBoundsScaleX = o.maxVVSize ? o.maxVVSize / M : 1, L._vertexBoundsScaleY = o.maxVVSize ? o.maxVVSize / u : 1, L;\n  }\n\n  static fromPictureMarker(t, o) {\n    const s = Math.round(e(t.width)),\n          r = Math.round(e(t.height)),\n          a = M,\n          n = Math.round(e(t.xoffset || 0)),\n          h = Math.round(e(t.yoffset || 0)),\n          l = new B(t.materialKey, n, h, t.angle, a, s, r, r, 0, 0, !1, !1, !1, i.SCREEN, o, 0, 0, 1, 1, null, null, _, g);\n    return l._vertexBoundsScaleX = t.maxVVSize ? t.maxVVSize / t.width : 1, l._vertexBoundsScaleY = t.maxVVSize ? t.maxVVSize / t.height : 1, l;\n  }\n\n  static fromSimpleMarker(t, o) {\n    const s = n(t.color),\n          r = Math.round(e(t.size)),\n          a = r,\n          h = Math.round(e(t.xoffset || 0)),\n          l = Math.round(e(t.yoffset || 0)),\n          m = t.style,\n          c = t.outline,\n          f = 0 | (c && c.color && n(c.color)),\n          d = 0 | (c && c.width && Math.round(e(c.width))),\n          u = new B(t.materialKey, h, l, t.angle, s, r, a, a, f, d, !1, !1, \"esriSMSCross\" === m || \"esriSMSX\" === m, i.SCREEN, o, 0, 0, 126 / 64, 1, null, null, _, g);\n    return u.boundsType = \"esriSMSCircle\" === m ? \"circle\" : \"square\", u._vertexBoundsScaleX = t.maxVVSize ? t.maxVVSize / t.size : 1, u._vertexBoundsScaleY = t.maxVVSize ? t.maxVVSize / t.size : 1, u;\n  }\n\n  static fromLineSymbolMarker(t, o) {\n    const s = n(t.color),\n          a = 6,\n          h = Math.round(e(a * t.lineWidth)),\n          l = h,\n          m = \"cross\" === t.style || \"x\" === t.style;\n    let c;\n\n    switch (t.placement) {\n      case \"begin-end\":\n        c = r.Both;\n        break;\n\n      case \"begin\":\n        c = r.JustBegin;\n        break;\n\n      case \"end\":\n        c = r.JustEnd;\n        break;\n\n      default:\n        c = r.None;\n    }\n\n    const f = {\n      type: \"CIMMarkerPlacementAtExtremities\",\n      angleToLine: !0,\n      offset: 0,\n      extremityPlacement: c,\n      offsetAlongLine: 0\n    },\n          d = new B(t.materialKey, 0, 0, 0, s, h, l, l / a, s, m ? Math.round(e(t.lineWidth)) : 0, !1, !1, m, i.MAP, o, 0, 0, 126 / 64, 1, f, null, _, g);\n    return d.boundsType = \"circle\" === t.style ? \"circle\" : \"square\", d;\n  }\n\n}\n\nexport { B as default };","map":{"version":3,"sources":["D:/Github/CUSP_DataBase/CUSP_DB/src/main/gis/node_modules/@arcgis/core/views/2d/engine/webgl/mesh/templates/WGLMarkerTemplate.js"],"names":["unwrapOr","t","pt2px","e","c","o","s","Alignment","i","ExtremityPlacement","r","premultiplyAlphaRGBA","a","premultiplyAlphaRGBAArray","n","MIN_MAX_ZOOM_PRECISION_FACTOR","h","BITSET_MARKER_ALIGNMENT_MAP","l","BITSET_MARKER_ALIGNMENT_SCREEN","m","BITSET_GENERIC_LOCK_COLOR","BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE","f","BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY","d","SPRITE_PADDING","u","PICTURE_FILL_COLOR","M","i1616to32","p","i8888to32","x","MarkerMaterialKey","y","getMinMaxZoom","S","DEFAULT_MIN_ZOOM","_","DEFAULT_MAX_ZOOM","g","V","z","B","constructor","b","k","w","j","L","C","P","R","E","v","A","angle","height","width","xOffset","yOffset","_markerPlacement","_effects","_anchorX","_anchorY","_minMaxZoom","Math","round","K","MAP","U","sdf","W","load","pattern","textureBinding","_materialKey","data","_fillColor","_outlineColor","_sizeOutlineWidth","min","sqrt","X","rect","q","T","Y","_offsets","xUpperLeft","yUpperLeft","xUpperRight","yUpperRight","xBottomLeft","yBottomLeft","xBottomRight","yBottomRight","_texUpperLeft","_texUpperRight","_texBottomLeft","_texBottomRight","N","_bitestAndDistRatio","_computedWidth","_computedHeight","H","I","_applyTransformation","fromCIMMarker","size","scaleX","scaleSymbolsProportionally","frameHeight","color","outlineColor","offsetX","offsetY","outlineWidth","alignment","SCREEN","referenceSize","scaleInfo","rotation","rotateClockwise","anchorPoint","isAbsoluteAnchorPoint","materialKey","colorLocked","sizeRatio","scaleFactor","markerPlacement","effects","_vertexBoundsScaleX","maxVVSize","_vertexBoundsScaleY","fromPictureMarker","xoffset","yoffset","fromSimpleMarker","style","outline","boundsType","fromLineSymbolMarker","lineWidth","placement","Both","JustBegin","JustEnd","None","type","angleToLine","offset","extremityPlacement","offsetAlongLine","default"],"mappings":"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","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nimport{unwrapOr as t}from\"../../../../../../core/maybe.js\";import{pt2px as e}from\"../../../../../../core/screenUtils.js\";import{c as o}from\"../../../../../../chunks/mat2df32.js\";import{c as s}from\"../../../../../../chunks/vec2f32.js\";import{Alignment as i,ExtremityPlacement as r}from\"../../../../../../symbols/cim/enums.js\";import{premultiplyAlphaRGBA as a,premultiplyAlphaRGBAArray as n}from\"../../color.js\";import{MIN_MAX_ZOOM_PRECISION_FACTOR as h,BITSET_MARKER_ALIGNMENT_MAP as l,BITSET_MARKER_ALIGNMENT_SCREEN as m,BITSET_GENERIC_LOCK_COLOR as c,BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE as f,BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY as d,SPRITE_PADDING as u,PICTURE_FILL_COLOR as M}from\"../../definitions.js\";import{i1616to32 as p,i8888to32 as x}from\"../../number.js\";import{MarkerMaterialKey as y}from\"../../materialKey/MaterialKey.js\";import{getMinMaxZoom as S,DEFAULT_MIN_ZOOM as _,DEFAULT_MAX_ZOOM as g}from\"./util.js\";import V from\"./WGLBaseMarkerTemplate.js\";import z from\"./WGLMeshTemplate.js\";class B extends(V(z)){constructor(t,e,r,a,n,M,S,_,g,V,z,B,b,k,w,j,L,C,P,R,E,v,A){super(),this.angle=a,this.height=S,this.width=M,this.xOffset=e*P,this.yOffset=r*P,this._markerPlacement=R,this._effects=E,this._anchorX=.5-(.5+j)*w.width/w.width,this._anchorY=.5-(.5+L)*w.height/w.height,this._minMaxZoom=p(Math.round(v*h),Math.round(A*h));const K=(k===i.MAP?l:m)|(z?c:0)|(b?f:0)|(B?d:0),U=w&&w.sdf,W=y.load(t);W.sdf=U,W.pattern=!0,W.textureBinding=w.textureBinding,this._materialKey=W.data,this._fillColor=n,this._outlineColor=g,this._sizeOutlineWidth=x(Math.round(Math.min(Math.sqrt(128*M),255)),Math.round(Math.min(Math.sqrt(128*S),255)),Math.round(Math.min(Math.sqrt(128*V),255)),Math.round(Math.min(Math.sqrt(128*_),255)));const X=w.rect.x+u,q=w.rect.y+u,T=X+w.width,Y=q+w.height;this._offsets.xUpperLeft=X,this._offsets.yUpperLeft=q,this._offsets.xUpperRight=T,this._offsets.yUpperRight=q,this._offsets.xBottomLeft=X,this._offsets.yBottomLeft=Y,this._offsets.xBottomRight=T,this._offsets.yBottomRight=Y,this._texUpperLeft=p(X,q),this._texUpperRight=p(T,q),this._texBottomLeft=p(X,Y),this._texBottomRight=p(T,Y),M*=C,S*=C,M*=P,S*=P;const N=Math.round(64*C);this._bitestAndDistRatio=p(K,N),this._computedWidth=M,this._computedHeight=S;const H=s(),I=o();this._applyTransformation(I,H)}static fromCIMMarker(o,s,r){const n=s&&s.width||1,h=s&&s.height||1,l=o.size,m=n/h*o.scaleX,c=o.scaleSymbolsProportionally&&o.frameHeight?l/o.frameHeight:1;let f=a(o.color);const d=a(o.outlineColor),u=e(l),M=u*m,p=e(o.offsetX||0),x=e(o.offsetY||0),y=e(o.outlineWidth||0)*c,_=o.alignment||i.SCREEN,g=e(o.referenceSize),[V,z]=S(o.scaleInfo,r);s.sdf||0!==f||(f=-1);let b=o.rotation||0;o.rotateClockwise||(b=-b);let k=0,w=0;const j=o.anchorPoint;j&&(o.isAbsoluteAnchorPoint?l&&(k=-j.x/(l*m),w=j.y/l):(k=j.x,w=j.y));const L=new B(o.materialKey,p,x,b,f,M,u,g,d,y,o.colorLocked,o.scaleSymbolsProportionally,!1,_,s,k,w,o.sizeRatio,t(o.scaleFactor,1),o.markerPlacement,o.effects,V,z);return L._vertexBoundsScaleX=o.maxVVSize?o.maxVVSize/M:1,L._vertexBoundsScaleY=o.maxVVSize?o.maxVVSize/u:1,L}static fromPictureMarker(t,o){const s=Math.round(e(t.width)),r=Math.round(e(t.height)),a=M,n=Math.round(e(t.xoffset||0)),h=Math.round(e(t.yoffset||0)),l=new B(t.materialKey,n,h,t.angle,a,s,r,r,0,0,!1,!1,!1,i.SCREEN,o,0,0,1,1,null,null,_,g);return l._vertexBoundsScaleX=t.maxVVSize?t.maxVVSize/t.width:1,l._vertexBoundsScaleY=t.maxVVSize?t.maxVVSize/t.height:1,l}static fromSimpleMarker(t,o){const s=n(t.color),r=Math.round(e(t.size)),a=r,h=Math.round(e(t.xoffset||0)),l=Math.round(e(t.yoffset||0)),m=t.style,c=t.outline,f=0|(c&&c.color&&n(c.color)),d=0|(c&&c.width&&Math.round(e(c.width))),u=new B(t.materialKey,h,l,t.angle,s,r,a,a,f,d,!1,!1,\"esriSMSCross\"===m||\"esriSMSX\"===m,i.SCREEN,o,0,0,126/64,1,null,null,_,g);return u.boundsType=\"esriSMSCircle\"===m?\"circle\":\"square\",u._vertexBoundsScaleX=t.maxVVSize?t.maxVVSize/t.size:1,u._vertexBoundsScaleY=t.maxVVSize?t.maxVVSize/t.size:1,u}static fromLineSymbolMarker(t,o){const s=n(t.color),a=6,h=Math.round(e(a*t.lineWidth)),l=h,m=\"cross\"===t.style||\"x\"===t.style;let c;switch(t.placement){case\"begin-end\":c=r.Both;break;case\"begin\":c=r.JustBegin;break;case\"end\":c=r.JustEnd;break;default:c=r.None}const f={type:\"CIMMarkerPlacementAtExtremities\",angleToLine:!0,offset:0,extremityPlacement:c,offsetAlongLine:0},d=new B(t.materialKey,0,0,0,s,h,l,l/a,s,m?Math.round(e(t.lineWidth)):0,!1,!1,m,i.MAP,o,0,0,126/64,1,f,null,_,g);return d.boundsType=\"circle\"===t.style?\"circle\":\"square\",d}}export{B as default};\n"]},"metadata":{},"sourceType":"module"}